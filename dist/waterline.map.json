{"version":3,"file":"bundle.js","sources":["/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/browser-pack/_prelude.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline.js","/Users/robwormald/Dev/Sails/waterline/utils/main.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/collection/loader.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/helpers.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/connections/index.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/collection/index.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/model/index.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/extend.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/model/lib/model.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-schema/lib/waterline-schema.js","/Users/robwormald/Dev/Sails/waterline/node_modules/async/lib/async.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/core/index.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/index.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/model/lib/internalMethods/index.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/model/lib/defaultMethods/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/lodash/dist/lodash.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/process/browser.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-schema/lib/waterline-schema/attributes.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-schema/lib/waterline-schema/foreignKeys.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-schema/lib/waterline-schema/joinTables.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-schema/lib/waterline-schema/references.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/schema.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/collection/defaults.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/core/typecast.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/core/schema.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/core/dictionary.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/core/validations.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/core/transformations.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/adapters.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/validate.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/ddl.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/aggregate.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/composite.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/finders/basic.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/finders/helpers.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/finders/dynamicFinders.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/stream.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/model/lib/internalMethods/normalizeAssociations.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/model/lib/internalMethods/defineAssociations.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/model/lib/defaultMethods/toObject.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/model/lib/defaultMethods/destroy.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/model/lib/defaultMethods/save.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/adapter/index.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/dql/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-schema/lib/waterline-schema/utils.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/types.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/callbacks.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/error/WLValidationError.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/usageError.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/normalize.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/callbacksRunner.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/deferred.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/stream.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/inherits/inherits_browser.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/sorter.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/finders/joins.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/finders/operations.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/adapter/dql.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/adapter/compoundQueries.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/adapter/aggregateQueries.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/adapter/setupTeardown.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/adapter/stream.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/model/lib/association.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/model/lib/associationMethods/update.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/model/lib/associationMethods/add.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/model/lib/associationMethods/remove.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/dql/create.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/dql/destroy.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/dql/update.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/dql/count.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/dql/join.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/integrator/index.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/adapter/ddl/index.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/adapter/sync/index.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/error/WLError.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/error/WLUsageError.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/acyclicTraversal.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/transformations.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/stream-browserify/index.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/error/index.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/getRelations.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/integrator/leftOuterJoin.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/integrator/innerJoin.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/integrator/populate.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/adapter/sync/strategies/drop.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/adapter/sync/strategies/alter.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/adapter/sync/strategies/safe.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/nestedOperations/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/events/events.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/integrator/_join.js","/Users/robwormald/Dev/Sails/waterline/node_modules/anchor/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/readable-stream/readable.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/readable-stream/writable.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/readable-stream/transform.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/readable-stream/duplex.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/readable-stream/passthrough.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/nestedOperations/reduceAssociations.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/nestedOperations/valuesParser.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/nestedOperations/create.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/utils/nestedOperations/update.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-criteria/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/anchor/lib/match/rules.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/readable-stream/lib/_stream_readable.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/readable-stream/lib/_stream_writable.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/readable-stream/lib/_stream_duplex.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/readable-stream/lib/_stream_transform.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/readable-stream/lib/_stream_passthrough.js","/Users/robwormald/Dev/Sails/waterline/node_modules/q/q.js","/Users/robwormald/Dev/Sails/waterline/lib/waterline/query/integrator/_partialJoin.js","/Users/robwormald/Dev/Sails/waterline/node_modules/anchor/lib/match/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/node-switchback/lib/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/assert/assert.js","/Users/robwormald/Dev/Sails/waterline/node_modules/deep-diff/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/anchor/node_modules/validator/validator.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-criteria/lib/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/buffer/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/node-switchback/lib/factory.js","/Users/robwormald/Dev/Sails/waterline/node_modules/node-switchback/lib/normalize.js","/Users/robwormald/Dev/Sails/waterline/node_modules/node-switchback/lib/constants.js","/Users/robwormald/Dev/Sails/waterline/node_modules/anchor/lib/match/matchType.js","/Users/robwormald/Dev/Sails/waterline/node_modules/anchor/lib/match/matchRule.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-criteria/lib/query.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-criteria/lib/filters/where.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-criteria/lib/filters/limit.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-criteria/lib/filters/skip.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-criteria/lib/sort.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-criteria/lib/projections/groupBy.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-criteria/lib/projections/select.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/path-browserify/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/assert/node_modules/util/util.js","/Users/robwormald/Dev/Sails/waterline/node_modules/anchor/lib/match/errorFactory.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/readable-stream/node_modules/string_decoder/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/readable-stream/node_modules/isarray/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/buffer/node_modules/ieee754/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/readable-stream/node_modules/core-util-is/lib/util.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-criteria/lib/X_ISO_DATE.constant.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/buffer/node_modules/base64-js/lib/b64.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/assert/node_modules/util/support/isBufferBrowser.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/lib/prompt.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-criteria/node_modules/include-all/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/waterline-criteria/node_modules/include-all/node_modules/underscore.string/lib/underscore.string.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/read/lib/read.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/pkginfo/lib/pkginfo.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/revalidator/lib/revalidator.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/lib/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/lib/winston.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/lib/file.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/lib/args.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/lib/base64.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/lib/format.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/lib/winston/transports.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/lib/winston/common.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/lib/winston/exception.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/lib/winston/config.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/lib/winston/container.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/lib/winston/logger.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/lib/winston/transports/transport.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/lib/winston/config/cli-config.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/lib/winston/config/npm-config.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/lib/winston/config/syslog-config.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/crypto-browserify/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/os-browserify/browser.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/read/node_modules/mute-stream/mute.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/node_modules/deep-equal/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/node_modules/rimraf/rimraf.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/node_modules/mkdirp/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/node_modules/ncp/lib/ncp.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/node_modules/i/lib/inflect.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/node_modules/pkginfo/lib/pkginfo.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/crypto-browserify/sha.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/crypto-browserify/sha256.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/crypto-browserify/rng.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/crypto-browserify/md5.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/node_modules/deep-equal/lib/keys.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/node_modules/deep-equal/lib/is_arguments.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/node_modules/i/lib/methods.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/node_modules/i/lib/native.js","/Users/robwormald/Dev/Sails/waterline/node_modules/browserify/node_modules/crypto-browserify/helpers.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/node_modules/cycle/cycle.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/node_modules/colors/colors.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/node_modules/async/index.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/node_modules/stack-trace/lib/stack-trace.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/node_modules/i/lib/util.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/node_modules/i/lib/inflections.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/winston/node_modules/async/lib/async.js","/Users/robwormald/Dev/Sails/waterline/node_modules/prompt/node_modules/utile/node_modules/i/lib/defaults.js"],"names":["_","require","async","Schema","Connections","CollectionLoader","hasOwnProperty","object","Waterline","module","exports","this","_collections","_connections","Collection","Model","prototype","loadCollection","collection","push","initialize","options","cb","item","next","loader","self","connections","defaults","collections","identity","toLowerCase","Error","adapters","cloneDeep","schema","auto","loadCollections","each","err","junctionTables","Object","keys","forEach","table","junctionTable","extend","buildCollectionSchemas","schemas","key","clone","_schema","meta","waterline","definition","registerConnections","results","nextItem","connection","config","usedSchemas","_adapter","coll","__proto__","tableName","registerConnection","bootstrap","teardown","toBeSynced","reduce","resources","eachSeries","sync","_validate","namedConnections","_getConnections","context","usedConnections","Array","isArray","conn","msg","objMap","input","mapper","obj","v","k","call","pluralize","application","map","isObject","capitalize","str","String","charAt","toUpperCase","slice","hop","prop","matchMongoId","id","isString","isFunction","toString","match","util","_build","format","adapter","merge","inherits","Core","Query","attributes","defaultMethods","internalMethods","mixins","prototypeFns","toObject","save","destroy","_defineAssociations","defineAssociations","_normalizeAssociations","normalizeAssociations","validate","values","protectedAttributes","compact","_attributes","attr","protected","undefined","toJSON","length","model","protoProps","staticProps","child","parent","has","constructor","apply","arguments","Surrogate","__super__","attrs","defineProperty","enumerable","writable","value","associationsCache","inspect","output","e","Attributes","ForeignKeys","JoinTables","References","only_once","fn","called","root","previous_async","noConflict","_toString","_isArray","_each","arr","iterator","i","_map","x","a","_reduce","memo","_keys","process","nextTick","setImmediate","setTimeout","callback","done","completed","iterate","forEachSeries","eachLimit","limit","_eachLimit","forEachLimit","started","running","replenish","doParallel","args","concat","doParallelLimit","doSeries","_asyncMap","eachfn","index","mapSeries","mapLimit","_mapLimit","inject","foldl","reduceRight","reversed","reverse","foldr","_filter","sort","b","filter","filterSeries","select","selectSeries","_reject","reject","rejectSeries","_detect","main_callback","result","detect","detectSeries","some","any","every","all","sortBy","criteria","left","right","tasks","remainingTasks","listeners","addListener","unshift","removeListener","splice","taskComplete","theCallback","task","taskCallback","safeResults","rkey","requires","Math","abs","ready","listener","retry","times","DEFAULT_TIMES","attempts","parseInt","wrappedTask","wrappedCallback","wrappedResults","retryAttempt","finalAttempt","seriesCallback","series","data","waterfall","wrapIterator","_parallel","parallel","parallelLimit","makeCallback","_concat","r","y","concatSeries","whilst","test","doWhilst","until","doUntil","queue","worker","concurrency","_insert","q","pos","drain","saturated","workers","empty","paused","kill","shift","idle","pause","resume","cargo","payload","working","drained","ts","ds","_console_fn","name","console","error","log","dir","memoize","hasher","queues","memoized","pop","l","unmemoized","unmemoize","count","counter","timesSeries","seq","fns","that","newargs","nextargs","compose","_applyEach","go","applyEach","applyEachSeries","forever","define","amd","schemaUtils","COLLECTION_DEFAULTS","Cast","Dictionary","Validator","Transformer","_cast","_validator","_callbacks","normalizeCallbacks","_instanceMethods","instanceMethods","normalizeAttributes","hasSchema","_normalizeSchemaFlag","migrate","getPrototypeOf","_initialize","_model","schemaAttributes","_validations","autoPK","autoCreatedAt","createdAt","autoUpdatedAt","updatedAt","connIdx","adapterInfo","reservedAttributes","types","primaryKey","_transformer","serialize","adapterDictionary","AdapterBase","utils","AdapterMixin","query","dictionary","buildDynamicFinders","connectionName","syncable","indexOf","strategyMethodName","baseIndexOf","array","fromIndex","cacheIndexOf","cache","type","keyPrefix","cachePush","typeCache","charAtCallback","charCodeAt","compareAscending","ac","bc","other","createCache","first","mid","last","getObject","escapeStringChar","stringEscapes","getArray","arrayPool","objectPool","false","null","number","string","true","releaseArray","maxPoolSize","releaseObject","start","end","runInContext","lodash","lodashWrapper","chainAll","__chain__","__wrapped__","baseBind","bindData","bound","partialArgs","thisBinding","baseCreate","func","thisArg","setBindData","baseClone","isDeep","stackA","stackB","isObj","className","cloneableClasses","ctor","ctorByClass","boolClass","dateClass","numberClass","stringClass","regexpClass","source","reFlags","exec","lastIndex","isArr","initedStack","assign","forOwn","objValue","nativeCreate","baseCreateCallback","argCount","__bindData__","support","funcNames","funcDecomp","fnToString","reFuncName","reThis","accumulator","bind","baseCreateWrapper","isBind","partialRightArgs","isCurry","arity","bitmask","isCurryBound","isBindKey","baseDifference","getIndexOf","isLarge","largeArraySize","baseFlatten","isShallow","isStrict","isArguments","valIndex","valLength","resIndex","baseIsEqual","isWhere","otherType","objectTypes","otherClass","argsClass","objectClass","arrayClass","aWrapped","bWrapped","ctorA","ctorB","size","forIn","baseMerge","found","isPlainObject","stackLength","baseRandom","min","max","floor","nativeRandom","baseUniq","isSorted","seen","computed","createAggregator","setter","createCallback","createWrapper","isPartial","isPartialRight","TypeError","creater","escapeHtmlChar","htmlEscapes","isNative","reNative","shimIsPlainObject","unescapeHtmlChar","htmlUnescapes","create","properties","findKey","findLastKey","forOwnRight","forInRight","pairs","props","functions","invert","isBoolean","isDate","isElement","nodeType","isEmpty","isEqual","isFinite","nativeIsFinite","nativeIsNaN","parseFloat","isNaN","isNumber","isNull","isRegExp","isUndefined","mapValues","sources","omit","pick","transform","proto","at","contains","target","nativeMax","find","findLast","forEachRight","invoke","methodName","isFunc","Infinity","current","noaccum","sample","collecti","on","n","guard","shuffle","nativeMin","rand","toArray","difference","findIndex","findLastIndex","flatten","sortedIndex","initial","intersection","argsIndex","argsLength","caches","trustIndexOf","outer","lastIndexOf","pull","range","step","ceil","remove","rest","low","high","union","uniq","without","xor","zip","pluck","zipObject","after","bindAll","funcs","bindKey","curry","debounce","wait","maxTimeoutId","stamp","timeoutId","trailingCall","lastCalled","maxWait","trailing","leading","delayed","remaining","now","clearTimeout","isCalled","maxDelayed","leadingCall","defer","delay","resolver","once","ran","partial","partialRight","throttle","debounceOptions","wrap","wrapper","constant","property","escape","replace","reUnescapedHtml","mixin","chain","methodNames","oldDash","noop","random","floating","noMin","noMax","template","text","settings","templateSettings","isEvaluating","imports","importsKeys","importsValues","interpolate","reNoMatch","reDelimiters","RegExp","reInterpolate","reEsTemplate","evaluate","escapeValue","interpolateValue","esTemplateValue","evaluateValue","offset","reUnescapedString","variable","hasVariable","reEmptyStringLeading","reEmptyStringMiddle","reEmptyStringTrailing","sourceURL","templateCounter","Function","unescape","reEscapedHtml","uniqueId","prefix","idCounter","tap","interceptor","wrapperChain","wrapperToString","wrapperValueOf","contextProps","Boolean","Date","Number","arrayRef","objectProto","o","nativeIsArray","nativeKeys","nativeParseInt","funcClass","WinRTError","descriptor","shimKeys","iterable","&","<",">","\"","'","join","ownIndex","ownProps","valueOf","objProto","countBy","groupBy","indexBy","where","getTime","whitespace","radix","reLeadingSpacesAndZeros","collect","drop","eachRight","methods","tail","unique","unzip","findWhere","include","take","head","callbackable","VERSION","configurable","boolean","function","\\","\n","\r","\t"," "," ","window","freeExports","freeModule","moduleExports","freeGlobal","global","canSetImmediate","canPost","postMessage","addEventListener","f","ev","stopPropagation","title","browser","env","argv","off","removeAllListeners","emit","binding","cwd","chdir","normalize","conns","stripFunctions","stripProperties","validatePropertyNames","normalizeIdentity","setDefaults","autoAttributes","defaultSettings","flags","flag","mainConnection","pk","autoIncrement","pkFormat","default","attribute","stripProperty","reservedWords","replaceKeys","modelName","findPrimaryKey","columnName","buildColumnName","foreignKey","references","joinTables","tables","buildJoins","uniqueTables","markCustomJoinTables","linkAttributes","joinedAttributes","collectionAttributes","mapCollections","parseAttribute","buildTable","val","collectionName","via","tableAttributes","column_one","column_two","columns","c1","c2","buildCollectionName","findDominantConnection","buildForeignKey","dominantCollection","searchForAttribute","attributeName","matching","viaName","groupKey","add","currentTable","updateAttribute","joined","findJoinTable","linkedCollection","through","reference","findReference","tableCollection","column","addKeys","matchingAttributes","callbacks","defaultFn","_i","len","_len","serializeJoins","joins","_types","run","integer","float","date","_value","parsed","parse","objectAttribute","defaultsTo","enum","cleanValues","ordered","_smash","adapterName","anchor","WLValidationError","validations","presentOnly","validation","curValidation","requirements","required","to","errors","rule","message","Transformation","_transformations","recursiveParse","unserialize","transformed","runner","beforeValidate","invalidAttributes","globalId","afterValidate","describe","alter","_validateValues","valuesList","record","beforeCreate","usageError","Deferred","createEach","records","usage","errStr","findOrCreateEach","transformedValues","transformedCriteria","unserializedValues","afterCreate","models","findOrCreate","sorter","Joins","Operations","Integrator","waterlineCriteria","findOne","expandPK","operations","returnResults","unserializedModels","combined","tmpCriteria","or","search","alias","_criteria","_results","res","c","findAll","findOneLike","likeCriteria","findLike","startsWith","endsWith","buildJoin","parentKey","_tableName","childKey","removeParentKey","associationQueryCriteria","attrName","finder","generateAssociationFinders","capitalizedMethods","lowercasedMethods","method","generateDynamicFinder","dontCapitalize","preparedAttrName","actualMethodName","like","ModelStream","stream","transformation","write","Normalize","Association","Define","collectionKeys","modelKeys","buildHasManyProperty","buildBelongsToProperty","associations","set","_setValue","get","_getValue","usedJoins","addAssociations","addProperties","makeObject","filterJoins","filterFunctions","_properties","showJoins","association","joinsName","Q","Destroy","deferred","status","resolve","promise","deep","updateInstance","addAssociation","removeAssociation","mutatedModels","compareModelValues","nextKey","currentVal","previousVal","updateRecord","buildAssociationOperations","removeKeys","addModels","removeModels","failedTransactions","removeAssociations","PK","populations","populate","Adapter","update","super_","WLUsageError","reason","isSingular","code","rules","details","messages","WLError","__defineGetter__","toPOJO","summary","numberizeModel","numberize","isNumbery","pow","escapeLikeQuery","likeCriterion","unescapeLikeQuery","applyInOriginalCtx","switchback","errorify","pkCriteria","origCriteria","skip","sum","average","falsy","_clone","clause","parts","split","direction","enhancer","resultSet","modifiedArgs","invalid","beforeUpdate","afterUpdate","beforeDestroy","afterDestroy","buildAggregate","acyclicTraversal","_context","_method","_values","populateDeep","keyName","populateAll","ref","paginate","defaultLimit","page","toPromise","makeNodeResolver","then","ec","spread","fail","Stream","Transformations","json","transformedModel","suffix","superCtor","TempCtor","sortCriteria","dynamicSort","sortOrder","substr","dynamicSortMultiple","obj1","obj2","numberOfProperties","sortArray","modelOptions","makeModels","j","modelize","usedInJoin","joinKey","checkForJoin","used","relatedJoin","preCombined","_seedCache","_buildOperations","parentOp","_runOperation","_execChildOpts","_stageOperations","_createParentOperation","parentConnection","parentOperation","localOpts","idx","operation","localOpt","nativeJoin","hasJoin","unsupportedJoins","defaultConnection","children","updateRegistry","collName","DefaultConnection","parentResults","_buildChildOpts","opts","_collectChildResults","parents","_tmpCriteria","userCriteria","intermediateResults","opt","_runChildOperations","_findCollectionPK","cacheCopy","copy","connName","createdRecord","updatedRecords","row","attributesToCheck","nestedOperations","Update","vals","reduced","reduceAssociations","Add","createCollectionAssociations","associationKey","createAssociations","associatedCollection","createNewRecord","joinCollection","createManyToMany","validateAssociation","associatedCollectionName","validateRecord","createRecord","findAssociationKey","attrCollection","Remove","removeCollectionAssociations","removeRecord","validAssociationKey","validatePrimaryKey","removeManyToMany","validAssociation","processValues","valuesParser","originalValues","createBelongsTo","valuesObject","pkValue","beforeCallbacks","createValues","parentModel","getRelations","destroyJoinTableRecords","refKey","mappedValues","relations","parentCollection","prepareArguments","updateRecords","updatedNestedAssociations","fk","leftOuterJoin","innerJoin","joinInstructions","CHILD_ATTR_PREFIX","GRANDCHILD_ATTR_PREFIX","instructions","parentPK","fkToParent","fkToChild","childPK","childSelect","parentRows","childRows","leftKey","rightKey","childNamespace","errMsg","existingAttributes","migrateDrop","migrateAlter","migrateSafe","_e","originalError","rawStack","stack","isError","raw","toLog","initialModel","initialRelation","traverseSchemaGraph","modelIdentity","nameOfRelation","isRedundant","currentModel","currentAttributes","alreadyTraversed","relation","identityOfRelatedModel","relatedModel","attrDef","cardinality","resultPlanPart","JSON","stringify","EE","EventEmitter","Readable","Writable","Duplex","Transform","PassThrough","pipe","dest","ondata","chunk","ondrain","readable","onend","didOnEnd","onclose","onerror","er","cleanup","listenerCount","_isStdio","duckType","_isConstraintViolation","collectionSchema","_cons","parentRow","associatedChildRows","childRow","childPKValue","_origChildRow","PREFIX_REGEXP","attrValue","unprefixedKey","uhoh","backupData","existingData","attrsAsArray","uniqueAttrs","uniqueAttr","each_cb","uniqueData","cleansedExistingData","cleansedUniqueData","prompt","wasConfirmedByUser","diff","destroyCriteria","datum","_events","_maxListeners","arg","defaultMaxListeners","setMaxListeners","handler","m","newListener","warned","trace","g","fired","list","position","ret","emitter","partialJoin","foundMatch","hasFoundMatchYet","newRow","Anchor","entity","todo","sanitize","ruleset","hasErrors","cast","hurl","as","assert","optValues","buildOperations","queueOperations","modelPk","updateRunner","unlink","unlinkRunner","link","linkRunner","associationLoop","unlinkParentAssociations","buildParentRemoveOperations","removeOperationRunner","linkChildRecords","recordsToCreate","buildParentLinkOperations","createNewRecords","updateParentRecord","pValues","searchCriteria","nullify","childAttribute","determineOperation","mapAssociations","createRunner","nextRecord","validator","notEmpty","alpha","isAlpha","alphadashed","numeric","isNumeric","alphanumeric","isAlphanumeric","alphanumericdashed","email","isEmail","url","isURL","urlish","ip","isIP","ipv4","isIPv4","ipv6","isIPv6","creditcard","isCreditCard","uuid","isUUID","uuidv3","uuidv4","int","isInt","finite","decimal","isFloat","falsey","truthy","notNull","binary","Buffer","isBuffer","datetime","hexadecimal","hexColor","isHexColor","lowercase","uppercase","isAfter","before","isBefore","equals","notContains","in","isIn","notIn","arrayOrString","minLength","isLength","maxLength","regex","matches","notRegex","ReadableState","hwm","highWaterMark","buffer","pipes","pipesCount","flowing","ended","endEmitted","reading","calledRead","needReadable","emittedReadable","readableListening","objectMode","defaultEncoding","ranOut","awaitDrain","readingMore","decoder","encoding","StringDecoder","_readableState","readableAddChunk","state","addToFront","chunkInvalid","onEofChunk","emitReadable","maybeReadMore","needMoreData","roundUpToNextPowerOf2","MAX_HWM","p","howMuchToRead","endReadable","emitReadable_","maybeReadMore_","read","pipeOnDrain","src","flow","written","emitDataEvents","pipeOnReadable","startPaused","fromList","stringMode","buf","cpy","xs","setEncoding","enc","nOrig","doRead","_read","pipeOpts","onunpipe","onfinish","_writableState","needDrain","unpipe","doEnd","stdout","stderr","endFn","dests","events","_fromList","WriteReq","WritableState","ending","finished","noDecode","decodeStrings","writing","bufferProcessing","onwrite","writecb","writelen","errorEmitted","writeAfterEnd","validChunk","valid","decodeChunk","writeOrBuffer","doWrite","_write","onwriteError","onwriteStateUpdate","needFinish","clearBuffer","afterWrite","onwriteDrain","finishMaybe","entry","need","endWritable","allowHalfOpen","objectKeys","TransformState","afterTransform","needTransform","transforming","writechunk","_transformState","rs","_flush","ws","_transform","writeencoding","ses","ok","makeQ","uncurryThis","isStopIteration","exception","object_toString","QReturnValue","makeStackTraceLong","hasStacks","STACK_JUMP_SEPARATOR","stacks","concatedStacks","filterStackString","stackString","lines","desiredLines","line","isInternalFrame","isNodeFrame","stackLine","getFileNameAndLineNumber","attempt1","attempt2","attempt3","fileNameAndLineNumber","fileName","lineNumber","qFileName","qStartingLine","qEndingLine","captureLine","firstLine","deprecate","alternative","warn","isPromise","isPromiseAlike","coerce","fulfill","become","newPromise","resolvedPromise","array_reduce","promiseDispatch","progressListeners","object_create","Promise","op","operands","array_slice","nearerValue","nearer","longStackSupport","substring","notify","progress","progressListener","race","answerPs","fallback","inspected","when","fulfilled","rejected","progressed","isPending","isFulfilled","isRejected","resetUnhandledRejections","unhandledReasons","unhandledRejections","trackUnhandledRejections","trackRejection","untrackRejection","array_indexOf","rejection","rhs","delete","post","thisp","object_keys","master","isDef","dispatch","makeGenerator","continuer","verb","StopIteration","generator","errback","spawn","_return","promised","promises","countDown","snapshot","allResolved","array_map","allSettled","nodeify","nodeback","flush","domain","enter","isNodeJS","exit","flushing","requestTick","MessageChannel","channel","port1","onmessage","requestPortTick","port2","basis","Type","object_hasOwnProperty","ReturnValue","passByCopy","makePromise","_fulfilled","_rejected","newException","_progressed","newValue","threw","thenResolve","thenReject","getUnhandledReasons","stopUnhandledRejectionTracking","del","mapply","send","mcall","fapply","fcall","fbind","regardless","fin","onUnhandledError","timeout","ms","nfapply","nodeArgs","nfcall","nfbind","denodeify","baseArgs","nbind","nmapply","npost","nsend","nmcall","ninvoke","newJoinRow","namespacedJoinRow","namespacedKey","factory","redirect","wildcard","constants","defaultHandlers","callbackContext","Switchback","getWildcardCaseHandler","caseName","prevHandler","runtimeHandler","runtimeArgs","runtimeCtx","MAX_FORWARDS","numIterations","success","isSwitchback","something","telltale","replacer","truncate","s","getMessage","actual","operator","expected","stackStartFunction","AssertionError","_deepEqual","multiline","ignoreCase","objEquiv","isNullOrUndefined","pSlice","ka","kb","expectedException","_throws","shouldThrow","block","hasOwn","generatedMessage","captureStackTrace","out","fn_name","next_line","equal","notEqual","deepEqual","notDeepEqual","strictEqual","notStrictEqual","throws","doesNotThrow","ifError","Diff","kind","path","DiffEdit","origin","DiffNew","DiffDeleted","DiffArray","arrayRemove","from","deepDiff","lhs","changes","prefilter","currentPath","ltype","rtype","ea","d","akeys","pkeys","accumulateDiff","accum","applyArrayChange","change","it","u","applyChange","applyDiff","onChange","$scope","conflict","conflictResolution","DeepDiff","defineProperties","observableDiff","isConflict","version","creditCard","isbn10Maybe","isbn13Maybe","ipv4Maybe","3","4","5","hexcolor","noCoerce","init","toDate","toFloat","toInt","toBoolean","strict","separator","comparison","elem","pattern","modifiers","default_url_options","protocols","require_tld","isHexadecimal","isLowercase","isUppercase","isDivisibleBy","num","original","sanitized","digit","tmpNum","shouldDouble","isISBN","checksum","factor","ltrim","chars","rtrim","trim","whitelist","blacklist","loadSubModules","relPath","dirname","__dirname","subject","noZero","stringtrim","byteLength","_useTypedArrays","_augment","Uint8Array","_isBuffer","_set","isArrayish","readUInt8","hexWrite","strLen","byte","utf8Write","charsWritten","blitBuffer","utf8ToBytes","asciiWrite","asciiToBytes","binaryWrite","base64Write","base64ToBytes","utf16leWrite","utf16leToBytes","base64Slice","base64","fromByteArray","utf8Slice","tmp","decodeUtf8Char","fromCharCode","asciiSlice","binarySlice","hexSlice","toHex","utf16leSlice","bytes","readUInt16","littleEndian","noAssert","readUInt32","readInt16","neg","readInt32","readFloat","ieee754","readDouble","writeUInt16","verifuint","writeUInt32","writeInt16","verifsint","writeInt32","writeFloat","verifIEEE754","writeDouble","clamp","defaultValue","byteArray","h","encodeURIComponent","hi","lo","toByteArray","dst","decodeURIComponent","SlowBuffer","INSPECT_MAX_BYTES","poolSize","ArrayBuffer","foo","subarray","isEncoding","totalLength","compare","swap","_arr","target_start","sliceLen","newBuf","writeUInt8","readUInt16LE","readUInt16BE","readUInt32LE","readUInt32BE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","fill","toArrayBuffer","BP","_get","toLocaleString","_switch","_originalCallbackFn","deepMatchType","depth","customMessage","MAX_DEPTH","matchType","_customMessage","RESERVED_KEYS","$message","subValidation","$validate","subRule","errorFactory","ruleName","outcome","_where","_limit","_skip","_select","_groupBy","_sort","tuples","classifier","INDEX_IN_ORIG_DATA","tuple","originalIndices","indices","matchSet","criterion","matchItem","matchOr","disjuncts","outcomes","matchAnd","conjuncts","matchLike","checkLike","matchNot","matchLiteral","checkStartsWith","checkEndsWith","checkContains","validSubAttrCriteria","normalizeComparison","toISOString","X_ISO_DATE","validAttributes","matchFn","matchString","sqlLikeMatch","escapeRegExp","=","!",">=","<=","numToSkip","sortData","sortVector","GREATER_THAN","LESS_THAN","EQUAL","flagSoFar","sortDirection","$a","$b","coerceIntoBestGuessType","guessType","comparator","filteredData","fields","subselect","normalizeArray","allowAboveRoot","up","splitPathRe","splitPath","filename","resolvedPath","resolvedAbsolute","isAbsolute","trailingSlash","paths","relative","fromParts","toParts","samePartsLength","outputParts","sep","delimiter","basename","ext","extname","ctx","stylize","stylizeNoColor","colors","showHidden","_extend","customInspect","stylizeWithColor","formatValue","styleType","style","styles","arrayToHash","hash","recurseTimes","primitive","formatPrimitive","visibleKeys","getOwnPropertyNames","formatError","base","braces","toUTCString","formatArray","formatProperty","reduceToSingleString","simple","desc","getOwnPropertyDescriptor","numLinesEst","prev","cur","ar","isSymbol","re","objectToString","isPrimitive","pad","timestamp","time","getHours","getMinutes","getSeconds","getDate","months","getMonth","formatRegExp","objects","deprecated","throwDeprecation","traceDeprecation","noDeprecation","debugs","debugEnviron","debuglog","NODE_DEBUG","pid","bold","italic","underline","inverse","white","grey","black","blue","cyan","green","magenta","red","yellow","special","regexp","actualType","expectedType","assertEncoding","isBufferEncoding","passThroughWrite","utf16DetectIncompleteChar","incomplete","charReceived","charLength","base64DetectIncompleteChar","surrogateSize","detectIncompleteChar","charBuffer","charStr","charCode","lenIncomplete","cr","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","LN2","lookup","decode","elt","PLUS","SLASH","NUMBER","UPPER","LOWER","b64ToByteArray","b64","L","placeHolders","Arr","uint8ToBase64","uint8","encode","tripletToBase64","temp","extraBytes","convert","newProps","newSchema","warning","description","conform","readline","utile","winston","Interface","setPrompt","_prompt","_promptLength","lastLine","stdin","history","logger","Logger","transports","allowEmpty","cli","memory","platform","names","pair","untangle","element","branch","build","attach","getInput","confirm","yes","RX_Y","RX_YN","vars","defaultLine","propName","storedSchema","delim","override","_performValidation","maxItems","help","silent","hidden","numericInput","isValid","against","_remember","putNested","fs","requireAll","excludeDirectory","excludeDirs","files","modules","force","_depth","startDirname","readdirSync","optional","file","filepath","statSync","isDirectory","pathFilter","dontLoad","markDirectories","flattenDirectories","keepDirectoryPath","pathMatch","resolved","nativeTrim","nativeTrimRight","trimRight","nativeTrimLeft","trimLeft","parseNumber","strRepeat","qty","defaultToWhiteSpace","characters","_s","escapeChars","lt","gt","quot","amp","apos","reversedEscapeChars","sprintf","get_type","str_repeat","str_format","parse_tree","pad_character","pad_length","cursor","tree_length","node_type","toExponential","toFixed","fmt","_fmt","arg_names","field_list","replacement_field","field_match","isBlank","stripTags","chop","clean","strip","swapCase","escapeHTML","unescapeHTML","entityCode","howmany","insert","needle","starts","ends","succ","titleize","camelize","underscored","dasherize","classify","humanize","truncateStr","prune","pruneStr","tmpl","words","padStr","padlen","lpad","rpad","lrpad","vsprintf","toNumber","decimals","numberFormat","dec","dsep","tsep","fnums","strRight","strRightBack","strLeft","strLeftBack","toSentence","lastSeparator","serial","lastMember","toSentenceSerial","slugify","surround","quote","repeat","levenshtein","str1","str2","lstrip","rstrip","center","rjust","ljust","rl","close","timer","mute","onError","onLine","terminal","unmute","isDefault","editDef","def","edit","isTTY","Mute","rlOpts","createInterface","_refreshLine","pkginfo","pmodule","pkg","package","readFileSync","validateObject","allProps","visitedProps","validateProperty","patternProperties","additionalProperties","unvisitedProps","unvisitedProperties","constrain","spec","validateFormats","validateFormatExtensions","formatExtensions","formats","validateFormatsStrict","dependencies","checkType","multiplier","propertyIsEnumerable","minimum","maximum","exclusiveMinimum","exclusiveMaximum","divisibleBy","minItems","uniqueItems","ip-address","date-time","color","host-name","utc-millisec","inflect","mkdirp","rimraf","cpr","ncp","rargs","_args","pred","chr","createPath","getter","randomString","mod","bits","requireDir","directory","requireDirLazy","camelToUnderscore","underscore","underscoreToCamel","common","longestElement","addColors","Container","Transport","loggers","defaultLogger","Console","setLevels","levels","padLevels","colorize","exceptionHandlers","readJson","readJSON","readFile","readJsonSync","readJSONSync","_cb","unencoded","encoded","ex","decoded","replacements","transport","crypto","cycle","past","level","npm","levelLength","timestampFn","decycle","stripColors","prettyPrint","createHash","digest","os","stackTrace","getAllInfo","getProcessInfo","getOsInfo","getTrace","uid","getuid","gid","getgid","execPath","memoryUsage","loadavg","uptime","site","getColumnNumber","getFileName","getFunctionName","getLineNumber","getMethodName","native","allColors","syslog","namedOptions","_close","ticksPerMillisecond","handleExceptions","emitErrs","exitOnError","rewriters","profilers","_names","_hnames","rewriter","addRewriter","queryTransport","formatQuery","formatResults","addResults","streams","_streams","handlers","catchExceptions","_uncaughtException","unhandleExceptions","created","instance","_onError","clear","ProfileHandler","duration","info","startTimer","profile","logAndWait","logException","gracefulExit","doExit","responded","_getExceptionHandlers","normalizeQuery","rows","order","onLogged","cliConfig","silly","verbose","debug","npmConfig","syslogConfig","notice","crit","alert","emerg","hmac","blocksize","zeroBuffer","ipad","opad","alg","algorithms","bufs","sha","sha256","rng","md5","sha1","createHmac","randomBytes","endianness","hostname","location","freemem","MAX_VALUE","totalmem","cpus","release","navigator","appVersion","networkInterfaces","getNetworkInterfaces","arch","tmpdir","tmpDir","EOL","MuteStream","muted","_onpipe","_hadControl","onPipe","_src","getIsTTY","_dest","setIsTTY","proxy","destroySoon","isUndefinedOrNull","busyTries","rimraf_","CB","isWindows","BUSYTRIES_MAX","EMFILE_MAX","fixWinEPERM","rmdir","chmod","er2","stat","er3","stats","fixWinEPERMSync","chmodSync","rmdirSync","unlinkSync","originalEr","rmkids","readdir","errState","rimrafSync","rmkidsSync","mkdirP","made","mode","xfs","umask","mkdir","mkdirSync","err0","err1","startCopy","getStats","lstat","onDir","isFile","onFile","isSymbolicLink","onLink","targetPath","isWritable","copyFile","clobber","rmFile","readStream","createReadStream","writeStream","createWriteStream","mkDir","copyDir","items","readlink","checkLink","makeLink","targetDest","linkPath","symlink","stopOnError","errs","skipped","basePath","core_sha1","w","olda","oldb","oldc","oldd","olde","rol","t","safe_add","sha1_ft","sha1_kt","lsw","msw","cnt","helpers","S","X","R","Ch","z","Maj","Sigma0256","Sigma1256","Gamma0256","Gamma1256","core_sha256","T1","T2","K","HASH","W","mathRNG","whatwgRNG","_global","getRandomValues","md5_vm_test","hex_md5","core_md5","md5_ff","md5_gg","md5_hh","md5_ii","md5_cmn","bit_rol","shim","supported","unsupported","supportsArgumentsClass","inflections","inflections_function","lower_case_and_underscored_word","first_letter_in_uppercase","gsub","$","upcase","downcase","camel_cased_word","underscored_word","demodulize","class_name_in_module","foreign_key","class_name","separate_class_name_and_id_with_underscore","ordinalize","_ref","uncountability","word","uncountables","ele","plural","plurals","singularize","singular","singulars","human","humans","tableize","table_name","addProperty","stringPrototypeBlacklist","bigEndian","intSize","toBuffer","hashSize","chrsz","derez","nu","$ref","retrocycle","px","rez","eval","strikethrough","whiteBG","greyBG","blackBG","blueBG","cyanBG","greenBG","magentaBG","redBG","yellowBG","applyTheme","theme","sequencer","isHeadless","exploded","zalgo","randomNumber","is_char","character","bool","heComes","counts","down","soul","rainbowMap","rainbowColors","letter","themes","addSequencer","setTheme","belowFn","oldLimit","stackTraceLimit","dummyObject","v8Handler","prepareStackTrace","v8StackTrace","_createParsedCallSite","functionName","typeName","columnNumber","lineMatch","methodMatch","callSite","replacement","matchCmpr","matchCmprPrev","replacementStr","spaces","Inflections","irregular","uncountable","scope","_forEach"],"mappings":"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","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var _ = require('lodash'),\n    async = require('async'),\n    Schema = require('waterline-schema'),\n    Connections = require('./waterline/connections'),\n    CollectionLoader = require('./waterline/collection/loader'),\n    hasOwnProperty = require('./waterline/utils/helpers').object.hasOwnProperty;\n\n/**\n * Waterline\n */\n\nvar Waterline = module.exports = function() {\n\n  if(!(this instanceof Waterline)) {\n    return new Waterline();\n  }\n\n  // Keep track of all the collections internally so we can build associations\n  // between them when needed.\n  this._collections = [];\n\n  // Keep track of all the active connections used by collections\n  this._connections = {};\n\n  return this;\n};\n\n\n/***********************************************************\n * Modules that can be extended\n ***********************************************************/\n\n\n// Collection to be extended in your application\nWaterline.Collection = require('./waterline/collection');\n\n// Model Instance, returned as query results\nWaterline.Model = require('./waterline/model');\n\n\n/***********************************************************\n * Prototype Methods\n ***********************************************************/\n\n\n/**\n * loadCollection\n *\n * Loads a new Collection. It should be an extended Waterline.Collection\n * that contains your attributes, instance methods and class methods.\n *\n * @param {Object} collection\n * @return {Object} internal models dictionary\n * @api public\n */\n\nWaterline.prototype.loadCollection = function(collection) {\n\n  // Cache collection\n  this._collections.push(collection);\n\n  return this._collections;\n};\n\n\n/**\n * initialize\n *\n * Creates an initialized version of each Collection and auto-migrates depending on\n * the Collection configuration.\n *\n * @param {Object} config object containing adapters\n * @param {Function} callback\n * @return {Array} instantiated collections\n * @api public\n */\n\nWaterline.prototype.initialize = function(options, cb) {\n  var self = this;\n\n  // Ensure a config object is passed in containing adapters\n  if(!options) throw new Error('Usage Error: function(options, callback)');\n  if(!options.adapters) throw new Error('Options object must contain an adapters object');\n  if(!options.connections) throw new Error('Options object must contain a connections object');\n\n  // Allow collections to be passed in to the initialize method\n  if(options.collections) {\n    for(var collection in options.collections) {\n      this.loadCollection(_.cloneDeep(options.collections[collection]));\n    }\n\n    // Remove collections from the options after they have been loaded\n    delete options.collections;\n  }\n\n  // Cache a reference to instantiated collections\n  this.collections = {};\n\n  // Build up all the connections used by the collections\n  this.connections = new Connections(options.adapters, options.connections);\n\n  // Grab config defaults or set them to empty\n  var defaults = options.defaults || {};\n\n  // Build a schema map\n  this.schema = new Schema(this._collections, this.connections, defaults);\n\n  // Load a Collection into memory\n  function loadCollection(item , next) {\n    var loader = new CollectionLoader(item, self.connections, defaults);\n    var collection = loader.initialize(self);\n\n    // Store the instantiated collection so it can be used\n    // internally to create other records\n    self.collections[collection.identity.toLowerCase()] = collection;\n\n    next();\n  }\n\n  async.auto({\n\n    // Load all the collections into memory\n    loadCollections: function(next) {\n      async.each(self._collections, loadCollection, function(err) {\n        if(err) return next(err);\n\n        // Migrate Junction Tables\n        var junctionTables = [];\n\n        Object.keys(self.schema).forEach(function(table) {\n          if(!self.schema[table].junctionTable) return;\n          junctionTables.push(Waterline.Collection.extend(self.schema[table]));\n        });\n\n        async.each(junctionTables, loadCollection, function(err) {\n          if(err) return next(err);\n          next(null, self.collections);\n        });\n      });\n    },\n\n\n    // Build up Collection Schemas\n    buildCollectionSchemas: ['loadCollections', function(next, results) {\n      var collections = self.collections,\n          schemas = {};\n\n      Object.keys(collections).forEach(function(key) {\n        var collection = collections[key];\n\n        // Remove hasMany association keys\n        var schema = _.clone(collection._schema.schema);\n\n        Object.keys(schema).forEach(function(key) {\n          if(hasOwnProperty(schema[key], 'type')) return;\n          delete schema[key];\n        });\n\n        // Grab JunctionTable flag\n        var meta = collection.meta || {};\n        meta.junctionTable = hasOwnProperty(collection.waterline.schema[collection.identity], 'junctionTable') ?\n          collection.waterline.schema[collection.identity].junctionTable : false;\n\n        schemas[collection.identity] = collection;\n        schemas[collection.identity].definition = schema;\n        schemas[collection.identity].meta = meta;\n      });\n\n      next(null, schemas);\n    }],\n\n\n    // Register the Connections with an adapter\n    registerConnections: ['buildCollectionSchemas', function(next, results) {\n      async.each(Object.keys(self.connections), function(item, nextItem) {\n        var connection = self.connections[item],\n            config = {},\n            usedSchemas = {};\n\n        // Check if the connection's adapter has a register connection method\n        if(!hasOwnProperty(connection._adapter, 'registerConnection')) return nextItem();\n\n        // Copy all values over to a tempory object minus the adapter definition\n        Object.keys(connection.config).forEach(function(key) {\n          config[key] = connection.config[key];\n        });\n\n        // Set an identity on the connection\n        config.identity = item;\n\n        // Grab the schemas used on this connection\n        connection._collections.forEach(function(coll) {\n          var identity = coll;\n          if(hasOwnProperty(self.collections[coll].__proto__, 'tableName')) {\n            identity = self.collections[coll].__proto__.tableName;\n          }\n\n          usedSchemas[identity] = results.buildCollectionSchemas[coll];\n        });\n\n        // Call the registerConnection method\n        connection._adapter.registerConnection(_.cloneDeep(config), usedSchemas, function(err) {\n          if(err) return nextItem(err);\n          nextItem();\n        });\n      }, next);\n    }]\n\n  }, function(err) {\n    if(err) return cb(err);\n    self.bootstrap(function(err) {\n      if(err) return cb(err);\n      cb(null, { collections: self.collections, connections: self.connections });\n    });\n  });\n\n};\n\n/**\n * Teardown\n *\n * Calls the teardown method on each connection if available.\n */\n\nWaterline.prototype.teardown = function teardown(cb) {\n  var self = this;\n\n  async.each(Object.keys(this.connections), function(item, next) {\n    var connection = self.connections[item];\n\n    // Check if the adapter has a teardown method implemented\n    if(!hasOwnProperty(connection._adapter, 'teardown')) return next();\n\n    connection._adapter.teardown(item, next);\n  }, cb);\n};\n\n\n\n/**\n * Bootstrap\n *\n * Auto-migrate all collections\n */\n\nWaterline.prototype.bootstrap = function bootstrap(cb) {\n  var self = this;\n\n\n  //\n  // TODO:\n  // Come back to this -- see https://github.com/balderdashy/waterline/issues/259\n  // (the stuff in this file works fine-- the work would be structural changes elsewhere)\n  //\n\n  // // Use the shema to get a list of junction tables idents\n  // // and then determine which are \"logical\" collections\n  // // (i.e. everything EXCEPT junction tables)\n  // var junctionTableIdents = _(this.schema).filter({junctionTable: true}).pluck('identity').value();\n  // var logicalCollections = _(this.collections).omit(junctionTableIdents).value();\n\n  // // Flatten logical collections obj into an array for convenience\n  // var toBeSynced = _.reduce(logicalCollections, function (logicals,coll,ident) {\n  //     logicals.push(coll);\n  //     return logicals;\n  //   }, []);\n\n  // // console.log(junctionTableIdents);\n  // // console.log(Object.keys(logicalCollections));\n  // // console.log('\\n',\n  // //   'Migrating collections ::',\n  // //   _(toBeSynced).pluck('identity').value()\n  // // );\n\n\n\n  // For now:\n  var toBeSynced = _.reduce(this.collections, function (resources, collection, ident) {\n    resources.push(collection);\n    return resources;\n  }, []);\n\n  // Run auto-migration strategies on each collection\n  // async.each(toBeSynced, function(collection, next) {\n  async.eachSeries(toBeSynced, function(collection, next) {\n  // async.eachLimit(toBeSynced, 9, function(collection, next) {\n    collection.sync(next);\n  }, cb);\n};\n","// Expose global `Waterline` object\nWaterline = require('../lib/waterline');","/**\n * Module Dependencies\n */\n\nvar hasOwnProperty = require('../utils/helpers').object.hasOwnProperty;\n\n/**\n * Collection Loader\n *\n * @param {Object} connections\n * @param {Object} collection\n * @api public\n */\n\nvar CollectionLoader = module.exports = function(collection, connections, defaults) {\n\n  this.defaults = defaults;\n\n  // Normalize and validate the collection\n  this.collection = this._validate(collection, connections);\n\n  // Find the named connections used in the collection\n  this.namedConnections = this._getConnections(collection, connections);\n\n  return this;\n};\n\n/**\n * Initalize the collection\n *\n * @param {Object} context\n * @param {Function} callback\n * @api public\n */\n\nCollectionLoader.prototype.initialize = function initialize(context) {\n  return new this.collection(context, this.namedConnections);\n};\n\n/**\n * Validate Collection structure.\n *\n * @param {Object} collection\n * @param {Object} connections\n * @api private\n */\n\nCollectionLoader.prototype._validate = function _validate(collection, connections) {\n\n  // Throw Error if no Tablename/Identity is set\n  if(!hasOwnProperty(collection.prototype, 'tableName') && !hasOwnProperty(collection.prototype, 'identity')) {\n    throw new Error('A tableName or identity property must be set.');\n  }\n\n  // Ensure identity is lowercased\n  collection.prototype.identity = collection.prototype.identity.toLowerCase();\n\n  // Set the defaults\n  collection.prototype.defaults = this.defaults;\n\n  // Find the connections used by this collection\n  // If none is specified check if a default connection exist\n  if(!hasOwnProperty(collection.prototype, 'connection')) {\n\n    // Check if a default connection was specified\n    if(!hasOwnProperty(connections, 'default')) {\n      throw new Error('No adapter was specified for collection: ' + collection.prototype.identity);\n    }\n\n    // Set the connection as the default\n    collection.prototype.connection = 'default';\n  }\n\n  return collection;\n};\n\n/**\n * Get the named connections\n *\n * @param {Object} collection\n * @param {Object} connections\n * @api private\n */\n\nCollectionLoader.prototype._getConnections = function _getConnections(collection, connections) {\n\n  // Hold the used connections\n  var usedConnections = {};\n\n  // Normalize connection to array\n  if(!Array.isArray(collection.prototype.connection)) {\n    collection.prototype.connection = [collection.prototype.connection];\n  }\n\n  // Set the connections used for the adapter\n  collection.prototype.connection.forEach(function(conn) {\n\n    // Ensure the named connection exist\n    if(!hasOwnProperty(connections, conn)) {\n      var msg = 'The connection ' + conn + ' specified in ' + collection.prototype.identity + ' does not exists.';\n      throw new Error(msg);\n    }\n\n    usedConnections[conn] = connections[conn];\n  });\n\n  return usedConnections;\n};\n","\n/**\n * Module Dependencies\n */\n\nvar _ = require('lodash');\n\n/**\n * Equivalent to _.objMap, _.map for objects, keeps key/value associations\n *\n * Should be deprecated.\n *\n * @api public\n */\nexports.objMap = function objMap(input, mapper, context) {\n  return _.reduce(input, function(obj, v, k) {\n    obj[k] = mapper.call(context, v, k, input);\n    return obj;\n  }, {}, context);\n};\n\n/**\n * Run a method meant for a single object on a object OR array\n * For an object, run the method and return the result.\n * For a list, run the method on each item return the resulting array.\n * For anything else, return it silently.\n *\n * Should be deprecated.\n *\n * @api public\n */\n\nexports.pluralize = function pluralize(collection, application) {\n  if(Array.isArray(collection)) return _.map(collection, application);\n  if(_.isObject(collection)) return application(collection);\n  return collection;\n};\n\n/**\n * _.str.capitalize\n *\n * @param {String} str\n * @return {String}\n * @api public\n */\n\nexports.capitalize = function capitalize(str) {\n  str = str === null ? '' : String(str);\n  return str.charAt(0).toUpperCase() + str.slice(1);\n};\n\n/**\n * ignore\n */\n\nexports.object = {};\n\n/**\n * Safer helper for hasOwnProperty checks\n *\n * @param {Object} obj\n * @param {String} prop\n * @return {Boolean}\n * @api public\n */\n\nvar hop = Object.prototype.hasOwnProperty;\nexports.object.hasOwnProperty = function(obj, prop) {\n  return hop.call(obj, prop);\n};\n\n/**\n * Check if an ID resembles a Mongo BSON ID.\n * Can't use the `hop` helper above because BSON ID's will have their own hasOwnProperty value.\n *\n * @param {String} id\n * @return {Boolean}\n * @api public\n */\n\nexports.matchMongoId = function matchMongoId(id) {\n  // id must be truthy- and either BE a string, or be an object\n  // with a toString method.\n  if( !id ||\n   ! (_.isString(id) || (_.isObject(id) || _.isFunction(id.toString)))\n  ) return false;\n  else return id.toString().match(/^[a-fA-F0-9]{24}$/) ? true : false;\n};\n","/**\n * Module Dependencies\n */\nvar _ = require('lodash'),\n  util = require('util'),\n  hasOwnProperty = require('../utils/helpers').object.hasOwnProperty;\n\n/**\n * Connections are active \"connections\" to a specific adapter for a specific configuration.\n * This allows you to have collections share named connections.\n *\n * @param {Object} adapters\n * @param {Object} objects\n * @api public\n */\n\nvar Connections = module.exports = function(adapters, options) {\n\n  // Hold the active connections\n  this._connections = {};\n\n  // Build the connections\n  this._build(adapters, options);\n\n  return this._connections;\n};\n\n\n/**\n * Builds up a named connections object with a clone of the adapter\n * it will use for the connection.\n *\n * @param {Object} adapters\n * @param {Object} options\n * @api private\n */\nConnections.prototype._build = function _build(adapters, options) {\n\n  var self = this;\n\n  // For each of the configured connections in options, find the required\n  // adapter by name and build up an object that can be attached to the\n  // internal connections object.\n  Object.keys(options).forEach(function(key) {\n    var config = options[key],\n        msg,\n        connection;\n\n    // Ensure an adapter module is specified\n    if(!hasOwnProperty(config, 'adapter')) {\n      msg = util.format('Connection (\"%s\") is missing a required property (`adapter`).  You should indicate the name of one of your adapters.', key);\n      throw new Error(msg);\n    }\n\n    // Ensure the adapter exists in the adapters options\n    if(!hasOwnProperty(adapters, config.adapter)) {\n      if (typeof config.adapter !== 'string') {\n        msg = util.format('Invalid `adapter` property in connection `%s`.  It should be a string (the name of one of the adapters you passed into `waterline.initialize()`)', key);\n      }\n      else msg = util.format('Unknown adapter \"%s\" for connection `%s`.  You should double-check that the connection\\'s `adapter` property matches the name of one of your adapters.  Or perhaps you forgot to include your \"%s\" adapter when you called `waterline.initialize()`...', config.adapter, key, config.adapter);\n      throw new Error(msg);\n    }\n\n    // Build the connection config\n    connection = {\n      config: _.merge({}, adapters[config.adapter].defaults, config),\n      _adapter: _.cloneDeep(adapters[config.adapter]),\n      _collections: []\n    };\n\n    // Attach the connections to the connection library\n    self._connections[key] = connection;\n  });\n\n};\n","/**\n * Dependencies\n */\n\nvar _ = require('lodash'),\n    extend = require('../utils/extend'),\n    inherits = require('util').inherits;\n\n// Various Pieces\nvar Core = require('../core'),\n    Query = require('../query');\n\n/**\n * Collection\n *\n * A prototype for managing a collection of database\n * records.\n *\n * This file is the prototype for collections defined using Waterline.\n * It contains the entry point for all ORM methods (e.g. User.find())\n *\n * Methods in this file defer to the adapter for their true implementation:\n * the implementation here just validates and normalizes the parameters.\n *\n * @param {Object} waterline, reference to parent\n * @param {Object} options\n * @param {Function} callback\n */\n\nvar Collection = module.exports = function(waterline, connections, cb) {\n\n  var self = this;\n\n  // Set the named connections\n  this.connections = connections || {};\n\n  // Cache reference to the parent\n  this.waterline = waterline;\n\n  // Default Attributes\n  this.attributes = this.attributes || {};\n\n  // Instantiate Base Collection\n  Core.call(this);\n\n  // Instantiate Query Language\n  Query.call(this);\n\n  return this;\n};\n\ninherits(Collection, Core);\ninherits(Collection, Query);\n\n// Make Extendable\nCollection.extend = extend;\n","\n/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\nvar Model = require('./lib/model');\nvar defaultMethods = require('./lib/defaultMethods');\nvar internalMethods = require('./lib/internalMethods');\n\n/**\n * Build Extended Model Prototype\n *\n * @param {Object} context\n * @param {Object} mixins\n * @return {Object}\n * @api public\n */\n\nmodule.exports = function(context, mixins) {\n\n  /**\n   * Extend the model prototype with default instance methods\n   */\n\n  var prototypeFns = {\n\n    toObject: function() {\n      return new defaultMethods.toObject(context, this);\n    },\n\n    save: function(cb) {\n      return new defaultMethods.save(context, this, cb);\n    },\n\n    destroy: function(cb) {\n      return new defaultMethods.destroy(context, this, cb);\n    },\n\n    _defineAssociations: function() {\n      new internalMethods.defineAssociations(context, this);\n    },\n\n    _normalizeAssociations: function() {\n      new internalMethods.normalizeAssociations(context, this);\n    },\n\n    /**\n     * Model.validate()\n     *\n     * Takes the currently set attributes and validates the model\n     * Shorthand for Model.validate({ attributes }, cb)\n     *\n     * @param {Function} callback\n     * @return callback - (err)\n     */\n\n    validate: function(cb) {\n      var self = this;\n\n      // Collect current values\n      var values = this.toObject();\n\n      context.validate( values, function(err) {\n        if(err) return cb(err);\n        cb();\n      });\n    }\n\n  };\n\n  // If any of the attributes are protected, the default toJSON method should\n  // remove them.\n  var protectedAttributes = _.compact(_.map(context._attributes, function(attr, key) {return attr.protected ? key : undefined;}));\n  if (protectedAttributes.length) {\n    prototypeFns.toJSON = function() {\n      var obj = this.toObject();\n      _.each(protectedAttributes, function(key) {\n        delete obj[key];\n      });\n      return obj;\n    };\n  }\n  // Otherwise just return the raw object\n  else {\n    prototypeFns.toJSON = function() {\n      return this.toObject();\n    };\n  }\n\n  var prototype = _.extend(prototypeFns, mixins);\n\n  var model = Model.extend(prototype);\n\n  // Return the extended model for use in Waterline\n  return model;\n};\n","/**\n * Extend Method\n *\n * Taken from Backbone Source:\n * http://backbonejs.org/docs/backbone.html#section-189\n */\n\nvar _ = require('lodash');\n\nmodule.exports = function(protoProps, staticProps) {\n  var parent = this;\n  var child;\n\n  if (protoProps && _.has(protoProps, 'constructor')) {\n    child = protoProps.constructor;\n  } else {\n    child = function(){ return parent.apply(this, arguments); };\n  }\n\n  _.extend(child, parent, staticProps);\n\n  var Surrogate = function(){ this.constructor = child; };\n  Surrogate.prototype = parent.prototype;\n  child.prototype = new Surrogate();\n\n  if (protoProps) _.extend(child.prototype, protoProps);\n\n  child.__super__ = parent.prototype;\n\n  return child;\n};\n","\n/**\n * Dependencies\n */\n\nvar extend = require('../../utils/extend');\nvar _ = require('lodash');\nvar util = require('util');\n\n/**\n * A Basic Model Interface\n *\n * Initialize a new Model with given params\n *\n * @param {Object} attrs\n * @param {Object} options\n * @return {Object}\n * @api public\n *\n * var Person = Model.prototype;\n * var person = new Person({ name: 'Foo Bar' });\n * person.name # => 'Foo Bar'\n */\n\nvar Model = module.exports = function(attrs, options) {\n  var self = this;\n\n  attrs = attrs || {};\n  options = options || {};\n\n  // Store options as properties\n  Object.defineProperty(this, '_properties', {\n    enumerable: false,\n    writable: false,\n    value: options\n  });\n\n  // Build association getters and setters\n  this._defineAssociations();\n\n  // Attach attributes to the model instance\n  for(var key in attrs) {\n    this[key] = attrs[key];\n\n    if(this.associationsCache.hasOwnProperty(key)) {\n      this.associationsCache[key] = _.cloneDeep(attrs[key]);\n    }\n  }\n\n  // Normalize associations\n  this._normalizeAssociations();\n\n\n  /**\n   * Log output\n   * @return {String} output when this model is util.inspect()ed\n   * (usually with console.log())\n   */\n  this.inspect = function() {\n    var output;\n    try {\n      output = self.toObject();\n    }\n    catch (e) {}\n\n    return output ? util.inspect(output) : self;\n  };\n\n\n  return this;\n};\n\n// Make Extendable\nModel.extend = extend;\n","\n/**\n * Module dependencies\n */\n\nvar Attributes = require('./waterline-schema/attributes');\nvar ForeignKeys = require('./waterline-schema/foreignKeys');\nvar JoinTables = require('./waterline-schema/joinTables');\nvar References = require('./waterline-schema/references');\n\n/**\n * Used to build a Waterline Schema object from a set of\n * loaded collections. It should turn the attributes into an\n * object that can be sent down to an adapter and understood.\n *\n * @param {Array} collections\n * @param {Object} connections\n * @return {Object}\n * @api public\n */\n\nmodule.exports = function(collections, connections, defaults) {\n\n  this.schema = {};\n\n  // Transform Collections into a basic schema\n  this.schema = new Attributes(collections, connections, defaults);\n\n  // Build Out Foreign Keys\n  this.schema = new ForeignKeys(this.schema);\n\n  // Add Join Tables\n  this.schema = new JoinTables(this.schema);\n\n  // Add References for Has Many Keys\n  this.schema = new References(this.schema);\n\n  return this.schema;\n\n};\n","/*jshint onevar: false, indent:4 */\n/*global setImmediate: false, setTimeout: false, console: false */\n(function () {\n\n    var async = {};\n\n    // global on the server, window in the browser\n    var root, previous_async;\n\n    root = this;\n    if (root != null) {\n      previous_async = root.async;\n    }\n\n    async.noConflict = function () {\n        root.async = previous_async;\n        return async;\n    };\n\n    function only_once(fn) {\n        var called = false;\n        return function() {\n            if (called) throw new Error(\"Callback was already called.\");\n            called = true;\n            fn.apply(root, arguments);\n        }\n    }\n\n    //// cross-browser compatiblity functions ////\n\n    var _toString = Object.prototype.toString;\n\n    var _isArray = Array.isArray || function (obj) {\n        return _toString.call(obj) === '[object Array]';\n    };\n\n    var _each = function (arr, iterator) {\n        if (arr.forEach) {\n            return arr.forEach(iterator);\n        }\n        for (var i = 0; i < arr.length; i += 1) {\n            iterator(arr[i], i, arr);\n        }\n    };\n\n    var _map = function (arr, iterator) {\n        if (arr.map) {\n            return arr.map(iterator);\n        }\n        var results = [];\n        _each(arr, function (x, i, a) {\n            results.push(iterator(x, i, a));\n        });\n        return results;\n    };\n\n    var _reduce = function (arr, iterator, memo) {\n        if (arr.reduce) {\n            return arr.reduce(iterator, memo);\n        }\n        _each(arr, function (x, i, a) {\n            memo = iterator(memo, x, i, a);\n        });\n        return memo;\n    };\n\n    var _keys = function (obj) {\n        if (Object.keys) {\n            return Object.keys(obj);\n        }\n        var keys = [];\n        for (var k in obj) {\n            if (obj.hasOwnProperty(k)) {\n                keys.push(k);\n            }\n        }\n        return keys;\n    };\n\n    //// exported async module functions ////\n\n    //// nextTick implementation with browser-compatible fallback ////\n    if (typeof process === 'undefined' || !(process.nextTick)) {\n        if (typeof setImmediate === 'function') {\n            async.nextTick = function (fn) {\n                // not a direct alias for IE10 compatibility\n                setImmediate(fn);\n            };\n            async.setImmediate = async.nextTick;\n        }\n        else {\n            async.nextTick = function (fn) {\n                setTimeout(fn, 0);\n            };\n            async.setImmediate = async.nextTick;\n        }\n    }\n    else {\n        async.nextTick = process.nextTick;\n        if (typeof setImmediate !== 'undefined') {\n            async.setImmediate = function (fn) {\n              // not a direct alias for IE10 compatibility\n              setImmediate(fn);\n            };\n        }\n        else {\n            async.setImmediate = async.nextTick;\n        }\n    }\n\n    async.each = function (arr, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length) {\n            return callback();\n        }\n        var completed = 0;\n        _each(arr, function (x) {\n            iterator(x, only_once(done) );\n        });\n        function done(err) {\n          if (err) {\n              callback(err);\n              callback = function () {};\n          }\n          else {\n              completed += 1;\n              if (completed >= arr.length) {\n                  callback();\n              }\n          }\n        }\n    };\n    async.forEach = async.each;\n\n    async.eachSeries = function (arr, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length) {\n            return callback();\n        }\n        var completed = 0;\n        var iterate = function () {\n            iterator(arr[completed], function (err) {\n                if (err) {\n                    callback(err);\n                    callback = function () {};\n                }\n                else {\n                    completed += 1;\n                    if (completed >= arr.length) {\n                        callback();\n                    }\n                    else {\n                        iterate();\n                    }\n                }\n            });\n        };\n        iterate();\n    };\n    async.forEachSeries = async.eachSeries;\n\n    async.eachLimit = function (arr, limit, iterator, callback) {\n        var fn = _eachLimit(limit);\n        fn.apply(null, [arr, iterator, callback]);\n    };\n    async.forEachLimit = async.eachLimit;\n\n    var _eachLimit = function (limit) {\n\n        return function (arr, iterator, callback) {\n            callback = callback || function () {};\n            if (!arr.length || limit <= 0) {\n                return callback();\n            }\n            var completed = 0;\n            var started = 0;\n            var running = 0;\n\n            (function replenish () {\n                if (completed >= arr.length) {\n                    return callback();\n                }\n\n                while (running < limit && started < arr.length) {\n                    started += 1;\n                    running += 1;\n                    iterator(arr[started - 1], function (err) {\n                        if (err) {\n                            callback(err);\n                            callback = function () {};\n                        }\n                        else {\n                            completed += 1;\n                            running -= 1;\n                            if (completed >= arr.length) {\n                                callback();\n                            }\n                            else {\n                                replenish();\n                            }\n                        }\n                    });\n                }\n            })();\n        };\n    };\n\n\n    var doParallel = function (fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [async.each].concat(args));\n        };\n    };\n    var doParallelLimit = function(limit, fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [_eachLimit(limit)].concat(args));\n        };\n    };\n    var doSeries = function (fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [async.eachSeries].concat(args));\n        };\n    };\n\n\n    var _asyncMap = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (err, v) {\n                results[x.index] = v;\n                callback(err);\n            });\n        }, function (err) {\n            callback(err, results);\n        });\n    };\n    async.map = doParallel(_asyncMap);\n    async.mapSeries = doSeries(_asyncMap);\n    async.mapLimit = function (arr, limit, iterator, callback) {\n        return _mapLimit(limit)(arr, iterator, callback);\n    };\n\n    var _mapLimit = function(limit) {\n        return doParallelLimit(limit, _asyncMap);\n    };\n\n    // reduce only has a series version, as doing reduce in parallel won't\n    // work in many situations.\n    async.reduce = function (arr, memo, iterator, callback) {\n        async.eachSeries(arr, function (x, callback) {\n            iterator(memo, x, function (err, v) {\n                memo = v;\n                callback(err);\n            });\n        }, function (err) {\n            callback(err, memo);\n        });\n    };\n    // inject alias\n    async.inject = async.reduce;\n    // foldl alias\n    async.foldl = async.reduce;\n\n    async.reduceRight = function (arr, memo, iterator, callback) {\n        var reversed = _map(arr, function (x) {\n            return x;\n        }).reverse();\n        async.reduce(reversed, memo, iterator, callback);\n    };\n    // foldr alias\n    async.foldr = async.reduceRight;\n\n    var _filter = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (v) {\n                if (v) {\n                    results.push(x);\n                }\n                callback();\n            });\n        }, function (err) {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    };\n    async.filter = doParallel(_filter);\n    async.filterSeries = doSeries(_filter);\n    // select alias\n    async.select = async.filter;\n    async.selectSeries = async.filterSeries;\n\n    var _reject = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (v) {\n                if (!v) {\n                    results.push(x);\n                }\n                callback();\n            });\n        }, function (err) {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    };\n    async.reject = doParallel(_reject);\n    async.rejectSeries = doSeries(_reject);\n\n    var _detect = function (eachfn, arr, iterator, main_callback) {\n        eachfn(arr, function (x, callback) {\n            iterator(x, function (result) {\n                if (result) {\n                    main_callback(x);\n                    main_callback = function () {};\n                }\n                else {\n                    callback();\n                }\n            });\n        }, function (err) {\n            main_callback();\n        });\n    };\n    async.detect = doParallel(_detect);\n    async.detectSeries = doSeries(_detect);\n\n    async.some = function (arr, iterator, main_callback) {\n        async.each(arr, function (x, callback) {\n            iterator(x, function (v) {\n                if (v) {\n                    main_callback(true);\n                    main_callback = function () {};\n                }\n                callback();\n            });\n        }, function (err) {\n            main_callback(false);\n        });\n    };\n    // any alias\n    async.any = async.some;\n\n    async.every = function (arr, iterator, main_callback) {\n        async.each(arr, function (x, callback) {\n            iterator(x, function (v) {\n                if (!v) {\n                    main_callback(false);\n                    main_callback = function () {};\n                }\n                callback();\n            });\n        }, function (err) {\n            main_callback(true);\n        });\n    };\n    // all alias\n    async.all = async.every;\n\n    async.sortBy = function (arr, iterator, callback) {\n        async.map(arr, function (x, callback) {\n            iterator(x, function (err, criteria) {\n                if (err) {\n                    callback(err);\n                }\n                else {\n                    callback(null, {value: x, criteria: criteria});\n                }\n            });\n        }, function (err, results) {\n            if (err) {\n                return callback(err);\n            }\n            else {\n                var fn = function (left, right) {\n                    var a = left.criteria, b = right.criteria;\n                    return a < b ? -1 : a > b ? 1 : 0;\n                };\n                callback(null, _map(results.sort(fn), function (x) {\n                    return x.value;\n                }));\n            }\n        });\n    };\n\n    async.auto = function (tasks, callback) {\n        callback = callback || function () {};\n        var keys = _keys(tasks);\n        var remainingTasks = keys.length\n        if (!remainingTasks) {\n            return callback();\n        }\n\n        var results = {};\n\n        var listeners = [];\n        var addListener = function (fn) {\n            listeners.unshift(fn);\n        };\n        var removeListener = function (fn) {\n            for (var i = 0; i < listeners.length; i += 1) {\n                if (listeners[i] === fn) {\n                    listeners.splice(i, 1);\n                    return;\n                }\n            }\n        };\n        var taskComplete = function () {\n            remainingTasks--\n            _each(listeners.slice(0), function (fn) {\n                fn();\n            });\n        };\n\n        addListener(function () {\n            if (!remainingTasks) {\n                var theCallback = callback;\n                // prevent final callback from calling itself if it errors\n                callback = function () {};\n\n                theCallback(null, results);\n            }\n        });\n\n        _each(keys, function (k) {\n            var task = _isArray(tasks[k]) ? tasks[k]: [tasks[k]];\n            var taskCallback = function (err) {\n                var args = Array.prototype.slice.call(arguments, 1);\n                if (args.length <= 1) {\n                    args = args[0];\n                }\n                if (err) {\n                    var safeResults = {};\n                    _each(_keys(results), function(rkey) {\n                        safeResults[rkey] = results[rkey];\n                    });\n                    safeResults[k] = args;\n                    callback(err, safeResults);\n                    // stop subsequent errors hitting callback multiple times\n                    callback = function () {};\n                }\n                else {\n                    results[k] = args;\n                    async.setImmediate(taskComplete);\n                }\n            };\n            var requires = task.slice(0, Math.abs(task.length - 1)) || [];\n            var ready = function () {\n                return _reduce(requires, function (a, x) {\n                    return (a && results.hasOwnProperty(x));\n                }, true) && !results.hasOwnProperty(k);\n            };\n            if (ready()) {\n                task[task.length - 1](taskCallback, results);\n            }\n            else {\n                var listener = function () {\n                    if (ready()) {\n                        removeListener(listener);\n                        task[task.length - 1](taskCallback, results);\n                    }\n                };\n                addListener(listener);\n            }\n        });\n    };\n\n    async.retry = function(times, task, callback) {\n        var DEFAULT_TIMES = 5;\n        var attempts = [];\n        // Use defaults if times not passed\n        if (typeof times === 'function') {\n            callback = task;\n            task = times;\n            times = DEFAULT_TIMES;\n        }\n        // Make sure times is a number\n        times = parseInt(times, 10) || DEFAULT_TIMES;\n        var wrappedTask = function(wrappedCallback, wrappedResults) {\n            var retryAttempt = function(task, finalAttempt) {\n                return function(seriesCallback) {\n                    task(function(err, result){\n                        seriesCallback(!err || finalAttempt, {err: err, result: result});\n                    }, wrappedResults);\n                };\n            };\n            while (times) {\n                attempts.push(retryAttempt(task, !(times-=1)));\n            }\n            async.series(attempts, function(done, data){\n                data = data[data.length - 1];\n                (wrappedCallback || callback)(data.err, data.result);\n            });\n        }\n        // If a callback is passed, run this as a controll flow\n        return callback ? wrappedTask() : wrappedTask\n    };\n\n    async.waterfall = function (tasks, callback) {\n        callback = callback || function () {};\n        if (!_isArray(tasks)) {\n          var err = new Error('First argument to waterfall must be an array of functions');\n          return callback(err);\n        }\n        if (!tasks.length) {\n            return callback();\n        }\n        var wrapIterator = function (iterator) {\n            return function (err) {\n                if (err) {\n                    callback.apply(null, arguments);\n                    callback = function () {};\n                }\n                else {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    var next = iterator.next();\n                    if (next) {\n                        args.push(wrapIterator(next));\n                    }\n                    else {\n                        args.push(callback);\n                    }\n                    async.setImmediate(function () {\n                        iterator.apply(null, args);\n                    });\n                }\n            };\n        };\n        wrapIterator(async.iterator(tasks))();\n    };\n\n    var _parallel = function(eachfn, tasks, callback) {\n        callback = callback || function () {};\n        if (_isArray(tasks)) {\n            eachfn.map(tasks, function (fn, callback) {\n                if (fn) {\n                    fn(function (err) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        if (args.length <= 1) {\n                            args = args[0];\n                        }\n                        callback.call(null, err, args);\n                    });\n                }\n            }, callback);\n        }\n        else {\n            var results = {};\n            eachfn.each(_keys(tasks), function (k, callback) {\n                tasks[k](function (err) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n\n    async.parallel = function (tasks, callback) {\n        _parallel({ map: async.map, each: async.each }, tasks, callback);\n    };\n\n    async.parallelLimit = function(tasks, limit, callback) {\n        _parallel({ map: _mapLimit(limit), each: _eachLimit(limit) }, tasks, callback);\n    };\n\n    async.series = function (tasks, callback) {\n        callback = callback || function () {};\n        if (_isArray(tasks)) {\n            async.mapSeries(tasks, function (fn, callback) {\n                if (fn) {\n                    fn(function (err) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        if (args.length <= 1) {\n                            args = args[0];\n                        }\n                        callback.call(null, err, args);\n                    });\n                }\n            }, callback);\n        }\n        else {\n            var results = {};\n            async.eachSeries(_keys(tasks), function (k, callback) {\n                tasks[k](function (err) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n\n    async.iterator = function (tasks) {\n        var makeCallback = function (index) {\n            var fn = function () {\n                if (tasks.length) {\n                    tasks[index].apply(null, arguments);\n                }\n                return fn.next();\n            };\n            fn.next = function () {\n                return (index < tasks.length - 1) ? makeCallback(index + 1): null;\n            };\n            return fn;\n        };\n        return makeCallback(0);\n    };\n\n    async.apply = function (fn) {\n        var args = Array.prototype.slice.call(arguments, 1);\n        return function () {\n            return fn.apply(\n                null, args.concat(Array.prototype.slice.call(arguments))\n            );\n        };\n    };\n\n    var _concat = function (eachfn, arr, fn, callback) {\n        var r = [];\n        eachfn(arr, function (x, cb) {\n            fn(x, function (err, y) {\n                r = r.concat(y || []);\n                cb(err);\n            });\n        }, function (err) {\n            callback(err, r);\n        });\n    };\n    async.concat = doParallel(_concat);\n    async.concatSeries = doSeries(_concat);\n\n    async.whilst = function (test, iterator, callback) {\n        if (test()) {\n            iterator(function (err) {\n                if (err) {\n                    return callback(err);\n                }\n                async.whilst(test, iterator, callback);\n            });\n        }\n        else {\n            callback();\n        }\n    };\n\n    async.doWhilst = function (iterator, test, callback) {\n        iterator(function (err) {\n            if (err) {\n                return callback(err);\n            }\n            var args = Array.prototype.slice.call(arguments, 1);\n            if (test.apply(null, args)) {\n                async.doWhilst(iterator, test, callback);\n            }\n            else {\n                callback();\n            }\n        });\n    };\n\n    async.until = function (test, iterator, callback) {\n        if (!test()) {\n            iterator(function (err) {\n                if (err) {\n                    return callback(err);\n                }\n                async.until(test, iterator, callback);\n            });\n        }\n        else {\n            callback();\n        }\n    };\n\n    async.doUntil = function (iterator, test, callback) {\n        iterator(function (err) {\n            if (err) {\n                return callback(err);\n            }\n            var args = Array.prototype.slice.call(arguments, 1);\n            if (!test.apply(null, args)) {\n                async.doUntil(iterator, test, callback);\n            }\n            else {\n                callback();\n            }\n        });\n    };\n\n    async.queue = function (worker, concurrency) {\n        if (concurrency === undefined) {\n            concurrency = 1;\n        }\n        function _insert(q, data, pos, callback) {\n          if (!q.started){\n            q.started = true;\n          }\n          if (!_isArray(data)) {\n              data = [data];\n          }\n          if(data.length == 0) {\n             // call drain immediately if there are no tasks\n             return async.setImmediate(function() {\n                 if (q.drain) {\n                     q.drain();\n                 }\n             });\n          }\n          _each(data, function(task) {\n              var item = {\n                  data: task,\n                  callback: typeof callback === 'function' ? callback : null\n              };\n\n              if (pos) {\n                q.tasks.unshift(item);\n              } else {\n                q.tasks.push(item);\n              }\n\n              if (q.saturated && q.tasks.length === q.concurrency) {\n                  q.saturated();\n              }\n              async.setImmediate(q.process);\n          });\n        }\n\n        var workers = 0;\n        var q = {\n            tasks: [],\n            concurrency: concurrency,\n            saturated: null,\n            empty: null,\n            drain: null,\n            started: false,\n            paused: false,\n            push: function (data, callback) {\n              _insert(q, data, false, callback);\n            },\n            kill: function () {\n              q.drain = null;\n              q.tasks = [];\n            },\n            unshift: function (data, callback) {\n              _insert(q, data, true, callback);\n            },\n            process: function () {\n                if (!q.paused && workers < q.concurrency && q.tasks.length) {\n                    var task = q.tasks.shift();\n                    if (q.empty && q.tasks.length === 0) {\n                        q.empty();\n                    }\n                    workers += 1;\n                    var next = function () {\n                        workers -= 1;\n                        if (task.callback) {\n                            task.callback.apply(task, arguments);\n                        }\n                        if (q.drain && q.tasks.length + workers === 0) {\n                            q.drain();\n                        }\n                        q.process();\n                    };\n                    var cb = only_once(next);\n                    worker(task.data, cb);\n                }\n            },\n            length: function () {\n                return q.tasks.length;\n            },\n            running: function () {\n                return workers;\n            },\n            idle: function() {\n                return q.tasks.length + workers === 0;\n            },\n            pause: function () {\n                if (q.paused === true) { return; }\n                q.paused = true;\n                q.process();\n            },\n            resume: function () {\n                if (q.paused === false) { return; }\n                q.paused = false;\n                q.process();\n            }\n        };\n        return q;\n    };\n\n    async.cargo = function (worker, payload) {\n        var working     = false,\n            tasks       = [];\n\n        var cargo = {\n            tasks: tasks,\n            payload: payload,\n            saturated: null,\n            empty: null,\n            drain: null,\n            drained: true,\n            push: function (data, callback) {\n                if (!_isArray(data)) {\n                    data = [data];\n                }\n                _each(data, function(task) {\n                    tasks.push({\n                        data: task,\n                        callback: typeof callback === 'function' ? callback : null\n                    });\n                    cargo.drained = false;\n                    if (cargo.saturated && tasks.length === payload) {\n                        cargo.saturated();\n                    }\n                });\n                async.setImmediate(cargo.process);\n            },\n            process: function process() {\n                if (working) return;\n                if (tasks.length === 0) {\n                    if(cargo.drain && !cargo.drained) cargo.drain();\n                    cargo.drained = true;\n                    return;\n                }\n\n                var ts = typeof payload === 'number'\n                            ? tasks.splice(0, payload)\n                            : tasks.splice(0, tasks.length);\n\n                var ds = _map(ts, function (task) {\n                    return task.data;\n                });\n\n                if(cargo.empty) cargo.empty();\n                working = true;\n                worker(ds, function () {\n                    working = false;\n\n                    var args = arguments;\n                    _each(ts, function (data) {\n                        if (data.callback) {\n                            data.callback.apply(null, args);\n                        }\n                    });\n\n                    process();\n                });\n            },\n            length: function () {\n                return tasks.length;\n            },\n            running: function () {\n                return working;\n            }\n        };\n        return cargo;\n    };\n\n    var _console_fn = function (name) {\n        return function (fn) {\n            var args = Array.prototype.slice.call(arguments, 1);\n            fn.apply(null, args.concat([function (err) {\n                var args = Array.prototype.slice.call(arguments, 1);\n                if (typeof console !== 'undefined') {\n                    if (err) {\n                        if (console.error) {\n                            console.error(err);\n                        }\n                    }\n                    else if (console[name]) {\n                        _each(args, function (x) {\n                            console[name](x);\n                        });\n                    }\n                }\n            }]));\n        };\n    };\n    async.log = _console_fn('log');\n    async.dir = _console_fn('dir');\n    /*async.info = _console_fn('info');\n    async.warn = _console_fn('warn');\n    async.error = _console_fn('error');*/\n\n    async.memoize = function (fn, hasher) {\n        var memo = {};\n        var queues = {};\n        hasher = hasher || function (x) {\n            return x;\n        };\n        var memoized = function () {\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            var key = hasher.apply(null, args);\n            if (key in memo) {\n                async.nextTick(function () {\n                    callback.apply(null, memo[key]);\n                });\n            }\n            else if (key in queues) {\n                queues[key].push(callback);\n            }\n            else {\n                queues[key] = [callback];\n                fn.apply(null, args.concat([function () {\n                    memo[key] = arguments;\n                    var q = queues[key];\n                    delete queues[key];\n                    for (var i = 0, l = q.length; i < l; i++) {\n                      q[i].apply(null, arguments);\n                    }\n                }]));\n            }\n        };\n        memoized.memo = memo;\n        memoized.unmemoized = fn;\n        return memoized;\n    };\n\n    async.unmemoize = function (fn) {\n      return function () {\n        return (fn.unmemoized || fn).apply(null, arguments);\n      };\n    };\n\n    async.times = function (count, iterator, callback) {\n        var counter = [];\n        for (var i = 0; i < count; i++) {\n            counter.push(i);\n        }\n        return async.map(counter, iterator, callback);\n    };\n\n    async.timesSeries = function (count, iterator, callback) {\n        var counter = [];\n        for (var i = 0; i < count; i++) {\n            counter.push(i);\n        }\n        return async.mapSeries(counter, iterator, callback);\n    };\n\n    async.seq = function (/* functions... */) {\n        var fns = arguments;\n        return function () {\n            var that = this;\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            async.reduce(fns, args, function (newargs, fn, cb) {\n                fn.apply(that, newargs.concat([function () {\n                    var err = arguments[0];\n                    var nextargs = Array.prototype.slice.call(arguments, 1);\n                    cb(err, nextargs);\n                }]))\n            },\n            function (err, results) {\n                callback.apply(that, [err].concat(results));\n            });\n        };\n    };\n\n    async.compose = function (/* functions... */) {\n      return async.seq.apply(null, Array.prototype.reverse.call(arguments));\n    };\n\n    var _applyEach = function (eachfn, fns /*args...*/) {\n        var go = function () {\n            var that = this;\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            return eachfn(fns, function (fn, cb) {\n                fn.apply(that, args.concat([cb]));\n            },\n            callback);\n        };\n        if (arguments.length > 2) {\n            var args = Array.prototype.slice.call(arguments, 2);\n            return go.apply(this, args);\n        }\n        else {\n            return go;\n        }\n    };\n    async.applyEach = doParallel(_applyEach);\n    async.applyEachSeries = doSeries(_applyEach);\n\n    async.forever = function (fn, callback) {\n        function next(err) {\n            if (err) {\n                if (callback) {\n                    return callback(err);\n                }\n                throw err;\n            }\n            fn(next);\n        }\n        next();\n    };\n\n    // Node.js\n    if (typeof module !== 'undefined' && module.exports) {\n        module.exports = async;\n    }\n    // AMD / RequireJS\n    else if (typeof define !== 'undefined' && define.amd) {\n        define([], function () {\n            return async;\n        });\n    }\n    // included directly via <script> tag\n    else {\n        root.async = async;\n    }\n\n}());\n","/**\n * Dependencies\n */\n\nvar _ = require('lodash'),\n    schemaUtils = require('../utils/schema'),\n    COLLECTION_DEFAULTS = require('../collection/defaults'),\n    Model = require('../model'),\n    Cast = require('./typecast'),\n    Schema = require('./schema'),\n    Dictionary = require('./dictionary'),\n    Validator = require('./validations'),\n    Transformer = require('./transformations'),\n    hasOwnProperty = require('../utils/helpers').object.hasOwnProperty;\n\n/**\n * Core\n *\n * Setup the basic Core of a collection to extend.\n */\n\nvar Core = module.exports = function(options) {\n\n  options = options || {};\n\n  // Set Defaults\n  this.adapter = this.adapter || {};\n  this._attributes = _.clone(this.attributes);\n  this.connections = this.connections || {};\n\n  this.defaults = _.merge(COLLECTION_DEFAULTS, this.defaults);\n\n  // Construct our internal objects\n  this._cast = new Cast();\n  this._schema = new Schema(this);\n  this._validator = new Validator();\n\n  // Normalize attributes, extract instance methods, and callbacks\n  // Note: this is ordered for a reason!\n  this._callbacks = schemaUtils.normalizeCallbacks(this);\n  this._instanceMethods = schemaUtils.instanceMethods(this.attributes);\n  this._attributes = schemaUtils.normalizeAttributes(this._attributes);\n\n  this.hasSchema = Core._normalizeSchemaFlag.call(this);\n\n  this.migrate = Object.getPrototypeOf(this).hasOwnProperty('migrate') ?\n    this.migrate : this.defaults.migrate;\n\n  // Initalize the internal values from the Collection\n  Core._initialize.call(this, options);\n\n  return this;\n};\n\n/**\n * Initialize\n *\n * Setups internal mappings from an extended collection.\n */\n\nCore._initialize = function(options) {\n  var self = this;\n\n  options = options || {};\n\n  // Extend a base Model with instance methods\n  this._model = new Model(this, this._instanceMethods);\n\n  // Cache the attributes from the schema builder\n  var schemaAttributes = this.waterline.schema[this.identity].attributes;\n\n  // Remove auto attributes for validations\n  var _validations = _.clone(this._attributes);\n  if(this.autoPK) delete _validations.id;\n  if(this.autoCreatedAt) delete _validations.createdAt;\n  if(this.autoUpdatedAt) delete _validations.updatedAt;\n\n  // If adapter exposes any reserved attributes, pass them to the schema\n  var connIdx = Array.isArray(this.connection) ? this.connection[0] : this.connection;\n\n  var adapterInfo = {};\n  if(this.connections[connIdx] && this.connections[connIdx]._adapter) {\n    adapterInfo = this.connections[connIdx]._adapter;\n  }\n\n  var reservedAttributes = adapterInfo.reservedAttributes || {};\n\n  // Initialize internal objects from attributes\n  this._schema.initialize(this._attributes, this.hasSchema, reservedAttributes);\n  this._cast.initialize(this._schema.schema);\n  this._validator.initialize(_validations, this.types);\n\n  // Set the collection's primaryKey attribute\n  Object.keys(schemaAttributes).forEach(function(key) {\n    if(!hasOwnProperty(schemaAttributes[key], 'primaryKey')) return;\n    self.primaryKey = key;\n  });\n\n  // Build Data Transformer\n  this._transformer = new Transformer(schemaAttributes, this.waterline.schema);\n\n  // Transform Schema\n  this._schema.schema = this._transformer.serialize(this._schema.schema);\n\n  // Build up a dictionary of which methods run on which connection\n  this.adapterDictionary = new Dictionary(_.cloneDeep(this.connections), this.connection);\n\n  // Add this collection to the connection\n  Object.keys(this.connections).forEach(function(conn) {\n    self.connections[conn]._collections = self.connections[conn]._collections || [];\n    self.connections[conn]._collections.push(self.identity);\n  });\n\n  // Remove remnants of user defined attributes\n  delete this.attributes;\n};\n\n/**\n * Normalize Schema Flag\n *\n * Normalize schema setting by looking at the model first to see if it is defined, if not look at\n * the connection and see if it's defined and if not finally look into the adapter and check if\n * there is a default setting. If not found anywhere be safe and set to true.\n *\n * @api private\n * @return {Boolean}\n */\n\nCore._normalizeSchemaFlag = function() {\n\n  // If schema is defined on the collection, return the value\n  if(hasOwnProperty(Object.getPrototypeOf(this), 'schema')) {\n    return Object.getPrototypeOf(this).schema;\n  }\n\n  // Grab the first connection used\n  if(!this.connection || !Array.isArray(this.connection)) return true;\n  var connection = this.connections[this.connection[0]];\n\n  // Check the user defined config\n  if(hasOwnProperty(connection, 'config') && hasOwnProperty(connection.config, 'schema')) {\n    return connection.config.schema;\n  }\n\n  // Check the defaults defined in the adapter\n  if(!hasOwnProperty(connection, '_adapter')) return true;\n  if(!hasOwnProperty(connection._adapter, 'schema')) return true;\n\n  return connection._adapter.schema;\n};\n","/**\n * Dependencies\n */\n\nvar _ = require('lodash'),\n    extend = require('../utils/extend'),\n    AdapterBase = require('../adapter'),\n    utils = require('../utils/helpers'),\n    AdapterMixin = require('./adapters'),\n    hop = utils.object.hasOwnProperty;\n\n/**\n * Query\n */\n\nvar Query = module.exports = function() {\n\n  // Create a reference to an internal Adapter Base\n  this.adapter = new AdapterBase({\n    connections: this.connections,\n    query: this,\n    collection: this.tableName || this.identity,\n    identity: this.identity,\n    dictionary: this.adapterDictionary\n  });\n\n  // Mixin Custom Adapter Functions.\n  AdapterMixin.call(this);\n\n  // Generate Dynamic Finders\n  this.buildDynamicFinders();\n};\n\n\n\n/**\n * Automigrate\n *\n * @param  {Function} cb\n */\nQuery.prototype.sync = function(cb) {\n  var self = this;\n\n  // If any adapters used in this collection have syncable turned off set migrate to safe.\n  //\n  // I don't think a collection would ever need two adapters where one needs migrations and\n  // the other doesn't but it may be a possibility. The way the auto-migrations work now doesn't\n  // allow for this either way so this should be good. We will probably need to revist this soonish\n  // however and take a pass at getting something working for better migration systems.\n  // - particlebanana\n\n  _.keys(this.connections).forEach(function(connectionName) {\n    var adapter = self.connections[connectionName]._adapter;\n\n    // If not syncable, don't sync\n    if (hop(adapter, 'syncable') && !adapter.syncable) {\n      self.migrate = 'safe';\n    }\n  });\n\n  // Assign synchronization behavior depending on migrate option in collection\n  if(this.migrate && ['drop', 'alter', 'safe'].indexOf(this.migrate) > -1) {\n\n    // Determine which sync strategy to use\n    var strategyMethodName = 'migrate' + utils.capitalize(this.migrate);\n\n    // Run automigration strategy\n    this.adapter[strategyMethodName](function(err) {\n      if(err) return cb(err);\n      cb();\n    });\n  }\n\n  // Throw Error\n  else cb(new Error('Invalid `migrate` strategy defind for collection . Must be one of: drop, alter, safe'));\n};\n\n\n_.extend(\n  Query.prototype,\n  require('./validate'),\n  require('./ddl'),\n  require('./dql'),\n  require('./aggregate'),\n  require('./composite'),\n  require('./finders/basic'),\n  require('./finders/helpers'),\n  require('./finders/dynamicFinders'),\n  require('./stream')\n);\n\n// Make Extendable\nQuery.extend = extend;\n","\n/**\n * Export Internal Methods\n */\n\nmodule.exports = {\n  normalizeAssociations: require('./normalizeAssociations'),\n  defineAssociations: require('./defineAssociations')\n};\n","\n/**\n * Export Default Methods\n */\n\nmodule.exports = {\n  toObject: require('./toObject'),\n  destroy: require('./destroy'),\n  save: require('./save')\n};\n","/**\n * @license\n * Lo-Dash 2.4.1 (Custom Build) <http://lodash.com/>\n * Build: `lodash modern -o ./dist/lodash.js`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\n;(function() {\n\n  /** Used as a safe reference for `undefined` in pre ES5 environments */\n  var undefined;\n\n  /** Used to pool arrays and objects used internally */\n  var arrayPool = [],\n      objectPool = [];\n\n  /** Used to generate unique IDs */\n  var idCounter = 0;\n\n  /** Used to prefix keys to avoid issues with `__proto__` and properties on `Object.prototype` */\n  var keyPrefix = +new Date + '';\n\n  /** Used as the size when optimizations are enabled for large arrays */\n  var largeArraySize = 75;\n\n  /** Used as the max size of the `arrayPool` and `objectPool` */\n  var maxPoolSize = 40;\n\n  /** Used to detect and test whitespace */\n  var whitespace = (\n    // whitespace\n    ' \\t\\x0B\\f\\xA0\\ufeff' +\n\n    // line terminators\n    '\\n\\r\\u2028\\u2029' +\n\n    // unicode category \"Zs\" space separators\n    '\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000'\n  );\n\n  /** Used to match empty string literals in compiled template source */\n  var reEmptyStringLeading = /\\b__p \\+= '';/g,\n      reEmptyStringMiddle = /\\b(__p \\+=) '' \\+/g,\n      reEmptyStringTrailing = /(__e\\(.*?\\)|\\b__t\\)) \\+\\n'';/g;\n\n  /**\n   * Used to match ES6 template delimiters\n   * http://people.mozilla.org/~jorendorff/es6-draft.html#sec-literals-string-literals\n   */\n  var reEsTemplate = /\\$\\{([^\\\\}]*(?:\\\\.[^\\\\}]*)*)\\}/g;\n\n  /** Used to match regexp flags from their coerced string values */\n  var reFlags = /\\w*$/;\n\n  /** Used to detected named functions */\n  var reFuncName = /^\\s*function[ \\n\\r\\t]+\\w/;\n\n  /** Used to match \"interpolate\" template delimiters */\n  var reInterpolate = /<%=([\\s\\S]+?)%>/g;\n\n  /** Used to match leading whitespace and zeros to be removed */\n  var reLeadingSpacesAndZeros = RegExp('^[' + whitespace + ']*0+(?=.$)');\n\n  /** Used to ensure capturing order of template delimiters */\n  var reNoMatch = /($^)/;\n\n  /** Used to detect functions containing a `this` reference */\n  var reThis = /\\bthis\\b/;\n\n  /** Used to match unescaped characters in compiled string literals */\n  var reUnescapedString = /['\\n\\r\\t\\u2028\\u2029\\\\]/g;\n\n  /** Used to assign default `context` object properties */\n  var contextProps = [\n    'Array', 'Boolean', 'Date', 'Function', 'Math', 'Number', 'Object',\n    'RegExp', 'String', '_', 'attachEvent', 'clearTimeout', 'isFinite', 'isNaN',\n    'parseInt', 'setTimeout'\n  ];\n\n  /** Used to make template sourceURLs easier to identify */\n  var templateCounter = 0;\n\n  /** `Object#toString` result shortcuts */\n  var argsClass = '[object Arguments]',\n      arrayClass = '[object Array]',\n      boolClass = '[object Boolean]',\n      dateClass = '[object Date]',\n      funcClass = '[object Function]',\n      numberClass = '[object Number]',\n      objectClass = '[object Object]',\n      regexpClass = '[object RegExp]',\n      stringClass = '[object String]';\n\n  /** Used to identify object classifications that `_.clone` supports */\n  var cloneableClasses = {};\n  cloneableClasses[funcClass] = false;\n  cloneableClasses[argsClass] = cloneableClasses[arrayClass] =\n  cloneableClasses[boolClass] = cloneableClasses[dateClass] =\n  cloneableClasses[numberClass] = cloneableClasses[objectClass] =\n  cloneableClasses[regexpClass] = cloneableClasses[stringClass] = true;\n\n  /** Used as an internal `_.debounce` options object */\n  var debounceOptions = {\n    'leading': false,\n    'maxWait': 0,\n    'trailing': false\n  };\n\n  /** Used as the property descriptor for `__bindData__` */\n  var descriptor = {\n    'configurable': false,\n    'enumerable': false,\n    'value': null,\n    'writable': false\n  };\n\n  /** Used to determine if values are of the language type Object */\n  var objectTypes = {\n    'boolean': false,\n    'function': true,\n    'object': true,\n    'number': false,\n    'string': false,\n    'undefined': false\n  };\n\n  /** Used to escape characters for inclusion in compiled string literals */\n  var stringEscapes = {\n    '\\\\': '\\\\',\n    \"'\": \"'\",\n    '\\n': 'n',\n    '\\r': 'r',\n    '\\t': 't',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  /** Used as a reference to the global object */\n  var root = (objectTypes[typeof window] && window) || this;\n\n  /** Detect free variable `exports` */\n  var freeExports = objectTypes[typeof exports] && exports && !exports.nodeType && exports;\n\n  /** Detect free variable `module` */\n  var freeModule = objectTypes[typeof module] && module && !module.nodeType && module;\n\n  /** Detect the popular CommonJS extension `module.exports` */\n  var moduleExports = freeModule && freeModule.exports === freeExports && freeExports;\n\n  /** Detect free variable `global` from Node.js or Browserified code and use it as `root` */\n  var freeGlobal = objectTypes[typeof global] && global;\n  if (freeGlobal && (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal)) {\n    root = freeGlobal;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * The base implementation of `_.indexOf` without support for binary searches\n   * or `fromIndex` constraints.\n   *\n   * @private\n   * @param {Array} array The array to search.\n   * @param {*} value The value to search for.\n   * @param {number} [fromIndex=0] The index to search from.\n   * @returns {number} Returns the index of the matched value or `-1`.\n   */\n  function baseIndexOf(array, value, fromIndex) {\n    var index = (fromIndex || 0) - 1,\n        length = array ? array.length : 0;\n\n    while (++index < length) {\n      if (array[index] === value) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * An implementation of `_.contains` for cache objects that mimics the return\n   * signature of `_.indexOf` by returning `0` if the value is found, else `-1`.\n   *\n   * @private\n   * @param {Object} cache The cache object to inspect.\n   * @param {*} value The value to search for.\n   * @returns {number} Returns `0` if `value` is found, else `-1`.\n   */\n  function cacheIndexOf(cache, value) {\n    var type = typeof value;\n    cache = cache.cache;\n\n    if (type == 'boolean' || value == null) {\n      return cache[value] ? 0 : -1;\n    }\n    if (type != 'number' && type != 'string') {\n      type = 'object';\n    }\n    var key = type == 'number' ? value : keyPrefix + value;\n    cache = (cache = cache[type]) && cache[key];\n\n    return type == 'object'\n      ? (cache && baseIndexOf(cache, value) > -1 ? 0 : -1)\n      : (cache ? 0 : -1);\n  }\n\n  /**\n   * Adds a given value to the corresponding cache object.\n   *\n   * @private\n   * @param {*} value The value to add to the cache.\n   */\n  function cachePush(value) {\n    var cache = this.cache,\n        type = typeof value;\n\n    if (type == 'boolean' || value == null) {\n      cache[value] = true;\n    } else {\n      if (type != 'number' && type != 'string') {\n        type = 'object';\n      }\n      var key = type == 'number' ? value : keyPrefix + value,\n          typeCache = cache[type] || (cache[type] = {});\n\n      if (type == 'object') {\n        (typeCache[key] || (typeCache[key] = [])).push(value);\n      } else {\n        typeCache[key] = true;\n      }\n    }\n  }\n\n  /**\n   * Used by `_.max` and `_.min` as the default callback when a given\n   * collection is a string value.\n   *\n   * @private\n   * @param {string} value The character to inspect.\n   * @returns {number} Returns the code unit of given character.\n   */\n  function charAtCallback(value) {\n    return value.charCodeAt(0);\n  }\n\n  /**\n   * Used by `sortBy` to compare transformed `collection` elements, stable sorting\n   * them in ascending order.\n   *\n   * @private\n   * @param {Object} a The object to compare to `b`.\n   * @param {Object} b The object to compare to `a`.\n   * @returns {number} Returns the sort order indicator of `1` or `-1`.\n   */\n  function compareAscending(a, b) {\n    var ac = a.criteria,\n        bc = b.criteria,\n        index = -1,\n        length = ac.length;\n\n    while (++index < length) {\n      var value = ac[index],\n          other = bc[index];\n\n      if (value !== other) {\n        if (value > other || typeof value == 'undefined') {\n          return 1;\n        }\n        if (value < other || typeof other == 'undefined') {\n          return -1;\n        }\n      }\n    }\n    // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications\n    // that causes it, under certain circumstances, to return the same value for\n    // `a` and `b`. See https://github.com/jashkenas/underscore/pull/1247\n    //\n    // This also ensures a stable sort in V8 and other engines.\n    // See http://code.google.com/p/v8/issues/detail?id=90\n    return a.index - b.index;\n  }\n\n  /**\n   * Creates a cache object to optimize linear searches of large arrays.\n   *\n   * @private\n   * @param {Array} [array=[]] The array to search.\n   * @returns {null|Object} Returns the cache object or `null` if caching should not be used.\n   */\n  function createCache(array) {\n    var index = -1,\n        length = array.length,\n        first = array[0],\n        mid = array[(length / 2) | 0],\n        last = array[length - 1];\n\n    if (first && typeof first == 'object' &&\n        mid && typeof mid == 'object' && last && typeof last == 'object') {\n      return false;\n    }\n    var cache = getObject();\n    cache['false'] = cache['null'] = cache['true'] = cache['undefined'] = false;\n\n    var result = getObject();\n    result.array = array;\n    result.cache = cache;\n    result.push = cachePush;\n\n    while (++index < length) {\n      result.push(array[index]);\n    }\n    return result;\n  }\n\n  /**\n   * Used by `template` to escape characters for inclusion in compiled\n   * string literals.\n   *\n   * @private\n   * @param {string} match The matched character to escape.\n   * @returns {string} Returns the escaped character.\n   */\n  function escapeStringChar(match) {\n    return '\\\\' + stringEscapes[match];\n  }\n\n  /**\n   * Gets an array from the array pool or creates a new one if the pool is empty.\n   *\n   * @private\n   * @returns {Array} The array from the pool.\n   */\n  function getArray() {\n    return arrayPool.pop() || [];\n  }\n\n  /**\n   * Gets an object from the object pool or creates a new one if the pool is empty.\n   *\n   * @private\n   * @returns {Object} The object from the pool.\n   */\n  function getObject() {\n    return objectPool.pop() || {\n      'array': null,\n      'cache': null,\n      'criteria': null,\n      'false': false,\n      'index': 0,\n      'null': false,\n      'number': null,\n      'object': null,\n      'push': null,\n      'string': null,\n      'true': false,\n      'undefined': false,\n      'value': null\n    };\n  }\n\n  /**\n   * Releases the given array back to the array pool.\n   *\n   * @private\n   * @param {Array} [array] The array to release.\n   */\n  function releaseArray(array) {\n    array.length = 0;\n    if (arrayPool.length < maxPoolSize) {\n      arrayPool.push(array);\n    }\n  }\n\n  /**\n   * Releases the given object back to the object pool.\n   *\n   * @private\n   * @param {Object} [object] The object to release.\n   */\n  function releaseObject(object) {\n    var cache = object.cache;\n    if (cache) {\n      releaseObject(cache);\n    }\n    object.array = object.cache = object.criteria = object.object = object.number = object.string = object.value = null;\n    if (objectPool.length < maxPoolSize) {\n      objectPool.push(object);\n    }\n  }\n\n  /**\n   * Slices the `collection` from the `start` index up to, but not including,\n   * the `end` index.\n   *\n   * Note: This function is used instead of `Array#slice` to support node lists\n   * in IE < 9 and to ensure dense arrays are returned.\n   *\n   * @private\n   * @param {Array|Object|string} collection The collection to slice.\n   * @param {number} start The start index.\n   * @param {number} end The end index.\n   * @returns {Array} Returns the new array.\n   */\n  function slice(array, start, end) {\n    start || (start = 0);\n    if (typeof end == 'undefined') {\n      end = array ? array.length : 0;\n    }\n    var index = -1,\n        length = end - start || 0,\n        result = Array(length < 0 ? 0 : length);\n\n    while (++index < length) {\n      result[index] = array[start + index];\n    }\n    return result;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Create a new `lodash` function using the given context object.\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @param {Object} [context=root] The context object.\n   * @returns {Function} Returns the `lodash` function.\n   */\n  function runInContext(context) {\n    // Avoid issues with some ES3 environments that attempt to use values, named\n    // after built-in constructors like `Object`, for the creation of literals.\n    // ES5 clears this up by stating that literals must use built-in constructors.\n    // See http://es5.github.io/#x11.1.5.\n    context = context ? _.defaults(root.Object(), context, _.pick(root, contextProps)) : root;\n\n    /** Native constructor references */\n    var Array = context.Array,\n        Boolean = context.Boolean,\n        Date = context.Date,\n        Function = context.Function,\n        Math = context.Math,\n        Number = context.Number,\n        Object = context.Object,\n        RegExp = context.RegExp,\n        String = context.String,\n        TypeError = context.TypeError;\n\n    /**\n     * Used for `Array` method references.\n     *\n     * Normally `Array.prototype` would suffice, however, using an array literal\n     * avoids issues in Narwhal.\n     */\n    var arrayRef = [];\n\n    /** Used for native method references */\n    var objectProto = Object.prototype;\n\n    /** Used to restore the original `_` reference in `noConflict` */\n    var oldDash = context._;\n\n    /** Used to resolve the internal [[Class]] of values */\n    var toString = objectProto.toString;\n\n    /** Used to detect if a method is native */\n    var reNative = RegExp('^' +\n      String(toString)\n        .replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\n        .replace(/toString| for [^\\]]+/g, '.*?') + '$'\n    );\n\n    /** Native method shortcuts */\n    var ceil = Math.ceil,\n        clearTimeout = context.clearTimeout,\n        floor = Math.floor,\n        fnToString = Function.prototype.toString,\n        getPrototypeOf = isNative(getPrototypeOf = Object.getPrototypeOf) && getPrototypeOf,\n        hasOwnProperty = objectProto.hasOwnProperty,\n        push = arrayRef.push,\n        setTimeout = context.setTimeout,\n        splice = arrayRef.splice,\n        unshift = arrayRef.unshift;\n\n    /** Used to set meta data on functions */\n    var defineProperty = (function() {\n      // IE 8 only accepts DOM elements\n      try {\n        var o = {},\n            func = isNative(func = Object.defineProperty) && func,\n            result = func(o, o, o) && func;\n      } catch(e) { }\n      return result;\n    }());\n\n    /* Native method shortcuts for methods with the same name as other `lodash` methods */\n    var nativeCreate = isNative(nativeCreate = Object.create) && nativeCreate,\n        nativeIsArray = isNative(nativeIsArray = Array.isArray) && nativeIsArray,\n        nativeIsFinite = context.isFinite,\n        nativeIsNaN = context.isNaN,\n        nativeKeys = isNative(nativeKeys = Object.keys) && nativeKeys,\n        nativeMax = Math.max,\n        nativeMin = Math.min,\n        nativeParseInt = context.parseInt,\n        nativeRandom = Math.random;\n\n    /** Used to lookup a built-in constructor by [[Class]] */\n    var ctorByClass = {};\n    ctorByClass[arrayClass] = Array;\n    ctorByClass[boolClass] = Boolean;\n    ctorByClass[dateClass] = Date;\n    ctorByClass[funcClass] = Function;\n    ctorByClass[objectClass] = Object;\n    ctorByClass[numberClass] = Number;\n    ctorByClass[regexpClass] = RegExp;\n    ctorByClass[stringClass] = String;\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Creates a `lodash` object which wraps the given value to enable intuitive\n     * method chaining.\n     *\n     * In addition to Lo-Dash methods, wrappers also have the following `Array` methods:\n     * `concat`, `join`, `pop`, `push`, `reverse`, `shift`, `slice`, `sort`, `splice`,\n     * and `unshift`\n     *\n     * Chaining is supported in custom builds as long as the `value` method is\n     * implicitly or explicitly included in the build.\n     *\n     * The chainable wrapper functions are:\n     * `after`, `assign`, `bind`, `bindAll`, `bindKey`, `chain`, `compact`,\n     * `compose`, `concat`, `countBy`, `create`, `createCallback`, `curry`,\n     * `debounce`, `defaults`, `defer`, `delay`, `difference`, `filter`, `flatten`,\n     * `forEach`, `forEachRight`, `forIn`, `forInRight`, `forOwn`, `forOwnRight`,\n     * `functions`, `groupBy`, `indexBy`, `initial`, `intersection`, `invert`,\n     * `invoke`, `keys`, `map`, `max`, `memoize`, `merge`, `min`, `object`, `omit`,\n     * `once`, `pairs`, `partial`, `partialRight`, `pick`, `pluck`, `pull`, `push`,\n     * `range`, `reject`, `remove`, `rest`, `reverse`, `shuffle`, `slice`, `sort`,\n     * `sortBy`, `splice`, `tap`, `throttle`, `times`, `toArray`, `transform`,\n     * `union`, `uniq`, `unshift`, `unzip`, `values`, `where`, `without`, `wrap`,\n     * and `zip`\n     *\n     * The non-chainable wrapper functions are:\n     * `clone`, `cloneDeep`, `contains`, `escape`, `every`, `find`, `findIndex`,\n     * `findKey`, `findLast`, `findLastIndex`, `findLastKey`, `has`, `identity`,\n     * `indexOf`, `isArguments`, `isArray`, `isBoolean`, `isDate`, `isElement`,\n     * `isEmpty`, `isEqual`, `isFinite`, `isFunction`, `isNaN`, `isNull`, `isNumber`,\n     * `isObject`, `isPlainObject`, `isRegExp`, `isString`, `isUndefined`, `join`,\n     * `lastIndexOf`, `mixin`, `noConflict`, `parseInt`, `pop`, `random`, `reduce`,\n     * `reduceRight`, `result`, `shift`, `size`, `some`, `sortedIndex`, `runInContext`,\n     * `template`, `unescape`, `uniqueId`, and `value`\n     *\n     * The wrapper functions `first` and `last` return wrapped values when `n` is\n     * provided, otherwise they return unwrapped values.\n     *\n     * Explicit chaining can be enabled by using the `_.chain` method.\n     *\n     * @name _\n     * @constructor\n     * @category Chaining\n     * @param {*} value The value to wrap in a `lodash` instance.\n     * @returns {Object} Returns a `lodash` instance.\n     * @example\n     *\n     * var wrapped = _([1, 2, 3]);\n     *\n     * // returns an unwrapped value\n     * wrapped.reduce(function(sum, num) {\n     *   return sum + num;\n     * });\n     * // => 6\n     *\n     * // returns a wrapped value\n     * var squares = wrapped.map(function(num) {\n     *   return num * num;\n     * });\n     *\n     * _.isArray(squares);\n     * // => false\n     *\n     * _.isArray(squares.value());\n     * // => true\n     */\n    function lodash(value) {\n      // don't wrap if already wrapped, even if wrapped by a different `lodash` constructor\n      return (value && typeof value == 'object' && !isArray(value) && hasOwnProperty.call(value, '__wrapped__'))\n       ? value\n       : new lodashWrapper(value);\n    }\n\n    /**\n     * A fast path for creating `lodash` wrapper objects.\n     *\n     * @private\n     * @param {*} value The value to wrap in a `lodash` instance.\n     * @param {boolean} chainAll A flag to enable chaining for all methods\n     * @returns {Object} Returns a `lodash` instance.\n     */\n    function lodashWrapper(value, chainAll) {\n      this.__chain__ = !!chainAll;\n      this.__wrapped__ = value;\n    }\n    // ensure `new lodashWrapper` is an instance of `lodash`\n    lodashWrapper.prototype = lodash.prototype;\n\n    /**\n     * An object used to flag environments features.\n     *\n     * @static\n     * @memberOf _\n     * @type Object\n     */\n    var support = lodash.support = {};\n\n    /**\n     * Detect if functions can be decompiled by `Function#toString`\n     * (all but PS3 and older Opera mobile browsers & avoided in Windows 8 apps).\n     *\n     * @memberOf _.support\n     * @type boolean\n     */\n    support.funcDecomp = !isNative(context.WinRTError) && reThis.test(runInContext);\n\n    /**\n     * Detect if `Function#name` is supported (all but IE).\n     *\n     * @memberOf _.support\n     * @type boolean\n     */\n    support.funcNames = typeof Function.name == 'string';\n\n    /**\n     * By default, the template delimiters used by Lo-Dash are similar to those in\n     * embedded Ruby (ERB). Change the following template settings to use alternative\n     * delimiters.\n     *\n     * @static\n     * @memberOf _\n     * @type Object\n     */\n    lodash.templateSettings = {\n\n      /**\n       * Used to detect `data` property values to be HTML-escaped.\n       *\n       * @memberOf _.templateSettings\n       * @type RegExp\n       */\n      'escape': /<%-([\\s\\S]+?)%>/g,\n\n      /**\n       * Used to detect code to be evaluated.\n       *\n       * @memberOf _.templateSettings\n       * @type RegExp\n       */\n      'evaluate': /<%([\\s\\S]+?)%>/g,\n\n      /**\n       * Used to detect `data` property values to inject.\n       *\n       * @memberOf _.templateSettings\n       * @type RegExp\n       */\n      'interpolate': reInterpolate,\n\n      /**\n       * Used to reference the data object in the template text.\n       *\n       * @memberOf _.templateSettings\n       * @type string\n       */\n      'variable': '',\n\n      /**\n       * Used to import variables into the compiled template.\n       *\n       * @memberOf _.templateSettings\n       * @type Object\n       */\n      'imports': {\n\n        /**\n         * A reference to the `lodash` function.\n         *\n         * @memberOf _.templateSettings.imports\n         * @type Function\n         */\n        '_': lodash\n      }\n    };\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * The base implementation of `_.bind` that creates the bound function and\n     * sets its meta data.\n     *\n     * @private\n     * @param {Array} bindData The bind data array.\n     * @returns {Function} Returns the new bound function.\n     */\n    function baseBind(bindData) {\n      var func = bindData[0],\n          partialArgs = bindData[2],\n          thisArg = bindData[4];\n\n      function bound() {\n        // `Function#bind` spec\n        // http://es5.github.io/#x15.3.4.5\n        if (partialArgs) {\n          // avoid `arguments` object deoptimizations by using `slice` instead\n          // of `Array.prototype.slice.call` and not assigning `arguments` to a\n          // variable as a ternary expression\n          var args = slice(partialArgs);\n          push.apply(args, arguments);\n        }\n        // mimic the constructor's `return` behavior\n        // http://es5.github.io/#x13.2.2\n        if (this instanceof bound) {\n          // ensure `new bound` is an instance of `func`\n          var thisBinding = baseCreate(func.prototype),\n              result = func.apply(thisBinding, args || arguments);\n          return isObject(result) ? result : thisBinding;\n        }\n        return func.apply(thisArg, args || arguments);\n      }\n      setBindData(bound, bindData);\n      return bound;\n    }\n\n    /**\n     * The base implementation of `_.clone` without argument juggling or support\n     * for `thisArg` binding.\n     *\n     * @private\n     * @param {*} value The value to clone.\n     * @param {boolean} [isDeep=false] Specify a deep clone.\n     * @param {Function} [callback] The function to customize cloning values.\n     * @param {Array} [stackA=[]] Tracks traversed source objects.\n     * @param {Array} [stackB=[]] Associates clones with source counterparts.\n     * @returns {*} Returns the cloned value.\n     */\n    function baseClone(value, isDeep, callback, stackA, stackB) {\n      if (callback) {\n        var result = callback(value);\n        if (typeof result != 'undefined') {\n          return result;\n        }\n      }\n      // inspect [[Class]]\n      var isObj = isObject(value);\n      if (isObj) {\n        var className = toString.call(value);\n        if (!cloneableClasses[className]) {\n          return value;\n        }\n        var ctor = ctorByClass[className];\n        switch (className) {\n          case boolClass:\n          case dateClass:\n            return new ctor(+value);\n\n          case numberClass:\n          case stringClass:\n            return new ctor(value);\n\n          case regexpClass:\n            result = ctor(value.source, reFlags.exec(value));\n            result.lastIndex = value.lastIndex;\n            return result;\n        }\n      } else {\n        return value;\n      }\n      var isArr = isArray(value);\n      if (isDeep) {\n        // check for circular references and return corresponding clone\n        var initedStack = !stackA;\n        stackA || (stackA = getArray());\n        stackB || (stackB = getArray());\n\n        var length = stackA.length;\n        while (length--) {\n          if (stackA[length] == value) {\n            return stackB[length];\n          }\n        }\n        result = isArr ? ctor(value.length) : {};\n      }\n      else {\n        result = isArr ? slice(value) : assign({}, value);\n      }\n      // add array properties assigned by `RegExp#exec`\n      if (isArr) {\n        if (hasOwnProperty.call(value, 'index')) {\n          result.index = value.index;\n        }\n        if (hasOwnProperty.call(value, 'input')) {\n          result.input = value.input;\n        }\n      }\n      // exit for shallow clone\n      if (!isDeep) {\n        return result;\n      }\n      // add the source value to the stack of traversed objects\n      // and associate it with its clone\n      stackA.push(value);\n      stackB.push(result);\n\n      // recursively populate clone (susceptible to call stack limits)\n      (isArr ? forEach : forOwn)(value, function(objValue, key) {\n        result[key] = baseClone(objValue, isDeep, callback, stackA, stackB);\n      });\n\n      if (initedStack) {\n        releaseArray(stackA);\n        releaseArray(stackB);\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.create` without support for assigning\n     * properties to the created object.\n     *\n     * @private\n     * @param {Object} prototype The object to inherit from.\n     * @returns {Object} Returns the new object.\n     */\n    function baseCreate(prototype, properties) {\n      return isObject(prototype) ? nativeCreate(prototype) : {};\n    }\n    // fallback for browsers without `Object.create`\n    if (!nativeCreate) {\n      baseCreate = (function() {\n        function Object() {}\n        return function(prototype) {\n          if (isObject(prototype)) {\n            Object.prototype = prototype;\n            var result = new Object;\n            Object.prototype = null;\n          }\n          return result || context.Object();\n        };\n      }());\n    }\n\n    /**\n     * The base implementation of `_.createCallback` without support for creating\n     * \"_.pluck\" or \"_.where\" style callbacks.\n     *\n     * @private\n     * @param {*} [func=identity] The value to convert to a callback.\n     * @param {*} [thisArg] The `this` binding of the created callback.\n     * @param {number} [argCount] The number of arguments the callback accepts.\n     * @returns {Function} Returns a callback function.\n     */\n    function baseCreateCallback(func, thisArg, argCount) {\n      if (typeof func != 'function') {\n        return identity;\n      }\n      // exit early for no `thisArg` or already bound by `Function#bind`\n      if (typeof thisArg == 'undefined' || !('prototype' in func)) {\n        return func;\n      }\n      var bindData = func.__bindData__;\n      if (typeof bindData == 'undefined') {\n        if (support.funcNames) {\n          bindData = !func.name;\n        }\n        bindData = bindData || !support.funcDecomp;\n        if (!bindData) {\n          var source = fnToString.call(func);\n          if (!support.funcNames) {\n            bindData = !reFuncName.test(source);\n          }\n          if (!bindData) {\n            // checks if `func` references the `this` keyword and stores the result\n            bindData = reThis.test(source);\n            setBindData(func, bindData);\n          }\n        }\n      }\n      // exit early if there are no `this` references or `func` is bound\n      if (bindData === false || (bindData !== true && bindData[1] & 1)) {\n        return func;\n      }\n      switch (argCount) {\n        case 1: return function(value) {\n          return func.call(thisArg, value);\n        };\n        case 2: return function(a, b) {\n          return func.call(thisArg, a, b);\n        };\n        case 3: return function(value, index, collection) {\n          return func.call(thisArg, value, index, collection);\n        };\n        case 4: return function(accumulator, value, index, collection) {\n          return func.call(thisArg, accumulator, value, index, collection);\n        };\n      }\n      return bind(func, thisArg);\n    }\n\n    /**\n     * The base implementation of `createWrapper` that creates the wrapper and\n     * sets its meta data.\n     *\n     * @private\n     * @param {Array} bindData The bind data array.\n     * @returns {Function} Returns the new function.\n     */\n    function baseCreateWrapper(bindData) {\n      var func = bindData[0],\n          bitmask = bindData[1],\n          partialArgs = bindData[2],\n          partialRightArgs = bindData[3],\n          thisArg = bindData[4],\n          arity = bindData[5];\n\n      var isBind = bitmask & 1,\n          isBindKey = bitmask & 2,\n          isCurry = bitmask & 4,\n          isCurryBound = bitmask & 8,\n          key = func;\n\n      function bound() {\n        var thisBinding = isBind ? thisArg : this;\n        if (partialArgs) {\n          var args = slice(partialArgs);\n          push.apply(args, arguments);\n        }\n        if (partialRightArgs || isCurry) {\n          args || (args = slice(arguments));\n          if (partialRightArgs) {\n            push.apply(args, partialRightArgs);\n          }\n          if (isCurry && args.length < arity) {\n            bitmask |= 16 & ~32;\n            return baseCreateWrapper([func, (isCurryBound ? bitmask : bitmask & ~3), args, null, thisArg, arity]);\n          }\n        }\n        args || (args = arguments);\n        if (isBindKey) {\n          func = thisBinding[key];\n        }\n        if (this instanceof bound) {\n          thisBinding = baseCreate(func.prototype);\n          var result = func.apply(thisBinding, args);\n          return isObject(result) ? result : thisBinding;\n        }\n        return func.apply(thisBinding, args);\n      }\n      setBindData(bound, bindData);\n      return bound;\n    }\n\n    /**\n     * The base implementation of `_.difference` that accepts a single array\n     * of values to exclude.\n     *\n     * @private\n     * @param {Array} array The array to process.\n     * @param {Array} [values] The array of values to exclude.\n     * @returns {Array} Returns a new array of filtered values.\n     */\n    function baseDifference(array, values) {\n      var index = -1,\n          indexOf = getIndexOf(),\n          length = array ? array.length : 0,\n          isLarge = length >= largeArraySize && indexOf === baseIndexOf,\n          result = [];\n\n      if (isLarge) {\n        var cache = createCache(values);\n        if (cache) {\n          indexOf = cacheIndexOf;\n          values = cache;\n        } else {\n          isLarge = false;\n        }\n      }\n      while (++index < length) {\n        var value = array[index];\n        if (indexOf(values, value) < 0) {\n          result.push(value);\n        }\n      }\n      if (isLarge) {\n        releaseObject(values);\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.flatten` without support for callback\n     * shorthands or `thisArg` binding.\n     *\n     * @private\n     * @param {Array} array The array to flatten.\n     * @param {boolean} [isShallow=false] A flag to restrict flattening to a single level.\n     * @param {boolean} [isStrict=false] A flag to restrict flattening to arrays and `arguments` objects.\n     * @param {number} [fromIndex=0] The index to start from.\n     * @returns {Array} Returns a new flattened array.\n     */\n    function baseFlatten(array, isShallow, isStrict, fromIndex) {\n      var index = (fromIndex || 0) - 1,\n          length = array ? array.length : 0,\n          result = [];\n\n      while (++index < length) {\n        var value = array[index];\n\n        if (value && typeof value == 'object' && typeof value.length == 'number'\n            && (isArray(value) || isArguments(value))) {\n          // recursively flatten arrays (susceptible to call stack limits)\n          if (!isShallow) {\n            value = baseFlatten(value, isShallow, isStrict);\n          }\n          var valIndex = -1,\n              valLength = value.length,\n              resIndex = result.length;\n\n          result.length += valLength;\n          while (++valIndex < valLength) {\n            result[resIndex++] = value[valIndex];\n          }\n        } else if (!isStrict) {\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.isEqual`, without support for `thisArg` binding,\n     * that allows partial \"_.where\" style comparisons.\n     *\n     * @private\n     * @param {*} a The value to compare.\n     * @param {*} b The other value to compare.\n     * @param {Function} [callback] The function to customize comparing values.\n     * @param {Function} [isWhere=false] A flag to indicate performing partial comparisons.\n     * @param {Array} [stackA=[]] Tracks traversed `a` objects.\n     * @param {Array} [stackB=[]] Tracks traversed `b` objects.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     */\n    function baseIsEqual(a, b, callback, isWhere, stackA, stackB) {\n      // used to indicate that when comparing objects, `a` has at least the properties of `b`\n      if (callback) {\n        var result = callback(a, b);\n        if (typeof result != 'undefined') {\n          return !!result;\n        }\n      }\n      // exit early for identical values\n      if (a === b) {\n        // treat `+0` vs. `-0` as not equal\n        return a !== 0 || (1 / a == 1 / b);\n      }\n      var type = typeof a,\n          otherType = typeof b;\n\n      // exit early for unlike primitive values\n      if (a === a &&\n          !(a && objectTypes[type]) &&\n          !(b && objectTypes[otherType])) {\n        return false;\n      }\n      // exit early for `null` and `undefined` avoiding ES3's Function#call behavior\n      // http://es5.github.io/#x15.3.4.4\n      if (a == null || b == null) {\n        return a === b;\n      }\n      // compare [[Class]] names\n      var className = toString.call(a),\n          otherClass = toString.call(b);\n\n      if (className == argsClass) {\n        className = objectClass;\n      }\n      if (otherClass == argsClass) {\n        otherClass = objectClass;\n      }\n      if (className != otherClass) {\n        return false;\n      }\n      switch (className) {\n        case boolClass:\n        case dateClass:\n          // coerce dates and booleans to numbers, dates to milliseconds and booleans\n          // to `1` or `0` treating invalid dates coerced to `NaN` as not equal\n          return +a == +b;\n\n        case numberClass:\n          // treat `NaN` vs. `NaN` as equal\n          return (a != +a)\n            ? b != +b\n            // but treat `+0` vs. `-0` as not equal\n            : (a == 0 ? (1 / a == 1 / b) : a == +b);\n\n        case regexpClass:\n        case stringClass:\n          // coerce regexes to strings (http://es5.github.io/#x15.10.6.4)\n          // treat string primitives and their corresponding object instances as equal\n          return a == String(b);\n      }\n      var isArr = className == arrayClass;\n      if (!isArr) {\n        // unwrap any `lodash` wrapped values\n        var aWrapped = hasOwnProperty.call(a, '__wrapped__'),\n            bWrapped = hasOwnProperty.call(b, '__wrapped__');\n\n        if (aWrapped || bWrapped) {\n          return baseIsEqual(aWrapped ? a.__wrapped__ : a, bWrapped ? b.__wrapped__ : b, callback, isWhere, stackA, stackB);\n        }\n        // exit for functions and DOM nodes\n        if (className != objectClass) {\n          return false;\n        }\n        // in older versions of Opera, `arguments` objects have `Array` constructors\n        var ctorA = a.constructor,\n            ctorB = b.constructor;\n\n        // non `Object` object instances with different constructors are not equal\n        if (ctorA != ctorB &&\n              !(isFunction(ctorA) && ctorA instanceof ctorA && isFunction(ctorB) && ctorB instanceof ctorB) &&\n              ('constructor' in a && 'constructor' in b)\n            ) {\n          return false;\n        }\n      }\n      // assume cyclic structures are equal\n      // the algorithm for detecting cyclic structures is adapted from ES 5.1\n      // section 15.12.3, abstract operation `JO` (http://es5.github.io/#x15.12.3)\n      var initedStack = !stackA;\n      stackA || (stackA = getArray());\n      stackB || (stackB = getArray());\n\n      var length = stackA.length;\n      while (length--) {\n        if (stackA[length] == a) {\n          return stackB[length] == b;\n        }\n      }\n      var size = 0;\n      result = true;\n\n      // add `a` and `b` to the stack of traversed objects\n      stackA.push(a);\n      stackB.push(b);\n\n      // recursively compare objects and arrays (susceptible to call stack limits)\n      if (isArr) {\n        // compare lengths to determine if a deep comparison is necessary\n        length = a.length;\n        size = b.length;\n        result = size == length;\n\n        if (result || isWhere) {\n          // deep compare the contents, ignoring non-numeric properties\n          while (size--) {\n            var index = length,\n                value = b[size];\n\n            if (isWhere) {\n              while (index--) {\n                if ((result = baseIsEqual(a[index], value, callback, isWhere, stackA, stackB))) {\n                  break;\n                }\n              }\n            } else if (!(result = baseIsEqual(a[size], value, callback, isWhere, stackA, stackB))) {\n              break;\n            }\n          }\n        }\n      }\n      else {\n        // deep compare objects using `forIn`, instead of `forOwn`, to avoid `Object.keys`\n        // which, in this case, is more costly\n        forIn(b, function(value, key, b) {\n          if (hasOwnProperty.call(b, key)) {\n            // count the number of properties.\n            size++;\n            // deep compare each property value.\n            return (result = hasOwnProperty.call(a, key) && baseIsEqual(a[key], value, callback, isWhere, stackA, stackB));\n          }\n        });\n\n        if (result && !isWhere) {\n          // ensure both objects have the same number of properties\n          forIn(a, function(value, key, a) {\n            if (hasOwnProperty.call(a, key)) {\n              // `size` will be `-1` if `a` has more properties than `b`\n              return (result = --size > -1);\n            }\n          });\n        }\n      }\n      stackA.pop();\n      stackB.pop();\n\n      if (initedStack) {\n        releaseArray(stackA);\n        releaseArray(stackB);\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.merge` without argument juggling or support\n     * for `thisArg` binding.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @param {Function} [callback] The function to customize merging properties.\n     * @param {Array} [stackA=[]] Tracks traversed source objects.\n     * @param {Array} [stackB=[]] Associates values with source counterparts.\n     */\n    function baseMerge(object, source, callback, stackA, stackB) {\n      (isArray(source) ? forEach : forOwn)(source, function(source, key) {\n        var found,\n            isArr,\n            result = source,\n            value = object[key];\n\n        if (source && ((isArr = isArray(source)) || isPlainObject(source))) {\n          // avoid merging previously merged cyclic sources\n          var stackLength = stackA.length;\n          while (stackLength--) {\n            if ((found = stackA[stackLength] == source)) {\n              value = stackB[stackLength];\n              break;\n            }\n          }\n          if (!found) {\n            var isShallow;\n            if (callback) {\n              result = callback(value, source);\n              if ((isShallow = typeof result != 'undefined')) {\n                value = result;\n              }\n            }\n            if (!isShallow) {\n              value = isArr\n                ? (isArray(value) ? value : [])\n                : (isPlainObject(value) ? value : {});\n            }\n            // add `source` and associated `value` to the stack of traversed objects\n            stackA.push(source);\n            stackB.push(value);\n\n            // recursively merge objects and arrays (susceptible to call stack limits)\n            if (!isShallow) {\n              baseMerge(value, source, callback, stackA, stackB);\n            }\n          }\n        }\n        else {\n          if (callback) {\n            result = callback(value, source);\n            if (typeof result == 'undefined') {\n              result = source;\n            }\n          }\n          if (typeof result != 'undefined') {\n            value = result;\n          }\n        }\n        object[key] = value;\n      });\n    }\n\n    /**\n     * The base implementation of `_.random` without argument juggling or support\n     * for returning floating-point numbers.\n     *\n     * @private\n     * @param {number} min The minimum possible value.\n     * @param {number} max The maximum possible value.\n     * @returns {number} Returns a random number.\n     */\n    function baseRandom(min, max) {\n      return min + floor(nativeRandom() * (max - min + 1));\n    }\n\n    /**\n     * The base implementation of `_.uniq` without support for callback shorthands\n     * or `thisArg` binding.\n     *\n     * @private\n     * @param {Array} array The array to process.\n     * @param {boolean} [isSorted=false] A flag to indicate that `array` is sorted.\n     * @param {Function} [callback] The function called per iteration.\n     * @returns {Array} Returns a duplicate-value-free array.\n     */\n    function baseUniq(array, isSorted, callback) {\n      var index = -1,\n          indexOf = getIndexOf(),\n          length = array ? array.length : 0,\n          result = [];\n\n      var isLarge = !isSorted && length >= largeArraySize && indexOf === baseIndexOf,\n          seen = (callback || isLarge) ? getArray() : result;\n\n      if (isLarge) {\n        var cache = createCache(seen);\n        indexOf = cacheIndexOf;\n        seen = cache;\n      }\n      while (++index < length) {\n        var value = array[index],\n            computed = callback ? callback(value, index, array) : value;\n\n        if (isSorted\n              ? !index || seen[seen.length - 1] !== computed\n              : indexOf(seen, computed) < 0\n            ) {\n          if (callback || isLarge) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n      }\n      if (isLarge) {\n        releaseArray(seen.array);\n        releaseObject(seen);\n      } else if (callback) {\n        releaseArray(seen);\n      }\n      return result;\n    }\n\n    /**\n     * Creates a function that aggregates a collection, creating an object composed\n     * of keys generated from the results of running each element of the collection\n     * through a callback. The given `setter` function sets the keys and values\n     * of the composed object.\n     *\n     * @private\n     * @param {Function} setter The setter function.\n     * @returns {Function} Returns the new aggregator function.\n     */\n    function createAggregator(setter) {\n      return function(collection, callback, thisArg) {\n        var result = {};\n        callback = lodash.createCallback(callback, thisArg, 3);\n\n        var index = -1,\n            length = collection ? collection.length : 0;\n\n        if (typeof length == 'number') {\n          while (++index < length) {\n            var value = collection[index];\n            setter(result, value, callback(value, index, collection), collection);\n          }\n        } else {\n          forOwn(collection, function(value, key, collection) {\n            setter(result, value, callback(value, key, collection), collection);\n          });\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Creates a function that, when called, either curries or invokes `func`\n     * with an optional `this` binding and partially applied arguments.\n     *\n     * @private\n     * @param {Function|string} func The function or method name to reference.\n     * @param {number} bitmask The bitmask of method flags to compose.\n     *  The bitmask may be composed of the following flags:\n     *  1 - `_.bind`\n     *  2 - `_.bindKey`\n     *  4 - `_.curry`\n     *  8 - `_.curry` (bound)\n     *  16 - `_.partial`\n     *  32 - `_.partialRight`\n     * @param {Array} [partialArgs] An array of arguments to prepend to those\n     *  provided to the new function.\n     * @param {Array} [partialRightArgs] An array of arguments to append to those\n     *  provided to the new function.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new function.\n     */\n    function createWrapper(func, bitmask, partialArgs, partialRightArgs, thisArg, arity) {\n      var isBind = bitmask & 1,\n          isBindKey = bitmask & 2,\n          isCurry = bitmask & 4,\n          isCurryBound = bitmask & 8,\n          isPartial = bitmask & 16,\n          isPartialRight = bitmask & 32;\n\n      if (!isBindKey && !isFunction(func)) {\n        throw new TypeError;\n      }\n      if (isPartial && !partialArgs.length) {\n        bitmask &= ~16;\n        isPartial = partialArgs = false;\n      }\n      if (isPartialRight && !partialRightArgs.length) {\n        bitmask &= ~32;\n        isPartialRight = partialRightArgs = false;\n      }\n      var bindData = func && func.__bindData__;\n      if (bindData && bindData !== true) {\n        // clone `bindData`\n        bindData = slice(bindData);\n        if (bindData[2]) {\n          bindData[2] = slice(bindData[2]);\n        }\n        if (bindData[3]) {\n          bindData[3] = slice(bindData[3]);\n        }\n        // set `thisBinding` is not previously bound\n        if (isBind && !(bindData[1] & 1)) {\n          bindData[4] = thisArg;\n        }\n        // set if previously bound but not currently (subsequent curried functions)\n        if (!isBind && bindData[1] & 1) {\n          bitmask |= 8;\n        }\n        // set curried arity if not yet set\n        if (isCurry && !(bindData[1] & 4)) {\n          bindData[5] = arity;\n        }\n        // append partial left arguments\n        if (isPartial) {\n          push.apply(bindData[2] || (bindData[2] = []), partialArgs);\n        }\n        // append partial right arguments\n        if (isPartialRight) {\n          unshift.apply(bindData[3] || (bindData[3] = []), partialRightArgs);\n        }\n        // merge flags\n        bindData[1] |= bitmask;\n        return createWrapper.apply(null, bindData);\n      }\n      // fast path for `_.bind`\n      var creater = (bitmask == 1 || bitmask === 17) ? baseBind : baseCreateWrapper;\n      return creater([func, bitmask, partialArgs, partialRightArgs, thisArg, arity]);\n    }\n\n    /**\n     * Used by `escape` to convert characters to HTML entities.\n     *\n     * @private\n     * @param {string} match The matched character to escape.\n     * @returns {string} Returns the escaped character.\n     */\n    function escapeHtmlChar(match) {\n      return htmlEscapes[match];\n    }\n\n    /**\n     * Gets the appropriate \"indexOf\" function. If the `_.indexOf` method is\n     * customized, this method returns the custom method, otherwise it returns\n     * the `baseIndexOf` function.\n     *\n     * @private\n     * @returns {Function} Returns the \"indexOf\" function.\n     */\n    function getIndexOf() {\n      var result = (result = lodash.indexOf) === indexOf ? baseIndexOf : result;\n      return result;\n    }\n\n    /**\n     * Checks if `value` is a native function.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a native function, else `false`.\n     */\n    function isNative(value) {\n      return typeof value == 'function' && reNative.test(value);\n    }\n\n    /**\n     * Sets `this` binding data on a given function.\n     *\n     * @private\n     * @param {Function} func The function to set data on.\n     * @param {Array} value The data array to set.\n     */\n    var setBindData = !defineProperty ? noop : function(func, value) {\n      descriptor.value = value;\n      defineProperty(func, '__bindData__', descriptor);\n    };\n\n    /**\n     * A fallback implementation of `isPlainObject` which checks if a given value\n     * is an object created by the `Object` constructor, assuming objects created\n     * by the `Object` constructor have no inherited enumerable properties and that\n     * there are no `Object.prototype` extensions.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n     */\n    function shimIsPlainObject(value) {\n      var ctor,\n          result;\n\n      // avoid non Object objects, `arguments` objects, and DOM elements\n      if (!(value && toString.call(value) == objectClass) ||\n          (ctor = value.constructor, isFunction(ctor) && !(ctor instanceof ctor))) {\n        return false;\n      }\n      // In most environments an object's own properties are iterated before\n      // its inherited properties. If the last iterated property is an object's\n      // own property then there are no inherited enumerable properties.\n      forIn(value, function(value, key) {\n        result = key;\n      });\n      return typeof result == 'undefined' || hasOwnProperty.call(value, result);\n    }\n\n    /**\n     * Used by `unescape` to convert HTML entities to characters.\n     *\n     * @private\n     * @param {string} match The matched character to unescape.\n     * @returns {string} Returns the unescaped character.\n     */\n    function unescapeHtmlChar(match) {\n      return htmlUnescapes[match];\n    }\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Checks if `value` is an `arguments` object.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is an `arguments` object, else `false`.\n     * @example\n     *\n     * (function() { return _.isArguments(arguments); })(1, 2, 3);\n     * // => true\n     *\n     * _.isArguments([1, 2, 3]);\n     * // => false\n     */\n    function isArguments(value) {\n      return value && typeof value == 'object' && typeof value.length == 'number' &&\n        toString.call(value) == argsClass || false;\n    }\n\n    /**\n     * Checks if `value` is an array.\n     *\n     * @static\n     * @memberOf _\n     * @type Function\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is an array, else `false`.\n     * @example\n     *\n     * (function() { return _.isArray(arguments); })();\n     * // => false\n     *\n     * _.isArray([1, 2, 3]);\n     * // => true\n     */\n    var isArray = nativeIsArray || function(value) {\n      return value && typeof value == 'object' && typeof value.length == 'number' &&\n        toString.call(value) == arrayClass || false;\n    };\n\n    /**\n     * A fallback implementation of `Object.keys` which produces an array of the\n     * given object's own enumerable property names.\n     *\n     * @private\n     * @type Function\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns an array of property names.\n     */\n    var shimKeys = function(object) {\n      var index, iterable = object, result = [];\n      if (!iterable) return result;\n      if (!(objectTypes[typeof object])) return result;\n        for (index in iterable) {\n          if (hasOwnProperty.call(iterable, index)) {\n            result.push(index);\n          }\n        }\n      return result\n    };\n\n    /**\n     * Creates an array composed of the own enumerable property names of an object.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns an array of property names.\n     * @example\n     *\n     * _.keys({ 'one': 1, 'two': 2, 'three': 3 });\n     * // => ['one', 'two', 'three'] (property order is not guaranteed across environments)\n     */\n    var keys = !nativeKeys ? shimKeys : function(object) {\n      if (!isObject(object)) {\n        return [];\n      }\n      return nativeKeys(object);\n    };\n\n    /**\n     * Used to convert characters to HTML entities:\n     *\n     * Though the `>` character is escaped for symmetry, characters like `>` and `/`\n     * don't require escaping in HTML and have no special meaning unless they're part\n     * of a tag or an unquoted attribute value.\n     * http://mathiasbynens.be/notes/ambiguous-ampersands (under \"semi-related fun fact\")\n     */\n    var htmlEscapes = {\n      '&': '&amp;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '\"': '&quot;',\n      \"'\": '&#39;'\n    };\n\n    /** Used to convert HTML entities to characters */\n    var htmlUnescapes = invert(htmlEscapes);\n\n    /** Used to match HTML entities and HTML characters */\n    var reEscapedHtml = RegExp('(' + keys(htmlUnescapes).join('|') + ')', 'g'),\n        reUnescapedHtml = RegExp('[' + keys(htmlEscapes).join('') + ']', 'g');\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Assigns own enumerable properties of source object(s) to the destination\n     * object. Subsequent sources will overwrite property assignments of previous\n     * sources. If a callback is provided it will be executed to produce the\n     * assigned values. The callback is bound to `thisArg` and invoked with two\n     * arguments; (objectValue, sourceValue).\n     *\n     * @static\n     * @memberOf _\n     * @type Function\n     * @alias extend\n     * @category Objects\n     * @param {Object} object The destination object.\n     * @param {...Object} [source] The source objects.\n     * @param {Function} [callback] The function to customize assigning values.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns the destination object.\n     * @example\n     *\n     * _.assign({ 'name': 'fred' }, { 'employer': 'slate' });\n     * // => { 'name': 'fred', 'employer': 'slate' }\n     *\n     * var defaults = _.partialRight(_.assign, function(a, b) {\n     *   return typeof a == 'undefined' ? b : a;\n     * });\n     *\n     * var object = { 'name': 'barney' };\n     * defaults(object, { 'name': 'fred', 'employer': 'slate' });\n     * // => { 'name': 'barney', 'employer': 'slate' }\n     */\n    var assign = function(object, source, guard) {\n      var index, iterable = object, result = iterable;\n      if (!iterable) return result;\n      var args = arguments,\n          argsIndex = 0,\n          argsLength = typeof guard == 'number' ? 2 : args.length;\n      if (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n        var callback = baseCreateCallback(args[--argsLength - 1], args[argsLength--], 2);\n      } else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n        callback = args[--argsLength];\n      }\n      while (++argsIndex < argsLength) {\n        iterable = args[argsIndex];\n        if (iterable && objectTypes[typeof iterable]) {\n        var ownIndex = -1,\n            ownProps = objectTypes[typeof iterable] && keys(iterable),\n            length = ownProps ? ownProps.length : 0;\n\n        while (++ownIndex < length) {\n          index = ownProps[ownIndex];\n          result[index] = callback ? callback(result[index], iterable[index]) : iterable[index];\n        }\n        }\n      }\n      return result\n    };\n\n    /**\n     * Creates a clone of `value`. If `isDeep` is `true` nested objects will also\n     * be cloned, otherwise they will be assigned by reference. If a callback\n     * is provided it will be executed to produce the cloned values. If the\n     * callback returns `undefined` cloning will be handled by the method instead.\n     * The callback is bound to `thisArg` and invoked with one argument; (value).\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to clone.\n     * @param {boolean} [isDeep=false] Specify a deep clone.\n     * @param {Function} [callback] The function to customize cloning values.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the cloned value.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * var shallow = _.clone(characters);\n     * shallow[0] === characters[0];\n     * // => true\n     *\n     * var deep = _.clone(characters, true);\n     * deep[0] === characters[0];\n     * // => false\n     *\n     * _.mixin({\n     *   'clone': _.partialRight(_.clone, function(value) {\n     *     return _.isElement(value) ? value.cloneNode(false) : undefined;\n     *   })\n     * });\n     *\n     * var clone = _.clone(document.body);\n     * clone.childNodes.length;\n     * // => 0\n     */\n    function clone(value, isDeep, callback, thisArg) {\n      // allows working with \"Collections\" methods without using their `index`\n      // and `collection` arguments for `isDeep` and `callback`\n      if (typeof isDeep != 'boolean' && isDeep != null) {\n        thisArg = callback;\n        callback = isDeep;\n        isDeep = false;\n      }\n      return baseClone(value, isDeep, typeof callback == 'function' && baseCreateCallback(callback, thisArg, 1));\n    }\n\n    /**\n     * Creates a deep clone of `value`. If a callback is provided it will be\n     * executed to produce the cloned values. If the callback returns `undefined`\n     * cloning will be handled by the method instead. The callback is bound to\n     * `thisArg` and invoked with one argument; (value).\n     *\n     * Note: This method is loosely based on the structured clone algorithm. Functions\n     * and DOM nodes are **not** cloned. The enumerable properties of `arguments` objects and\n     * objects created by constructors other than `Object` are cloned to plain `Object` objects.\n     * See http://www.w3.org/TR/html5/infrastructure.html#internal-structured-cloning-algorithm.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to deep clone.\n     * @param {Function} [callback] The function to customize cloning values.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the deep cloned value.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * var deep = _.cloneDeep(characters);\n     * deep[0] === characters[0];\n     * // => false\n     *\n     * var view = {\n     *   'label': 'docs',\n     *   'node': element\n     * };\n     *\n     * var clone = _.cloneDeep(view, function(value) {\n     *   return _.isElement(value) ? value.cloneNode(true) : undefined;\n     * });\n     *\n     * clone.node == view.node;\n     * // => false\n     */\n    function cloneDeep(value, callback, thisArg) {\n      return baseClone(value, true, typeof callback == 'function' && baseCreateCallback(callback, thisArg, 1));\n    }\n\n    /**\n     * Creates an object that inherits from the given `prototype` object. If a\n     * `properties` object is provided its own enumerable properties are assigned\n     * to the created object.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} prototype The object to inherit from.\n     * @param {Object} [properties] The properties to assign to the object.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * function Shape() {\n     *   this.x = 0;\n     *   this.y = 0;\n     * }\n     *\n     * function Circle() {\n     *   Shape.call(this);\n     * }\n     *\n     * Circle.prototype = _.create(Shape.prototype, { 'constructor': Circle });\n     *\n     * var circle = new Circle;\n     * circle instanceof Circle;\n     * // => true\n     *\n     * circle instanceof Shape;\n     * // => true\n     */\n    function create(prototype, properties) {\n      var result = baseCreate(prototype);\n      return properties ? assign(result, properties) : result;\n    }\n\n    /**\n     * Assigns own enumerable properties of source object(s) to the destination\n     * object for all destination properties that resolve to `undefined`. Once a\n     * property is set, additional defaults of the same property will be ignored.\n     *\n     * @static\n     * @memberOf _\n     * @type Function\n     * @category Objects\n     * @param {Object} object The destination object.\n     * @param {...Object} [source] The source objects.\n     * @param- {Object} [guard] Allows working with `_.reduce` without using its\n     *  `key` and `object` arguments as sources.\n     * @returns {Object} Returns the destination object.\n     * @example\n     *\n     * var object = { 'name': 'barney' };\n     * _.defaults(object, { 'name': 'fred', 'employer': 'slate' });\n     * // => { 'name': 'barney', 'employer': 'slate' }\n     */\n    var defaults = function(object, source, guard) {\n      var index, iterable = object, result = iterable;\n      if (!iterable) return result;\n      var args = arguments,\n          argsIndex = 0,\n          argsLength = typeof guard == 'number' ? 2 : args.length;\n      while (++argsIndex < argsLength) {\n        iterable = args[argsIndex];\n        if (iterable && objectTypes[typeof iterable]) {\n        var ownIndex = -1,\n            ownProps = objectTypes[typeof iterable] && keys(iterable),\n            length = ownProps ? ownProps.length : 0;\n\n        while (++ownIndex < length) {\n          index = ownProps[ownIndex];\n          if (typeof result[index] == 'undefined') result[index] = iterable[index];\n        }\n        }\n      }\n      return result\n    };\n\n    /**\n     * This method is like `_.findIndex` except that it returns the key of the\n     * first element that passes the callback check, instead of the element itself.\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to search.\n     * @param {Function|Object|string} [callback=identity] The function called per\n     *  iteration. If a property name or object is provided it will be used to\n     *  create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {string|undefined} Returns the key of the found element, else `undefined`.\n     * @example\n     *\n     * var characters = {\n     *   'barney': {  'age': 36, 'blocked': false },\n     *   'fred': {    'age': 40, 'blocked': true },\n     *   'pebbles': { 'age': 1,  'blocked': false }\n     * };\n     *\n     * _.findKey(characters, function(chr) {\n     *   return chr.age < 40;\n     * });\n     * // => 'barney' (property order is not guaranteed across environments)\n     *\n     * // using \"_.where\" callback shorthand\n     * _.findKey(characters, { 'age': 1 });\n     * // => 'pebbles'\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.findKey(characters, 'blocked');\n     * // => 'fred'\n     */\n    function findKey(object, callback, thisArg) {\n      var result;\n      callback = lodash.createCallback(callback, thisArg, 3);\n      forOwn(object, function(value, key, object) {\n        if (callback(value, key, object)) {\n          result = key;\n          return false;\n        }\n      });\n      return result;\n    }\n\n    /**\n     * This method is like `_.findKey` except that it iterates over elements\n     * of a `collection` in the opposite order.\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to search.\n     * @param {Function|Object|string} [callback=identity] The function called per\n     *  iteration. If a property name or object is provided it will be used to\n     *  create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {string|undefined} Returns the key of the found element, else `undefined`.\n     * @example\n     *\n     * var characters = {\n     *   'barney': {  'age': 36, 'blocked': true },\n     *   'fred': {    'age': 40, 'blocked': false },\n     *   'pebble,s': { 'age': 1,  'blocked': true }\n     * };\n     *\n     * _.findLastKey(characters, function(chr) {\n     *   return chr.age < 40;\n     * });\n     * // => returns `pebbles`, assuming `_.findKey` returns `barney`\n     *\n     * // using \"_.where\" callback shorthand\n     * _.findLastKey(characters, { 'age': 40 });\n     * // => 'fred'\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.findLastKey(characters, 'blocked');\n     * // => 'pebbles'\n     */\n    function findLastKey(object, callback, thisArg) {\n      var result;\n      callback = lodash.createCallback(callback, thisArg, 3);\n      forOwnRight(object, function(value, key, object) {\n        if (callback(value, key, object)) {\n          result = key;\n          return false;\n        }\n      });\n      return result;\n    }\n\n    /**\n     * Iterates over own and inherited enumerable properties of an object,\n     * executing the callback for each property. The callback is bound to `thisArg`\n     * and invoked with three arguments; (value, key, object). Callbacks may exit\n     * iteration early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @type Function\n     * @category Objects\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * function Shape() {\n     *   this.x = 0;\n     *   this.y = 0;\n     * }\n     *\n     * Shape.prototype.move = function(x, y) {\n     *   this.x += x;\n     *   this.y += y;\n     * };\n     *\n     * _.forIn(new Shape, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => logs 'x', 'y', and 'move' (property order is not guaranteed across environments)\n     */\n    var forIn = function(collection, callback, thisArg) {\n      var index, iterable = collection, result = iterable;\n      if (!iterable) return result;\n      if (!objectTypes[typeof iterable]) return result;\n      callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);\n        for (index in iterable) {\n          if (callback(iterable[index], index, collection) === false) return result;\n        }\n      return result\n    };\n\n    /**\n     * This method is like `_.forIn` except that it iterates over elements\n     * of a `collection` in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * function Shape() {\n     *   this.x = 0;\n     *   this.y = 0;\n     * }\n     *\n     * Shape.prototype.move = function(x, y) {\n     *   this.x += x;\n     *   this.y += y;\n     * };\n     *\n     * _.forInRight(new Shape, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => logs 'move', 'y', and 'x' assuming `_.forIn ` logs 'x', 'y', and 'move'\n     */\n    function forInRight(object, callback, thisArg) {\n      var pairs = [];\n\n      forIn(object, function(value, key) {\n        pairs.push(key, value);\n      });\n\n      var length = pairs.length;\n      callback = baseCreateCallback(callback, thisArg, 3);\n      while (length--) {\n        if (callback(pairs[length--], pairs[length], object) === false) {\n          break;\n        }\n      }\n      return object;\n    }\n\n    /**\n     * Iterates over own enumerable properties of an object, executing the callback\n     * for each property. The callback is bound to `thisArg` and invoked with three\n     * arguments; (value, key, object). Callbacks may exit iteration early by\n     * explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @type Function\n     * @category Objects\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * _.forOwn({ '0': 'zero', '1': 'one', 'length': 2 }, function(num, key) {\n     *   console.log(key);\n     * });\n     * // => logs '0', '1', and 'length' (property order is not guaranteed across environments)\n     */\n    var forOwn = function(collection, callback, thisArg) {\n      var index, iterable = collection, result = iterable;\n      if (!iterable) return result;\n      if (!objectTypes[typeof iterable]) return result;\n      callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);\n        var ownIndex = -1,\n            ownProps = objectTypes[typeof iterable] && keys(iterable),\n            length = ownProps ? ownProps.length : 0;\n\n        while (++ownIndex < length) {\n          index = ownProps[ownIndex];\n          if (callback(iterable[index], index, collection) === false) return result;\n        }\n      return result\n    };\n\n    /**\n     * This method is like `_.forOwn` except that it iterates over elements\n     * of a `collection` in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * _.forOwnRight({ '0': 'zero', '1': 'one', 'length': 2 }, function(num, key) {\n     *   console.log(key);\n     * });\n     * // => logs 'length', '1', and '0' assuming `_.forOwn` logs '0', '1', and 'length'\n     */\n    function forOwnRight(object, callback, thisArg) {\n      var props = keys(object),\n          length = props.length;\n\n      callback = baseCreateCallback(callback, thisArg, 3);\n      while (length--) {\n        var key = props[length];\n        if (callback(object[key], key, object) === false) {\n          break;\n        }\n      }\n      return object;\n    }\n\n    /**\n     * Creates a sorted array of property names of all enumerable properties,\n     * own and inherited, of `object` that have function values.\n     *\n     * @static\n     * @memberOf _\n     * @alias methods\n     * @category Objects\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns an array of property names that have function values.\n     * @example\n     *\n     * _.functions(_);\n     * // => ['all', 'any', 'bind', 'bindAll', 'clone', 'compact', 'compose', ...]\n     */\n    function functions(object) {\n      var result = [];\n      forIn(object, function(value, key) {\n        if (isFunction(value)) {\n          result.push(key);\n        }\n      });\n      return result.sort();\n    }\n\n    /**\n     * Checks if the specified property name exists as a direct property of `object`,\n     * instead of an inherited property.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to inspect.\n     * @param {string} key The name of the property to check.\n     * @returns {boolean} Returns `true` if key is a direct property, else `false`.\n     * @example\n     *\n     * _.has({ 'a': 1, 'b': 2, 'c': 3 }, 'b');\n     * // => true\n     */\n    function has(object, key) {\n      return object ? hasOwnProperty.call(object, key) : false;\n    }\n\n    /**\n     * Creates an object composed of the inverted keys and values of the given object.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to invert.\n     * @returns {Object} Returns the created inverted object.\n     * @example\n     *\n     * _.invert({ 'first': 'fred', 'second': 'barney' });\n     * // => { 'fred': 'first', 'barney': 'second' }\n     */\n    function invert(object) {\n      var index = -1,\n          props = keys(object),\n          length = props.length,\n          result = {};\n\n      while (++index < length) {\n        var key = props[index];\n        result[object[key]] = key;\n      }\n      return result;\n    }\n\n    /**\n     * Checks if `value` is a boolean value.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a boolean value, else `false`.\n     * @example\n     *\n     * _.isBoolean(null);\n     * // => false\n     */\n    function isBoolean(value) {\n      return value === true || value === false ||\n        value && typeof value == 'object' && toString.call(value) == boolClass || false;\n    }\n\n    /**\n     * Checks if `value` is a date.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a date, else `false`.\n     * @example\n     *\n     * _.isDate(new Date);\n     * // => true\n     */\n    function isDate(value) {\n      return value && typeof value == 'object' && toString.call(value) == dateClass || false;\n    }\n\n    /**\n     * Checks if `value` is a DOM element.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a DOM element, else `false`.\n     * @example\n     *\n     * _.isElement(document.body);\n     * // => true\n     */\n    function isElement(value) {\n      return value && value.nodeType === 1 || false;\n    }\n\n    /**\n     * Checks if `value` is empty. Arrays, strings, or `arguments` objects with a\n     * length of `0` and objects with no own enumerable properties are considered\n     * \"empty\".\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Array|Object|string} value The value to inspect.\n     * @returns {boolean} Returns `true` if the `value` is empty, else `false`.\n     * @example\n     *\n     * _.isEmpty([1, 2, 3]);\n     * // => false\n     *\n     * _.isEmpty({});\n     * // => true\n     *\n     * _.isEmpty('');\n     * // => true\n     */\n    function isEmpty(value) {\n      var result = true;\n      if (!value) {\n        return result;\n      }\n      var className = toString.call(value),\n          length = value.length;\n\n      if ((className == arrayClass || className == stringClass || className == argsClass ) ||\n          (className == objectClass && typeof length == 'number' && isFunction(value.splice))) {\n        return !length;\n      }\n      forOwn(value, function() {\n        return (result = false);\n      });\n      return result;\n    }\n\n    /**\n     * Performs a deep comparison between two values to determine if they are\n     * equivalent to each other. If a callback is provided it will be executed\n     * to compare values. If the callback returns `undefined` comparisons will\n     * be handled by the method instead. The callback is bound to `thisArg` and\n     * invoked with two arguments; (a, b).\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} a The value to compare.\n     * @param {*} b The other value to compare.\n     * @param {Function} [callback] The function to customize comparing values.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * var object = { 'name': 'fred' };\n     * var copy = { 'name': 'fred' };\n     *\n     * object == copy;\n     * // => false\n     *\n     * _.isEqual(object, copy);\n     * // => true\n     *\n     * var words = ['hello', 'goodbye'];\n     * var otherWords = ['hi', 'goodbye'];\n     *\n     * _.isEqual(words, otherWords, function(a, b) {\n     *   var reGreet = /^(?:hello|hi)$/i,\n     *       aGreet = _.isString(a) && reGreet.test(a),\n     *       bGreet = _.isString(b) && reGreet.test(b);\n     *\n     *   return (aGreet || bGreet) ? (aGreet == bGreet) : undefined;\n     * });\n     * // => true\n     */\n    function isEqual(a, b, callback, thisArg) {\n      return baseIsEqual(a, b, typeof callback == 'function' && baseCreateCallback(callback, thisArg, 2));\n    }\n\n    /**\n     * Checks if `value` is, or can be coerced to, a finite number.\n     *\n     * Note: This is not the same as native `isFinite` which will return true for\n     * booleans and empty strings. See http://es5.github.io/#x15.1.2.5.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is finite, else `false`.\n     * @example\n     *\n     * _.isFinite(-101);\n     * // => true\n     *\n     * _.isFinite('10');\n     * // => true\n     *\n     * _.isFinite(true);\n     * // => false\n     *\n     * _.isFinite('');\n     * // => false\n     *\n     * _.isFinite(Infinity);\n     * // => false\n     */\n    function isFinite(value) {\n      return nativeIsFinite(value) && !nativeIsNaN(parseFloat(value));\n    }\n\n    /**\n     * Checks if `value` is a function.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a function, else `false`.\n     * @example\n     *\n     * _.isFunction(_);\n     * // => true\n     */\n    function isFunction(value) {\n      return typeof value == 'function';\n    }\n\n    /**\n     * Checks if `value` is the language type of Object.\n     * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is an object, else `false`.\n     * @example\n     *\n     * _.isObject({});\n     * // => true\n     *\n     * _.isObject([1, 2, 3]);\n     * // => true\n     *\n     * _.isObject(1);\n     * // => false\n     */\n    function isObject(value) {\n      // check if the value is the ECMAScript language type of Object\n      // http://es5.github.io/#x8\n      // and avoid a V8 bug\n      // http://code.google.com/p/v8/issues/detail?id=2291\n      return !!(value && objectTypes[typeof value]);\n    }\n\n    /**\n     * Checks if `value` is `NaN`.\n     *\n     * Note: This is not the same as native `isNaN` which will return `true` for\n     * `undefined` and other non-numeric values. See http://es5.github.io/#x15.1.2.4.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is `NaN`, else `false`.\n     * @example\n     *\n     * _.isNaN(NaN);\n     * // => true\n     *\n     * _.isNaN(new Number(NaN));\n     * // => true\n     *\n     * isNaN(undefined);\n     * // => true\n     *\n     * _.isNaN(undefined);\n     * // => false\n     */\n    function isNaN(value) {\n      // `NaN` as a primitive is the only value that is not equal to itself\n      // (perform the [[Class]] check first to avoid errors with some host objects in IE)\n      return isNumber(value) && value != +value;\n    }\n\n    /**\n     * Checks if `value` is `null`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is `null`, else `false`.\n     * @example\n     *\n     * _.isNull(null);\n     * // => true\n     *\n     * _.isNull(undefined);\n     * // => false\n     */\n    function isNull(value) {\n      return value === null;\n    }\n\n    /**\n     * Checks if `value` is a number.\n     *\n     * Note: `NaN` is considered a number. See http://es5.github.io/#x8.5.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a number, else `false`.\n     * @example\n     *\n     * _.isNumber(8.4 * 5);\n     * // => true\n     */\n    function isNumber(value) {\n      return typeof value == 'number' ||\n        value && typeof value == 'object' && toString.call(value) == numberClass || false;\n    }\n\n    /**\n     * Checks if `value` is an object created by the `Object` constructor.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n     * @example\n     *\n     * function Shape() {\n     *   this.x = 0;\n     *   this.y = 0;\n     * }\n     *\n     * _.isPlainObject(new Shape);\n     * // => false\n     *\n     * _.isPlainObject([1, 2, 3]);\n     * // => false\n     *\n     * _.isPlainObject({ 'x': 0, 'y': 0 });\n     * // => true\n     */\n    var isPlainObject = !getPrototypeOf ? shimIsPlainObject : function(value) {\n      if (!(value && toString.call(value) == objectClass)) {\n        return false;\n      }\n      var valueOf = value.valueOf,\n          objProto = isNative(valueOf) && (objProto = getPrototypeOf(valueOf)) && getPrototypeOf(objProto);\n\n      return objProto\n        ? (value == objProto || getPrototypeOf(value) == objProto)\n        : shimIsPlainObject(value);\n    };\n\n    /**\n     * Checks if `value` is a regular expression.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a regular expression, else `false`.\n     * @example\n     *\n     * _.isRegExp(/fred/);\n     * // => true\n     */\n    function isRegExp(value) {\n      return value && typeof value == 'object' && toString.call(value) == regexpClass || false;\n    }\n\n    /**\n     * Checks if `value` is a string.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a string, else `false`.\n     * @example\n     *\n     * _.isString('fred');\n     * // => true\n     */\n    function isString(value) {\n      return typeof value == 'string' ||\n        value && typeof value == 'object' && toString.call(value) == stringClass || false;\n    }\n\n    /**\n     * Checks if `value` is `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is `undefined`, else `false`.\n     * @example\n     *\n     * _.isUndefined(void 0);\n     * // => true\n     */\n    function isUndefined(value) {\n      return typeof value == 'undefined';\n    }\n\n    /**\n     * Creates an object with the same keys as `object` and values generated by\n     * running each own enumerable property of `object` through the callback.\n     * The callback is bound to `thisArg` and invoked with three arguments;\n     * (value, key, object).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a new object with values of the results of each `callback` execution.\n     * @example\n     *\n     * _.mapValues({ 'a': 1, 'b': 2, 'c': 3} , function(num) { return num * 3; });\n     * // => { 'a': 3, 'b': 6, 'c': 9 }\n     *\n     * var characters = {\n     *   'fred': { 'name': 'fred', 'age': 40 },\n     *   'pebbles': { 'name': 'pebbles', 'age': 1 }\n     * };\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.mapValues(characters, 'age');\n     * // => { 'fred': 40, 'pebbles': 1 }\n     */\n    function mapValues(object, callback, thisArg) {\n      var result = {};\n      callback = lodash.createCallback(callback, thisArg, 3);\n\n      forOwn(object, function(value, key, object) {\n        result[key] = callback(value, key, object);\n      });\n      return result;\n    }\n\n    /**\n     * Recursively merges own enumerable properties of the source object(s), that\n     * don't resolve to `undefined` into the destination object. Subsequent sources\n     * will overwrite property assignments of previous sources. If a callback is\n     * provided it will be executed to produce the merged values of the destination\n     * and source properties. If the callback returns `undefined` merging will\n     * be handled by the method instead. The callback is bound to `thisArg` and\n     * invoked with two arguments; (objectValue, sourceValue).\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The destination object.\n     * @param {...Object} [source] The source objects.\n     * @param {Function} [callback] The function to customize merging properties.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns the destination object.\n     * @example\n     *\n     * var names = {\n     *   'characters': [\n     *     { 'name': 'barney' },\n     *     { 'name': 'fred' }\n     *   ]\n     * };\n     *\n     * var ages = {\n     *   'characters': [\n     *     { 'age': 36 },\n     *     { 'age': 40 }\n     *   ]\n     * };\n     *\n     * _.merge(names, ages);\n     * // => { 'characters': [{ 'name': 'barney', 'age': 36 }, { 'name': 'fred', 'age': 40 }] }\n     *\n     * var food = {\n     *   'fruits': ['apple'],\n     *   'vegetables': ['beet']\n     * };\n     *\n     * var otherFood = {\n     *   'fruits': ['banana'],\n     *   'vegetables': ['carrot']\n     * };\n     *\n     * _.merge(food, otherFood, function(a, b) {\n     *   return _.isArray(a) ? a.concat(b) : undefined;\n     * });\n     * // => { 'fruits': ['apple', 'banana'], 'vegetables': ['beet', 'carrot] }\n     */\n    function merge(object) {\n      var args = arguments,\n          length = 2;\n\n      if (!isObject(object)) {\n        return object;\n      }\n      // allows working with `_.reduce` and `_.reduceRight` without using\n      // their `index` and `collection` arguments\n      if (typeof args[2] != 'number') {\n        length = args.length;\n      }\n      if (length > 3 && typeof args[length - 2] == 'function') {\n        var callback = baseCreateCallback(args[--length - 1], args[length--], 2);\n      } else if (length > 2 && typeof args[length - 1] == 'function') {\n        callback = args[--length];\n      }\n      var sources = slice(arguments, 1, length),\n          index = -1,\n          stackA = getArray(),\n          stackB = getArray();\n\n      while (++index < length) {\n        baseMerge(object, sources[index], callback, stackA, stackB);\n      }\n      releaseArray(stackA);\n      releaseArray(stackB);\n      return object;\n    }\n\n    /**\n     * Creates a shallow clone of `object` excluding the specified properties.\n     * Property names may be specified as individual arguments or as arrays of\n     * property names. If a callback is provided it will be executed for each\n     * property of `object` omitting the properties the callback returns truey\n     * for. The callback is bound to `thisArg` and invoked with three arguments;\n     * (value, key, object).\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The source object.\n     * @param {Function|...string|string[]} [callback] The properties to omit or the\n     *  function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns an object without the omitted properties.\n     * @example\n     *\n     * _.omit({ 'name': 'fred', 'age': 40 }, 'age');\n     * // => { 'name': 'fred' }\n     *\n     * _.omit({ 'name': 'fred', 'age': 40 }, function(value) {\n     *   return typeof value == 'number';\n     * });\n     * // => { 'name': 'fred' }\n     */\n    function omit(object, callback, thisArg) {\n      var result = {};\n      if (typeof callback != 'function') {\n        var props = [];\n        forIn(object, function(value, key) {\n          props.push(key);\n        });\n        props = baseDifference(props, baseFlatten(arguments, true, false, 1));\n\n        var index = -1,\n            length = props.length;\n\n        while (++index < length) {\n          var key = props[index];\n          result[key] = object[key];\n        }\n      } else {\n        callback = lodash.createCallback(callback, thisArg, 3);\n        forIn(object, function(value, key, object) {\n          if (!callback(value, key, object)) {\n            result[key] = value;\n          }\n        });\n      }\n      return result;\n    }\n\n    /**\n     * Creates a two dimensional array of an object's key-value pairs,\n     * i.e. `[[key1, value1], [key2, value2]]`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns new array of key-value pairs.\n     * @example\n     *\n     * _.pairs({ 'barney': 36, 'fred': 40 });\n     * // => [['barney', 36], ['fred', 40]] (property order is not guaranteed across environments)\n     */\n    function pairs(object) {\n      var index = -1,\n          props = keys(object),\n          length = props.length,\n          result = Array(length);\n\n      while (++index < length) {\n        var key = props[index];\n        result[index] = [key, object[key]];\n      }\n      return result;\n    }\n\n    /**\n     * Creates a shallow clone of `object` composed of the specified properties.\n     * Property names may be specified as individual arguments or as arrays of\n     * property names. If a callback is provided it will be executed for each\n     * property of `object` picking the properties the callback returns truey\n     * for. The callback is bound to `thisArg` and invoked with three arguments;\n     * (value, key, object).\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The source object.\n     * @param {Function|...string|string[]} [callback] The function called per\n     *  iteration or property names to pick, specified as individual property\n     *  names or arrays of property names.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns an object composed of the picked properties.\n     * @example\n     *\n     * _.pick({ 'name': 'fred', '_userid': 'fred1' }, 'name');\n     * // => { 'name': 'fred' }\n     *\n     * _.pick({ 'name': 'fred', '_userid': 'fred1' }, function(value, key) {\n     *   return key.charAt(0) != '_';\n     * });\n     * // => { 'name': 'fred' }\n     */\n    function pick(object, callback, thisArg) {\n      var result = {};\n      if (typeof callback != 'function') {\n        var index = -1,\n            props = baseFlatten(arguments, true, false, 1),\n            length = isObject(object) ? props.length : 0;\n\n        while (++index < length) {\n          var key = props[index];\n          if (key in object) {\n            result[key] = object[key];\n          }\n        }\n      } else {\n        callback = lodash.createCallback(callback, thisArg, 3);\n        forIn(object, function(value, key, object) {\n          if (callback(value, key, object)) {\n            result[key] = value;\n          }\n        });\n      }\n      return result;\n    }\n\n    /**\n     * An alternative to `_.reduce` this method transforms `object` to a new\n     * `accumulator` object which is the result of running each of its own\n     * enumerable properties through a callback, with each callback execution\n     * potentially mutating the `accumulator` object. The callback is bound to\n     * `thisArg` and invoked with four arguments; (accumulator, value, key, object).\n     * Callbacks may exit iteration early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Array|Object} object The object to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [accumulator] The custom accumulator value.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the accumulated value.\n     * @example\n     *\n     * var squares = _.transform([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], function(result, num) {\n     *   num *= num;\n     *   if (num % 2) {\n     *     return result.push(num) < 3;\n     *   }\n     * });\n     * // => [1, 9, 25]\n     *\n     * var mapped = _.transform({ 'a': 1, 'b': 2, 'c': 3 }, function(result, num, key) {\n     *   result[key] = num * 3;\n     * });\n     * // => { 'a': 3, 'b': 6, 'c': 9 }\n     */\n    function transform(object, callback, accumulator, thisArg) {\n      var isArr = isArray(object);\n      if (accumulator == null) {\n        if (isArr) {\n          accumulator = [];\n        } else {\n          var ctor = object && object.constructor,\n              proto = ctor && ctor.prototype;\n\n          accumulator = baseCreate(proto);\n        }\n      }\n      if (callback) {\n        callback = lodash.createCallback(callback, thisArg, 4);\n        (isArr ? forEach : forOwn)(object, function(value, index, object) {\n          return callback(accumulator, value, index, object);\n        });\n      }\n      return accumulator;\n    }\n\n    /**\n     * Creates an array composed of the own enumerable property values of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns an array of property values.\n     * @example\n     *\n     * _.values({ 'one': 1, 'two': 2, 'three': 3 });\n     * // => [1, 2, 3] (property order is not guaranteed across environments)\n     */\n    function values(object) {\n      var index = -1,\n          props = keys(object),\n          length = props.length,\n          result = Array(length);\n\n      while (++index < length) {\n        result[index] = object[props[index]];\n      }\n      return result;\n    }\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Creates an array of elements from the specified indexes, or keys, of the\n     * `collection`. Indexes may be specified as individual arguments or as arrays\n     * of indexes.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {...(number|number[]|string|string[])} [index] The indexes of `collection`\n     *   to retrieve, specified as individual indexes or arrays of indexes.\n     * @returns {Array} Returns a new array of elements corresponding to the\n     *  provided indexes.\n     * @example\n     *\n     * _.at(['a', 'b', 'c', 'd', 'e'], [0, 2, 4]);\n     * // => ['a', 'c', 'e']\n     *\n     * _.at(['fred', 'barney', 'pebbles'], 0, 2);\n     * // => ['fred', 'pebbles']\n     */\n    function at(collection) {\n      var args = arguments,\n          index = -1,\n          props = baseFlatten(args, true, false, 1),\n          length = (args[2] && args[2][args[1]] === collection) ? 1 : props.length,\n          result = Array(length);\n\n      while(++index < length) {\n        result[index] = collection[props[index]];\n      }\n      return result;\n    }\n\n    /**\n     * Checks if a given value is present in a collection using strict equality\n     * for comparisons, i.e. `===`. If `fromIndex` is negative, it is used as the\n     * offset from the end of the collection.\n     *\n     * @static\n     * @memberOf _\n     * @alias include\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {*} target The value to check for.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {boolean} Returns `true` if the `target` element is found, else `false`.\n     * @example\n     *\n     * _.contains([1, 2, 3], 1);\n     * // => true\n     *\n     * _.contains([1, 2, 3], 1, 2);\n     * // => false\n     *\n     * _.contains({ 'name': 'fred', 'age': 40 }, 'fred');\n     * // => true\n     *\n     * _.contains('pebbles', 'eb');\n     * // => true\n     */\n    function contains(collection, target, fromIndex) {\n      var index = -1,\n          indexOf = getIndexOf(),\n          length = collection ? collection.length : 0,\n          result = false;\n\n      fromIndex = (fromIndex < 0 ? nativeMax(0, length + fromIndex) : fromIndex) || 0;\n      if (isArray(collection)) {\n        result = indexOf(collection, target, fromIndex) > -1;\n      } else if (typeof length == 'number') {\n        result = (isString(collection) ? collection.indexOf(target, fromIndex) : indexOf(collection, target, fromIndex)) > -1;\n      } else {\n        forOwn(collection, function(value) {\n          if (++index >= fromIndex) {\n            return !(result = value === target);\n          }\n        });\n      }\n      return result;\n    }\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` through the callback. The corresponding value\n     * of each key is the number of times the key was returned by the callback.\n     * The callback is bound to `thisArg` and invoked with three arguments;\n     * (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * _.countBy([4.3, 6.1, 6.4], function(num) { return Math.floor(num); });\n     * // => { '4': 1, '6': 2 }\n     *\n     * _.countBy([4.3, 6.1, 6.4], function(num) { return this.floor(num); }, Math);\n     * // => { '4': 1, '6': 2 }\n     *\n     * _.countBy(['one', 'two', 'three'], 'length');\n     * // => { '3': 2, '5': 1 }\n     */\n    var countBy = createAggregator(function(result, value, key) {\n      (hasOwnProperty.call(result, key) ? result[key]++ : result[key] = 1);\n    });\n\n    /**\n     * Checks if the given callback returns truey value for **all** elements of\n     * a collection. The callback is bound to `thisArg` and invoked with three\n     * arguments; (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias all\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {boolean} Returns `true` if all elements passed the callback check,\n     *  else `false`.\n     * @example\n     *\n     * _.every([true, 1, null, 'yes']);\n     * // => false\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.every(characters, 'age');\n     * // => true\n     *\n     * // using \"_.where\" callback shorthand\n     * _.every(characters, { 'age': 36 });\n     * // => false\n     */\n    function every(collection, callback, thisArg) {\n      var result = true;\n      callback = lodash.createCallback(callback, thisArg, 3);\n\n      var index = -1,\n          length = collection ? collection.length : 0;\n\n      if (typeof length == 'number') {\n        while (++index < length) {\n          if (!(result = !!callback(collection[index], index, collection))) {\n            break;\n          }\n        }\n      } else {\n        forOwn(collection, function(value, index, collection) {\n          return (result = !!callback(value, index, collection));\n        });\n      }\n      return result;\n    }\n\n    /**\n     * Iterates over elements of a collection, returning an array of all elements\n     * the callback returns truey for. The callback is bound to `thisArg` and\n     * invoked with three arguments; (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias select\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a new array of elements that passed the callback check.\n     * @example\n     *\n     * var evens = _.filter([1, 2, 3, 4, 5, 6], function(num) { return num % 2 == 0; });\n     * // => [2, 4, 6]\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36, 'blocked': false },\n     *   { 'name': 'fred',   'age': 40, 'blocked': true }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.filter(characters, 'blocked');\n     * // => [{ 'name': 'fred', 'age': 40, 'blocked': true }]\n     *\n     * // using \"_.where\" callback shorthand\n     * _.filter(characters, { 'age': 36 });\n     * // => [{ 'name': 'barney', 'age': 36, 'blocked': false }]\n     */\n    function filter(collection, callback, thisArg) {\n      var result = [];\n      callback = lodash.createCallback(callback, thisArg, 3);\n\n      var index = -1,\n          length = collection ? collection.length : 0;\n\n      if (typeof length == 'number') {\n        while (++index < length) {\n          var value = collection[index];\n          if (callback(value, index, collection)) {\n            result.push(value);\n          }\n        }\n      } else {\n        forOwn(collection, function(value, index, collection) {\n          if (callback(value, index, collection)) {\n            result.push(value);\n          }\n        });\n      }\n      return result;\n    }\n\n    /**\n     * Iterates over elements of a collection, returning the first element that\n     * the callback returns truey for. The callback is bound to `thisArg` and\n     * invoked with three arguments; (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias detect, findWhere\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the found element, else `undefined`.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'age': 36, 'blocked': false },\n     *   { 'name': 'fred',    'age': 40, 'blocked': true },\n     *   { 'name': 'pebbles', 'age': 1,  'blocked': false }\n     * ];\n     *\n     * _.find(characters, function(chr) {\n     *   return chr.age < 40;\n     * });\n     * // => { 'name': 'barney', 'age': 36, 'blocked': false }\n     *\n     * // using \"_.where\" callback shorthand\n     * _.find(characters, { 'age': 1 });\n     * // =>  { 'name': 'pebbles', 'age': 1, 'blocked': false }\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.find(characters, 'blocked');\n     * // => { 'name': 'fred', 'age': 40, 'blocked': true }\n     */\n    function find(collection, callback, thisArg) {\n      callback = lodash.createCallback(callback, thisArg, 3);\n\n      var index = -1,\n          length = collection ? collection.length : 0;\n\n      if (typeof length == 'number') {\n        while (++index < length) {\n          var value = collection[index];\n          if (callback(value, index, collection)) {\n            return value;\n          }\n        }\n      } else {\n        var result;\n        forOwn(collection, function(value, index, collection) {\n          if (callback(value, index, collection)) {\n            result = value;\n            return false;\n          }\n        });\n        return result;\n      }\n    }\n\n    /**\n     * This method is like `_.find` except that it iterates over elements\n     * of a `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the found element, else `undefined`.\n     * @example\n     *\n     * _.findLast([1, 2, 3, 4], function(num) {\n     *   return num % 2 == 1;\n     * });\n     * // => 3\n     */\n    function findLast(collection, callback, thisArg) {\n      var result;\n      callback = lodash.createCallback(callback, thisArg, 3);\n      forEachRight(collection, function(value, index, collection) {\n        if (callback(value, index, collection)) {\n          result = value;\n          return false;\n        }\n      });\n      return result;\n    }\n\n    /**\n     * Iterates over elements of a collection, executing the callback for each\n     * element. The callback is bound to `thisArg` and invoked with three arguments;\n     * (value, index|key, collection). Callbacks may exit iteration early by\n     * explicitly returning `false`.\n     *\n     * Note: As with other \"Collections\" methods, objects with a `length` property\n     * are iterated like arrays. To avoid this behavior `_.forIn` or `_.forOwn`\n     * may be used for object iteration.\n     *\n     * @static\n     * @memberOf _\n     * @alias each\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array|Object|string} Returns `collection`.\n     * @example\n     *\n     * _([1, 2, 3]).forEach(function(num) { console.log(num); }).join(',');\n     * // => logs each number and returns '1,2,3'\n     *\n     * _.forEach({ 'one': 1, 'two': 2, 'three': 3 }, function(num) { console.log(num); });\n     * // => logs each number and returns the object (property order is not guaranteed across environments)\n     */\n    function forEach(collection, callback, thisArg) {\n      var index = -1,\n          length = collection ? collection.length : 0;\n\n      callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);\n      if (typeof length == 'number') {\n        while (++index < length) {\n          if (callback(collection[index], index, collection) === false) {\n            break;\n          }\n        }\n      } else {\n        forOwn(collection, callback);\n      }\n      return collection;\n    }\n\n    /**\n     * This method is like `_.forEach` except that it iterates over elements\n     * of a `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @alias eachRight\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array|Object|string} Returns `collection`.\n     * @example\n     *\n     * _([1, 2, 3]).forEachRight(function(num) { console.log(num); }).join(',');\n     * // => logs each number from right to left and returns '3,2,1'\n     */\n    function forEachRight(collection, callback, thisArg) {\n      var length = collection ? collection.length : 0;\n      callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);\n      if (typeof length == 'number') {\n        while (length--) {\n          if (callback(collection[length], length, collection) === false) {\n            break;\n          }\n        }\n      } else {\n        var props = keys(collection);\n        length = props.length;\n        forOwn(collection, function(value, key, collection) {\n          key = props ? props[--length] : --length;\n          return callback(collection[key], key, collection);\n        });\n      }\n      return collection;\n    }\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of a collection through the callback. The corresponding value\n     * of each key is an array of the elements responsible for generating the key.\n     * The callback is bound to `thisArg` and invoked with three arguments;\n     * (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * _.groupBy([4.2, 6.1, 6.4], function(num) { return Math.floor(num); });\n     * // => { '4': [4.2], '6': [6.1, 6.4] }\n     *\n     * _.groupBy([4.2, 6.1, 6.4], function(num) { return this.floor(num); }, Math);\n     * // => { '4': [4.2], '6': [6.1, 6.4] }\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.groupBy(['one', 'two', 'three'], 'length');\n     * // => { '3': ['one', 'two'], '5': ['three'] }\n     */\n    var groupBy = createAggregator(function(result, value, key) {\n      (hasOwnProperty.call(result, key) ? result[key] : result[key] = []).push(value);\n    });\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of the collection through the given callback. The corresponding\n     * value of each key is the last element responsible for generating the key.\n     * The callback is bound to `thisArg` and invoked with three arguments;\n     * (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * var keys = [\n     *   { 'dir': 'left', 'code': 97 },\n     *   { 'dir': 'right', 'code': 100 }\n     * ];\n     *\n     * _.indexBy(keys, 'dir');\n     * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }\n     *\n     * _.indexBy(keys, function(key) { return String.fromCharCode(key.code); });\n     * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }\n     *\n     * _.indexBy(characters, function(key) { this.fromCharCode(key.code); }, String);\n     * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }\n     */\n    var indexBy = createAggregator(function(result, value, key) {\n      result[key] = value;\n    });\n\n    /**\n     * Invokes the method named by `methodName` on each element in the `collection`\n     * returning an array of the results of each invoked method. Additional arguments\n     * will be provided to each invoked method. If `methodName` is a function it\n     * will be invoked for, and `this` bound to, each element in the `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|string} methodName The name of the method to invoke or\n     *  the function invoked per iteration.\n     * @param {...*} [arg] Arguments to invoke the method with.\n     * @returns {Array} Returns a new array of the results of each invoked method.\n     * @example\n     *\n     * _.invoke([[5, 1, 7], [3, 2, 1]], 'sort');\n     * // => [[1, 5, 7], [1, 2, 3]]\n     *\n     * _.invoke([123, 456], String.prototype.split, '');\n     * // => [['1', '2', '3'], ['4', '5', '6']]\n     */\n    function invoke(collection, methodName) {\n      var args = slice(arguments, 2),\n          index = -1,\n          isFunc = typeof methodName == 'function',\n          length = collection ? collection.length : 0,\n          result = Array(typeof length == 'number' ? length : 0);\n\n      forEach(collection, function(value) {\n        result[++index] = (isFunc ? methodName : value[methodName]).apply(value, args);\n      });\n      return result;\n    }\n\n    /**\n     * Creates an array of values by running each element in the collection\n     * through the callback. The callback is bound to `thisArg` and invoked with\n     * three arguments; (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias collect\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a new array of the results of each `callback` execution.\n     * @example\n     *\n     * _.map([1, 2, 3], function(num) { return num * 3; });\n     * // => [3, 6, 9]\n     *\n     * _.map({ 'one': 1, 'two': 2, 'three': 3 }, function(num) { return num * 3; });\n     * // => [3, 6, 9] (property order is not guaranteed across environments)\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.map(characters, 'name');\n     * // => ['barney', 'fred']\n     */\n    function map(collection, callback, thisArg) {\n      var index = -1,\n          length = collection ? collection.length : 0;\n\n      callback = lodash.createCallback(callback, thisArg, 3);\n      if (typeof length == 'number') {\n        var result = Array(length);\n        while (++index < length) {\n          result[index] = callback(collection[index], index, collection);\n        }\n      } else {\n        result = [];\n        forOwn(collection, function(value, key, collection) {\n          result[++index] = callback(value, key, collection);\n        });\n      }\n      return result;\n    }\n\n    /**\n     * Retrieves the maximum value of a collection. If the collection is empty or\n     * falsey `-Infinity` is returned. If a callback is provided it will be executed\n     * for each value in the collection to generate the criterion by which the value\n     * is ranked. The callback is bound to `thisArg` and invoked with three\n     * arguments; (value, index, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the maximum value.\n     * @example\n     *\n     * _.max([4, 2, 8, 6]);\n     * // => 8\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * _.max(characters, function(chr) { return chr.age; });\n     * // => { 'name': 'fred', 'age': 40 };\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.max(characters, 'age');\n     * // => { 'name': 'fred', 'age': 40 };\n     */\n    function max(collection, callback, thisArg) {\n      var computed = -Infinity,\n          result = computed;\n\n      // allows working with functions like `_.map` without using\n      // their `index` argument as a callback\n      if (typeof callback != 'function' && thisArg && thisArg[callback] === collection) {\n        callback = null;\n      }\n      if (callback == null && isArray(collection)) {\n        var index = -1,\n            length = collection.length;\n\n        while (++index < length) {\n          var value = collection[index];\n          if (value > result) {\n            result = value;\n          }\n        }\n      } else {\n        callback = (callback == null && isString(collection))\n          ? charAtCallback\n          : lodash.createCallback(callback, thisArg, 3);\n\n        forEach(collection, function(value, index, collection) {\n          var current = callback(value, index, collection);\n          if (current > computed) {\n            computed = current;\n            result = value;\n          }\n        });\n      }\n      return result;\n    }\n\n    /**\n     * Retrieves the minimum value of a collection. If the collection is empty or\n     * falsey `Infinity` is returned. If a callback is provided it will be executed\n     * for each value in the collection to generate the criterion by which the value\n     * is ranked. The callback is bound to `thisArg` and invoked with three\n     * arguments; (value, index, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the minimum value.\n     * @example\n     *\n     * _.min([4, 2, 8, 6]);\n     * // => 2\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * _.min(characters, function(chr) { return chr.age; });\n     * // => { 'name': 'barney', 'age': 36 };\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.min(characters, 'age');\n     * // => { 'name': 'barney', 'age': 36 };\n     */\n    function min(collection, callback, thisArg) {\n      var computed = Infinity,\n          result = computed;\n\n      // allows working with functions like `_.map` without using\n      // their `index` argument as a callback\n      if (typeof callback != 'function' && thisArg && thisArg[callback] === collection) {\n        callback = null;\n      }\n      if (callback == null && isArray(collection)) {\n        var index = -1,\n            length = collection.length;\n\n        while (++index < length) {\n          var value = collection[index];\n          if (value < result) {\n            result = value;\n          }\n        }\n      } else {\n        callback = (callback == null && isString(collection))\n          ? charAtCallback\n          : lodash.createCallback(callback, thisArg, 3);\n\n        forEach(collection, function(value, index, collection) {\n          var current = callback(value, index, collection);\n          if (current < computed) {\n            computed = current;\n            result = value;\n          }\n        });\n      }\n      return result;\n    }\n\n    /**\n     * Retrieves the value of a specified property from all elements in the collection.\n     *\n     * @static\n     * @memberOf _\n     * @type Function\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {string} property The name of the property to pluck.\n     * @returns {Array} Returns a new array of property values.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * _.pluck(characters, 'name');\n     * // => ['barney', 'fred']\n     */\n    var pluck = map;\n\n    /**\n     * Reduces a collection to a value which is the accumulated result of running\n     * each element in the collection through the callback, where each successive\n     * callback execution consumes the return value of the previous execution. If\n     * `accumulator` is not provided the first element of the collection will be\n     * used as the initial `accumulator` value. The callback is bound to `thisArg`\n     * and invoked with four arguments; (accumulator, value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @alias foldl, inject\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [accumulator] Initial value of the accumulator.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the accumulated value.\n     * @example\n     *\n     * var sum = _.reduce([1, 2, 3], function(sum, num) {\n     *   return sum + num;\n     * });\n     * // => 6\n     *\n     * var mapped = _.reduce({ 'a': 1, 'b': 2, 'c': 3 }, function(result, num, key) {\n     *   result[key] = num * 3;\n     *   return result;\n     * }, {});\n     * // => { 'a': 3, 'b': 6, 'c': 9 }\n     */\n    function reduce(collection, callback, accumulator, thisArg) {\n      if (!collection) return accumulator;\n      var noaccum = arguments.length < 3;\n      callback = lodash.createCallback(callback, thisArg, 4);\n\n      var index = -1,\n          length = collection.length;\n\n      if (typeof length == 'number') {\n        if (noaccum) {\n          accumulator = collection[++index];\n        }\n        while (++index < length) {\n          accumulator = callback(accumulator, collection[index], index, collection);\n        }\n      } else {\n        forOwn(collection, function(value, index, collection) {\n          accumulator = noaccum\n            ? (noaccum = false, value)\n            : callback(accumulator, value, index, collection)\n        });\n      }\n      return accumulator;\n    }\n\n    /**\n     * This method is like `_.reduce` except that it iterates over elements\n     * of a `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @alias foldr\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [accumulator] Initial value of the accumulator.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the accumulated value.\n     * @example\n     *\n     * var list = [[0, 1], [2, 3], [4, 5]];\n     * var flat = _.reduceRight(list, function(a, b) { return a.concat(b); }, []);\n     * // => [4, 5, 2, 3, 0, 1]\n     */\n    function reduceRight(collection, callback, accumulator, thisArg) {\n      var noaccum = arguments.length < 3;\n      callback = lodash.createCallback(callback, thisArg, 4);\n      forEachRight(collection, function(value, index, collection) {\n        accumulator = noaccum\n          ? (noaccum = false, value)\n          : callback(accumulator, value, index, collection);\n      });\n      return accumulator;\n    }\n\n    /**\n     * The opposite of `_.filter` this method returns the elements of a\n     * collection that the callback does **not** return truey for.\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a new array of elements that failed the callback check.\n     * @example\n     *\n     * var odds = _.reject([1, 2, 3, 4, 5, 6], function(num) { return num % 2 == 0; });\n     * // => [1, 3, 5]\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36, 'blocked': false },\n     *   { 'name': 'fred',   'age': 40, 'blocked': true }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.reject(characters, 'blocked');\n     * // => [{ 'name': 'barney', 'age': 36, 'blocked': false }]\n     *\n     * // using \"_.where\" callback shorthand\n     * _.reject(characters, { 'age': 36 });\n     * // => [{ 'name': 'fred', 'age': 40, 'blocked': true }]\n     */\n    function reject(collection, callback, thisArg) {\n      callback = lodash.createCallback(callback, thisArg, 3);\n      return filter(collection, function(value, index, collection) {\n        return !callback(value, index, collection);\n      });\n    }\n\n    /**\n     * Retrieves a random element or `n` random elements from a collection.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to sample.\n     * @param {number} [n] The number of elements to sample.\n     * @param- {Object} [guard] Allows working with functions like `_.map`\n     *  without using their `index` arguments as `n`.\n     * @returns {Array} Returns the random sample(s) of `collection`.\n     * @example\n     *\n     * _.sample([1, 2, 3, 4]);\n     * // => 2\n     *\n     * _.sample([1, 2, 3, 4], 2);\n     * // => [3, 1]\n     */\n    function sample(collecti,on, n, guard) {\n      if (collection && typeof collection.length != 'number') {\n        collection = values(collection);\n      }\n      if (n == null || guard) {\n        return collection ? collection[baseRandom(0, collection.length - 1)] : undefined;\n      }\n      var result = shuffle(collection);\n      result.length = nativeMin(nativeMax(0, n), result.length);\n      return result;\n    }\n\n    /**\n     * Creates an array of shuffled values, using a version of the Fisher-Yates\n     * shuffle. See http://en.wikipedia.org/wiki/Fisher-Yates_shuffle.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to shuffle.\n     * @returns {Array} Returns a new shuffled collection.\n     * @example\n     *\n     * _.shuffle([1, 2, 3, 4, 5, 6]);\n     * // => [4, 1, 6, 3, 5, 2]\n     */\n    function shuffle(collection) {\n      var index = -1,\n          length = collection ? collection.length : 0,\n          result = Array(typeof length == 'number' ? length : 0);\n\n      forEach(collection, function(value) {\n        var rand = baseRandom(0, ++index);\n        result[index] = result[rand];\n        result[rand] = value;\n      });\n      return result;\n    }\n\n    /**\n     * Gets the size of the `collection` by returning `collection.length` for arrays\n     * and array-like objects or the number of own enumerable properties for objects.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to inspect.\n     * @returns {number} Returns `collection.length` or number of own enumerable properties.\n     * @example\n     *\n     * _.size([1, 2]);\n     * // => 2\n     *\n     * _.size({ 'one': 1, 'two': 2, 'three': 3 });\n     * // => 3\n     *\n     * _.size('pebbles');\n     * // => 7\n     */\n    function size(collection) {\n      var length = collection ? collection.length : 0;\n      return typeof length == 'number' ? length : keys(collection).length;\n    }\n\n    /**\n     * Checks if the callback returns a truey value for **any** element of a\n     * collection. The function returns as soon as it finds a passing value and\n     * does not iterate over the entire collection. The callback is bound to\n     * `thisArg` and invoked with three arguments; (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias any\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {boolean} Returns `true` if any element passed the callback check,\n     *  else `false`.\n     * @example\n     *\n     * _.some([null, 0, 'yes', false], Boolean);\n     * // => true\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36, 'blocked': false },\n     *   { 'name': 'fred',   'age': 40, 'blocked': true }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.some(characters, 'blocked');\n     * // => true\n     *\n     * // using \"_.where\" callback shorthand\n     * _.some(characters, { 'age': 1 });\n     * // => false\n     */\n    function some(collection, callback, thisArg) {\n      var result;\n      callback = lodash.createCallback(callback, thisArg, 3);\n\n      var index = -1,\n          length = collection ? collection.length : 0;\n\n      if (typeof length == 'number') {\n        while (++index < length) {\n          if ((result = callback(collection[index], index, collection))) {\n            break;\n          }\n        }\n      } else {\n        forOwn(collection, function(value, index, collection) {\n          return !(result = callback(value, index, collection));\n        });\n      }\n      return !!result;\n    }\n\n    /**\n     * Creates an array of elements, sorted in ascending order by the results of\n     * running each element in a collection through the callback. This method\n     * performs a stable sort, that is, it will preserve the original sort order\n     * of equal elements. The callback is bound to `thisArg` and invoked with\n     * three arguments; (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an array of property names is provided for `callback` the collection\n     * will be sorted by each property value.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Array|Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a new array of sorted elements.\n     * @example\n     *\n     * _.sortBy([1, 2, 3], function(num) { return Math.sin(num); });\n     * // => [3, 1, 2]\n     *\n     * _.sortBy([1, 2, 3], function(num) { return this.sin(num); }, Math);\n     * // => [3, 1, 2]\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'age': 36 },\n     *   { 'name': 'fred',    'age': 40 },\n     *   { 'name': 'barney',  'age': 26 },\n     *   { 'name': 'fred',    'age': 30 }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.map(_.sortBy(characters, 'age'), _.values);\n     * // => [['barney', 26], ['fred', 30], ['barney', 36], ['fred', 40]]\n     *\n     * // sorting by multiple properties\n     * _.map(_.sortBy(characters, ['name', 'age']), _.values);\n     * // = > [['barney', 26], ['barney', 36], ['fred', 30], ['fred', 40]]\n     */\n    function sortBy(collection, callback, thisArg) {\n      var index = -1,\n          isArr = isArray(callback),\n          length = collection ? collection.length : 0,\n          result = Array(typeof length == 'number' ? length : 0);\n\n      if (!isArr) {\n        callback = lodash.createCallback(callback, thisArg, 3);\n      }\n      forEach(collection, function(value, key, collection) {\n        var object = result[++index] = getObject();\n        if (isArr) {\n          object.criteria = map(callback, function(key) { return value[key]; });\n        } else {\n          (object.criteria = getArray())[0] = callback(value, key, collection);\n        }\n        object.index = index;\n        object.value = value;\n      });\n\n      length = result.length;\n      result.sort(compareAscending);\n      while (length--) {\n        var object = result[length];\n        result[length] = object.value;\n        if (!isArr) {\n          releaseArray(object.criteria);\n        }\n        releaseObject(object);\n      }\n      return result;\n    }\n\n    /**\n     * Converts the `collection` to an array.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to convert.\n     * @returns {Array} Returns the new converted array.\n     * @example\n     *\n     * (function() { return _.toArray(arguments).slice(1); })(1, 2, 3, 4);\n     * // => [2, 3, 4]\n     */\n    function toArray(collection) {\n      if (collection && typeof collection.length == 'number') {\n        return slice(collection);\n      }\n      return values(collection);\n    }\n\n    /**\n     * Performs a deep comparison of each element in a `collection` to the given\n     * `properties` object, returning an array of all elements that have equivalent\n     * property values.\n     *\n     * @static\n     * @memberOf _\n     * @type Function\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Object} props The object of property values to filter by.\n     * @returns {Array} Returns a new array of elements that have the given properties.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36, 'pets': ['hoppy'] },\n     *   { 'name': 'fred',   'age': 40, 'pets': ['baby puss', 'dino'] }\n     * ];\n     *\n     * _.where(characters, { 'age': 36 });\n     * // => [{ 'name': 'barney', 'age': 36, 'pets': ['hoppy'] }]\n     *\n     * _.where(characters, { 'pets': ['dino'] });\n     * // => [{ 'name': 'fred', 'age': 40, 'pets': ['baby puss', 'dino'] }]\n     */\n    var where = filter;\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Creates an array with all falsey values removed. The values `false`, `null`,\n     * `0`, `\"\"`, `undefined`, and `NaN` are all falsey.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to compact.\n     * @returns {Array} Returns a new array of filtered values.\n     * @example\n     *\n     * _.compact([0, 1, false, 2, '', 3]);\n     * // => [1, 2, 3]\n     */\n    function compact(array) {\n      var index = -1,\n          length = array ? array.length : 0,\n          result = [];\n\n      while (++index < length) {\n        var value = array[index];\n        if (value) {\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Creates an array excluding all values of the provided arrays using strict\n     * equality for comparisons, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to process.\n     * @param {...Array} [values] The arrays of values to exclude.\n     * @returns {Array} Returns a new array of filtered values.\n     * @example\n     *\n     * _.difference([1, 2, 3, 4, 5], [5, 2, 10]);\n     * // => [1, 3, 4]\n     */\n    function difference(array) {\n      return baseDifference(array, baseFlatten(arguments, true, true, 1));\n    }\n\n    /**\n     * This method is like `_.find` except that it returns the index of the first\n     * element that passes the callback check, instead of the element itself.\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to search.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {number} Returns the index of the found element, else `-1`.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'age': 36, 'blocked': false },\n     *   { 'name': 'fred',    'age': 40, 'blocked': true },\n     *   { 'name': 'pebbles', 'age': 1,  'blocked': false }\n     * ];\n     *\n     * _.findIndex(characters, function(chr) {\n     *   return chr.age < 20;\n     * });\n     * // => 2\n     *\n     * // using \"_.where\" callback shorthand\n     * _.findIndex(characters, { 'age': 36 });\n     * // => 0\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.findIndex(characters, 'blocked');\n     * // => 1\n     */\n    function findIndex(array, callback, thisArg) {\n      var index = -1,\n          length = array ? array.length : 0;\n\n      callback = lodash.createCallback(callback, thisArg, 3);\n      while (++index < length) {\n        if (callback(array[index], index, array)) {\n          return index;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * This method is like `_.findIndex` except that it iterates over elements\n     * of a `collection` from right to left.\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to search.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {number} Returns the index of the found element, else `-1`.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'age': 36, 'blocked': true },\n     *   { 'name': 'fred',    'age': 40, 'blocked': false },\n     *   { 'name': 'pebbles', 'age': 1,  'blocked': true }\n     * ];\n     *\n     * _.findLastIndex(characters, function(chr) {\n     *   return chr.age > 30;\n     * });\n     * // => 1\n     *\n     * // using \"_.where\" callback shorthand\n     * _.findLastIndex(characters, { 'age': 36 });\n     * // => 0\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.findLastIndex(characters, 'blocked');\n     * // => 2\n     */\n    function findLastIndex(array, callback, thisArg) {\n      var length = array ? array.length : 0;\n      callback = lodash.createCallback(callback, thisArg, 3);\n      while (length--) {\n        if (callback(array[length], length, array)) {\n          return length;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * Gets the first element or first `n` elements of an array. If a callback\n     * is provided elements at the beginning of the array are returned as long\n     * as the callback returns truey. The callback is bound to `thisArg` and\n     * invoked with three arguments; (value, index, array).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias head, take\n     * @category Arrays\n     * @param {Array} array The array to query.\n     * @param {Function|Object|number|string} [callback] The function called\n     *  per element or the number of elements to return. If a property name or\n     *  object is provided it will be used to create a \"_.pluck\" or \"_.where\"\n     *  style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the first element(s) of `array`.\n     * @example\n     *\n     * _.first([1, 2, 3]);\n     * // => 1\n     *\n     * _.first([1, 2, 3], 2);\n     * // => [1, 2]\n     *\n     * _.first([1, 2, 3], function(num) {\n     *   return num < 3;\n     * });\n     * // => [1, 2]\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'blocked': true,  'employer': 'slate' },\n     *   { 'name': 'fred',    'blocked': false, 'employer': 'slate' },\n     *   { 'name': 'pebbles', 'blocked': true,  'employer': 'na' }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.first(characters, 'blocked');\n     * // => [{ 'name': 'barney', 'blocked': true, 'employer': 'slate' }]\n     *\n     * // using \"_.where\" callback shorthand\n     * _.pluck(_.first(characters, { 'employer': 'slate' }), 'name');\n     * // => ['barney', 'fred']\n     */\n    function first(array, callback, thisArg) {\n      var n = 0,\n          length = array ? array.length : 0;\n\n      if (typeof callback != 'number' && callback != null) {\n        var index = -1;\n        callback = lodash.createCallback(callback, thisArg, 3);\n        while (++index < length && callback(array[index], index, array)) {\n          n++;\n        }\n      } else {\n        n = callback;\n        if (n == null || thisArg) {\n          return array ? array[0] : undefined;\n        }\n      }\n      return slice(array, 0, nativeMin(nativeMax(0, n), length));\n    }\n\n    /**\n     * Flattens a nested array (the nesting can be to any depth). If `isShallow`\n     * is truey, the array will only be flattened a single level. If a callback\n     * is provided each element of the array is passed through the callback before\n     * flattening. The callback is bound to `thisArg` and invoked with three\n     * arguments; (value, index, array).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to flatten.\n     * @param {boolean} [isShallow=false] A flag to restrict flattening to a single level.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a new flattened array.\n     * @example\n     *\n     * _.flatten([1, [2], [3, [[4]]]]);\n     * // => [1, 2, 3, 4];\n     *\n     * _.flatten([1, [2], [3, [[4]]]], true);\n     * // => [1, 2, 3, [[4]]];\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 30, 'pets': ['hoppy'] },\n     *   { 'name': 'fred',   'age': 40, 'pets': ['baby puss', 'dino'] }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.flatten(characters, 'pets');\n     * // => ['hoppy', 'baby puss', 'dino']\n     */\n    function flatten(array, isShallow, callback, thisArg) {\n      // juggle arguments\n      if (typeof isShallow != 'boolean' && isShallow != null) {\n        thisArg = callback;\n        callback = (typeof isShallow != 'function' && thisArg && thisArg[isShallow] === array) ? null : isShallow;\n        isShallow = false;\n      }\n      if (callback != null) {\n        array = map(array, callback, thisArg);\n      }\n      return baseFlatten(array, isShallow);\n    }\n\n    /**\n     * Gets the index at which the first occurrence of `value` is found using\n     * strict equality for comparisons, i.e. `===`. If the array is already sorted\n     * providing `true` for `fromIndex` will run a faster binary search.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to search.\n     * @param {*} value The value to search for.\n     * @param {boolean|number} [fromIndex=0] The index to search from or `true`\n     *  to perform a binary search on a sorted array.\n     * @returns {number} Returns the index of the matched value or `-1`.\n     * @example\n     *\n     * _.indexOf([1, 2, 3, 1, 2, 3], 2);\n     * // => 1\n     *\n     * _.indexOf([1, 2, 3, 1, 2, 3], 2, 3);\n     * // => 4\n     *\n     * _.indexOf([1, 1, 2, 2, 3, 3], 2, true);\n     * // => 2\n     */\n    function indexOf(array, value, fromIndex) {\n      if (typeof fromIndex == 'number') {\n        var length = array ? array.length : 0;\n        fromIndex = (fromIndex < 0 ? nativeMax(0, length + fromIndex) : fromIndex || 0);\n      } else if (fromIndex) {\n        var index = sortedIndex(array, value);\n        return array[index] === value ? index : -1;\n      }\n      return baseIndexOf(array, value, fromIndex);\n    }\n\n    /**\n     * Gets all but the last element or last `n` elements of an array. If a\n     * callback is provided elements at the end of the array are excluded from\n     * the result as long as the callback returns truey. The callback is bound\n     * to `thisArg` and invoked with three arguments; (value, index, array).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to query.\n     * @param {Function|Object|number|string} [callback=1] The function called\n     *  per element or the number of elements to exclude. If a property name or\n     *  object is provided it will be used to create a \"_.pluck\" or \"_.where\"\n     *  style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a slice of `array`.\n     * @example\n     *\n     * _.initial([1, 2, 3]);\n     * // => [1, 2]\n     *\n     * _.initial([1, 2, 3], 2);\n     * // => [1]\n     *\n     * _.initial([1, 2, 3], function(num) {\n     *   return num > 1;\n     * });\n     * // => [1]\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'blocked': false, 'employer': 'slate' },\n     *   { 'name': 'fred',    'blocked': true,  'employer': 'slate' },\n     *   { 'name': 'pebbles', 'blocked': true,  'employer': 'na' }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.initial(characters, 'blocked');\n     * // => [{ 'name': 'barney',  'blocked': false, 'employer': 'slate' }]\n     *\n     * // using \"_.where\" callback shorthand\n     * _.pluck(_.initial(characters, { 'employer': 'na' }), 'name');\n     * // => ['barney', 'fred']\n     */\n    function initial(array, callback, thisArg) {\n      var n = 0,\n          length = array ? array.length : 0;\n\n      if (typeof callback != 'number' && callback != null) {\n        var index = length;\n        callback = lodash.createCallback(callback, thisArg, 3);\n        while (index-- && callback(array[index], index, array)) {\n          n++;\n        }\n      } else {\n        n = (callback == null || thisArg) ? 1 : callback || n;\n      }\n      return slice(array, 0, nativeMin(nativeMax(0, length - n), length));\n    }\n\n    /**\n     * Creates an array of unique values present in all provided arrays using\n     * strict equality for comparisons, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {...Array} [array] The arrays to inspect.\n     * @returns {Array} Returns an array of shared values.\n     * @example\n     *\n     * _.intersection([1, 2, 3], [5, 2, 1, 4], [2, 1]);\n     * // => [1, 2]\n     */\n    function intersection() {\n      var args = [],\n          argsIndex = -1,\n          argsLength = arguments.length,\n          caches = getArray(),\n          indexOf = getIndexOf(),\n          trustIndexOf = indexOf === baseIndexOf,\n          seen = getArray();\n\n      while (++argsIndex < argsLength) {\n        var value = arguments[argsIndex];\n        if (isArray(value) || isArguments(value)) {\n          args.push(value);\n          caches.push(trustIndexOf && value.length >= largeArraySize &&\n            createCache(argsIndex ? args[argsIndex] : seen));\n        }\n      }\n      var array = args[0],\n          index = -1,\n          length = array ? array.length : 0,\n          result = [];\n\n      outer:\n      while (++index < length) {\n        var cache = caches[0];\n        value = array[index];\n\n        if ((cache ? cacheIndexOf(cache, value) : indexOf(seen, value)) < 0) {\n          argsIndex = argsLength;\n          (cache || seen).push(value);\n          while (--argsIndex) {\n            cache = caches[argsIndex];\n            if ((cache ? cacheIndexOf(cache, value) : indexOf(args[argsIndex], value)) < 0) {\n              continue outer;\n            }\n          }\n          result.push(value);\n        }\n      }\n      while (argsLength--) {\n        cache = caches[argsLength];\n        if (cache) {\n          releaseObject(cache);\n        }\n      }\n      releaseArray(caches);\n      releaseArray(seen);\n      return result;\n    }\n\n    /**\n     * Gets the last element or last `n` elements of an array. If a callback is\n     * provided elements at the end of the array are returned as long as the\n     * callback returns truey. The callback is bound to `thisArg` and invoked\n     * with three arguments; (value, index, array).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to query.\n     * @param {Function|Object|number|string} [callback] The function called\n     *  per element or the number of elements to return. If a property name or\n     *  object is provided it will be used to create a \"_.pluck\" or \"_.where\"\n     *  style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the last element(s) of `array`.\n     * @example\n     *\n     * _.last([1, 2, 3]);\n     * // => 3\n     *\n     * _.last([1, 2, 3], 2);\n     * // => [2, 3]\n     *\n     * _.last([1, 2, 3], function(num) {\n     *   return num > 1;\n     * });\n     * // => [2, 3]\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'blocked': false, 'employer': 'slate' },\n     *   { 'name': 'fred',    'blocked': true,  'employer': 'slate' },\n     *   { 'name': 'pebbles', 'blocked': true,  'employer': 'na' }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.pluck(_.last(characters, 'blocked'), 'name');\n     * // => ['fred', 'pebbles']\n     *\n     * // using \"_.where\" callback shorthand\n     * _.last(characters, { 'employer': 'na' });\n     * // => [{ 'name': 'pebbles', 'blocked': true, 'employer': 'na' }]\n     */\n    function last(array, callback, thisArg) {\n      var n = 0,\n          length = array ? array.length : 0;\n\n      if (typeof callback != 'number' && callback != null) {\n        var index = length;\n        callback = lodash.createCallback(callback, thisArg, 3);\n        while (index-- && callback(array[index], index, array)) {\n          n++;\n        }\n      } else {\n        n = callback;\n        if (n == null || thisArg) {\n          return array ? array[length - 1] : undefined;\n        }\n      }\n      return slice(array, nativeMax(0, length - n));\n    }\n\n    /**\n     * Gets the index at which the last occurrence of `value` is found using strict\n     * equality for comparisons, i.e. `===`. If `fromIndex` is negative, it is used\n     * as the offset from the end of the collection.\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to search.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=array.length-1] The index to search from.\n     * @returns {number} Returns the index of the matched value or `-1`.\n     * @example\n     *\n     * _.lastIndexOf([1, 2, 3, 1, 2, 3], 2);\n     * // => 4\n     *\n     * _.lastIndexOf([1, 2, 3, 1, 2, 3], 2, 3);\n     * // => 1\n     */\n    function lastIndexOf(array, value, fromIndex) {\n      var index = array ? array.length : 0;\n      if (typeof fromIndex == 'number') {\n        index = (fromIndex < 0 ? nativeMax(0, index + fromIndex) : nativeMin(fromIndex, index - 1)) + 1;\n      }\n      while (index--) {\n        if (array[index] === value) {\n          return index;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * Removes all provided values from the given array using strict equality for\n     * comparisons, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to modify.\n     * @param {...*} [value] The values to remove.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [1, 2, 3, 1, 2, 3];\n     * _.pull(array, 2, 3);\n     * console.log(array);\n     * // => [1, 1]\n     */\n    function pull(array) {\n      var args = arguments,\n          argsIndex = 0,\n          argsLength = args.length,\n          length = array ? array.length : 0;\n\n      while (++argsIndex < argsLength) {\n        var index = -1,\n            value = args[argsIndex];\n        while (++index < length) {\n          if (array[index] === value) {\n            splice.call(array, index--, 1);\n            length--;\n          }\n        }\n      }\n      return array;\n    }\n\n    /**\n     * Creates an array of numbers (positive and/or negative) progressing from\n     * `start` up to but not including `end`. If `start` is less than `stop` a\n     * zero-length range is created unless a negative `step` is specified.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} [step=1] The value to increment or decrement by.\n     * @returns {Array} Returns a new range array.\n     * @example\n     *\n     * _.range(4);\n     * // => [0, 1, 2, 3]\n     *\n     * _.range(1, 5);\n     * // => [1, 2, 3, 4]\n     *\n     * _.range(0, 20, 5);\n     * // => [0, 5, 10, 15]\n     *\n     * _.range(0, -4, -1);\n     * // => [0, -1, -2, -3]\n     *\n     * _.range(1, 4, 0);\n     * // => [1, 1, 1]\n     *\n     * _.range(0);\n     * // => []\n     */\n    function range(start, end, step) {\n      start = +start || 0;\n      step = typeof step == 'number' ? step : (+step || 1);\n\n      if (end == null) {\n        end = start;\n        start = 0;\n      }\n      // use `Array(length)` so engines like Chakra and V8 avoid slower modes\n      // http://youtu.be/XAqIpGU8ZZk#t=17m25s\n      var index = -1,\n          length = nativeMax(0, ceil((end - start) / (step || 1))),\n          result = Array(length);\n\n      while (++index < length) {\n        result[index] = start;\n        start += step;\n      }\n      return result;\n    }\n\n    /**\n     * Removes all elements from an array that the callback returns truey for\n     * and returns an array of removed elements. The callback is bound to `thisArg`\n     * and invoked with three arguments; (value, index, array).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to modify.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a new array of removed elements.\n     * @example\n     *\n     * var array = [1, 2, 3, 4, 5, 6];\n     * var evens = _.remove(array, function(num) { return num % 2 == 0; });\n     *\n     * console.log(array);\n     * // => [1, 3, 5]\n     *\n     * console.log(evens);\n     * // => [2, 4, 6]\n     */\n    function remove(array, callback, thisArg) {\n      var index = -1,\n          length = array ? array.length : 0,\n          result = [];\n\n      callback = lodash.createCallback(callback, thisArg, 3);\n      while (++index < length) {\n        var value = array[index];\n        if (callback(value, index, array)) {\n          result.push(value);\n          splice.call(array, index--, 1);\n          length--;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The opposite of `_.initial` this method gets all but the first element or\n     * first `n` elements of an array. If a callback function is provided elements\n     * at the beginning of the array are excluded from the result as long as the\n     * callback returns truey. The callback is bound to `thisArg` and invoked\n     * with three arguments; (value, index, array).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias drop, tail\n     * @category Arrays\n     * @param {Array} array The array to query.\n     * @param {Function|Object|number|string} [callback=1] The function called\n     *  per element or the number of elements to exclude. If a property name or\n     *  object is provided it will be used to create a \"_.pluck\" or \"_.where\"\n     *  style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a slice of `array`.\n     * @example\n     *\n     * _.rest([1, 2, 3]);\n     * // => [2, 3]\n     *\n     * _.rest([1, 2, 3], 2);\n     * // => [3]\n     *\n     * _.rest([1, 2, 3], function(num) {\n     *   return num < 3;\n     * });\n     * // => [3]\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'blocked': true,  'employer': 'slate' },\n     *   { 'name': 'fred',    'blocked': false,  'employer': 'slate' },\n     *   { 'name': 'pebbles', 'blocked': true, 'employer': 'na' }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.pluck(_.rest(characters, 'blocked'), 'name');\n     * // => ['fred', 'pebbles']\n     *\n     * // using \"_.where\" callback shorthand\n     * _.rest(characters, { 'employer': 'slate' });\n     * // => [{ 'name': 'pebbles', 'blocked': true, 'employer': 'na' }]\n     */\n    function rest(array, callback, thisArg) {\n      if (typeof callback != 'number' && callback != null) {\n        var n = 0,\n            index = -1,\n            length = array ? array.length : 0;\n\n        callback = lodash.createCallback(callback, thisArg, 3);\n        while (++index < length && callback(array[index], index, array)) {\n          n++;\n        }\n      } else {\n        n = (callback == null || thisArg) ? 1 : nativeMax(0, callback);\n      }\n      return slice(array, n);\n    }\n\n    /**\n     * Uses a binary search to determine the smallest index at which a value\n     * should be inserted into a given sorted array in order to maintain the sort\n     * order of the array. If a callback is provided it will be executed for\n     * `value` and each element of `array` to compute their sort ranking. The\n     * callback is bound to `thisArg` and invoked with one argument; (value).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * _.sortedIndex([20, 30, 50], 40);\n     * // => 2\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.sortedIndex([{ 'x': 20 }, { 'x': 30 }, { 'x': 50 }], { 'x': 40 }, 'x');\n     * // => 2\n     *\n     * var dict = {\n     *   'wordToNumber': { 'twenty': 20, 'thirty': 30, 'fourty': 40, 'fifty': 50 }\n     * };\n     *\n     * _.sortedIndex(['twenty', 'thirty', 'fifty'], 'fourty', function(word) {\n     *   return dict.wordToNumber[word];\n     * });\n     * // => 2\n     *\n     * _.sortedIndex(['twenty', 'thirty', 'fifty'], 'fourty', function(word) {\n     *   return this.wordToNumber[word];\n     * }, dict);\n     * // => 2\n     */\n    function sortedIndex(array, value, callback, thisArg) {\n      var low = 0,\n          high = array ? array.length : low;\n\n      // explicitly reference `identity` for better inlining in Firefox\n      callback = callback ? lodash.createCallback(callback, thisArg, 1) : identity;\n      value = callback(value);\n\n      while (low < high) {\n        var mid = (low + high) >>> 1;\n        (callback(array[mid]) < value)\n          ? low = mid + 1\n          : high = mid;\n      }\n      return low;\n    }\n\n    /**\n     * Creates an array of unique values, in order, of the provided arrays using\n     * strict equality for comparisons, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {...Array} [array] The arrays to inspect.\n     * @returns {Array} Returns an array of combined values.\n     * @example\n     *\n     * _.union([1, 2, 3], [5, 2, 1, 4], [2, 1]);\n     * // => [1, 2, 3, 5, 4]\n     */\n    function union() {\n      return baseUniq(baseFlatten(arguments, true, true));\n    }\n\n    /**\n     * Creates a duplicate-value-free version of an array using strict equality\n     * for comparisons, i.e. `===`. If the array is sorted, providing\n     * `true` for `isSorted` will use a faster algorithm. If a callback is provided\n     * each element of `array` is passed through the callback before uniqueness\n     * is computed. The callback is bound to `thisArg` and invoked with three\n     * arguments; (value, index, array).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias unique\n     * @category Arrays\n     * @param {Array} array The array to process.\n     * @param {boolean} [isSorted=false] A flag to indicate that `array` is sorted.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a duplicate-value-free array.\n     * @example\n     *\n     * _.uniq([1, 2, 1, 3, 1]);\n     * // => [1, 2, 3]\n     *\n     * _.uniq([1, 1, 2, 2, 3], true);\n     * // => [1, 2, 3]\n     *\n     * _.uniq(['A', 'b', 'C', 'a', 'B', 'c'], function(letter) { return letter.toLowerCase(); });\n     * // => ['A', 'b', 'C']\n     *\n     * _.uniq([1, 2.5, 3, 1.5, 2, 3.5], function(num) { return this.floor(num); }, Math);\n     * // => [1, 2.5, 3]\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.uniq([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }, { 'x': 2 }]\n     */\n    function uniq(array, isSorted, callback, thisArg) {\n      // juggle arguments\n      if (typeof isSorted != 'boolean' && isSorted != null) {\n        thisArg = callback;\n        callback = (typeof isSorted != 'function' && thisArg && thisArg[isSorted] === array) ? null : isSorted;\n        isSorted = false;\n      }\n      if (callback != null) {\n        callback = lodash.createCallback(callback, thisArg, 3);\n      }\n      return baseUniq(array, isSorted, callback);\n    }\n\n    /**\n     * Creates an array excluding all provided values using strict equality for\n     * comparisons, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to filter.\n     * @param {...*} [value] The values to exclude.\n     * @returns {Array} Returns a new array of filtered values.\n     * @example\n     *\n     * _.without([1, 2, 1, 0, 3, 1, 4], 0, 1);\n     * // => [2, 3, 4]\n     */\n    function without(array) {\n      return baseDifference(array, slice(arguments, 1));\n    }\n\n    /**\n     * Creates an array that is the symmetric difference of the provided arrays.\n     * See http://en.wikipedia.org/wiki/Symmetric_difference.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {...Array} [array] The arrays to inspect.\n     * @returns {Array} Returns an array of values.\n     * @example\n     *\n     * _.xor([1, 2, 3], [5, 2, 1, 4]);\n     * // => [3, 5, 4]\n     *\n     * _.xor([1, 2, 5], [2, 3, 5], [3, 4, 5]);\n     * // => [1, 4, 5]\n     */\n    function xor() {\n      var index = -1,\n          length = arguments.length;\n\n      while (++index < length) {\n        var array = arguments[index];\n        if (isArray(array) || isArguments(array)) {\n          var result = result\n            ? baseUniq(baseDifference(result, array).concat(baseDifference(array, result)))\n            : array;\n        }\n      }\n      return result || [];\n    }\n\n    /**\n     * Creates an array of grouped elements, the first of which contains the first\n     * elements of the given arrays, the second of which contains the second\n     * elements of the given arrays, and so on.\n     *\n     * @static\n     * @memberOf _\n     * @alias unzip\n     * @category Arrays\n     * @param {...Array} [array] Arrays to process.\n     * @returns {Array} Returns a new array of grouped elements.\n     * @example\n     *\n     * _.zip(['fred', 'barney'], [30, 40], [true, false]);\n     * // => [['fred', 30, true], ['barney', 40, false]]\n     */\n    function zip() {\n      var array = arguments.length > 1 ? arguments : arguments[0],\n          index = -1,\n          length = array ? max(pluck(array, 'length')) : 0,\n          result = Array(length < 0 ? 0 : length);\n\n      while (++index < length) {\n        result[index] = pluck(array, index);\n      }\n      return result;\n    }\n\n    /**\n     * Creates an object composed from arrays of `keys` and `values`. Provide\n     * either a single two dimensional array, i.e. `[[key1, value1], [key2, value2]]`\n     * or two arrays, one of `keys` and one of corresponding `values`.\n     *\n     * @static\n     * @memberOf _\n     * @alias object\n     * @category Arrays\n     * @param {Array} keys The array of keys.\n     * @param {Array} [values=[]] The array of values.\n     * @returns {Object} Returns an object composed of the given keys and\n     *  corresponding values.\n     * @example\n     *\n     * _.zipObject(['fred', 'barney'], [30, 40]);\n     * // => { 'fred': 30, 'barney': 40 }\n     */\n    function zipObject(keys, values) {\n      var index = -1,\n          length = keys ? keys.length : 0,\n          result = {};\n\n      if (!values && length && !isArray(keys[0])) {\n        values = [];\n      }\n      while (++index < length) {\n        var key = keys[index];\n        if (values) {\n          result[key] = values[index];\n        } else if (key) {\n          result[key[0]] = key[1];\n        }\n      }\n      return result;\n    }\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Creates a function that executes `func`, with  the `this` binding and\n     * arguments of the created function, only after being called `n` times.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {number} n The number of times the function must be called before\n     *  `func` is executed.\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * var saves = ['profile', 'settings'];\n     *\n     * var done = _.after(saves.length, function() {\n     *   console.log('Done saving!');\n     * });\n     *\n     * _.forEach(saves, function(type) {\n     *   asyncSave({ 'type': type, 'complete': done });\n     * });\n     * // => logs 'Done saving!', after all saves have completed\n     */\n    function after(n, func) {\n      if (!isFunction(func)) {\n        throw new TypeError;\n      }\n      return function() {\n        if (--n < 1) {\n          return func.apply(this, arguments);\n        }\n      };\n    }\n\n    /**\n     * Creates a function that, when called, invokes `func` with the `this`\n     * binding of `thisArg` and prepends any additional `bind` arguments to those\n     * provided to the bound function.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to bind.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {...*} [arg] Arguments to be partially applied.\n     * @returns {Function} Returns the new bound function.\n     * @example\n     *\n     * var func = function(greeting) {\n     *   return greeting + ' ' + this.name;\n     * };\n     *\n     * func = _.bind(func, { 'name': 'fred' }, 'hi');\n     * func();\n     * // => 'hi fred'\n     */\n    function bind(func, thisArg) {\n      return arguments.length > 2\n        ? createWrapper(func, 17, slice(arguments, 2), null, thisArg)\n        : createWrapper(func, 1, null, null, thisArg);\n    }\n\n    /**\n     * Binds methods of an object to the object itself, overwriting the existing\n     * method. Method names may be specified as individual arguments or as arrays\n     * of method names. If no method names are provided all the function properties\n     * of `object` will be bound.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Object} object The object to bind and assign the bound methods to.\n     * @param {...string} [methodName] The object method names to\n     *  bind, specified as individual method names or arrays of method names.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var view = {\n     *   'label': 'docs',\n     *   'onClick': function() { console.log('clicked ' + this.label); }\n     * };\n     *\n     * _.bindAll(view);\n     * jQuery('#docs').on('click', view.onClick);\n     * // => logs 'clicked docs', when the button is clicked\n     */\n    function bindAll(object) {\n      var funcs = arguments.length > 1 ? baseFlatten(arguments, true, false, 1) : functions(object),\n          index = -1,\n          length = funcs.length;\n\n      while (++index < length) {\n        var key = funcs[index];\n        object[key] = createWrapper(object[key], 1, null, null, object);\n      }\n      return object;\n    }\n\n    /**\n     * Creates a function that, when called, invokes the method at `object[key]`\n     * and prepends any additional `bindKey` arguments to those provided to the bound\n     * function. This method differs from `_.bind` by allowing bound functions to\n     * reference methods that will be redefined or don't yet exist.\n     * See http://michaux.ca/articles/lazy-function-definition-pattern.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Object} object The object the method belongs to.\n     * @param {string} key The key of the method.\n     * @param {...*} [arg] Arguments to be partially applied.\n     * @returns {Function} Returns the new bound function.\n     * @example\n     *\n     * var object = {\n     *   'name': 'fred',\n     *   'greet': function(greeting) {\n     *     return greeting + ' ' + this.name;\n     *   }\n     * };\n     *\n     * var func = _.bindKey(object, 'greet', 'hi');\n     * func();\n     * // => 'hi fred'\n     *\n     * object.greet = function(greeting) {\n     *   return greeting + 'ya ' + this.name + '!';\n     * };\n     *\n     * func();\n     * // => 'hiya fred!'\n     */\n    function bindKey(object, key) {\n      return arguments.length > 2\n        ? createWrapper(key, 19, slice(arguments, 2), null, object)\n        : createWrapper(key, 3, null, null, object);\n    }\n\n    /**\n     * Creates a function that is the composition of the provided functions,\n     * where each function consumes the return value of the function that follows.\n     * For example, composing the functions `f()`, `g()`, and `h()` produces `f(g(h()))`.\n     * Each function is executed with the `this` binding of the composed function.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {...Function} [func] Functions to compose.\n     * @returns {Function} Returns the new composed function.\n     * @example\n     *\n     * var realNameMap = {\n     *   'pebbles': 'penelope'\n     * };\n     *\n     * var format = function(name) {\n     *   name = realNameMap[name.toLowerCase()] || name;\n     *   return name.charAt(0).toUpperCase() + name.slice(1).toLowerCase();\n     * };\n     *\n     * var greet = function(formatted) {\n     *   return 'Hiya ' + formatted + '!';\n     * };\n     *\n     * var welcome = _.compose(greet, format);\n     * welcome('pebbles');\n     * // => 'Hiya Penelope!'\n     */\n    function compose() {\n      var funcs = arguments,\n          length = funcs.length;\n\n      while (length--) {\n        if (!isFunction(funcs[length])) {\n          throw new TypeError;\n        }\n      }\n      return function() {\n        var args = arguments,\n            length = funcs.length;\n\n        while (length--) {\n          args = [funcs[length].apply(this, args)];\n        }\n        return args[0];\n      };\n    }\n\n    /**\n     * Creates a function which accepts one or more arguments of `func` that when\n     * invoked either executes `func` returning its result, if all `func` arguments\n     * have been provided, or returns a function that accepts one or more of the\n     * remaining `func` arguments, and so on. The arity of `func` can be specified\n     * if `func.length` is not sufficient.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to curry.\n     * @param {number} [arity=func.length] The arity of `func`.\n     * @returns {Function} Returns the new curried function.\n     * @example\n     *\n     * var curried = _.curry(function(a, b, c) {\n     *   console.log(a + b + c);\n     * });\n     *\n     * curried(1)(2)(3);\n     * // => 6\n     *\n     * curried(1, 2)(3);\n     * // => 6\n     *\n     * curried(1, 2, 3);\n     * // => 6\n     */\n    function curry(func, arity) {\n      arity = typeof arity == 'number' ? arity : (+arity || func.length);\n      return createWrapper(func, 4, null, null, null, arity);\n    }\n\n    /**\n     * Creates a function that will delay the execution of `func` until after\n     * `wait` milliseconds have elapsed since the last time it was invoked.\n     * Provide an options object to indicate that `func` should be invoked on\n     * the leading and/or trailing edge of the `wait` timeout. Subsequent calls\n     * to the debounced function will return the result of the last `func` call.\n     *\n     * Note: If `leading` and `trailing` options are `true` `func` will be called\n     * on the trailing edge of the timeout only if the the debounced function is\n     * invoked more than once during the `wait` timeout.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to debounce.\n     * @param {number} wait The number of milliseconds to delay.\n     * @param {Object} [options] The options object.\n     * @param {boolean} [options.leading=false] Specify execution on the leading edge of the timeout.\n     * @param {number} [options.maxWait] The maximum time `func` is allowed to be delayed before it's called.\n     * @param {boolean} [options.trailing=true] Specify execution on the trailing edge of the timeout.\n     * @returns {Function} Returns the new debounced function.\n     * @example\n     *\n     * // avoid costly calculations while the window size is in flux\n     * var lazyLayout = _.debounce(calculateLayout, 150);\n     * jQuery(window).on('resize', lazyLayout);\n     *\n     * // execute `sendMail` when the click event is fired, debouncing subsequent calls\n     * jQuery('#postbox').on('click', _.debounce(sendMail, 300, {\n     *   'leading': true,\n     *   'trailing': false\n     * });\n     *\n     * // ensure `batchLog` is executed once after 1 second of debounced calls\n     * var source = new EventSource('/stream');\n     * source.addEventListener('message', _.debounce(batchLog, 250, {\n     *   'maxWait': 1000\n     * }, false);\n     */\n    function debounce(func, wait, options) {\n      var args,\n          maxTimeoutId,\n          result,\n          stamp,\n          thisArg,\n          timeoutId,\n          trailingCall,\n          lastCalled = 0,\n          maxWait = false,\n          trailing = true;\n\n      if (!isFunction(func)) {\n        throw new TypeError;\n      }\n      wait = nativeMax(0, wait) || 0;\n      if (options === true) {\n        var leading = true;\n        trailing = false;\n      } else if (isObject(options)) {\n        leading = options.leading;\n        maxWait = 'maxWait' in options && (nativeMax(wait, options.maxWait) || 0);\n        trailing = 'trailing' in options ? options.trailing : trailing;\n      }\n      var delayed = function() {\n        var remaining = wait - (now() - stamp);\n        if (remaining <= 0) {\n          if (maxTimeoutId) {\n            clearTimeout(maxTimeoutId);\n          }\n          var isCalled = trailingCall;\n          maxTimeoutId = timeoutId = trailingCall = undefined;\n          if (isCalled) {\n            lastCalled = now();\n            result = func.apply(thisArg, args);\n            if (!timeoutId && !maxTimeoutId) {\n              args = thisArg = null;\n            }\n          }\n        } else {\n          timeoutId = setTimeout(delayed, remaining);\n        }\n      };\n\n      var maxDelayed = function() {\n        if (timeoutId) {\n          clearTimeout(timeoutId);\n        }\n        maxTimeoutId = timeoutId = trailingCall = undefined;\n        if (trailing || (maxWait !== wait)) {\n          lastCalled = now();\n          result = func.apply(thisArg, args);\n          if (!timeoutId && !maxTimeoutId) {\n            args = thisArg = null;\n          }\n        }\n      };\n\n      return function() {\n        args = arguments;\n        stamp = now();\n        thisArg = this;\n        trailingCall = trailing && (timeoutId || !leading);\n\n        if (maxWait === false) {\n          var leadingCall = leading && !timeoutId;\n        } else {\n          if (!maxTimeoutId && !leading) {\n            lastCalled = stamp;\n          }\n          var remaining = maxWait - (stamp - lastCalled),\n              isCalled = remaining <= 0;\n\n          if (isCalled) {\n            if (maxTimeoutId) {\n              maxTimeoutId = clearTimeout(maxTimeoutId);\n            }\n            lastCalled = stamp;\n            result = func.apply(thisArg, args);\n          }\n          else if (!maxTimeoutId) {\n            maxTimeoutId = setTimeout(maxDelayed, remaining);\n          }\n        }\n        if (isCalled && timeoutId) {\n          timeoutId = clearTimeout(timeoutId);\n        }\n        else if (!timeoutId && wait !== maxWait) {\n          timeoutId = setTimeout(delayed, wait);\n        }\n        if (leadingCall) {\n          isCalled = true;\n          result = func.apply(thisArg, args);\n        }\n        if (isCalled && !timeoutId && !maxTimeoutId) {\n          args = thisArg = null;\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Defers executing the `func` function until the current call stack has cleared.\n     * Additional arguments will be provided to `func` when it is invoked.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to defer.\n     * @param {...*} [arg] Arguments to invoke the function with.\n     * @returns {number} Returns the timer id.\n     * @example\n     *\n     * _.defer(function(text) { console.log(text); }, 'deferred');\n     * // logs 'deferred' after one or more milliseconds\n     */\n    function defer(func) {\n      if (!isFunction(func)) {\n        throw new TypeError;\n      }\n      var args = slice(arguments, 1);\n      return setTimeout(function() { func.apply(undefined, args); }, 1);\n    }\n\n    /**\n     * Executes the `func` function after `wait` milliseconds. Additional arguments\n     * will be provided to `func` when it is invoked.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay execution.\n     * @param {...*} [arg] Arguments to invoke the function with.\n     * @returns {number} Returns the timer id.\n     * @example\n     *\n     * _.delay(function(text) { console.log(text); }, 1000, 'later');\n     * // => logs 'later' after one second\n     */\n    function delay(func, wait) {\n      if (!isFunction(func)) {\n        throw new TypeError;\n      }\n      var args = slice(arguments, 2);\n      return setTimeout(function() { func.apply(undefined, args); }, wait);\n    }\n\n    /**\n     * Creates a function that memoizes the result of `func`. If `resolver` is\n     * provided it will be used to determine the cache key for storing the result\n     * based on the arguments provided to the memoized function. By default, the\n     * first argument provided to the memoized function is used as the cache key.\n     * The `func` is executed with the `this` binding of the memoized function.\n     * The result cache is exposed as the `cache` property on the memoized function.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to have its output memoized.\n     * @param {Function} [resolver] A function used to resolve the cache key.\n     * @returns {Function} Returns the new memoizing function.\n     * @example\n     *\n     * var fibonacci = _.memoize(function(n) {\n     *   return n < 2 ? n : fibonacci(n - 1) + fibonacci(n - 2);\n     * });\n     *\n     * fibonacci(9)\n     * // => 34\n     *\n     * var data = {\n     *   'fred': { 'name': 'fred', 'age': 40 },\n     *   'pebbles': { 'name': 'pebbles', 'age': 1 }\n     * };\n     *\n     * // modifying the result cache\n     * var get = _.memoize(function(name) { return data[name]; }, _.identity);\n     * get('pebbles');\n     * // => { 'name': 'pebbles', 'age': 1 }\n     *\n     * get.cache.pebbles.name = 'penelope';\n     * get('pebbles');\n     * // => { 'name': 'penelope', 'age': 1 }\n     */\n    function memoize(func, resolver) {\n      if (!isFunction(func)) {\n        throw new TypeError;\n      }\n      var memoized = function() {\n        var cache = memoized.cache,\n            key = resolver ? resolver.apply(this, arguments) : keyPrefix + arguments[0];\n\n        return hasOwnProperty.call(cache, key)\n          ? cache[key]\n          : (cache[key] = func.apply(this, arguments));\n      }\n      memoized.cache = {};\n      return memoized;\n    }\n\n    /**\n     * Creates a function that is restricted to execute `func` once. Repeat calls to\n     * the function will return the value of the first call. The `func` is executed\n     * with the `this` binding of the created function.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * var initialize = _.once(createApplication);\n     * initialize();\n     * initialize();\n     * // `initialize` executes `createApplication` once\n     */\n    function once(func) {\n      var ran,\n          result;\n\n      if (!isFunction(func)) {\n        throw new TypeError;\n      }\n      return function() {\n        if (ran) {\n          return result;\n        }\n        ran = true;\n        result = func.apply(this, arguments);\n\n        // clear the `func` variable so the function may be garbage collected\n        func = null;\n        return result;\n      };\n    }\n\n    /**\n     * Creates a function that, when called, invokes `func` with any additional\n     * `partial` arguments prepended to those provided to the new function. This\n     * method is similar to `_.bind` except it does **not** alter the `this` binding.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to partially apply arguments to.\n     * @param {...*} [arg] Arguments to be partially applied.\n     * @returns {Function} Returns the new partially applied function.\n     * @example\n     *\n     * var greet = function(greeting, name) { return greeting + ' ' + name; };\n     * var hi = _.partial(greet, 'hi');\n     * hi('fred');\n     * // => 'hi fred'\n     */\n    function partial(func) {\n      return createWrapper(func, 16, slice(arguments, 1));\n    }\n\n    /**\n     * This method is like `_.partial` except that `partial` arguments are\n     * appended to those provided to the new function.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to partially apply arguments to.\n     * @param {...*} [arg] Arguments to be partially applied.\n     * @returns {Function} Returns the new partially applied function.\n     * @example\n     *\n     * var defaultsDeep = _.partialRight(_.merge, _.defaults);\n     *\n     * var options = {\n     *   'variable': 'data',\n     *   'imports': { 'jq': $ }\n     * };\n     *\n     * defaultsDeep(options, _.templateSettings);\n     *\n     * options.variable\n     * // => 'data'\n     *\n     * options.imports\n     * // => { '_': _, 'jq': $ }\n     */\n    function partialRight(func) {\n      return createWrapper(func, 32, null, slice(arguments, 1));\n    }\n\n    /**\n     * Creates a function that, when executed, will only call the `func` function\n     * at most once per every `wait` milliseconds. Provide an options object to\n     * indicate that `func` should be invoked on the leading and/or trailing edge\n     * of the `wait` timeout. Subsequent calls to the throttled function will\n     * return the result of the last `func` call.\n     *\n     * Note: If `leading` and `trailing` options are `true` `func` will be called\n     * on the trailing edge of the timeout only if the the throttled function is\n     * invoked more than once during the `wait` timeout.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to throttle.\n     * @param {number} wait The number of milliseconds to throttle executions to.\n     * @param {Object} [options] The options object.\n     * @param {boolean} [options.leading=true] Specify execution on the leading edge of the timeout.\n     * @param {boolean} [options.trailing=true] Specify execution on the trailing edge of the timeout.\n     * @returns {Function} Returns the new throttled function.\n     * @example\n     *\n     * // avoid excessively updating the position while scrolling\n     * var throttled = _.throttle(updatePosition, 100);\n     * jQuery(window).on('scroll', throttled);\n     *\n     * // execute `renewToken` when the click event is fired, but not more than once every 5 minutes\n     * jQuery('.interactive').on('click', _.throttle(renewToken, 300000, {\n     *   'trailing': false\n     * }));\n     */\n    function throttle(func, wait, options) {\n      var leading = true,\n          trailing = true;\n\n      if (!isFunction(func)) {\n        throw new TypeError;\n      }\n      if (options === false) {\n        leading = false;\n      } else if (isObject(options)) {\n        leading = 'leading' in options ? options.leading : leading;\n        trailing = 'trailing' in options ? options.trailing : trailing;\n      }\n      debounceOptions.leading = leading;\n      debounceOptions.maxWait = wait;\n      debounceOptions.trailing = trailing;\n\n      return debounce(func, wait, debounceOptions);\n    }\n\n    /**\n     * Creates a function that provides `value` to the wrapper function as its\n     * first argument. Additional arguments provided to the function are appended\n     * to those provided to the wrapper function. The wrapper is executed with\n     * the `this` binding of the created function.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {*} value The value to wrap.\n     * @param {Function} wrapper The wrapper function.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var p = _.wrap(_.escape, function(func, text) {\n     *   return '<p>' + func(text) + '</p>';\n     * });\n     *\n     * p('Fred, Wilma, & Pebbles');\n     * // => '<p>Fred, Wilma, &amp; Pebbles</p>'\n     */\n    function wrap(value, wrapper) {\n      return createWrapper(wrapper, 16, [value]);\n    }\n\n    /*-----------------------------------------------,---------------------------*/\n\n    /**\n     * Creates a function that returns `value`.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {*} value The value to return from the new function.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var object = { 'name': 'fred' };\n     * var getter = _.constant(object);\n     * getter() === object;\n     * // => true\n     */\n    function constant(value) {\n      return function() {\n        return value;\n      };\n    }\n\n    /**\n     * Produces a callback bound to an optional `thisArg`. If `func` is a property\n     * name the created callback will return the property value for a given element.\n     * If `func` is an object the created callback will return `true` for elements\n     * that contain the equivalent object properties, otherwise it will return `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {*} [func=identity] The value to convert to a callback.\n     * @param {*} [thisArg] The `this` binding of the created callback.\n     * @param {number} [argCount] The number of arguments the callback accepts.\n     * @returns {Function} Returns a callback function.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * // wrap to create custom callback shorthands\n     * _.createCallback = _.wrap(_.createCallback, function(func, callback, thisArg) {\n     *   var match = /^(.+?)__([gl]t)(.+)$/.exec(callback);\n     *   return !match ? func(callback, thisArg) : function(object) {\n     *     return match[2] == 'gt' ? object[match[1]] > match[3] : object[match[1]] < match[3];\n     *   };\n     * });\n     *\n     * _.filter(characters, 'age__gt38');\n     * // => [{ 'name': 'fred', 'age': 40 }]\n     */\n    function createCallback(func, thisArg, argCount) {\n      var type = typeof func;\n      if (func == null || type == 'function') {\n        return baseCreateCallback(func, thisArg, argCount);\n      }\n      // handle \"_.pluck\" style callback shorthands\n      if (type != 'object') {\n        return property(func);\n      }\n      var props = keys(func),\n          key = props[0],\n          a = func[key];\n\n      // handle \"_.where\" style callback shorthands\n      if (props.length == 1 && a === a && !isObject(a)) {\n        // fast path the common case of providing an object with a single\n        // property containing a primitive value\n        return function(object) {\n          var b = object[key];\n          return a === b && (a !== 0 || (1 / a == 1 / b));\n        };\n      }\n      return function(object) {\n        var length = props.length,\n            result = false;\n\n        while (length--) {\n          if (!(result = baseIsEqual(object[props[length]], func[props[length]], null, true))) {\n            break;\n          }\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Converts the characters `&`, `<`, `>`, `\"`, and `'` in `string` to their\n     * corresponding HTML entities.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {string} string The string to escape.\n     * @returns {string} Returns the escaped string.\n     * @example\n     *\n     * _.escape('Fred, Wilma, & Pebbles');\n     * // => 'Fred, Wilma, &amp; Pebbles'\n     */\n    function escape(string) {\n      return string == null ? '' : String(string).replace(reUnescapedHtml, escapeHtmlChar);\n    }\n\n    /**\n     * This method returns the first argument provided to it.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {*} value Any value.\n     * @returns {*} Returns `value`.\n     * @example\n     *\n     * var object = { 'name': 'fred' };\n     * _.identity(object) === object;\n     * // => true\n     */\n    function identity(value) {\n      return value;\n    }\n\n    /**\n     * Adds function properties of a source object to the destination object.\n     * If `object` is a function methods will be added to its prototype as well.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {Function|Object} [object=lodash] object The destination object.\n     * @param {Object} source The object of functions to add.\n     * @param {Object} [options] The options object.\n     * @param {boolean} [options.chain=true] Specify whether the functions added are chainable.\n     * @example\n     *\n     * function capitalize(string) {\n     *   return string.charAt(0).toUpperCase() + string.slice(1).toLowerCase();\n     * }\n     *\n     * _.mixin({ 'capitalize': capitalize });\n     * _.capitalize('fred');\n     * // => 'Fred'\n     *\n     * _('fred').capitalize().value();\n     * // => 'Fred'\n     *\n     * _.mixin({ 'capitalize': capitalize }, { 'chain': false });\n     * _('fred').capitalize();\n     * // => 'Fred'\n     */\n    function mixin(object, source, options) {\n      var chain = true,\n          methodNames = source && functions(source);\n\n      if (!source || (!options && !methodNames.length)) {\n        if (options == null) {\n          options = source;\n        }\n        ctor = lodashWrapper;\n        source = object;\n        object = lodash;\n        methodNames = functions(source);\n      }\n      if (options === false) {\n        chain = false;\n      } else if (isObject(options) && 'chain' in options) {\n        chain = options.chain;\n      }\n      var ctor = object,\n          isFunc = isFunction(ctor);\n\n      forEach(methodNames, function(methodName) {\n        var func = object[methodName] = source[methodName];\n        if (isFunc) {\n          ctor.prototype[methodName] = function() {\n            var chainAll = this.__chain__,\n                value = this.__wrapped__,\n                args = [value];\n\n            push.apply(args, arguments);\n            var result = func.apply(object, args);\n            if (chain || chainAll) {\n              if (value === result && isObject(result)) {\n                return this;\n              }\n              result = new ctor(result);\n              result.__chain__ = chainAll;\n            }\n            return result;\n          };\n        }\n      });\n    }\n\n    /**\n     * Reverts the '_' variable to its previous value and returns a reference to\n     * the `lodash` function.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @returns {Function} Returns the `lodash` function.\n     * @example\n     *\n     * var lodash = _.noConflict();\n     */\n    function noConflict() {\n      context._ = oldDash;\n      return this;\n    }\n\n    /**\n     * A no-operation function.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @example\n     *\n     * var object = { 'name': 'fred' };\n     * _.noop(object) === undefined;\n     * // => true\n     */\n    function noop() {\n      // no operation performed\n    }\n\n    /**\n     * Gets the number of milliseconds that have elapsed since the Unix epoch\n     * (1 January 1970 00:00:00 UTC).\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @example\n     *\n     * var stamp = _.now();\n     * _.defer(function() { console.log(_.now() - stamp); });\n     * // => logs the number of milliseconds it took for the deferred function to be called\n     */\n    var now = isNative(now = Date.now) && now || function() {\n      return new Date().getTime();\n    };\n\n    /**\n     * Converts the given value into an integer of the specified radix.\n     * If `radix` is `undefined` or `0` a `radix` of `10` is used unless the\n     * `value` is a hexadecimal, in which case a `radix` of `16` is used.\n     *\n     * Note: This method avoids differences in native ES3 and ES5 `parseInt`\n     * implementations. See http://es5.github.io/#E.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {string} value The value to parse.\n     * @param {number} [radix] The radix used to interpret the value to parse.\n     * @returns {number} Returns the new integer value.\n     * @example\n     *\n     * _.parseInt('08');\n     * // => 8\n     */\n    var parseInt = nativeParseInt(whitespace + '08') == 8 ? nativeParseInt : function(value, radix) {\n      // Firefox < 21 and Opera < 15 follow the ES3 specified implementation of `parseInt`\n      return nativeParseInt(isString(value) ? value.replace(reLeadingSpacesAndZeros, '') : value, radix || 0);\n    };\n\n    /**\n     * Creates a \"_.pluck\" style function, which returns the `key` value of a\n     * given object.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {string} key The name of the property to retrieve.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'fred',   'age': 40 },\n     *   { 'name': 'barney', 'age': 36 }\n     * ];\n     *\n     * var getName = _.property('name');\n     *\n     * _.map(characters, getName);\n     * // => ['barney', 'fred']\n     *\n     * _.sortBy(characters, getName);\n     * // => [{ 'name': 'barney', 'age': 36 }, { 'name': 'fred',   'age': 40 }]\n     */\n    function property(key) {\n      return function(object) {\n        return object[key];\n      };\n    }\n\n    /**\n     * Produces a random number between `min` and `max` (inclusive). If only one\n     * argument is provided a number between `0` and the given number will be\n     * returned. If `floating` is truey or either `min` or `max` are floats a\n     * floating-point number will be returned instead of an integer.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {number} [min=0] The minimum possible value.\n     * @param {number} [max=1] The maximum possible value.\n     * @param {boolean} [floating=false] Specify returning a floating-point number.\n     * @returns {number} Returns a random number.\n     * @example\n     *\n     * _.random(0, 5);\n     * // => an integer between 0 and 5\n     *\n     * _.random(5);\n     * // => also an integer between 0 and 5\n     *\n     * _.random(5, true);\n     * // => a floating-point number between 0 and 5\n     *\n     * _.random(1.2, 5.2);\n     * // => a floating-point number between 1.2 and 5.2\n     */\n    function random(min, max, floating) {\n      var noMin = min == null,\n          noMax = max == null;\n\n      if (floating == null) {\n        if (typeof min == 'boolean' && noMax) {\n          floating = min;\n          min = 1;\n        }\n        else if (!noMax && typeof max == 'boolean') {\n          floating = max;\n          noMax = true;\n        }\n      }\n      if (noMin && noMax) {\n        max = 1;\n      }\n      min = +min || 0;\n      if (noMax) {\n        max = min;\n        min = 0;\n      } else {\n        max = +max || 0;\n      }\n      if (floating || min % 1 || max % 1) {\n        var rand = nativeRandom();\n        return nativeMin(min + (rand * (max - min + parseFloat('1e-' + ((rand +'').length - 1)))), max);\n      }\n      return baseRandom(min, max);\n    }\n\n    /**\n     * Resolves the value of property `key` on `object`. If `key` is a function\n     * it will be invoked with the `this` binding of `object` and its result returned,\n     * else the property value is returned. If `object` is falsey then `undefined`\n     * is returned.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {Object} object The object to inspect.\n     * @param {string} key The name of the property to resolve.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * var object = {\n     *   'cheese': 'crumpets',\n     *   'stuff': function() {\n     *     return 'nonsense';\n     *   }\n     * };\n     *\n     * _.result(object, 'cheese');\n     * // => 'crumpets'\n     *\n     * _.result(object, 'stuff');\n     * // => 'nonsense'\n     */\n    function result(object, key) {\n      if (object) {\n        var value = object[key];\n        return isFunction(value) ? object[key]() : value;\n      }\n    }\n\n    /**\n     * A micro-templating method that handles arbitrary delimiters, preserves\n     * whitespace, and correctly escapes quotes within interpolated code.\n     *\n     * Note: In the development build, `_.template` utilizes sourceURLs for easier\n     * debugging. See http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl\n     *\n     * For more information on precompiling templates see:\n     * http://lodash.com/custom-builds\n     *\n     * For more information on Chrome extension sandboxes see:\n     * http://developer.chrome.com/stable/extensions/sandboxingEval.html\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {string} text The template text.\n     * @param {Object} data The data object used to populate the text.\n     * @param {Object} [options] The options object.\n     * @param {RegExp} [options.escape] The \"escape\" delimiter.\n     * @param {RegExp} [options.evaluate] The \"evaluate\" delimiter.\n     * @param {Object} [options.imports] An object to import into the template as local variables.\n     * @param {RegExp} [options.interpolate] The \"interpolate\" delimiter.\n     * @param {string} [sourceURL] The sourceURL of the template's compiled source.\n     * @param {string} [variable] The data object variable name.\n     * @returns {Function|string} Returns a compiled function when no `data` object\n     *  is given, else it returns the interpolated text.\n     * @example\n     *\n     * // using the \"interpolate\" delimiter to create a compiled template\n     * var compiled = _.template('hello <%= name %>');\n     * compiled({ 'name': 'fred' });\n     * // => 'hello fred'\n     *\n     * // using the \"escape\" delimiter to escape HTML in data property values\n     * _.template('<b><%- value %></b>', { 'value': '<script>' });\n     * // => '<b>&lt;script&gt;</b>'\n     *\n     * // using the \"evaluate\" delimiter to generate HTML\n     * var list = '<% _.forEach(people, function(name) { %><li><%- name %></li><% }); %>';\n     * _.template(list, { 'people': ['fred', 'barney'] });\n     * // => '<li>fred</li><li>barney</li>'\n     *\n     * // using the ES6 delimiter as an alternative to the default \"interpolate\" delimiter\n     * _.template('hello ${ name }', { 'name': 'pebbles' });\n     * // => 'hello pebbles'\n     *\n     * // using the internal `print` function in \"evaluate\" delimiters\n     * _.template('<% print(\"hello \" + name); %>!', { 'name': 'barney' });\n     * // => 'hello barney!'\n     *\n     * // using a custom template delimiters\n     * _.templateSettings = {\n     *   'interpolate': /{{([\\s\\S]+?)}}/g\n     * };\n     *\n     * _.template('hello {{ name }}!', { 'name': 'mustache' });\n     * // => 'hello mustache!'\n     *\n     * // using the `imports` option to import jQuery\n     * var list = '<% jq.each(people, function(name) { %><li><%- name %></li><% }); %>';\n     * _.template(list, { 'people': ['fred', 'barney'] }, { 'imports': { 'jq': jQuery } });\n     * // => '<li>fred</li><li>barney</li>'\n     *\n     * // using the `sourceURL` option to specify a custom sourceURL for the template\n     * var compiled = _.template('hello <%= name %>', null, { 'sourceURL': '/basic/greeting.jst' });\n     * compiled(data);\n     * // => find the source of \"greeting.jst\" under the Sources tab or Resources panel of the web inspector\n     *\n     * // using the `variable` option to ensure a with-statement isn't used in the compiled template\n     * var compiled = _.template('hi <%= data.name %>!', null, { 'variable': 'data' });\n     * compiled.source;\n     * // => function(data) {\n     *   var __t, __p = '', __e = _.escape;\n     *   __p += 'hi ' + ((__t = ( data.name )) == null ? '' : __t) + '!';\n     *   return __p;\n     * }\n     *\n     * // using the `source` property to inline compiled templates for meaningful\n     * // line numbers in error messages and a stack trace\n     * fs.writeFileSync(path.join(cwd, 'jst.js'), '\\\n     *   var JST = {\\\n     *     \"main\": ' + _.template(mainText).source + '\\\n     *   };\\\n     * ');\n     */\n    function template(text, data, options) {\n      // based on John Resig's `tmpl` implementation\n      // http://ejohn.org/blog/javascript-micro-templating/\n      // and Laura Doktorova's doT.js\n      // https://github.com/olado/doT\n      var settings = lodash.templateSettings;\n      text = String(text || '');\n\n      // avoid missing dependencies when `iteratorTemplate` is not defined\n      options = defaults({}, options, settings);\n\n      var imports = defaults({}, options.imports, settings.imports),\n          importsKeys = keys(imports),\n          importsValues = values(imports);\n\n      var isEvaluating,\n          index = 0,\n          interpolate = options.interpolate || reNoMatch,\n          source = \"__p += '\";\n\n      // compile the regexp to match each delimiter\n      var reDelimiters = RegExp(\n        (options.escape || reNoMatch).source + '|' +\n        interpolate.source + '|' +\n        (interpolate === reInterpolate ? reEsTemplate : reNoMatch).source + '|' +\n        (options.evaluate || reNoMatch).source + '|$'\n      , 'g');\n\n      text.replace(reDelimiters, function(match, escapeValue, interpolateValue, esTemplateValue, evaluateValue, offset) {\n        interpolateValue || (interpolateValue = esTemplateValue);\n\n        // escape characters that cannot be included in string literals\n        source += text.slice(index, offset).replace(reUnescapedString, escapeStringChar);\n\n        // replace delimiters with snippets\n        if (escapeValue) {\n          source += \"' +\\n__e(\" + escapeValue + \") +\\n'\";\n        }\n        if (evaluateValue) {\n          isEvaluating = true;\n          source += \"';\\n\" + evaluateValue + \";\\n__p += '\";\n        }\n        if (interpolateValue) {\n          source += \"' +\\n((__t = (\" + interpolateValue + \")) == null ? '' : __t) +\\n'\";\n        }\n        index = offset + match.length;\n\n        // the JS engine embedded in Adobe products requires returning the `match`\n        // string in order to produce the correct `offset` value\n        return match;\n      });\n\n      source += \"';\\n\";\n\n      // if `variable` is not specified, wrap a with-statement around the generated\n      // code to add the data object to the top of the scope chain\n      var variable = options.variable,\n          hasVariable = variable;\n\n      if (!hasVariable) {\n        variable = 'obj';\n        source = 'with (' + variable + ') {\\n' + source + '\\n}\\n';\n      }\n      // cleanup code by stripping empty strings\n      source = (isEvaluating ? source.replace(reEmptyStringLeading, '') : source)\n        .replace(reEmptyStringMiddle, '$1')\n        .replace(reEmptyStringTrailing, '$1;');\n\n      // frame code as the function body\n      source = 'function(' + variable + ') {\\n' +\n        (hasVariable ? '' : variable + ' || (' + variable + ' = {});\\n') +\n        \"var __t, __p = '', __e = _.escape\" +\n        (isEvaluating\n          ? ', __j = Array.prototype.join;\\n' +\n            \"function print() { __p += __j.call(arguments, '') }\\n\"\n          : ';\\n'\n        ) +\n        source +\n        'return __p\\n}';\n\n      // Use a sourceURL for easier debugging.\n      // http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl\n      var sourceURL = '\\n/*\\n//# sourceURL=' + (options.sourceURL || '/lodash/template/source[' + (templateCounter++) + ']') + '\\n*/';\n\n      try {\n        var result = Function(importsKeys, 'return ' + source + sourceURL).apply(undefined, importsValues);\n      } catch(e) {\n        e.source = source;\n        throw e;\n      }\n      if (data) {\n        return result(data);\n      }\n      // provide the compiled function's source by its `toString` method, in\n      // supported environments, or the `source` property as a convenience for\n      // inlining compiled templates during the build process\n      result.source = source;\n      return result;\n    }\n\n    /**\n     * Executes the callback `n` times, returning an array of the results\n     * of each callback execution. The callback is bound to `thisArg` and invoked\n     * with one argument; (index).\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {number} n The number of times to execute the callback.\n     * @param {Function} callback The function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns an array of the results of each `callback` execution.\n     * @example\n     *\n     * var diceRolls = _.times(3, _.partial(_.random, 1, 6));\n     * // => [3, 6, 4]\n     *\n     * _.times(3, function(n) { mage.castSpell(n); });\n     * // => calls `mage.castSpell(n)` three times, passing `n` of `0`, `1`, and `2` respectively\n     *\n     * _.times(3, function(n) { this.cast(n); }, mage);\n     * // => also calls `mage.castSpell(n)` three times\n     */\n    function times(n, callback, thisArg) {\n      n = (n = +n) > -1 ? n : 0;\n      var index = -1,\n          result = Array(n);\n\n      callback = baseCreateCallback(callback, thisArg, 1);\n      while (++index < n) {\n        result[index] = callback(index);\n      }\n      return result;\n    }\n\n    /**\n     * The inverse of `_.escape` this method converts the HTML entities\n     * `&amp;`, `&lt;`, `&gt;`, `&quot;`, and `&#39;` in `string` to their\n     * corresponding characters.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {string} string The string to unescape.\n     * @returns {string} Returns the unescaped string.\n     * @example\n     *\n     * _.unescape('Fred, Barney &amp; Pebbles');\n     * // => 'Fred, Barney & Pebbles'\n     */\n    function unescape(string) {\n      return string == null ? '' : String(string).replace(reEscapedHtml, unescapeHtmlChar);\n    }\n\n    /**\n     * Generates a unique ID. If `prefix` is provided the ID will be appended to it.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {string} [prefix] The value to prefix the ID with.\n     * @returns {string} Returns the unique ID.\n     * @example\n     *\n     * _.uniqueId('contact_');\n     * // => 'contact_104'\n     *\n     * _.uniqueId();\n     * // => '105'\n     */\n    function uniqueId(prefix) {\n      var id = ++idCounter;\n      return String(prefix == null ? '' : prefix) + id;\n    }\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Creates a `lodash` object that wraps the given value with explicit\n     * method chaining enabled.\n     *\n     * @static\n     * @memberOf _\n     * @category Chaining\n     * @param {*} value The value to wrap.\n     * @returns {Object} Returns the wrapper object.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'age': 36 },\n     *   { 'name': 'fred',    'age': 40 },\n     *   { 'name': 'pebbles', 'age': 1 }\n     * ];\n     *\n     * var youngest = _.chain(characters)\n     *     .sortBy('age')\n     *     .map(function(chr) { return chr.name + ' is ' + chr.age; })\n     *     .first()\n     *     .value();\n     * // => 'pebbles is 1'\n     */\n    function chain(value) {\n      value = new lodashWrapper(value);\n      value.__chain__ = true;\n      return value;\n    }\n\n    /**\n     * Invokes `interceptor` with the `value` as the first argument and then\n     * returns `value`. The purpose of this method is to \"tap into\" a method\n     * chain in order to perform operations on intermediate results within\n     * the chain.\n     *\n     * @static\n     * @memberOf _\n     * @category Chaining\n     * @param {*} value The value to provide to `interceptor`.\n     * @param {Function} interceptor The function to invoke.\n     * @returns {*} Returns `value`.\n     * @example\n     *\n     * _([1, 2, 3, 4])\n     *  .tap(function(array) { array.pop(); })\n     *  .reverse()\n     *  .value();\n     * // => [3, 2, 1]\n     */\n    function tap(value, interceptor) {\n      interceptor(value);\n      return value;\n    }\n\n    /**\n     * Enables explicit method chaining on the wrapper object.\n     *\n     * @name chain\n     * @memberOf _\n     * @category Chaining\n     * @returns {*} Returns the wrapper object.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * // without explicit chaining\n     * _(characters).first();\n     * // => { 'name': 'barney', 'age': 36 }\n     *\n     * // with explicit chaining\n     * _(characters).chain()\n     *   .first()\n     *   .pick('age')\n     *   .value();\n     * // => { 'age': 36 }\n     */\n    function wrapperChain() {\n      this.__chain__ = true;\n      return this;\n    }\n\n    /**\n     * Produces the `toString` result of the wrapped value.\n     *\n     * @name toString\n     * @memberOf _\n     * @category Chaining\n     * @returns {string} Returns the string result.\n     * @example\n     *\n     * _([1, 2, 3]).toString();\n     * // => '1,2,3'\n     */\n    function wrapperToString() {\n      return String(this.__wrapped__);\n    }\n\n    /**\n     * Extracts the wrapped value.\n     *\n     * @name valueOf\n     * @memberOf _\n     * @alias value\n     * @category Chaining\n     * @returns {*} Returns the wrapped value.\n     * @example\n     *\n     * _([1, 2, 3]).valueOf();\n     * // => [1, 2, 3]\n     */\n    function wrapperValueOf() {\n      return this.__wrapped__;\n    }\n\n    /*--------------------------------------------------------------------------*/\n\n    // add functions that return wrapped values when chaining\n    lodash.after = after;\n    lodash.assign = assign;\n    lodash.at = at;\n    lodash.bind = bind;\n    lodash.bindAll = bindAll;\n    lodash.bindKey = bindKey;\n    lodash.chain = chain;\n    lodash.compact = compact;\n    lodash.compose = compose;\n    lodash.constant = constant;\n    lodash.countBy = countBy;\n    lodash.create = create;\n    lodash.createCallback = createCallback;\n    lodash.curry = curry;\n    lodash.debounce = debounce;\n    lodash.defaults = defaults;\n    lodash.defer = defer;\n    lodash.delay = delay;\n    lodash.difference = difference;\n    lodash.filter = filter;\n    lodash.flatten = flatten;\n    lodash.forEach = forEach;\n    lodash.forEachRight = forEachRight;\n    lodash.forIn = forIn;\n    lodash.forInRight = forInRight;\n    lodash.forOwn = forOwn;\n    lodash.forOwnRight = forOwnRight;\n    lodash.functions = functions;\n    lodash.groupBy = groupBy;\n    lodash.indexBy = indexBy;\n    lodash.initial = initial;\n    lodash.intersection = intersection;\n    lodash.invert = invert;\n    lodash.invoke = invoke;\n    lodash.keys = keys;\n    lodash.map = map;\n    lodash.mapValues = mapValues;\n    lodash.max = max;\n    lodash.memoize = memoize;\n    lodash.merge = merge;\n    lodash.min = min;\n    lodash.omit = omit;\n    lodash.once = once;\n    lodash.pairs = pairs;\n    lodash.partial = partial;\n    lodash.partialRight = partialRight;\n    lodash.pick = pick;\n    lodash.pluck = pluck;\n    lodash.property = property;\n    lodash.pull = pull;\n    lodash.range = range;\n    lodash.reject = reject;\n    lodash.remove = remove;\n    lodash.rest = rest;\n    lodash.shuffle = shuffle;\n    lodash.sortBy = sortBy;\n    lodash.tap = tap;\n    lodash.throttle = throttle;\n    lodash.times = times;\n    lodash.toArray = toArray;\n    lodash.transform = transform;\n    lodash.union = union;\n    lodash.uniq = uniq;\n    lodash.values = values;\n    lodash.where = where;\n    lodash.without = without;\n    lodash.wrap = wrap;\n    lodash.xor = xor;\n    lodash.zip = zip;\n    lodash.zipObject = zipObject;\n\n    // add aliases\n    lodash.collect = map;\n    lodash.drop = rest;\n    lodash.each = forEach;\n    lodash.eachRight = forEachRight;\n    lodash.extend = assign;\n    lodash.methods = functions;\n    lodash.object = zipObject;\n    lodash.select = filter;\n    lodash.tail = rest;\n    lodash.unique = uniq;\n    lodash.unzip = zip;\n\n    // add functions to `lodash.prototype`\n    mixin(lodash);\n\n    /*--------------------------------------------------------------------------*/\n\n    // add functions that return unwrapped values when chaining\n    lodash.clone = clone;\n    lodash.cloneDeep = cloneDeep;\n    lodash.contains = contains;\n    lodash.escape = escape;\n    lodash.every = every;\n    lodash.find = find;\n    lodash.findIndex = findIndex;\n    lodash.findKey = findKey;\n    lodash.findLast = findLast;\n    lodash.findLastIndex = findLastIndex;\n    lodash.findLastKey = findLastKey;\n    lodash.has = has;\n    lodash.identity = identity;\n    lodash.indexOf = indexOf;\n    lodash.isArguments = isArguments;\n    lodash.isArray = isArray;\n    lodash.isBoolean = isBoolean;\n    lodash.isDate = isDate;\n    lodash.isElement = isElement;\n    lodash.isEmpty = isEmpty;\n    lodash.isEqual = isEqual;\n    lodash.isFinite = isFinite;\n    lodash.isFunction = isFunction;\n    lodash.isNaN = isNaN;\n    lodash.isNull = isNull;\n    lodash.isNumber = isNumber;\n    lodash.isObject = isObject;\n    lodash.isPlainObject = isPlainObject;\n    lodash.isRegExp = isRegExp;\n    lodash.isString = isString;\n    lodash.isUndefined = isUndefined;\n    lodash.lastIndexOf = lastIndexOf;\n    lodash.mixin = mixin;\n    lodash.noConflict = noConflict;\n    lodash.noop = noop;\n    lodash.now = now;\n    lodash.parseInt = parseInt;\n    lodash.random = random;\n    lodash.reduce = reduce;\n    lodash.reduceRight = reduceRight;\n    lodash.result = result;\n    lodash.runInContext = runInContext;\n    lodash.size = size;\n    lodash.some = some;\n    lodash.sortedIndex = sortedIndex;\n    lodash.template = template;\n    lodash.unescape = unescape;\n    lodash.uniqueId = uniqueId;\n\n    // add aliases\n    lodash.all = every;\n    lodash.any = some;\n    lodash.detect = find;\n    lodash.findWhere = find;\n    lodash.foldl = reduce;\n    lodash.foldr = reduceRight;\n    lodash.include = contains;\n    lodash.inject = reduce;\n\n    mixin(function() {\n      var source = {}\n      forOwn(lodash, function(func, methodName) {\n        if (!lodash.prototype[methodName]) {\n          source[methodName] = func;\n        }\n      });\n      return source;\n    }(), false);\n\n    /*--------------------------------------------------------------------------*/\n\n    // add functions capable of returning wrapped and unwrapped values when chaining\n    lodash.first = first;\n    lodash.last = last;\n    lodash.sample = sample;\n\n    // add aliases\n    lodash.take = first;\n    lodash.head = first;\n\n    forOwn(lodash, function(func, methodName) {\n      var callbackable = methodName !== 'sample';\n      if (!lodash.prototype[methodName]) {\n        lodash.prototype[methodName]= function(n, guard) {\n          var chainAll = this.__chain__,\n              result = func(this.__wrapped__, n, guard);\n\n          return !chainAll && (n == null || (guard && !(callbackable && typeof n == 'function')))\n            ? result\n            : new lodashWrapper(result, chainAll);\n        };\n      }\n    });\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * The semantic version number.\n     *\n     * @static\n     * @memberOf _\n     * @type string\n     */\n    lodash.VERSION = '2.4.1';\n\n    // add \"Chaining\" functions to the wrapper\n    lodash.prototype.chain = wrapperChain;\n    lodash.prototype.toString = wrapperToString;\n    lodash.prototype.value = wrapperValueOf;\n    lodash.prototype.valueOf = wrapperValueOf;\n\n    // add `Array` functions that return unwrapped values\n    forEach(['join', 'pop', 'shift'], function(methodName) {\n      var func = arrayRef[methodName];\n      lodash.prototype[methodName] = function() {\n        var chainAll = this.__chain__,\n            result = func.apply(this.__wrapped__, arguments);\n\n        return chainAll\n          ? new lodashWrapper(result, chainAll)\n          : result;\n      };\n    });\n\n    // add `Array` functions that return the existing wrapped value\n    forEach(['push', 'reverse', 'sort', 'unshift'], function(methodName) {\n      var func = arrayRef[methodName];\n      lodash.prototype[methodName] = function() {\n        func.apply(this.__wrapped__, arguments);\n        return this;\n      };\n    });\n\n    // add `Array` functions that return new wrapped values\n    forEach(['concat', 'slice', 'splice'], function(methodName) {\n      var func = arrayRef[methodName];\n      lodash.prototype[methodName] = function() {\n        return new lodashWrapper(func.apply(this.__wrapped__, arguments), this.__chain__);\n      };\n    });\n\n    return lodash;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  // expose Lo-Dash\n  var _ = runInContext();\n\n  // some AMD build optimizers like r.js check for condition patterns like the following:\n  if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {\n    // Expose Lo-Dash to the global object even when an AMD loader is present in\n    // case Lo-Dash is loaded with a RequireJS shim config.\n    // See http://requirejs.org/docs/api.html#config-shim\n    root._ = _;\n\n    // define as an anonymous module so, through path mapping, it can be\n    // referenced as the \"underscore\" module\n    define(function() {\n      return _;\n    });\n  }\n  // check for `exports` after `define` in case a build optimizer adds an `exports` object\n  else if (freeExports && freeModule) {\n    // in Node.js or RingoJS\n    if (moduleExports) {\n      (freeModule.exports = _)._ = _;\n    }\n    // in Narwhal or Rhino -require\n    else {\n      freeExports._ = _;\n    }\n  }\n  else {\n    // in a browser or Rhino\n    root._ = _;\n  }\n}.call(this));\n","// shim for using process in browser\n\nvar process = module.exports = {};\n\nprocess.nextTick = (function () {\n    var canSetImmediate = typeof window !== 'undefined'\n    && window.setImmediate;\n    var canPost = typeof window !== 'undefined'\n    && window.postMessage && window.addEventListener\n    ;\n\n    if (canSetImmediate) {\n        return function (f) { return window.setImmediate(f) };\n    }\n\n    if (canPost) {\n        var queue = [];\n        window.addEventListener('message', function (ev) {\n            var source = ev.source;\n            if ((source === window || source === null) && ev.data === 'process-tick') {\n                ev.stopPropagation();\n                if (queue.length > 0) {\n                    var fn = queue.shift();\n                    fn();\n                }\n            }\n        }, true);\n\n        return function nextTick(fn) {\n            queue.push(fn);\n            window.postMessage('process-tick', '*');\n        };\n    }\n\n    return function nextTick(fn) {\n        setTimeout(fn, 0);\n    };\n})();\n\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n}\n\n// TODO(shtylman)\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\n","\n/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\nvar utils = require('./utils');\nvar hop = utils.object.hasOwnProperty;\n\n/**\n * Expose Attributes\n */\n\nmodule.exports = Attributes;\n\n/**\n * Build an Attributes Definition\n *\n * Takes a collection of attributes from a Waterline Collection\n * and builds up an initial schema by normalizing into a known format.\n *\n * @param {Object} collections\n * @param {Object} connections\n * @return {Object}\n * @api private\n */\n\nfunction Attributes(collections, connections, defaults) {\n  var self = this;\n\n  this.attributes = {};\n\n  // Ensure a value is set for connections\n  connections = connections || {};\n\n  for(var key in collections) {\n    var collection = this.normalize(collections[key].prototype, connections, defaults);\n    var conns = _.cloneDeep(collection.connection);\n    var attributes = _.cloneDeep(collection.attributes);\n\n    this.stripFunctions(attributes);\n    this.stripProperties(attributes);\n    this.validatePropertyNames(attributes);\n\n    this.attributes[collection.identity.toLowerCase()] = {\n      connection: conns,\n      identity: collection.identity.toLowerCase(),\n      tableName: collection.tableName || collection.identity,\n      attributes: attributes\n    };\n  }\n\n  return this.attributes;\n\n}\n\n/**\n * Normalize attributes for a collection into a known format.\n *\n * @param {Object} collection\n * @param {Object} connections\n * @return {Object}\n * @api private\n */\n\nAttributes.prototype.normalize = function(collection, connections, defaults) {\n\n  this.normalizeIdentity(collection);\n  this.setDefaults(collection, defaults);\n  this.autoAttributes(collection, connections);\n\n  return collection;\n\n};\n\n/**\n * Set Default Values for the collection.\n *\n * Adds flags to the collection to determine if timestamps and a primary key\n * should be added to the collection's schema.\n *\n * @param {Object} collection\n * @api private\n */\n\nAttributes.prototype.setDefaults = function(collection, defaults) {\n\n  // Ensure defaults is always set to something\n  defaults = defaults || {};\n\n  if(!hop(collection, 'connection')) {\n    collection.connection = '';\n  }\n\n  if(!hop(collection, 'attributes')) {\n    collection.attributes = {};\n  }\n\n  var defaultSettings = {\n    autoPK: true,\n    autoCreatedAt: true,\n    autoUpdatedAt: true\n  };\n\n  // Override default settings with user defined defaults\n  if(hop(defaults, 'autoPK')) defaultSettings.autoPK = defaults.autoPK;\n  if(hop(defaults, 'autoCreatedAt')) defaultSettings.autoCreatedAt = defaults.autoCreatedAt;\n  if(hop(defaults, 'autoUpdatedAt')) defaultSettings.autoUpdatedAt = defaults.autoUpdatedAt;\n\n  // Override defaults with collection defined values\n  if(hop(collection, 'autoPK')) defaultSettings.autoPK = collection.autoPK;\n  if(hop(collection, 'autoCreatedAt')) defaultSettings.autoCreatedAt = collection.autoCreatedAt;\n  if(hop(collection, 'autoUpdatedAt')) defaultSettings.autoUpdatedAt = collection.autoUpdatedAt;\n\n  var flags = {\n    autoPK: defaultSettings.autoPK,\n    autoCreatedAt: defaultSettings.autoCreatedAt,\n    autoUpdatedAt: defaultSettings.autoUpdatedAt\n  };\n\n  for(var flag in flags) {\n    collection[flag] = flags[flag];\n  }\n\n};\n\n/**\n * Normalize identity\n *\n * @param {Object} collection\n * @api private\n */\n\nAttributes.prototype.normalizeIdentity = function(collection) {\n\n  if(hop(collection, 'tableName') && !hop(collection, 'identity')) {\n    collection.identity = collection.tableName.toLowerCase();\n  }\n\n  // Require an identity so the object key can be set\n  if(!hop(collection, 'identity')) {\n    throw new Error('A Collection must include an identity or tableName attribute');\n  }\n\n};\n\n/**\n * Add Auto Attribute definitions to the schema if they are not defined.\n *\n * Adds in things such as an Id primary key and timestamps unless they have been\n * disabled in the collection.\n *\n * @param {Object} collection\n * @param {Object} connections\n * @api private\n */\n\nAttributes.prototype.autoAttributes = function(collection, connections) {\n\n  var attributes = collection.attributes;\n  var pk = false;\n  var mainConnection;\n\n  // Check to make sure another property hasn't set itself as a primary key\n  for(var key in attributes) {\n    if(hop(attributes[key], 'primaryKey')) pk = true;\n  }\n\n  // If a primary key was manually defined, turn off autoPK\n  if(pk) collection.autoPK = false;\n\n  // Add a primary key attribute\n  if(!pk && collection.autoPK && !attributes.id) {\n    attributes.id = {\n      type: 'integer',\n      autoIncrement: true,\n      primaryKey: true,\n      unique: true\n    };\n\n    // Check if the adapter used in the collection specifies the primary key format\n    if(Array.isArray(collection.connection)) {\n      mainConnection = collection.connection[0];\n    }\n    else {\n      mainConnection = collection.connection;\n    }\n\n    if(hop(connections, mainConnection)) {\n      var connection = connections[mainConnection];\n      if(hop(connection._adapter, 'pkFormat')) {\n        attributes.id.type = connection._adapter.pkFormat;\n      }\n    }\n  }\n\n  // Extend definition with autoUpdatedAt and autoCreatedAt timestamps\n  var now = {\n    type: 'datetime',\n    'default': 'NOW'\n  };\n\n  if(collection.autoCreatedAt && !attributes.createdAt) {\n    attributes.createdAt = now;\n  }\n\n  if(collection.autoUpdatedAt && !attributes.updatedAt) {\n    attributes.updatedAt = now;\n  }\n\n};\n\n/**\n * Strip Functions From Schema\n *\n * @param {Object} attributes\n * @api private\n */\n\nAttributes.prototype.stripFunctions = function(attributes) {\n\n  for(var attribute in attributes) {\n    if(typeof attributes[attribute] === 'function') delete attributes[attribute];\n  }\n\n};\n\n/**\n * Strip Non-Reserved Properties\n *\n * @param {Object} attributes\n * @api private\n */\n\nAttributes.prototype.stripProperties = function(attributes) {\n\n  for(var attribute in attributes) {\n    this.stripProperty(attributes[attribute]);\n  }\n\n};\n\n/**\n * Strip Property that isn't in the reserved words list.\n *\n * @param {Object}\n * @api private\n */\n\nAttributes.prototype.stripProperty = function(properties) {\n\n  for(var prop in properties) {\n    if(utils.reservedWords.indexOf(prop) > -1) continue;\n    delete properties[prop];\n  }\n\n};\n\n/**\n * Validates property names to ensure they are valid.\n *\n * @param {Object}\n * @api private\n */\n\nAttributes.prototype.validatePropertyNames = function(attributes) {\n\n  for(var attribute in attributes) {\n\n    // Check for dots in name\n    if(attribute.match(/\\./g)) {\n      var error = 'Invalid Attribute Name: Attributes may not contain a \".\"\" character';\n      throw new Error(error);\n    }\n\n  }\n\n};\n","\n/**\n * Module Dependencies\n */\n\nvar _ = require('lodash');\nvar utils = require('./utils');\nvar hop = utils.object.hasOwnProperty;\n\n/**\n * Expose Foreign Keys\n */\n\nmodule.exports = ForeignKeys;\n\n/**\n * Adds Foreign keys to a Collection where needed for belongsTo associations.\n *\n * @param {Object} collections\n * @return {Object}\n * @api private\n */\n\nfunction ForeignKeys(collections) {\n\n  collections = collections || {};\n  this.collections = _.clone(collections);\n\n  for(var collection in collections) {\n    this.replaceKeys(collections[collection].attributes);\n  }\n\n  return collections;\n\n}\n\n/**\n * Replace Model Association with a foreign key attribute\n *\n * @param {Object} attributes\n * @api private\n */\n\nForeignKeys.prototype.replaceKeys = function(attributes) {\n\n  for(var attribute in attributes) {\n\n    // We only care about adding foreign key values to attributes\n    // with a `model` key\n    if(!hop(attributes[attribute], 'model')) continue;\n\n    var modelName = attributes[attribute].model.toLowerCase();\n    var primaryKey = this.findPrimaryKey(modelName);\n    var columnName = this.buildColumnName(attribute, attributes[attribute]);\n    var foreignKey = {\n      columnName: columnName,\n      type: primaryKey.attributes.type,\n      foreignKey: true,\n      references: modelName,\n      on: primaryKey.attributes.columnName || primaryKey.name\n    };\n\n    // Remove the attribute and replace it with the foreign key\n    delete attributes[attribute];\n    attributes[attribute] = foreignKey;\n  }\n\n};\n\n/**\n * Find a collection's primary key attribute\n *\n * @param {String} collection\n * @return {Object}\n * @api private\n */\n\nForeignKeys.prototype.findPrimaryKey = function(collection) {\n\n  if(!this.collections[collection]) {\n    throw new Error('Trying to access a collection ' + collection + ' that is not defined.');\n  }\n\n  if(!this.collections[collection].attributes) {\n    throw new Error('Collection, ' + collection + ', has no attributes defined.');\n  }\n\n  var primaryKey = null;\n\n  for(var key in this.collections[collection].attributes) {\n    var attribute = this.collections[collection].attributes[key];\n\n    if(!hop(attribute, 'primaryKey')) continue;\n\n    primaryKey = {\n      name: key,\n      attributes: attribute\n    };\n  }\n\n  if(!primaryKey) {\n    var error = 'Trying to create an association on a model that doesn\\'t have a Primary Key.';\n    throw new Error(error);\n  }\n\n  return primaryKey;\n\n};\n\n/**\n * Build A Column Name\n *\n * Uses either the attributes defined columnName or the user defined attribute name\n *\n * @param {String} key\n * @param {Object} attribute\n * @param {Object} primaryKey\n * @return {String}\n * @api private\n */\n\nForeignKeys.prototype.buildColumnName = function(key, attribute) {\n\n  if(hop(attribute, 'columnName')) return attribute.columnName;\n  return key;\n\n};\n","\n/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\nvar utils = require('./utils');\nvar hop = utils.object.hasOwnProperty;\n\n/**\n * Expose JoinTables\n */\n\nmodule.exports = JoinTables;\n\n/**\n * Insert Join/Junction Tables where needed whenever two collections\n * point to each other. Also replaces the references to point to the new join table.\n *\n * @param {Object} collections\n * @return {Object}\n * @api private\n */\n\nfunction JoinTables(collections) {\n\n  var self = this;\n  var joinTables;\n\n  collections = collections || {};\n  this.tables = {};\n\n  this.collections = _.cloneDeep(collections);\n\n  // Build Up Join Tables\n  for(var collection in collections) {\n\n    // Parse the collection's attributes and create join tables\n    // where needed for collections\n    joinTables = this.buildJoins(collection);\n    this.uniqueTables(joinTables);\n\n    // Mark hasManyThrough tables as junction tables with select all set to true\n    this.markCustomJoinTables(collection);\n  }\n\n  // Update Collection Attributes to point to the join table\n  this.linkAttributes();\n\n  // Remove properties added just for unqueness\n  Object.keys(this.tables).forEach(function(table) {\n    delete self.tables[table].joinedAttributes;\n  });\n\n  return _.extend(this.collections, this.tables);\n\n}\n\n/**\n * Build A Set of Join Tables\n *\n * @param {String} collection\n * @api private\n * @return {Array}\n */\n\nJoinTables.prototype.buildJoins = function(collection) {\n\n  var self = this;\n  var tables = [];\n\n  var attributes = this.collections[collection].attributes;\n  var collectionAttributes = this.mapCollections(attributes);\n\n  // If there are no collection attributes return an empty array\n  if(Object.keys(collectionAttributes).length === 0) return [];\n\n  // For each collection attribute, inspect it to build up a join table if needed.\n  collectionAttributes.forEach(function(attribute) {\n    var table = self.parseAttribute(collection, attribute);\n    if(table) tables.push(self.buildTable(table));\n  });\n\n  return tables;\n\n};\n\n/**\n * Find Has Many attributes for a given set of attributes.\n *\n * @param {Object} attributes\n * @return {Object}\n * @api private\n */\n\nJoinTables.prototype.mapCollections = function(attributes) {\n\n  var collectionAttributes = [];\n\n  for(var attribute in attributes) {\n    if(!hop(attributes[attribute], 'collection')) continue;\n    collectionAttributes.push({ key: attribute, val: attributes[attribute] });\n  }\n\n  return collectionAttributes;\n\n};\n\n/**\n * Parse Collection Attributes\n *\n * Check the collection the attribute references to see if this is a one-to-many or many-to-many\n * relationship. If it's a one-to-many we don't need to build up a join table.\n *\n * @param {String} collectionName\n * @param {Object} attribute\n * @return {Object}\n * @api private\n */\n\nJoinTables.prototype.parseAttribute = function(collectionName, attribute) {\n\n  var error = '';\n  var attr = attribute.val;\n\n  // Check if this is a hasManyThrough attribute,\n  // if so a join table doesn't need to be created\n  if(hop(attr, 'through')) return;\n\n  // Normalize `collection` property name to lowercased version\n  attr.collection = attr.collection.toLowerCase();\n\n  // Grab the associated collection and ensure it exists\n  var child = this.collections[attr.collection];\n  if(!child) {\n    error = 'Collection ' + collectionName + ' has an attribute named ' + attribute.key + ' that is ' +\n            'pointing to a collection named ' + attr.collection + ' which doesn\\'t exist. You must ' +\n            ' first create the ' + attr.collection + ' collection.';\n\n    throw new Error(error);\n  }\n\n  // If the attribute has a `via` key, check if it's a foreign key. If so this is a one-to-many\n  // relationship and no join table is needed.\n  if(hop(attr, 'via') && hop(child.attributes[attr.via], 'foreignKey')) return;\n\n  // If no via is specified, a name needs to be created for the other column\n  // in the join table. Use the attribute key and the associated collection name\n  // which will be unique.\n  if(!hop(attr, 'via')) attr.via = attribute.key + '_' + attr.collection;\n\n  // Build up an object that can be used to build a join table\n  var tableAttributes = {\n    column_one: {\n      collection: collectionName.toLowerCase(),\n      attribute: attribute.key,\n      via: attr.via\n    },\n\n    column_two: {\n      collection: attr.collection,\n      attribute: attr.via,\n      via: attribute.key\n    }\n  };\n\n  return tableAttributes;\n\n};\n\n/**\n * Build Collection for a single join\n *\n * @param {Object} columns\n * @return {Object}\n * @api private\n */\n\nJoinTables.prototype.buildTable = function(columns) {\n\n  var table = {};\n  var c1 = columns.column_one;\n  var c2 = columns.column_two;\n\n  table.identity = this.buildCollectionName(columns).toLowerCase();\n  table.tableName = table.identity;\n  table.tables = [c1.collection, c2.collection];\n  table.joinedAttributes = [];\n  table.junctionTable = true;\n\n  // Look for a dominant collection property so the join table can be created on the correct connection.\n  table.connection = this.findDominantConnection(columns);\n  if(!table.connection) {\n    var err = \"A 'dominant' property was not supplied for the two collections in a many-to-many relationship. \" +\n        \"One side of the relationship between '\" + c1.collection + \"' and '\" + c2.collection + \"' needs a \" +\n        \"'domiant: true' flag set so a join table can be created on the correct connection.\";\n\n    throw new Error(err);\n  }\n\n  // Set a primary key (should probably be refactored)\n  table.attributes = {\n    id: {\n      primaryKey: true,\n      autoIncrement: true,\n      type: 'integer'\n    }\n  };\n\n  // Add each foreign key as an attribute\n  table.attributes[c1.collection + '_' + c1.attribute] = this.buildForeignKey(c1, c2);\n  table.attributes[c2.collection + '_' + c2.attribute] = this.buildForeignKey(c2, c1);\n\n  table.joinedAttributes.push(c1.collection + '_' + c1.attribute);\n  table.joinedAttributes.push(c2.collection + '_' + c2.attribute);\n\n  return table;\n\n};\n\n/**\n * Build a collection name by combining two collection and attribute names.\n *\n * @param {Object} columns\n * @return {String}\n * @api private\n */\n\nJoinTables.prototype.buildCollectionName = function(columns) {\n\n  var c1 = columns.column_one;\n  var c2 = columns.column_two;\n\n  if(c1.collection < c2.collection) {\n    return c1.collection + '_' + c1.attribute + '__' + c2.collection + '_' + c2.attribute;\n  }\n\n  return c2.collection + '_' + c2.attribute + '__' + c1.collection + '_' + c1.attribute;\n\n};\n\n/**\n * Find the dominant collection.\n *\n * @param {Object} columns\n * @return {String}\n * @api private\n */\n\nJoinTables.prototype.findDominantConnection = function(columns) {\n\n  var c1 = this.collections[columns.column_one.collection];\n  var c2 = this.collections[columns.column_two.collection];\n  var dominantCollection;\n\n  // Don't require a dominant collection on self-referencing associations\n  if(columns.column_one.collection === columns.column_two.collection) {\n    return c1.connection;\n  }\n\n  dominantCollection = this.searchForAttribute(columns.column_one.collection, 'dominant');\n  if(dominantCollection) return c1.connection;\n\n  dominantCollection = this.searchForAttribute(columns.column_two.collection, 'dominant');\n  if(dominantCollection) return c2.connection;\n\n  // Don't require a dominant collection for models on the same connection.\n  if (c1.connection[0] === c2.connection[0]) {\n    return c1.connection;\n  }\n\n  return false;\n\n};\n\n/**\n * Search Attributes for an attribute property.\n *\n * @param {String} collectionName\n * @param {String} attributeName\n * @param {String} value (optional)\n * @return {String}\n * @api private\n */\n\nJoinTables.prototype.searchForAttribute = function(collectionName, attributeName, value) {\n\n  var collection = this.collections[collectionName];\n  var matching;\n  var properties;\n\n  Object.keys(collection.attributes).forEach(function(key) {\n    properties = collection.attributes[key];\n    if(!value && hop(properties, attributeName)) matching = key;\n    if(hop(properties, attributeName) && properties[attributeName] === value) matching = key;\n  });\n\n  return matching;\n\n};\n\n/**\n * Build a Foreign Key value for an attribute in the join collection\n *\n * @param {Object} column_one\n * @param {Object} column_two\n * @return {Object}\n * @api private\n */\n\nJoinTables.prototype.buildForeignKey = function(column_one, column_two) {\n\n  var primaryKey = this.findPrimaryKey(column_one.collection);\n  var columnName = (column_one.collection + '_' + column_one.attribute);\n  var viaName = column_two.collection + '_' + column_one.via;\n\n  return {\n    columnName: columnName,\n    type: primaryKey.attributes.type,\n    foreignKey: true,\n    references: column_one.collection,\n    on: primaryKey.name,\n    via: viaName,\n    groupKey: column_one.collection\n  };\n\n};\n\n/**\n * Filter Out Duplicate Join Tables\n *\n * @param {Array} tables\n * @api private\n */\n\nJoinTables.prototype.uniqueTables = function(tables) {\n\n  var self = this;\n\n  tables.forEach(function(table) {\n    var add = true;\n\n    // Check if any tables are already joining these attributes together\n    Object.keys(self.tables).forEach(function(tableName) {\n      var currentTable = self.tables[tableName];\n      if(currentTable.joinedAttributes.indexOf(table.joinedAttributes[0]) === -1) return;\n      if(currentTable.joinedAttributes.indexOf(table.joinedAttributes[1]) === -1) return;\n\n      add = false;\n    });\n\n    if(hop(self.tables, table.identity)) return;\n    if(add) self.tables[table.identity] = table;\n  });\n\n};\n\n/**\n * Find a collection's primary key attribute\n *\n * @param {String} collection\n * @return {Object}\n * @api private\n */\n\nJoinTables.prototype.findPrimaryKey = function(collection) {\n\n  var primaryKey = null;\n  var attribute;\n  var error;\n\n  if(!this.collections[collection]) {\n    throw new Error('Trying to access a collection ' + collection + ' that is not defined.');\n  }\n\n  if(!this.collections[collection].attributes) {\n    throw new Error('Collection, ' + collection + ', has no attributes defined.');\n  }\n\n  for(var key in this.collections[collection].attributes) {\n    attribute = this.collections[collection].attributes[key];\n\n    if(!hop(attribute, 'primaryKey')) continue;\n\n    primaryKey = {\n      name: key,\n      attributes: attribute\n    };\n  }\n\n  if(!primaryKey) {\n    error = 'Trying to create an association on a model that doesn\\'t have a Primary Key.';\n    throw new Error(error);\n  }\n\n  return primaryKey;\n\n};\n\n/**\n * Update Collection Attributes to point to the join table instead of the other collection\n *\n * @api private\n */\n\nJoinTables.prototype.linkAttributes = function() {\n\n  for(var collection in this.collections) {\n    var attributes = this.collections[collection].attributes;\n    this.updateAttribute(collection, attributes);\n  }\n\n};\n\n/**\n * Update An Attribute\n *\n * @param {String} collection\n * @param {Object} attributes\n * @api private\n */\n\nJoinTables.prototype.updateAttribute = function(collection, attributes) {\n\n  for(var attribute in attributes) {\n    if(!hop(attributes[attribute], 'collection')) continue;\n\n    var attr = attributes[attribute];\n    var parent = collection;\n    var child = attr.collection;\n    var via = attr.via;\n\n    var joined = this.findJoinTable(parent, child, via);\n\n    if(!joined.join) continue;\n\n    // If the table doesn't know about the other side ignore updating anything\n    if(!hop(joined.table.attributes, collection + '_' + attribute)) continue;\n\n    this.collections[collection].attributes[attribute] = {\n      collection: joined.table.identity,\n      references: joined.table.identity,\n      on: joined.table.attributes[collection + '_' + attribute].columnName\n    };\n  }\n\n};\n\n/**\n * Mark Custom Join Tables as a Junction Table\n *\n * If a collection has an attribute with a `through` property, lookup\n * the collection it points to and mark it as a `junctionTable`.\n *\n * @param {String} collection\n * @api private\n */\n\nJoinTables.prototype.markCustomJoinTables = function(collection) {\n\n  var attributes = this.collections[collection].attributes;\n\n  for(var attribute in attributes) {\n    if(!hop(attributes[attribute], 'through')) continue;\n\n    var linkedCollection = attributes[attribute].through;\n    this.collections[linkedCollection].junctionTable = true;\n\n    // Build up proper reference on the attribute\n    attributes[attribute].collection = linkedCollection;\n    attributes[attribute].references = linkedCollection;\n\n    // Find Reference Key\n    var reference = this.findReference(collection, linkedCollection);\n    attributes[attribute].on = reference;\n\n    delete attributes[attribute].through;\n  }\n\n};\n\n/**\n * Find Reference attribute name in a set of attributes\n *\n * @param {String} parent\n * @param {String} collection\n * @return {String}\n * @api private\n */\n\nJoinTables.prototype.findReference = function(parent, collection) {\n\n  var attributes = this.collections[collection].attributes;\n  var reference;\n\n  for(var attribute in attributes) {\n    if(!hop(attributes[attribute], 'foreignKey')) continue;\n    if(!hop(attributes[attribute], 'references')) continue;\n    if(attributes[attribute].references !== parent) continue;\n\n    reference = attributes[attribute].columnName || attribute;\n    break;\n  }\n\n  return reference;\n\n};\n\n/**\n * Search for a matching join table\n *\n * @param {String} parent\n * @param {String} child\n * @param {String} via\n * @return {Object}\n * @api private\n */\n\nJoinTables.prototype.findJoinTable = function(parent, child, via) {\n\n  var join = false;\n  var tableCollection;\n\n  for(var table in this.tables) {\n    var tables = this.tables[table].tables;\n\n    if(tables.indexOf(parent) < 0) continue;\n    if(tables.indexOf(child) < 0) continue;\n\n    var column = child + '_' + via;\n\n    if(!hop(this.tables[table].attributes, column)) continue;\n\n    join = true;\n    tableCollection = this.tables[table];\n    break;\n  }\n\n  return { join: join, table: tableCollection };\n\n};\n","\n/**\n * Module Dependencies\n */\n\nvar _ = require('lodash');\nvar utils = require('./utils');\nvar hop = utils.object.hasOwnProperty;\n\n/**\n * Expose References\n */\n\nmodule.exports = References;\n\n/**\n * Map References for hasMany attributes. Not necessarily used for most schemas\n * but used internally in Waterline. It could also be helpful for key/value datastores.\n *\n * @param {Object} collections\n * @return {Object}\n * @api private\n */\n\nfunction References(collections) {\n\n  collections = collections || {};\n  this.collections = _.clone(collections);\n\n  for(var collection in collections) {\n    this.addKeys(collection);\n  }\n\n  return this.collections;\n\n}\n\n/**\n * Add Reference Keys to hasMany attributes\n *\n * @param {String} collection\n * @api private\n */\n\nReferences.prototype.addKeys = function(collection) {\n\n  var attributes = this.collections[collection].attributes;\n  var reference;\n\n  for(var attribute in attributes) {\n    if(!hop(attributes[attribute], 'collection')) continue;\n\n    // If references have already been configured, continue on\n    if(attributes[attribute].references && attributes[attribute].on) continue;\n\n    attributes[attribute].collection = attributes[attribute].collection;\n\n    // Check For HasMany Through\n    if(hop(attributes[attribute], 'through')) {\n      reference = this.findReference(attributes[attribute].collection.toLowerCase(), attributes[attribute].through.toLowerCase());\n      if(!reference) continue;\n\n      attributes[attribute].references = attributes[attribute].through;\n      attributes[attribute].on = reference;\n      delete attributes[attribute].through;\n\n      continue;\n    }\n\n    // Figure out what to reference by looping through the other collection\n    reference = this.findReference(collection, attributes[attribute].collection.toLowerCase(), attributes[attribute]);\n    if(!reference) continue;\n\n    attributes[attribute].references = attributes[attribute].collection.toLowerCase();\n    attributes[attribute].on = reference;\n  }\n\n};\n\n/**\n * Find Reference attribute name in a set of attributes\n *\n * @param {String} parent\n * @param {String} collection\n * @param {Object} attribute\n * @return {String}\n * @api private\n */\n\nReferences.prototype.findReference = function(parent, collection, attribute) {\n\n  if(typeof this.collections[collection] != 'object') {\n    throw new Error('Cannot find collection \\'' + collection + '\\' referenced in ' + parent);\n  }\n\n  var attributes = this.collections[collection].attributes;\n  var reference;\n  var matchingAttributes = [];\n\n  for(var attr in attributes) {\n    if(!hop(attributes[attr], 'foreignKey')) continue;\n    if(!hop(attributes[attr], 'references')) continue;\n    if(attributes[attr].references !== parent) continue;\n\n    // Add the attribute to the matchingAttribute array\n    matchingAttributes.push(attr);\n  }\n\n  // If no matching attributes are found, throw an error because you are trying to add a hasMany\n  // attribute to a model where the association doesn't have a foreign key matching the collection.\n  if(matchingAttributes.length === 0) {\n    throw new Error('Trying to associate a collection attribute to a model that doesn\\'t have a ' +\n                    'Foreign Key. ' + parent + ' is trying to reference a foreign key in ' + collection);\n  }\n\n  // If multiple matching attributes were found on the model, ensure that the collection has a `via`\n  // key that describes which foreign key to use when populating.\n  if(matchingAttributes.length > 1) {\n    if(!hop(attribute, 'via')) {\n      throw new Error('Multiple foreign keys were found on ' + collection + '. You need to specify a ' +\n                      'foreign key to use by adding in the `via` property to the collection association');\n    }\n\n    // Find the collection attribute used in the `via` property\n    var via = false;\n    var viaName;\n\n    matchingAttributes.forEach(function(attr) {\n      if(attr !== attribute.via) return;\n      via = attributes[attr];\n      viaName = attr;\n    });\n\n    if(!via) {\n      throw new Error('No matching attribute was found on ' + collection + ' with the name ' + attribute.via);\n    }\n\n    reference = via.columnName || viaName;\n    return reference;\n  }\n\n  // If only a single matching attribute was found we can just use that for the reference\n  reference = attributes[matchingAttributes[0]].columnName || matchingAttributes[0];\n  return reference;\n\n};\n","/**\n * Dependencies\n */\n\nvar _ = require('lodash'),\n    types = require('./types'),\n    callbacks = require('./callbacks'),\n    hasOwnProperty = require('./helpers').object.hasOwnProperty;\n\n/**\n * Expose schema\n */\n\nvar schema = module.exports = exports;\n\n/**\n * Iterate over `attrs` normalizing string values to the proper\n * attribute object.\n *\n * Example:\n * {\n *   name: 'STRING',\n *   age: {\n *     type: 'INTEGER'\n *   }\n * }\n *\n * Returns:\n * {\n *   name: {\n *     type: 'string'\n *   },\n *   age: {\n *     type: 'integer'\n *   }\n * }\n *\n * @param {Object} attrs\n * @return {Object}\n */\n\nschema.normalizeAttributes = function(attrs) {\n  var attributes = {};\n\n  Object.keys(attrs).forEach(function(key) {\n\n    // Not concerned with functions\n    if(typeof attrs[key] === 'function') return;\n\n    // Expand shorthand type\n    if(typeof attrs[key] === 'string') {\n      attributes[key] = { type: attrs[key] };\n    } else {\n      attributes[key] = attrs[key];\n    }\n\n    // Ensure type is lower case\n    if(attributes[key].type && typeof attributes[key].type !== 'undefined') {\n      attributes[key].type = attributes[key].type.toLowerCase();\n    }\n\n    // Ensure Collection property is lowercased\n    if(hasOwnProperty(attrs[key], 'collection')) {\n      attrs[key].collection = attrs[key].collection.toLowerCase();\n    }\n\n    // Ensure Model property is lowercased\n    if(hasOwnProperty(attrs[key], 'model')) {\n      attrs[key].model = attrs[key].model.toLowerCase();\n    }\n  });\n\n  return attributes;\n};\n\n\n/**\n * Return all methods in `attrs` that should be provided\n * on the model.\n *\n * Example:\n * {\n *   name: 'string',\n *   email: 'string',\n *   doSomething: function() {\n *     return true;\n *   }\n * }\n *\n * Returns:\n * {\n *   doSomething: function() {\n *     return true;\n *   }\n * }\n *\n * @param {Object} attrs\n * @return {Object}\n */\n\nschema.instanceMethods = function(attrs) {\n  var methods = {};\n\n  if(!attrs) return methods;\n\n  Object.keys(attrs).forEach(function(key) {\n    if(typeof attrs[key] === 'function') {\n      methods[key] = attrs[key];\n    }\n  });\n\n  return methods;\n};\n\n\n/**\n * Normalize callbacks\n *\n * Return all callback functions in `context`, allows for string mapping to\n * functions located in `context.attributes`.\n *\n * Example:\n * {\n *   attributes: {\n *     name: 'string',\n *     email: 'string',\n *     increment: function increment() { i++; }\n *   },\n *   afterCreate: 'increment',\n *   beforeCreate: function() { return true; }\n * }\n *\n * Returns:\n * {\n *   afterCreate: [\n *     function increment() { i++; }\n *   ],\n *   beforeCreate: [\n *     function() { return true; }\n *   ]\n * }\n *\n * @param {Object} context\n * @return {Object}\n */\n\nschema.normalizeCallbacks = function(context) {\n  var i, _i, len, _len, fn, fns = {};\n\n  function defaultFn(fn) {\n    return function(values, next) { return next(); };\n  }\n\n  for(i = 0, len = callbacks.length; i < len; i = i + 1) {\n    fn = callbacks[i];\n\n    // Skip if the model hasn't defined this callback\n    if(typeof context[fn] === 'undefined') {\n      fns[fn] = [ defaultFn(fn) ];\n      continue;\n    }\n\n    if(Array.isArray(context[fn])) {\n      fns[fn] = [];\n\n      // Iterate over all functions\n      for(_i = 0, _len = context[fn].length; _i < _len; _i = _i + 1) {\n        if(typeof context[fn][_i] === 'string') {\n          // Attempt to map string to function\n          if(typeof context.attributes[context[fn][_i]] === 'function') {\n            fns[fn][_i] = context.attributes[context[fn][_i]];\n            delete context.attributes[context[fn][_i]];\n          } else {\n            throw new Error('Unable to locate callback `' + context[fn][_i] + '`');\n          }\n        } else {\n          fns[fn][_i] = context[fn][_i];\n        }\n      }\n    } else if(typeof context[fn] === 'string') {\n      // Attempt to map string to function\n      if(typeof context.attributes[context[fn]] === 'function') {\n        fns[fn] = [ context.attributes[context[fn]] ];\n        delete context.attributes[context[fn]];\n      } else {\n        throw new Error('Unable to locate callback `' + context[fn] + '`');\n      }\n    } else {\n      // Just add a single function\n      fns[fn] = [ context[fn] ];\n    }\n  }\n\n  return fns;\n};\n\n\n/**\n * Replace any Join Criteria references with the defined tableName for a collection.\n *\n * @param {Object} criteria\n * @param {Object} collections\n * @return {Object}\n * @api public\n */\n\nschema.serializeJoins = function(criteria, collections) {\n\n  if(!criteria.joins) return criteria;\n\n  var joins = _.cloneDeep(criteria.joins);\n\n  joins.forEach(function(join) {\n\n    if(!hasOwnProperty(collections[join.parent], 'tableName')) return;\n    if(!hasOwnProperty(collections[join.child], 'tableName')) return;\n\n    join.parent = collections[join.parent].tableName;\n    join.child = collections[join.child].tableName;\n\n  });\n\n  criteria.joins = joins;\n  return criteria;\n};\n","\n/**\n * Default Collection properties\n * @type {Object}\n */\nmodule.exports = {\n\t\n\tmigrate: 'alter'\n\t\n};","/**\n * Module dependencies\n */\n\nvar types = require('../utils/types'),\n    utils = require('../utils/helpers'),\n    hasOwnProperty = utils.object.hasOwnProperty,\n    _ = require('lodash');\n\n/**\n * Cast Types\n *\n * Will take values and cast they to the correct type based on the\n * type defined in the schema.\n *\n * Especially handy for converting numbers passed as strings to the\n * correct integer type.\n *\n * Should be run before sending values to an adapter.\n */\n\nvar Cast = module.exports = function() {\n  this._types = {};\n\n  return this;\n};\n\n/**\n * Builds an internal _types object that contains each\n * attribute with it's type. This can later be used to\n * transform values into the correct type.\n *\n * @param {Object} attrs\n */\n\nCast.prototype.initialize = function(attrs) {\n  var self = this;\n\n  Object.keys(attrs).forEach(function(key) {\n    self._types[key] = ~types.indexOf(attrs[key].type) ? attrs[key].type : 'string';\n  });\n};\n\n/**\n * Converts a set of values into the proper types\n * based on the Collection's schema.\n *\n * @param {Object} values\n * @return {Object}\n * @api public\n */\n\nCast.prototype.run = function(values) {\n  var self = this;\n\n  Object.keys(values).forEach(function(key) {\n\n    // Set undefined to null\n    if(_.isUndefined(values[key])) values[key] = null;\n    if(!hasOwnProperty(self._types, key) || values[key] === null || !hasOwnProperty(values, key)) {\n      return;\n    }\n\n    // If the value is a plain object, don't attempt to cast it\n    if(_.isPlainObject(values[key])) return;\n\n    // Find the value's type\n    var type = self._types[key];\n\n    // Casting Function\n    switch(type) {\n      case 'string':\n      case 'text':\n        values[key] = self.string(values[key]);\n        break;\n\n      case 'integer':\n        values[key] = self.integer(key, values[key]);\n        break;\n\n      case 'float':\n        values[key] = self.float(values[key]);\n        break;\n\n      case 'date':\n      case 'time':\n      case 'datetime':\n        values[key] = self.date(values[key]);\n        break;\n\n      case 'boolean':\n        values[key] = self.boolean(values[key]);\n        break;\n\n      case 'array':\n        values[key] = self.array(values[key]);\n        break;\n    }\n  });\n\n  return values;\n};\n\n/**\n * Cast String Values\n *\n * @param {String} str\n * @return {String}\n * @api private\n */\n\nCast.prototype.string = function string(str) {\n  return typeof str.toString !== 'undefined' ? str.toString() : '' + str;\n};\n\n/**\n * Cast Integer Values\n *\n * @param {String} key\n * @param {Integer} value\n * @return {Integer}\n * @api private\n */\n\nCast.prototype.integer = function integer(key, value) {\n  var _value;\n\n  // Attempt to see if the value is resembles a MongoID\n  // if so let's not try and cast it and instead return a string representation of\n  // it. Needed for sails-mongo.\n  if(utils.matchMongoId(value)) return value.toString();\n\n  // Attempt to parseInt\n  try {\n    _value = parseInt(value, 10);\n  } catch(e) {\n    return value;\n  }\n\n  return _value;\n};\n\n/**\n * Cast Float Values\n *\n * @param {Float} value\n * @return {Float}\n * @api private\n */\n\nCast.prototype.float = function float(value) {\n  var _value;\n\n  try {\n    _value = parseFloat(value);\n  } catch(e) {\n    return value;\n  }\n\n  return _value;\n};\n\n/**\n * Cast Boolean Values\n *\n * @param {Boolean} value\n * @return {Boolean}\n * @api private\n */\n\nCast.prototype.boolean = function boolean(value) {\n  var parsed;\n\n  if(_.isString(value)) {\n    if(value === \"true\") return true;\n    if(value === \"false\") return false;\n    return false;\n  }\n\n  // Nicely cast [0, 1] to true and false\n  try {\n    parsed = parseInt(value, 10);\n  } catch(e) {\n    return false;\n  }\n\n  if(parsed === 0) return false;\n  if(parsed === 1) return true;\n\n  if(value === true || value === false) return value;\n\n  return false;\n};\n\n/**\n * Cast Date Values\n *\n * @param {String|Date} value\n * @return {Date}\n * @api private\n */\n\nCast.prototype.date = function date(value) {\n  var _value;\n  if (value.__proto__ == Date.prototype) {\n    _value = new Date(value.getTime());\n  }\n  else {\n    _value = new Date(Date.parse(value));\n  }\n\n  if(_value.toString() === 'Invalid Date') return value;\n  return _value;\n};\n\n/**\n * Cast Array Values\n *\n * @param {Array|String} value\n * @return {Array}\n * @api private\n */\n\nCast.prototype.array = function array(value) {\n  if(Array.isArray(value)) return value;\n  return [value];\n};\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash'),\n    types = require('../utils/types'),\n    utils = require('../utils/helpers'),\n    hasOwnProperty = utils.object.hasOwnProperty;\n\n/**\n * Builds a Schema Object from an attributes\n * object in a model.\n *\n * Loops through an attributes object to build a schema\n * containing attribute name as key and a type for casting\n * in the database. Also includes a default value if supplied.\n *\n * Example:\n *\n * attributes: {\n *   name: 'string',\n *   phone: {\n *     type: 'string',\n *     defaultsTo: '555-555-5555'\n *   }\n * }\n *\n * Returns: {\n *   name: { type: 'string' },\n *   phone: { type: 'string, defaultsTo: '555-555-5555' }\n * }\n *\n * @param {Object} context\n * @return {Object}\n */\n\nvar Schema = module.exports = function(context) {\n  this.context = context || {};\n  this.schema = {};\n\n  return this;\n};\n\n/**\n * Initialize the internal schema object\n *\n * @param {Object} attrs\n * @param {Object} associations\n * @param {Boolean} hasSchema\n */\n\nSchema.prototype.initialize = function(attrs, hasSchema, reservedAttributes) {\n  var self = this;\n\n  // Build normal attributes\n  Object.keys(attrs).forEach(function(key) {\n    if(hasOwnProperty(attrs[key], 'collection')) return;\n    self.schema[key] = self.objectAttribute(attrs[key]);\n  });\n\n  // Build Reserved Attributes\n  if(Array.isArray(reservedAttributes)) {\n    reservedAttributes.forEach(function(key) {\n      self.schema[key] = {};\n    });\n  }\n\n  // Set hasSchema to determine if values should be cleansed or not\n  this.hasSchema = typeof hasSchema !== 'undefined' ? hasSchema : true;\n};\n\n/**\n * Handle the building of an Object attribute\n *\n * Cleans any unnecessary attributes such as validation properties off of\n * the internal schema and set's defaults for incorrect values.\n *\n * @param {Object} value\n * @return {Object}\n */\n\nSchema.prototype.objectAttribute = function(value) {\n  var attr = {};\n\n  for(var key in value) {\n    switch(key) {\n\n      // Set schema[attribute].type\n      case 'type':\n        // Allow validation types in attributes and transform them to strings\n        attr.type = ~types.indexOf(value[key]) ? value[key] : 'string';\n        break;\n\n      // Set schema[attribute].defaultsTo\n      case 'defaultsTo':\n        attr.defaultsTo = value[key];\n        break;\n\n      // Set schema[attribute].primaryKey\n      case 'primaryKey':\n        attr.primaryKey = value[key];\n        attr.unique = true;\n        break;\n\n      // Set schema[attribute].foreignKey\n      case 'foreignKey':\n        attr.foreignKey = value[key];\n        break;\n\n      // Set schema[attribute].references\n      case 'references':\n        attr.references = value[key];\n        break;\n\n      // Set schema[attribute].on\n      case 'on':\n        attr.on = value[key];\n        break;\n\n      // Set schema[attribute].via\n      case 'via':\n        attr.via = value[key];\n        break;\n\n      // Set schema[attribute].autoIncrement\n      case 'autoIncrement':\n        attr.autoIncrement = value[key];\n        attr.type = 'integer';\n        break;\n\n      // Set schema[attribute].unique\n      case 'unique':\n        attr.unique = value[key];\n        break;\n\n      // Set schema[attribute].index\n      case 'index':\n        attr.index = value[key];\n        break;\n\n      // Set schema[attribute].enum\n      case 'enum':\n        attr.enum = value[key];\n        break;\n\n      // Set schema[attribute].size\n      case 'size':\n        attr.size = value[key];\n        break;\n\n      // Handle Belongs To Attributes\n      case 'model':\n        var type;\n        var attrs = this.context.waterline.schema[value[key].toLowerCase()].attributes;\n\n        for(var attribute in attrs) {\n          if(!hasOwnProperty(attrs[attribute], 'primaryKey')) continue;\n          type = attrs[attribute].type;\n        }\n\n        attr.type = type.toLowerCase();\n        attr.model = value[key].toLowerCase();\n        attr.foreignKey = true;\n        break;\n    }\n  }\n\n  return attr;\n};\n\n\n/**\n * Clean Values\n *\n * Takes user inputted data and strips out any values not defined in\n * the schema.\n *\n * This is run after all the validations and right before being sent to the\n * adapter. This allows you to add temporary properties when doing validation\n * callbacks and have them stripped before being sent to the database.\n *\n * @param {Object} values to clean\n * @return {Object} clone of values, stripped of any extra properties\n */\n\nSchema.prototype.cleanValues = function(values) {\n  var clone = {};\n\n  // Return if hasSchema === false\n  if(!this.hasSchema) return values;\n\n  for(var key in values) {\n    if(hasOwnProperty(this.schema, key)) clone[key] = values[key];\n  }\n\n  return clone;\n};\n","/**\n * Module Dependencies\n */\n\nvar _ = require('lodash');\n\n/**\n * Handle Building an Adapter/Connection dictionary\n *\n * @param {Object} connections\n * @param {Array} ordered\n * @return {Object}\n * @api public\n */\n\nvar Dictionary = module.exports = function(connections, ordered) {\n\n  // Build up a dictionary of methods for the collection's adapters and which connection\n  // they will run on.\n  this.dictionary = {};\n\n  // Build the Dictionary\n  this._build(connections);\n\n  // Smash together Dictionary methods into a single level\n  var dictionary = this._smash(ordered);\n\n  return dictionary;\n};\n\n/**\n * Build Dictionary\n *\n * @param {Object} connections\n * @api private\n */\n\nDictionary.prototype._build = function _build(connections) {\n  var self = this;\n\n  Object.keys(connections).forEach(function(conn) {\n    var connection = connections[conn];\n    var methods = {};\n    var adapter = connection._adapter || {};\n\n    Object.keys(adapter).forEach(function(key) {\n      methods[key] = conn;\n    });\n\n    self.dictionary[conn] = _.cloneDeep(methods);\n  });\n\n};\n\n/**\n * Combine Dictionary into a single level object.\n *\n * Appends methods from other adapters onto the left most connection adapter.\n *\n * @param {Array} ordered\n * @return {Object}\n * @api private\n */\n\nDictionary.prototype._smash = function _smash(ordered) {\n  var self = this;\n\n  // Ensure Ordered is defined\n  ordered = ordered || [];\n\n  // Smash the methods together into a single layer object using the lodash merge\n  // functionality.\n  var adapter = {};\n\n  // Reverse the order of connections so we will start at the end merging objects together\n  ordered.reverse();\n\n  ordered.forEach(function(adapterName) {\n    adapter = _.merge(adapter, self.dictionary[adapterName]);\n  });\n\n  return adapter;\n};\n","/**\n * Handles validation on a model\n *\n * Uses Anchor for validating\n * https://github.com/balderdashy/anchor\n */\n\nvar _ = require('lodash');\nvar anchor = require('anchor');\nvar async = require('async');\nvar utils = require('../utils/helpers');\nvar hasOwnProperty = utils.object.hasOwnProperty;\nvar WLValidationError = require('../error/WLValidationError');\n\n\n\n\n/**\n * Build up validations using the Anchor module.\n *\n * @param {String} adapter\n */\n\nvar Validator = module.exports = function(adapter) {\n  this.validations = {};\n};\n\n/**\n * Builds a Validation Object from a normalized attributes\n * object.\n *\n * Loops through an attributes object to build a validation object\n * containing attribute name as key and a series of validations that\n * are run on each model. Skips over type and defaultsTo as they are\n * schema properties.\n *\n * Example:\n *\n * attributes: {\n *   name: {\n *     type: 'string',\n *     length: { min: 2, max: 5 }\n *   }\n *   email: {\n *     type: 'string',\n *     required: true\n *   }\n * }\n *\n * Returns: {\n *   name: { length: { min:2, max: 5 }},\n *   email: { required: true }\n * }\n */\n\nValidator.prototype.initialize = function(attrs, types) {\n  var self = this;\n\n  // add custom type definitions to anchor\n  types = types || {};\n  anchor.define(types);\n\n  Object.keys(attrs).forEach(function(attr) {\n    self.validations[attr] = {};\n\n    Object.keys(attrs[attr]).forEach(function(prop) {\n\n      // Ignore null values\n      if(attrs[attr][prop] === null) return;\n\n      // If property is reserved don't do anything with it\n      if(['defaultsTo', 'primaryKey', 'autoIncrement', 'unique', 'index', 'collection', 'dominant',\n          'columnName', 'foreignKey', 'references', 'on', 'groupKey', 'model', 'via', 'size',\n          'example', 'validationMessage', 'validations', 'populateSettings'].indexOf(prop) > -1) return;\n\n      // use the Anchor `in` method for enums\n      if(prop === 'enum') {\n        self.validations[attr]['in'] = attrs[attr][prop];\n        return;\n      }\n\n      self.validations[attr][prop] = attrs[attr][prop];\n    });\n  });\n};\n\n/**\n * Validate\n *\n * Accepts an object of values and runs them through the\n * schema's validations using Anchor.\n *\n * @param {Object} values to check\n * @param {Boolean} presentOnly only validate present values\n * @param {Function} callback\n * @return Array of errors\n */\n\nValidator.prototype.validate = function(values, presentOnly, cb) {\n  var self = this,\n      errors = {},\n      validations = Object.keys(this.validations);\n\n  // Handle optional second arg\n  if(typeof presentOnly === 'function') {\n    cb = presentOnly;\n  }\n  // Use present values only or all validations\n  else if(presentOnly) {\n    validations = _.intersection(validations, Object.keys(values));\n  }\n\n  function validate(validation, cb) {\n    var curValidation = self.validations[validation];\n\n    // Build Requirements\n    var requirements = anchor(curValidation);\n\n    // Grab value and set to null if undefined\n    var value = values[validation];\n    if(typeof value == 'undefined') value = null;\n\n    // If value is not required and empty then don't\n    // try and validate it\n    if(!curValidation.required) {\n      if(value === null || value === '') return cb();\n    }\n\n    // If Boolean and required manually check\n    if(curValidation.required && curValidation.type === 'boolean' && (typeof value !== 'undefined' && value !== null)) {\n      if(value.toString() == 'true' || value.toString() == 'false') return cb();\n    }\n\n    // If type is integer and the value matches a mongoID let it validate\n    if(hasOwnProperty(self.validations[validation], 'type') && self.validations[validation].type === 'integer') {\n      if(utils.matchMongoId(value)) return cb();\n    }\n\n    // Rule values may be specified as sync or async functions.\n    // Call them and replace the rule value with the function's result\n    // before running validations.\n    async.each( Object.keys(requirements.data), function (key, cb) {\n      if (typeof requirements.data[key] !== 'function') return cb();\n\n      // Run synchronous function\n      if (requirements.data[key].length < 1) {\n        requirements.data[key] = requirements.data[key].apply(values, []);\n        return cb();\n      }\n\n      // Run async function\n      requirements.data[key].call(values, function (result) {\n        requirements.data[key] = result;\n        cb();\n      });\n    }, function() {\n\n      // Validate with Anchor\n      var err = anchor(value).to(requirements.data, values);\n\n      // If No Error return\n      if(!err) return cb();\n\n      // Build an Error Object\n      errors[validation] = [];\n\n      err.forEach(function(obj) {\n        if(obj.property) delete obj.property;\n        errors[validation].push({ rule: obj.rule, message: obj.message });\n      });\n\n      return cb();\n    });\n\n  }\n\n  // Validate all validations in parallel\n  async.each(validations, validate, function allValidationsChecked () {\n    if(Object.keys(errors).length === 0) return cb();\n\n    cb(errors);\n  });\n\n};\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash'),\n    utils = require('../utils/helpers'),\n    hasOwnProperty = utils.object.hasOwnProperty;\n\n/**\n * Transformation\n *\n * Allows for a Waterline Collection to have different\n * attributes than what actually exist in an adater's representation.\n *\n * @param {Object} attributes\n * @param {Object} tables\n */\n\nvar Transformation = module.exports = function(attributes, tables) {\n\n  // Hold an internal mapping of keys to transform\n  this._transformations = {};\n\n  // Initialize\n  this.initialize(attributes, tables);\n\n  return this;\n};\n\n/**\n * Initial mapping of transformations.\n *\n * @param {Object} attributes\n * @param {Object} tables\n */\n\nTransformation.prototype.initialize = function(attributes, tables) {\n  var self = this;\n\n  Object.keys(attributes).forEach(function(attr) {\n\n    // Ignore Functions and Strings\n    if(['function', 'string'].indexOf(typeof attributes[attr]) > -1) return;\n\n    // If not an object, ignore\n    if(attributes[attr] !== Object(attributes[attr])) return;\n\n    // Loop through an attribute and check for transformation keys\n    Object.keys(attributes[attr]).forEach(function(key) {\n\n      // Currently just works with `columnName`, `collection`, `groupKey`\n      if(key !== 'columnName') return;\n\n      // Error if value is not a string\n      if(typeof attributes[attr][key] !== 'string') {\n        throw new Error('columnName transformation must be a string');\n      }\n\n      // Set transformation attr to new key\n      if(key === 'columnName') {\n        if(attr === attributes[attr][key]) return;\n        self._transformations[attr] = attributes[attr][key];\n      }\n\n    });\n  });\n};\n\n/**\n * Transforms a set of attributes into a representation used\n * in an adapter.\n *\n * @param {Object} attributes to transform\n * @return {Object}\n */\n\nTransformation.prototype.serialize = function(attributes) {\n  var self = this,\n      values = _.clone(attributes);\n\n  function recursiveParse(obj) {\n\n    // Return if no object\n    if(!obj) return;\n\n    // Handle array of types for findOrCreateEach\n    if(typeof obj === 'string') {\n      if(hasOwnProperty(self._transformations, obj)) {\n        values = self._transformations[obj];\n        return;\n      }\n\n      return;\n    }\n\n    Object.keys(obj).forEach(function(property) {\n\n      // Just a double check to exit if hasOwnProperty fails\n      if(!hasOwnProperty(obj, property)) return;\n\n      // Recursively parse `OR` criteria objects to transform keys\n      if(Array.isArray(obj[property]) && property === 'or') return recursiveParse(obj[property]);\n\n      // If Nested Object call function again passing the property as obj\n      if((toString.call(obj[property]) !== '[object Date]') && (_.isPlainObject(obj[property]))) {\n\n        // check if object key is in the transformations\n        if(hasOwnProperty(self._transformations, property)) {\n          obj[self._transformations[property]] = _.clone(obj[property]);\n          delete obj[property];\n\n          return recursiveParse(obj[self._transformations[property]]);\n        }\n\n        return recursiveParse(obj[property]);\n      }\n\n      // Check if property is a transformation key\n      if(hasOwnProperty(self._transformations, property)) {\n\n        obj[self._transformations[property]] = obj[property];\n        delete obj[property];\n      }\n    });\n  }\n\n  // Recursivly parse attributes to handle nested criteria\n  recursiveParse(values);\n\n  return values;\n};\n\n/**\n * Transforms a set of attributes received from an adapter\n * into a representation used in a collection.\n *\n * @param {Object} attributes to transform\n * @return {Object}\n */\n\nTransformation.prototype.unserialize = function(attributes) {\n  var self = this,\n      values = _.clone(attributes);\n\n  // Loop through the attributes and change them\n  Object.keys(this._transformations).forEach(function(key) {\n    var transformed = self._transformations[key];\n\n    if(!hasOwnProperty(attributes, transformed)) return;\n\n    values[key] = attributes[transformed];\n    if(transformed !== key) delete values[transformed];\n  });\n\n  return values;\n};\n","/**\n * Mixes Custom Non-CRUD Adapter Methods into the prototype.\n */\n\nmodule.exports = function() {\n  var self = this;\n\n  Object.keys(this.connections).forEach(function(conn) {\n\n    var adapter = self.connections[conn]._adapter || {};\n\n    Object.keys(adapter).forEach(function(key) {\n\n      // Ignore the Identity Property\n      if(['identity', 'tableName'].indexOf(key) >= 0) return;\n\n      // Don't override keys that already exists\n      if(self[key]) return;\n\n      // Don't override a property, only functions\n      if(typeof adapter[key] != 'function')  {\n\t\t\t\tself[key] = adapter[key];\n\t\t\t\treturn;\n\t\t\t}\n\n      // Apply the Function with passed in args and set this.identity as\n      // the first argument\n      self[key] = function() {\n\n        var tableName = self.tableName || self.identity;\n\n        // Concat self.identity with args (must massage arguments into a proper array)\n        // Use a normalized _tableName set in the core module.\n        var args = [conn, tableName].concat(Array.prototype.slice.call(arguments));\n        adapter[key].apply(self, args);\n      };\n    });\n  });\n\n};\n","/**\n * Validation\n *\n * Used in create and update methods validate a model\n * Can also be used independently\n */\n\nvar _ = require('lodash'),\n    async = require('async');\n\nmodule.exports = {\n\n  validate: function(values, presentOnly, cb) {\n    var self = this;\n\n    //Handle optional second arg\n    if (typeof presentOnly === 'function') {\n      cb = presentOnly;\n    }\n\n    async.series([\n\n      // Run Before Validate Lifecycle Callbacks\n      function(cb) {\n        var runner = function(item, callback) {\n          item(values, function(err) {\n            if(err) return callback(err);\n            callback();\n          });\n        };\n\n        async.eachSeries(self._callbacks.beforeValidate, runner, function(err) {\n          if(err) return cb(err);\n          cb();\n        });\n      },\n\n      // Run Validation\n      function(cb) {\n        self._validator.validate(values, presentOnly === true, function(invalidAttributes) {\n\n          // Create validation error here\n          // (pass in the invalid attributes as well as the collection's globalId)\n          if(invalidAttributes) return cb(new WLValidationError({\n            invalidAttributes: invalidAttributes,\n            model: self.globalId\n          }));\n\n          cb();\n        });\n      },\n\n      // Run After Validate Lifecycle Callbacks\n      function(cb) {\n        var runner = function(item, callback) {\n          item(values, function(err) {\n            if(err) return callback(err);\n            callback();\n          });\n        };\n\n        async.eachSeries(self._callbacks.afterValidate, runner, function(err) {\n          if(err) return cb(err);\n          cb();\n        });\n      }\n\n    ], function(err) {\n      if(err) return cb(err);\n      cb();\n    });\n  }\n\n}\n","/**\n * DDL Queries\n */\n\nmodule.exports = {\n\n  /**\n   * Describe a collection\n   */\n\n  describe: function(cb) {\n    this.adapter.describe(cb);\n  },\n\n  /**\n   * Alter a table/set/etc\n   */\n\n  alter: function(attributes, cb) {\n    this.adapter.alter(attributes, cb);\n  },\n\n  /**\n   * Drop a table/set/etc\n   */\n\n  drop: function(cb) {\n    this.adapter.drop(cb);\n  }\n\n};\n","/**\n * Aggregate Queries\n */\n\nvar async = require('async'),\n    _ = require('lodash'),\n    usageError = require('../utils/usageError'),\n    utils = require('../utils/helpers'),\n    normalize = require('../utils/normalize'),\n    callbacks = require('../utils/callbacksRunner'),\n    Deferred = require('./deferred'),\n    hasOwnProperty = utils.object.hasOwnProperty;\n\nmodule.exports = {\n\n  /**\n   * Create an Array of records\n   *\n   * @param {Array} array of values to create\n   * @param {Function} callback\n   * @return Deferred object if no callback\n   */\n\n  createEach: function(valuesList, cb) {\n    var self = this;\n\n    // Handle Deferred where it passes criteria first\n    if(arguments.length === 3) {\n      var args = Array.prototype.slice.call(arguments);\n      cb = args.pop();\n      valuesList = args.pop();\n    }\n\n    // Return Deferred or pass to adapter\n    if(typeof cb !== 'function') {\n      return new Deferred(this, this.createEach, {}, valuesList);\n    }\n\n    // Validate Params\n    var usage = utils.capitalize(this.identity) + '.createEach(valuesList, callback)';\n\n    if(!valuesList) return usageError('No valuesList specified!', usage, cb);\n    if(!Array.isArray(valuesList)) return usageError('Invalid valuesList specified (should be an array!)', usage, cb);\n    if(typeof cb !== 'function') return usageError('Invalid callback specified!', usage, cb);\n\n    var errStr = _validateValues(valuesList);\n    if(errStr) return usageError(errStr, usage, cb);\n\n    var records = [];\n\n    function create(value, next) {\n      self.create(value, function(err, record) {\n        if(err) return next(err);\n        records.push(record);\n        next();\n      });\n    }\n\n    async.each(valuesList, create, function(err) {\n      if(err) return cb(err);\n      cb(null, records);\n    });\n  },\n\n  /**\n   * Iterate through a list of objects, trying to find each one\n   * For any that don't exist, create them\n   *\n   * @param {Object} criteria\n   * @param {Array} valuesList\n   * @param {Function} callback\n   * @return Deferred object if no callback\n   */\n\n  findOrCreateEach: function(criteria, valuesList, cb) {\n    var self = this;\n\n    if(typeof valuesList === 'function') {\n      cb = valuesList;\n      valuesList = null;\n    }\n\n    // Normalize criteria\n    criteria = normalize.criteria(criteria);\n\n    // Return Deferred or pass to adapter\n    if(typeof cb !== 'function') {\n      return new Deferred(this, this.findOrCreateEach, criteria, valuesList);\n    }\n\n    // Validate Params\n    var usage = utils.capitalize(this.identity) + '.findOrCreateEach(criteria, valuesList, callback)';\n\n    if(typeof cb !== 'function') return usageError('Invalid callback specified!', usage, cb);\n    if(!criteria) return usageError('No criteria specified!', usage, cb);\n    if(!Array.isArray(criteria)) return usageError('No criteria specified!', usage, cb);\n    if(!valuesList) return usageError('No valuesList specified!', usage, cb);\n    if(!Array.isArray(valuesList)) return usageError('Invalid valuesList specified (should be an array!)', usage, cb);\n\n    var errStr = _validateValues(valuesList);\n    if(errStr) return usageError(errStr, usage, cb);\n\n    // Validate each record in the array and if all are valid\n    // pass the array to the adapter's findOrCreateEach method\n    async.each(valuesList, function(item, next) { _validate.call(self, item, next); }, function(err) {\n      if(err) return cb(err);\n\n      // Transform Values\n      var transformedValues = [];\n\n      valuesList.forEach(function(value) {\n\n        // Transform values\n        value = self._transformer.serialize(value);\n\n        // Clean attributes\n        value = self._schema.cleanValues(value);\n        transformedValues.push(value);\n      });\n\n      // Set values array to the transformed array\n      valuesList = transformedValues;\n\n      // Transform Search Criteria\n      var transformedCriteria = [];\n\n      criteria.forEach(function(value) {\n        value = self._transformer.serialize(value);\n        transformedCriteria.push(value);\n      });\n\n      // Set criteria array to the transformed array\n      criteria = transformedCriteria;\n\n      // Pass criteria and attributes to adapter definition\n      self.adapter.findOrCreateEach(criteria, valuesList, function(err, values) {\n        if(err) return cb(err);\n\n        // Unserialize Values\n        var unserializedValues = [];\n\n        values.forEach(function(value) {\n          value = self._transformer.unserialize(value);\n          unserializedValues.push(value);\n        });\n\n        // Set values array to the transformed array\n        values = unserializedValues;\n\n        // Run AfterCreate Callbacks\n        async.each(values, function(item, next) {\n          callbacks.afterCreate(self, item, next);\n        }, function(err) {\n          if(err) return cb(err);\n\n          var models = [];\n\n          // Make each result an instance of model\n          values.forEach(function(value) {\n            models.push(new self._model(value));\n          });\n\n          cb(null, models);\n        });\n      });\n    });\n  }\n};\n\n\n/**\n * Validate valuesList\n *\n * @param {Array} valuesList\n * @return {String}\n * @api private\n */\n\nfunction _validateValues(valuesList) {\n  var err;\n\n  for(var i=0; i < valuesList.length; i++) {\n    if(valuesList[i] !== Object(valuesList[i])) {\n      err = 'Invalid valuesList specified (should be an array of valid values objects!)';\n    }\n  }\n\n  return err;\n}\n\n\n/**\n * Validate values and add in default values\n *\n * @param {Object} record\n * @param {Function} cb\n * @api private\n */\n\nfunction _validate(record, cb) {\n  var self = this;\n\n  // Set Default Values if available\n  for(var key in self.attributes) {\n    if(!record[key] && record[key] !== false && hasOwnProperty(self.attributes[key], 'defaultsTo')) {\n      var defaultsTo = self.attributes[key].defaultsTo;\n      record[key] = typeof defaultsTo === 'function' ? defaultsTo.call(record) : _.clone(defaultsTo);\n    }\n  }\n\n  // Cast values to proper types (handle numbers as strings)\n  record = self._cast.run(record);\n\n  async.series([\n\n    // Run Validation with Validation LifeCycle Callbacks\n    function(next) {\n      callbacks.validate(self, record, true, next);\n    },\n\n    // Before Create Lifecycle Callback\n    function(next) {\n      callbacks.beforeCreate(self, record, next);\n    }\n\n  ], function(err) {\n    if(err) return cb(err);\n\n    // Automatically add updatedAt and createdAt (if enabled)\n    if (self.autoCreatedAt) record.createdAt = new Date();\n    if (self.autoUpdatedAt) record.updatedAt = new Date();\n\n    cb();\n  });\n}\n","/**\n * Composite Queries\n */\n\nvar async = require('async'),\n    _ = require('lodash'),\n    usageError = require('../utils/usageError'),\n    utils = require('../utils/helpers'),\n    normalize = require('../utils/normalize'),\n    Deferred = require('./deferred'),\n    hasOwnProperty = utils.object.hasOwnProperty;\n\nmodule.exports = {\n\n  /**\n   * Find or Create a New Record\n   *\n   * @param {Object} search criteria\n   * @param {Object} values to create if no record found\n   * @param {Function} callback\n   * @return Deferred object if no callback\n   */\n\n  findOrCreate: function(criteria, values, cb) {\n    var self = this;\n\n    if(typeof values === 'function') {\n      cb = values;\n      values = null;\n    }\n\n    // If no criteria is specified, bail out with a vengeance.\n    var usage = utils.capitalize(this.identity) + '.findOrCreate([criteria], values, callback)';\n    if(typeof cb == 'function' && !criteria) {\n      return usageError('No criteria option specified!', usage, cb);\n    }\n\n    // Normalize criteria\n    criteria = normalize.criteria(criteria);\n\n    // Return Deferred or pass to adapter\n    if(typeof cb !== 'function') {\n      return new Deferred(this, this.findOrCreate, criteria, values);\n    }\n\n    // This is actually an implicit call to findOrCreateEach\n    if(Array.isArray(criteria) && Array.isArray(values)) {\n      return this.findOrCreateEach(criteria, values, cb);\n    }\n\n    if(typeof cb !== 'function') return usageError('Invalid callback specified!', usage, cb);\n\n    // Try a find first.\n    this.find(criteria).exec(function(err, results) {\n      if (err) return cb(err);\n\n      if (results && results.length !== 0) {\n\n        // Unserialize values\n        results = self._transformer.unserialize(results[0]);\n\n        // Return an instance of Model\n        var model = new self._model(results);\n        return cb(null, model);\n      }\n\n      // Create a new record if nothing is found.\n      self.create(values).exec(function(err, result) {\n        if(err) return cb(err);\n        return cb(null, result);\n      });\n    });\n  }\n\n};\n","/**\n * Basic Finder Queries\n */\n\nvar usageError = require('../../utils/usageError'),\n    utils = require('../../utils/helpers'),\n    normalize = require('../../utils/normalize'),\n    sorter = require('../../utils/sorter'),\n    Deferred = require('../deferred'),\n    Joins = require('./joins'),\n    Operations = require('./operations'),\n    Integrator = require('../integrator'),\n    waterlineCriteria = require('waterline-criteria'),\n    _ = require('lodash'),\n    async = require('async'),\n    hasOwnProperty = utils.object.hasOwnProperty;\n\nmodule.exports = {\n\n  /**\n   * Find a single record that meets criteria\n   *\n   * @param {Object} criteria to search\n   * @param {Function} callback\n   * @return Deferred object if no callback\n   */\n\n  findOne: function(criteria, cb) {\n    var self = this;\n\n    if(typeof criteria === 'function') {\n      cb = criteria;\n      criteria = null;\n    }\n\n    // Check if criteria is an integer or string and normalize criteria\n    // to object, using the specified primary key field.\n    criteria = normalize.expandPK(self, criteria);\n\n    // Normalize criteria\n    criteria = normalize.criteria(criteria);\n\n    // Return Deferred or pass to adapter\n    if(typeof cb !== 'function') {\n      return new Deferred(this, this.findOne, criteria);\n    }\n\n    // Transform Search Criteria\n    criteria = self._transformer.serialize(criteria);\n\n    // If there was something defined in the criteria that would return no results, don't even\n    // run the query and just return an empty result set.\n    if(criteria === false) {\n      return cb(null, null);\n    }\n\n    // Build up an operations set\n    var operations = new Operations(self, criteria, 'findOne');\n\n    // Run the operations\n    operations.run(function(err, values) {\n      if(err) return cb(err);\n      if(!values.cache) return cb();\n\n      // If no joins are used grab the only item from the cache and pass to the returnResults\n      // function.\n      if(!criteria.joins) {\n        values = values.cache[self.identity];\n        return returnResults(values);\n      }\n\n      // If the values are already combined, return the results\n      if(values.combined) {\n        return returnResults(values.cache[self.identity]);\n      }\n\n      // Find the primaryKey of the current model so it can be passed down to the integrator.\n      // Use 'id' as a good general default;\n      var primaryKey = 'id';\n\n      Object.keys(self._schema.schema).forEach(function(key) {\n        if(self._schema.schema[key].hasOwnProperty('primaryKey')) primaryKey = key;\n      });\n\n\n      // Perform in-memory joins\n      Integrator(values.cache, criteria.joins, primaryKey, function(err, results) {\n        if(err) return cb(err);\n        if(!results) return cb();\n\n        // We need to run one last check on the results using the criteria. This allows a self\n        // association where we end up with two records in the cache both having each other as\n        // embedded objects and we only want one result. However we need to filter any join criteria\n        // out of the top level where query so that searchs by primary key still work.\n        var tmpCriteria = _.cloneDeep(criteria.where);\n        if(!tmpCriteria) tmpCriteria = {};\n\n        criteria.joins.forEach(function(join) {\n          if(!hasOwnProperty(join, 'alias')) return;\n\n          // Check for `OR` criteria\n          if(hasOwnProperty(tmpCriteria, 'or')) {\n            tmpCriteria.or.forEach(function(search) {\n              if(!hasOwnProperty(search, join.alias)) return;\n              delete search[join.alias];\n            });\n            return;\n          }\n\n          if(!hasOwnProperty(tmpCriteria, join.alias)) return;\n          delete tmpCriteria[join.alias];\n        });\n\n        // Pass results into Waterline-Criteria\n        var _criteria = { where: tmpCriteria };\n        results = waterlineCriteria('parent', { parent: results }, _criteria).results;\n\n        // Serialize values coming from an in-memory join before modelizing\n        var _results = [];\n        results.forEach(function(res) {\n\n          // Go Ahead and perform any sorts on the associated data\n          criteria.joins.forEach(function(join) {\n            if(!join.criteria) return;\n            var c = normalize.criteria(join.criteria);\n            if(!c.sort) return;\n\n            var alias = join.alias;\n            res[alias] = sorter(res[alias], c.sort);\n          });\n\n          var val = self._transformer.serialize(res);\n          _results.push(val);\n        });\n\n        returnResults(_results);\n      });\n\n      function returnResults(results) {\n\n        if(!results) return cb();\n\n        // Normalize results to an array\n        if(!Array.isArray(results) && results) results = [results];\n\n        // Unserialize each of the results before attempting any join logic on them\n        var unserializedModels = [];\n        results.forEach(function(result) {\n          unserializedModels.push(self._transformer.unserialize(result));\n        });\n\n        var models = [];\n        var joins = criteria.joins ? criteria.joins : [];\n        var data = new Joins(joins, unserializedModels, self._schema.schema, self.waterline.collections);\n\n        // If `data.models` is invalid (not an array) return early to avoid getting into trouble.\n        if (!data || !data.models || !data.models.forEach) {\n          return cb(new Error('Values returned from operations set are not an array...'));\n        }\n\n        // Create a model for the top level values\n        data.models.forEach(function(model) {\n          models.push(new self._model(model, data.options));\n        });\n\n        cb(null, models[0]);\n      }\n    });\n  },\n\n  /**\n   * Find All Records that meet criteria\n   *\n   * @param {Object} search criteria\n   * @param {Object} options\n   * @param {Function} callback\n   * @return Deferred object if no callback\n   */\n\n  find: function(criteria, options, cb) {\n    var self = this;\n\n    var usage = utils.capitalize(this.identity) + '.find([criteria],[options]).exec(callback|switchback)';\n\n    if(typeof criteria === 'function') {\n      cb = criteria;\n      criteria = null;\n      options = null;\n    }\n\n    if(typeof options === 'function') {\n      cb = options;\n      options = null;\n    }\n\n    // Check if criteria is an integer or string and normalize criteria\n    // to object, using the specified primary key field.\n    criteria = normalize.expandPK(self, criteria);\n\n    // Normalize criteria\n    criteria = normalize.criteria(criteria);\n\n    // Validate Arguments\n    if(typeof criteria === 'function' || typeof options === 'criteria') {\n      return usageError('Invalid options specified!', usage, cb);\n    }\n\n    // Return Deferred or pass to adapter\n    if(typeof cb !== 'function') {\n      return new Deferred(this, this.find, criteria);\n    }\n\n    // If there was something defined in the criteria that would return no results, don't even\n    // run the query and just return an empty result set.\n    if(criteria === false) {\n      return cb(null, []);\n    }\n\n    // Fold in options\n    if(options === Object(options) && criteria === Object(criteria)) {\n      criteria = _.extend({}, criteria, options);\n    }\n\n    // Transform Search Criteria\n    if (!self._transformer) {\n      throw new Error('Waterline can not access transformer-- maybe the context of the method is being overridden?');\n    }\n\n    criteria = self._transformer.serialize(criteria);\n\n\n    // Build up an operations set\n    var operations = new Operations(self, criteria, 'find');\n\n    // Run the operations\n    operations.run(function(err, values) {\n      if(err) return cb(err);\n      if(!values.cache) return cb();\n\n      // If no joins are used grab current collection's item from the cache and pass to the returnResults\n      // function.\n      if(!criteria.joins) {\n        values = values.cache[self.identity];\n        return returnResults(values);\n      }\n\n      // If the values are already combined, return the results\n      if(values.combined) {\n        return returnResults(values.cache[self.identity]);\n      }\n\n      // Find the primaryKey of the current model so it can be passed down to the integrator.\n      // Use 'id' as a good general default;\n      var primaryKey = 'id';\n\n      Object.keys(self._schema.schema).forEach(function(key) {\n        if(self._schema.schema[key].hasOwnProperty('primaryKey')) primaryKey = key;\n      });\n\n      // Perform in-memory joins\n      Integrator(values.cache, criteria.joins, primaryKey, function(err, results) {\n        if(err) return cb(err);\n        if(!results) return cb();\n\n        // We need to run one last check on the results using the criteria. This allows a self\n        // association where we end up with two records in the cache both having each other as\n        // embedded objects and we only want one result. However we need to filter any join criteria\n        // out of the top level where query so that searchs by primary key still work.\n        var tmpCriteria = _.cloneDeep(criteria.where);\n        if(!tmpCriteria) tmpCriteria = {};\n\n        criteria.joins.forEach(function(join) {\n          if(!hasOwnProperty(join, 'alias')) return;\n\n          // Check for `OR` criteria\n          if(hasOwnProperty(tmpCriteria, 'or')) {\n            tmpCriteria.or.forEach(function(search) {\n              if(!hasOwnProperty(search, join.alias)) return;\n              delete search[join.alias];\n            });\n            return;\n          }\n\n          if(!hasOwnProperty(tmpCriteria, join.alias)) return;\n          delete tmpCriteria[join.alias];\n        });\n\n        // Pass results into Waterline-Criteria\n        var _criteria = { where: tmpCriteria };\n        results = waterlineCriteria('parent', { parent: results }, _criteria).results;\n\n        // Serialize values coming from an in-memory join before modelizing\n        var _results = [];\n        results.forEach(function(res) {\n\n          // Go Ahead and perform any sorts on the associated data\n          criteria.joins.forEach(function(join) {\n            if(!join.criteria) return;\n            var c = normalize.criteria(join.criteria);\n            if(!c.sort) return;\n\n            var alias = join.alias;\n            res[alias] = sorter(res[alias], c.sort);\n          });\n\n          var val = self._transformer.serialize(res);\n          _results.push(val);\n        });\n\n        returnResults(_results);\n      });\n\n      function returnResults(results) {\n\n        if(!results) return cb(null, []);\n\n        // Normalize results to an array\n        if(!Array.isArray(results) && results) results = [results];\n\n        // Unserialize each of the results before attempting any join logic on them\n        var unserializedModels = [];\n\n        if(results) {\n          results.forEach(function(result) {\n            unserializedModels.push(self._transformer.unserialize(result));\n          });\n        }\n\n        var models = [];\n        var joins = criteria.joins ? criteria.joins : [];\n        var data = new Joins(joins, unserializedModels, self._schema.schema, self.waterline.collections);\n\n        // If `data.models` is invalid (not an array) return early to avoid getting into trouble.\n        if (!data || !data.models || !data.models.forEach) {\n          return cb(new Error('Values returned from operations set are not an array...'));\n        }\n\n        // Create a model for the top level values\n        data.models.forEach(function(model) {\n          models.push(new self._model(model, data.options));\n        });\n\n        cb(null, models);\n      }\n\n    });\n  },\n\n  where: function() {\n    this.find.apply(this, Array.prototype.slice.call(arguments));\n  },\n\n  select: function() {\n    this.find.apply(this, Array.prototype.slice.call(arguments));\n  },\n\n\n  /**\n   * findAll\n   * [[ Deprecated! ]]\n   *\n   * @param  {Object}   criteria\n   * @param  {Object}   options\n   * @param  {Function} cb\n   */\n  findAll: function(criteria, options, cb) {\n    if(typeof criteria === 'function') {\n      cb = criteria;\n      criteria = null;\n      options = null;\n    }\n\n    if(typeof options === 'function') {\n      cb = options;\n      options = null;\n    }\n\n    // Return Deferred or pass to adapter\n    if(typeof cb !== 'function') {\n      return new Deferred(this, this.findAll, criteria);\n    }\n\n    cb(new Error('In Waterline >= 0.9, findAll() has been deprecated in favor of find().' +\n                '\\nPlease visit the migration guide at http://sailsjs.org for help upgrading.'));\n  }\n\n};\n","/**\n * Finder Helper Queries\n *\n * (these call other collection-level methods)\n */\n\nvar usageError = require('../../utils/usageError'),\n    utils = require('../../utils/helpers'),\n    normalize = require('../../utils/normalize');\n\nmodule.exports = {\n\n  // Return models where ALL of the specified attributes match queryString\n\n  findOneLike: function(criteria, options, cb) {\n    var usage = utils.capitalize(this.identity) + '.findOneLike([criteria],[options],callback)';\n\n    // Normalize criteria\n    criteria = normalize.likeCriteria(criteria, this._schema.schema);\n    if(!criteria) return usageError('Criteria must be an object!', usage, cb);\n\n    this.findOne(criteria, options, cb);\n  },\n\n  findLike: function(criteria, options, cb) {\n    var usage = utils.capitalize(this.identity) + '.findLike([criteria],[options],callback)';\n\n    // Normalize criteria\n    criteria = normalize.likeCriteria(criteria, this._schema.schema);\n    if(!criteria) return usageError('Criteria must be an object!', usage, cb);\n\n    this.find(criteria, options, cb);\n  },\n\n  // Return models where >= 1 of the specified attributes start with queryString\n  startsWith: function(criteria, options, cb) {\n    var usage = utils.capitalize(this.identity) + '.startsWith([criteria],[options],callback)';\n\n    criteria = normalize.likeCriteria(criteria, this._schema.schema, function applyStartsWith(criteria) {\n      return criteria + '%';\n    });\n\n    if(!criteria) return usageError('Criteria must be an object!', usage, cb);\n\n    this.find(criteria, options, cb);\n  },\n\n  // Return models where >= 1 of the specified attributes end with queryString\n  endsWith: function(criteria, options, cb) {\n    var usage = utils.capitalize(this.identity) + '.startsWith([criteria],[options],callback)';\n\n    criteria = normalize.likeCriteria(criteria, this._schema.schema, function applyEndsWith(criteria) {\n      return '%' + criteria;\n    });\n\n    if(!criteria) return usageError('Criteria must be an object!', usage, cb);\n\n    this.find(criteria, options, cb);\n  },\n\n  // Return models where >= 1 of the specified attributes contain queryString\n  contains: function(criteria, options, cb) {\n    var usage = utils.capitalize(this.identity) + '.startsWith([criteria],[options],callback)';\n\n    criteria = normalize.likeCriteria(criteria, this._schema.schema, function applyContains(criteria) {\n      return '%' + criteria + '%';\n    });\n\n    if(!criteria) return usageError('Criteria must be an object!', usage, cb);\n\n    this.find(criteria, options, cb);\n  }\n\n};\n","/**\n * Dynamic Queries\n *\n * Query the collection using the name of the attribute directly\n */\n\nvar _ = require('lodash'),\n    usageError = require('../../utils/usageError'),\n    utils = require('../../utils/helpers'),\n    normalize = require('../../utils/normalize'),\n    hasOwnProperty = utils.object.hasOwnProperty;\n\nvar finder = module.exports = {};\n\n/**\n * buildDynamicFinders\n *\n * Attaches shorthand dynamic methods to the prototype for each attribute\n * in the schema.\n */\n\nfinder.buildDynamicFinders = function() {\n  var self = this;\n\n  // For each defined attribute, create a dynamic finder function\n  Object.keys(this._schema.schema).forEach(function(attrName) {\n\n    // Check if attribute is an association, if so generate limited dynamic finders\n    if(hasOwnProperty(self._schema.schema[attrName], 'foreignKey')) {\n      self.generateAssociationFinders(attrName);\n      return;\n    }\n\n    var capitalizedMethods = ['findOneBy*', 'findOneBy*In', 'findOneBy*Like', 'findBy*', 'findBy*In',\n      'findBy*Like', 'countBy*', 'countBy*In', 'countBy*Like'];\n\n    var lowercasedMethods = ['*StartsWith', '*Contains', '*EndsWith'];\n\n    capitalizedMethods.forEach(function(method) {\n      self.generateDynamicFinder(attrName, method);\n    });\n\n    lowercasedMethods.forEach(function(method) {\n      self.generateDynamicFinder(attrName, method, true);\n    });\n  });\n};\n\n\n/**\n * generateDynamicFinder\n *\n * Creates a dynamic method based off the schema. Used for shortcuts for various\n * methods where a criteria object can automatically be built.\n *\n * @param {String} attrName\n * @param {String} method\n * @param {Boolean} dont capitalize the attrName or do, defaults to false\n */\n\nfinder.generateDynamicFinder = function(attrName, method, dontCapitalize) {\n  var self = this,\n      criteria;\n\n  // Capitalize Attribute Name for camelCase\n  var preparedAttrName = dontCapitalize ? attrName : utils.capitalize(attrName);\n\n  // Figure out actual dynamic method name by injecting attribute name\n  var actualMethodName = method.replace(/\\*/g, preparedAttrName);\n\n  // Assign this finder to the collection\n  this[actualMethodName] = function dynamicMethod(value, options, cb) {\n\n    if(typeof options === 'function') {\n      cb = options;\n      options = null;\n    }\n\n    options = options || {};\n\n    var usage = utils.capitalize(self.identity) + '.' + actualMethodName + '(someValue,[options],callback)';\n\n    if(typeof value === 'undefined') return usageError('No value specified!', usage, cb);\n    if(options.where) return usageError('Cannot specify `where` option in a dynamic ' + method + '*() query!', usage, cb);\n\n    // Build criteria query and submit it\n    options.where = {};\n    options.where[attrName] = value;\n\n    switch(method) {\n\n\n      ///////////////////////////////////////\n      // Finders\n      ///////////////////////////////////////\n\n\n      case 'findOneBy*':\n      case 'findOneBy*In':\n        return self.findOne(options, cb);\n\n      case 'findOneBy*Like':\n        criteria = _.extend(options, {\n          where: {\n            like: options.where\n          }\n        });\n\n        return self.findOne(criteria, cb);\n\n\n      ///////////////////////////////////////\n      // Aggregate Finders\n      ///////////////////////////////////////\n\n\n      case 'findBy*':\n      case 'findBy*In':\n        return self.find(options, cb);\n\n      case 'findBy*Like':\n        criteria = _.extend(options, {\n          where: {\n            like: options.where\n          }\n        });\n\n        return self.find(criteria, cb);\n\n\n      ///////////////////////////////////////\n      // Count Finders\n      ///////////////////////////////////////\n\n\n      case 'countBy*':\n      case 'countBy*In':\n        return self.count(options, cb);\n\n      case 'countBy*Like':\n        criteria = _.extend(options, {\n          where: {\n            like: options.where\n          }\n        });\n\n        return self.count(criteria, cb);\n\n\n      ///////////////////////////////////////\n      // Searchers\n      ///////////////////////////////////////\n\n      case '*StartsWith':\n        return self.startsWith(options, cb);\n\n      case '*Contains':\n        return self.contains(options, cb);\n\n      case '*EndsWith':\n        return self.endsWith(options, cb);\n    }\n  };\n};\n\n\n/**\n * generateAssociationFinders\n *\n * Generate Dynamic Finders for an association.\n * Adds a .findBy<name>() method for has_one and belongs_to associations.\n *\n * @param {String} attrName, the column name of the attribute\n */\n\nfinder.generateAssociationFinders = function(attrName) {\n  var self = this,\n      name, model;\n\n  // Find the user defined key for this attrName, look in self defined columnName\n  // properties and if that's not set see if the generated columnName matches the attrName\n  for(var key in this._attributes) {\n\n    // Cache the value\n    var cache = this._attributes[key];\n\n    if(!hasOwnProperty(cache, 'model')) continue;\n\n    if(cache.model.toLowerCase() + '_id' === attrName) {\n      name = key;\n      model = cache.model;\n    }\n  }\n\n  if(!name || !model) return;\n\n  // Build a findOneBy<attrName> dynamic finder that forces a join on the association\n  this['findOneBy' + utils.capitalize(name)] = function dynamicAssociationMethod(value, cb) {\n\n    // Check proper usage\n    var usage = utils.capitalize(self.identity) + '.' + 'findBy' + utils.capitalize(name) +\n      '(someValue, callback)';\n\n    if(typeof value === 'undefined') return usageError('No value specified!', usage, cb);\n    if(typeof value === 'function') return usageError('No value specified!', usage, cb);\n\n    var criteria = associationQueryCriteria(self, value, attrName);\n    return this.findOne(criteria, cb);\n  };\n\n  // Build a findBy<attrName> dynamic finder that forces a join on the association\n  this['findBy' + utils.capitalize(name)] = function dynamicAssociationMethod(value, cb) {\n\n    // Check proper usage\n    var usage = utils.capitalize(self.identity) + '.' + 'findBy' + utils.capitalize(name) +\n      '(someValue, callback)';\n\n    if(typeof value === 'undefined') return usageError('No value specified!', usage, cb);\n    if(typeof value === 'function') return usageError('No value specified!', usage, cb);\n\n    var criteria = associationQueryCriteria(self, value, attrName);\n    return this.find(criteria, cb);\n  };\n};\n\n\n/**\n * Build Join Array\n */\n\nfunction buildJoin() {\n  var self = this,\n      pk, attr;\n\n  // Set the attr value to the generated schema attribute\n  attr = self.waterline.schema[self.identity].attributes[name];\n\n  // Get the current collection's primary key attribute\n  Object.keys(self._attributes).forEach(function(key) {\n    if(hasOwnProperty(self._attributes[key], 'primaryKey')) {\n      pk = key;\n    }\n  });\n\n  if(!attr) throw new Error('Attempting to populate an attribute that doesn\\'t exist');\n\n  // Grab the key being populated to check if it is a has many to belongs to\n  // If it's a belongs_to the adapter needs to know that it should replace the foreign key\n  // with the associated value.\n  var parentKey = self.waterline.collections[self.identity].attributes[name];\n\n\n  // Build the initial join object that will link this collection to either another collection\n  // or to a junction table.\n  var join = {\n    parent: self._tableName,\n    parentKey: attr.columnName || pk,\n    child: attr.references,\n    childKey: attr.on,\n    select: true,\n    removeParentKey: parentKey.model ? true : false\n  };\n\n  return join;\n}\n\n/**\n * Query Criteria Builder for associations\n */\n\nfunction associationQueryCriteria(context, value, attrName) {\n\n  // Build a criteria object\n  var criteria = {\n    where: {},\n    joins: []\n  };\n\n  // Build a join condition\n  var join = buildJoin.call(context);\n  criteria.joins.push(join);\n\n  // Add where values\n  criteria.where[attrName] = value;\n  return criteria;\n}\n","/**\n * Streaming Queries\n */\n\nvar usageError = require('../utils/usageError'),\n    utils = require('../utils/helpers'),\n    normalize = require('../utils/normalize'),\n    ModelStream = require('../utils/stream');\n\nmodule.exports = {\n\n  /**\n   * Stream a Result Set\n   *\n   * @param {Object} criteria\n   * @param {Object} transformation, defaults to JSON\n   */\n\n  stream: function (criteria, transformation) {\n    var self = this;\n\n    var usage = utils.capitalize(this.identity) + '.stream([criteria],[options])';\n\n    // Normalize criteria and fold in options\n    criteria = normalize.criteria(criteria);\n\n    // Transform Search Criteria\n    criteria = self._transformer.serialize(criteria);\n\n    // Configure stream to adapter, kick off fetch, and return stream object\n    // so that user code can use it as it fires data events\n    var stream = new ModelStream(transformation);\n\n    // very important to wait until next tick before triggering adapter\n    // otherwise write() and end() won't fire properly\n    process.nextTick(function (){\n\n      // Write once immediately to force prefix in case no models are returned\n      stream.write();\n\n      // Trigger Adapter Method\n      self.adapter.stream(criteria, stream);\n    });\n\n    return stream;\n  }\n\n};\n","\n/**\n * Check and normalize belongs_to and has_many association keys\n *\n * Ensures that a belongs_to association is an object and that a has_many association\n * is an array.\n *\n * @param {Object} context,\n * @param {Object} proto\n * @api private\n */\n\nvar Normalize = module.exports = function(context, proto) {\n\n  this.proto = proto;\n\n  var attributes = context.waterline.collections[context.identity].attributes || {};\n\n  this.collections(attributes);\n  this.models(attributes);\n};\n\n/**\n * Normalize Collection Attribute to Array\n *\n * @param {Object} attributes\n * @api private\n */\n\nNormalize.prototype.collections = function(attributes) {\n  for(var attribute in attributes) {\n\n    // If attribute is not a collection, it doesn't need normalizing\n    if(!attributes[attribute].collection) continue;\n\n    // Sets the attribute as an array if it's not already\n    if(this.proto[attribute] && !Array.isArray(this.proto[attribute])) {\n      this.proto[attribute] = [this.proto[attribute]];\n    }\n  }\n};\n\n/**\n * Normalize Model Attribute to Object\n *\n * @param {Object} attributes\n * @api private\n */\n\nNormalize.prototype.models = function(attributes) {\n  for(var attribute in attributes) {\n\n    // If attribute is not a model, it doesn't need normalizing\n    if(!attributes[attribute].model) continue;\n\n    // Sets the attribute to the first item in the array if it's an array\n    if(this.proto[attribute] && Array.isArray(this.proto[attribute])) {\n      this.proto[attribute] = this.proto[attribute][0];\n    }\n  }\n};\n","\n/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\nvar Association = require('../association');\nvar utils = require('../../../utils/helpers');\nvar hasOwnProperty = utils.object.hasOwnProperty;\n\n/**\n * Add association getters and setters for any has_many\n * attributes.\n *\n * @param {Object} context\n * @param {Object} proto\n * @api private\n */\n\nvar Define = module.exports = function(context, proto) {\n  var self = this;\n\n  this.proto = proto;\n\n  // Build Associations Listing\n  Object.defineProperty(proto, 'associations', {\n    enumerable: false,\n    writable: true,\n    value: {}\n  });\n\n  // Build associations cache to hold original values.\n  // Used to check if values have been mutated and need to be synced when\n  // a model.save call is made.\n  Object.defineProperty(proto, 'associationsCache', {\n    enumerable: false,\n    writable: true,\n    value: {}\n  });\n\n  var attributes = _.cloneDeep(context._attributes) || {};\n  var collections = this.collectionKeys(attributes);\n  var models = this.modelKeys(attributes);\n\n  if(collections.length === 0 && models.length === 0) return;\n\n  // Create an Association getter and setter for each collection\n  collections.forEach(function(collection) {\n    self.buildHasManyProperty(collection);\n  });\n\n  // Attach Models to the prototype and set in the associations object\n  models.forEach(function(model) {\n    self.buildBelongsToProperty(model);\n  });\n};\n\n/**\n * Find Collection Keys\n *\n * @param {Object} attributes\n * @api private\n * @return {Array}\n */\n\nDefine.prototype.collectionKeys = function(attributes) {\n  var collections = [];\n\n  // Find any collection keys\n  for(var attribute in attributes) {\n    if(!hasOwnProperty(attributes[attribute], 'collection')) continue;\n    collections.push(attribute);\n  }\n\n  return collections;\n};\n\n/**\n * Find Model Keys\n *\n * @param {Object} attributes\n * @api private\n * @return {Array}\n */\n\nDefine.prototype.modelKeys = function(attributes) {\n  var models = [];\n\n  // Find any collection keys\n  for(var attribute in attributes) {\n    if(!hasOwnProperty(attributes[attribute], 'model')) continue;\n    models.push({ key: attribute, val: attributes[attribute] });\n  }\n\n  return models;\n};\n\n/**\n * Create Getter/Setter for hasMany associations\n *\n * @param {String} collection\n * @api private\n */\n\nDefine.prototype.buildHasManyProperty = function(collection) {\n  var self = this;\n\n  // Attach to a non-enumerable property\n  this.proto.associations[collection] = new Association();\n\n  // Attach getter and setter to the model\n  Object.defineProperty(this.proto, collection, {\n    set: function(val) { self.proto.associations[collection]._setValue(val); },\n    get: function() { return self.proto.associations[collection]._getValue(); },\n    enumerable: true,\n    configurable: true\n  });\n};\n\n/**\n * Add belongsTo attributes to associations object\n *\n * @param {String} collection\n * @api private\n */\n\nDefine.prototype.buildBelongsToProperty = function(model) {\n\n  // Attach to a non-enumerable property\n  this.proto.associations[model.key] = model.val;\n\n  // Build a cache for this model\n  this.proto.associationsCache[model.key] = {};\n};\n","\n/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\nvar utils = require('../../../utils/helpers');\nvar hasOwnProperty = utils.object.hasOwnProperty;\n\n/**\n * Model.toObject()\n *\n * Returns a cloned object containing just the model\n * values. Useful for doing operations on the current values\n * minus the instance methods.\n *\n * @param {Object} context, Waterline collection instance\n * @param {Object} proto, model prototype\n * @api public\n * @return {Object}\n */\n\nvar toObject = module.exports = function(context, proto) {\n\n  this.context = context;\n  this.proto = proto;\n\n  // Hold joins used in the query\n  this.usedJoins = [];\n\n  this.object = Object.create(proto.__proto__);\n\n  this.addAssociations();\n  this.addProperties();\n  this.makeObject();\n  this.filterJoins();\n  this.filterFunctions();\n\n  return this.object;\n};\n\n\n/**\n * Add Association Keys\n *\n * If a showJoins flag is active, add all association keys.\n *\n * @param {Object} keys\n * @api private\n */\n\ntoObject.prototype.addAssociations = function() {\n  var self = this;\n\n  if(!this.proto._properties) return;\n  if(!this.proto._properties.showJoins) return;\n\n  // Copy prototype over for attributes\n  for(var association in this.proto.associations) {\n\n    // Handle hasMany attributes\n    if(hasOwnProperty(this.proto.associations[association], 'value')) {\n\n      var records = [];\n      var values = this.proto.associations[association].value;\n\n      values.forEach(function(record) {\n        if(typeof record !== 'object') return;\n        var item = Object.create(record.__proto__);\n        Object.keys(record).forEach(function(key) {\n          item[key] = _.cloneDeep(record[key]);\n        });\n        records.push(item);\n      });\n\n      this.object[association] = records;\n      continue;\n    }\n\n    // Handle belongsTo attributes\n    var record = this.proto[association];\n\n    if(_.isObject(record) && !Array.isArray(record)) {\n\n      var item = Object.create(record.__proto__);\n\n      Object.keys(record).forEach(function(key) {\n        item[key] = _.cloneDeep(record[key]);\n      });\n\n      this.object[association] = item;\n    } else {\n      this.object[association] = record;\n    }\n  }\n};\n\n/**\n * Add Properties\n *\n * Copies over non-association attributes to the newly created object.\n *\n * @api private\n */\n\ntoObject.prototype.addProperties = function() {\n  var self = this;\n\n  Object.keys(this.proto).forEach(function(key) {\n    if(hasOwnProperty(self.object, key)) return;\n    self.object[key] = _.cloneDeep(self.proto[key]);\n  });\n\n};\n\n/**\n * Make Object\n *\n * Runs toJSON on all associated values\n *\n * @api private\n */\n\ntoObject.prototype.makeObject = function() {\n  var self = this;\n\n  if(!this.proto._properties) return;\n  if(!this.proto._properties.showJoins) return;\n\n  // Handle Joins\n  Object.keys(this.proto.associations).forEach(function(association) {\n\n    // Don't run toJSON on records that were not populated\n    if(!self.proto._properties || !self.proto._properties.joins) return;\n\n    // Build up a join key name based on the attribute's model/collection name\n    var joinsName = association;\n    if(self.context._attributes[association].model) joinsName = self.context._attributes[association].model.toLowerCase();\n    if(self.context._attributes[association].collection) joinsName = self.context._attributes[association].collection.toLowerCase();\n\n    // Check if the join was used\n    if(self.proto._properties.joins.indexOf(joinsName) < 0 && self.proto._properties.joins.indexOf(association) < 0) return;\n    self.usedJoins.push(association);\n\n    // Call toJSON on each associated record\n    if(Array.isArray(self.object[association])) {\n      var records = [];\n\n      self.object[association].forEach(function(item) {\n        if(!hasOwnProperty(item.__proto__, 'toJSON')) return;\n        records.push(item.toJSON());\n      });\n\n      self.object[association] = records;\n      return;\n    }\n\n    if(!self.object[association]) return;\n\n    // Association was null or not valid\n    // (don't try to `hasOwnProperty` it so we don't throw)\n    if (typeof self.object[association] !== 'object') {\n      self.object[association] = self.object[association];\n      return;\n    }\n\n    if(!hasOwnProperty(self.object[association].__proto__, 'toJSON')) return;\n    self.object[association] = self.object[association].toJSON();\n  });\n\n};\n\n/**\n * Remove Non-Joined Associations\n *\n * @api private\n */\n\ntoObject.prototype.filterJoins = function() {\n  var attributes = this.context._attributes;\n  var properties = this.proto._properties;\n\n  for(var attribute in attributes) {\n    if(!hasOwnProperty(attributes[attribute], 'model') && !hasOwnProperty(attributes[attribute], 'collection')) continue;\n\n    // If no properties and a collection attribute, delete the association and return\n    if(!properties && hasOwnProperty(attributes[attribute], 'collection')) {\n      delete this.object[attribute];\n      continue;\n    }\n\n    // If showJoins is false remove the association object\n    if(properties && !properties.showJoins) {\n\n      // Don't delete belongs to keys\n      if(!attributes[attribute].model) delete this.object[attribute];\n    }\n\n    if(properties && properties.joins) {\n      if(this.usedJoins.indexOf(attribute) < 0) {\n\n        // Don't delete belongs to keys\n        if(!attributes[attribute].model) delete this.object[attribute];\n      }\n    }\n  }\n};\n\n/**\n * Filter Functions\n *\n * @api private\n */\n\ntoObject.prototype.filterFunctions = function() {\n  for(var key in this.object) {\n    if(typeof this.object[key] === 'function') {\n      delete this.object[key];\n    }\n  }\n};\n","\n/**\n * Module dependencies\n */\n\nvar utils = require('../../../utils/helpers');\nvar hasOwnProperty = utils.object.hasOwnProperty;\nvar Q = require('q');\nvar noop = function() {};\n\n/**\n * Model.destroy()\n *\n * Destroys an instance of a model\n *\n * @param {Object} context,\n * @param {Object} proto\n * @param {Function} callback\n * @return {Promise}\n * @api public\n */\n\nvar Destroy = module.exports = function(context, proto, cb) {\n  var values, attributes, primaryKey, deferred, err;\n\n  cb = cb || noop;\n\n  deferred = Q.defer();\n  values = proto.toObject();\n  attributes = context.waterline.schema[context.identity].attributes;\n  primaryKey = this.findPrimaryKey(attributes, values);\n\n  if(!primaryKey) {\n    err = new Error('No Primary Key set to update the record with! ' +\n    'Try setting an attribute as a primary key or include an ID property.');\n    deferred.reject(err);\n    return cb(err);\n  }\n\n  if(!values[primaryKey]) {\n    err = new Error('No Primary Key set to update the record with! ' +\n    'Primary Key must have a value, it can\\'t be an optional value.');\n    deferred.reject(err);\n    return cb(err);\n  }\n\n  // Build Search Criteria\n  var criteria = {};\n  criteria[primaryKey] = values[primaryKey];\n\n  // Execute Query\n  context.destroy(criteria, function(err, status) {\n    if (err) {\n      deferred.reject(err);\n      return cb(err);\n    }\n    deferred.resolve(status);\n    cb.apply(this, arguments);\n  });\n\n  return deferred.promise;\n};\n\n/**\n * Find Primary Key\n *\n * @param {Object} attributes\n * @param {Object} values\n * @api private\n */\n\nDestroy.prototype.findPrimaryKey = function(attributes, values) {\n  var primaryKey = null;\n\n  for(var attribute in attributes) {\n    if(hasOwnProperty(attributes[attribute], 'primaryKey')) {\n      primaryKey = attribute;\n    }\n  }\n\n  // If no primary key check for an ID property\n  if(!primaryKey && hasOwnProperty(values, 'id')) primaryKey = 'id';\n\n  return primaryKey;\n};\n","var _ = require('lodash');\nvar async = require('async');\nvar deep = require('deep-diff');\nvar updateInstance = require('../associationMethods/update');\nvar addAssociation = require('../associationMethods/add');\nvar removeAssociation = require('../associationMethods/remove');\nvar hop = require('../../../utils/helpers').object.hasOwnProperty;\nvar Q = require('q');\nvar noop = function() {};\n\n/**\n * Model.save()\n *\n * Takes the currently set attributes and updates the database.\n * Shorthand for Model.update({ attributes }, cb)\n *\n * @param {Object} context\n * @param {Object} proto\n * @param {Function} callback\n * @return {Promise}\n * @api public\n */\n\nmodule.exports = function(context, proto, cb) {\n  var deferred = Q.defer();\n  cb = cb || noop;\n\n  /**\n   * TO-DO:\n   * This should all be wrapped in a transaction. That's coming next but for the meantime\n   * just hope we don't get in a nasty state where the operation fails!\n   */\n\n  var mutatedModels = [];\n\n  async.auto({\n\n    // Compare any populated model values to their current state.\n    // If they have been mutated then the values will need to be synced.\n    compareModelValues: function(next) {\n      var modelKeys = Object.keys(proto.associationsCache);\n\n      async.each(modelKeys, function(key, nextKey) {\n\n        if(!hop(proto, key) || proto[key] === undefined) return nextKey();\n\n        var currentVal = proto[key];\n        var previousVal = proto.associationsCache[key];\n\n        // Normalize previousVal to an object\n        if(Array.isArray(previousVal)) previousVal = previousVal[0];\n\n        if(deep(currentVal, previousVal)) {\n          mutatedModels.push(key);\n        }\n\n        nextKey();\n      }, next);\n    },\n\n    // Update The Current Record\n    updateRecord: ['compareModelValues', function(next) {\n\n      // Shallow clone proto.toObject() to remove all the functions\n      var data = _.clone(proto.toObject());\n\n      new updateInstance(context, data, mutatedModels, function(err, data) {\n        next(err, data);\n      });\n    }],\n\n\n    // Build a set of associations to add and remove.\n    // These are populated from using model[associationKey].add() and\n    // model[associationKey].remove().\n    buildAssociationOperations: ['compareModelValues', function(next) {\n\n      // Build a dictionary to hold operations based on association key\n      var operations = {\n        addKeys: {},\n        removeKeys: {}\n      };\n\n      Object.keys(proto.associations).forEach(function(key) {\n\n        // Ignore belongsTo associations\n        if(proto.associations[key].hasOwnProperty('model')) return;\n\n        // Grab what records need adding\n        if(proto.associations[key].addModels.length > 0) {\n          operations.addKeys[key] = proto.associations[key].addModels;\n        }\n\n        // Grab what records need removing\n        if(proto.associations[key].removeModels.length > 0) {\n          operations.removeKeys[key] = proto.associations[key].removeModels;\n        }\n      });\n\n      return next(null, operations);\n    }],\n\n    // Create new associations for each association key\n    addAssociations: ['buildAssociationOperations', 'updateRecord', function(next, results) {\n      var keys = results.buildAssociationOperations.addKeys;\n      return new addAssociation(context, proto, keys, function(err, failedTransactions) {\n        if(err) return next(err);\n\n        // reset addKeys\n        for(var key in results.buildAssociationOperations.addKeys) {\n          proto.associations[key].addModels = [];\n        }\n\n        next(null, failedTransactions);\n      });\n    }],\n\n    // Remove associations for each association key\n    // Run after the addAssociations so that the connection pools don't get exhausted.\n    // Once transactions are ready we can remove this restriction as they will be run on the same\n    // connection.\n    removeAssociations: ['buildAssociationOperations', 'addAssociations', function(next, results) {\n      var keys = results.buildAssociationOperations.removeKeys;\n      return new removeAssociation(context, proto, keys, function(err, failedTransactions) {\n        if(err) return next(err);\n\n        // reset removeKeys\n        for(var key in results.buildAssociationOperations.removeKeys) {\n          proto.associations[key].removeModels = [];\n        }\n\n        next(null, failedTransactions);\n      });\n    }]\n\n  }, function(err, results) {\n    if(err) {\n      deferred.reject(err);\n      return cb(err);\n    }\n\n    // Collect all failed transactions if any\n    var failedTransactions = [];\n\n    if(results.addAssociations) {\n      failedTransactions = failedTransactions.concat(results.addAssociations);\n    }\n\n    if(results.removeAssociations) {\n      failedTransactions = failedTransactions.concat(results.removeAssociations);\n    }\n\n    if(failedTransactions.length > 0) {\n      deferred.reject(failedTransactions);\n      return cb(failedTransactions);\n    }\n\n    // Rebuild proper criteria object from the original query\n    var PK = context.primaryKey;\n    var obj = results.updateRecord[0].toObject();\n    var populations = Object.keys(proto.associations);\n    var criteria = {};\n    criteria[PK] = obj[PK];\n\n    // Build up a new query and re-populate everything\n    var query = context.findOne(criteria);\n    populations.forEach(function(pop) {\n      query.populate(pop);\n    });\n\n    query.exec(function(err, data) {\n      if(err) return cb(err);\n      deferred.resolve(data);\n      cb(null, data);\n    });\n  });\n\n  return deferred.promise;\n};\n","/**\n * Base Adapter Definition\n */\n\nvar _ = require('lodash');\n\nvar Adapter = module.exports = function(options) {\n\n  // Ensure the connections are set\n  this.connections = options.connections || {};\n\n  // Ensure the dictionary is built\n  this.dictionary = options.dictionary || {};\n\n  // Set a Query instance to get access to top\n  // level query functions\n  this.query = options.query || {};\n\n  // Set Collection Name\n  this.collection = options.collection || '';\n\n  // Set Model Identity\n  this.identity = options.identity || '';\n\n  return this;\n};\n\n_.extend(\n  Adapter.prototype,\n  require('./dql'),\n  require('./ddl'),\n  require('./compoundQueries'),\n  require('./aggregateQueries'),\n  require('./setupTeardown'),\n  require('./sync'),\n  require('./stream')\n);\n","\n/**\n * Export DQL Methods\n */\n\nmodule.exports = {\n  create: require('./create'),\n  update: require('./update'),\n  destroy: require('./destroy'),\n  count: require('./count'),\n  join: require('./join')\n};\n","\n\n/**\n * Contains a list of reserved words. All others should be stripped from\n * a schema when building.\n */\n\nexports.reservedWords = [\n  'defaultsTo',\n  'primaryKey',\n  'autoIncrement',\n  'unique',\n  'index',\n  'columnName',\n  'foreignKey',\n  'references',\n  'on',\n  'through',\n  'groupKey',\n  'required',\n  'default',\n  'type',\n  'collection',\n  'model',\n  'via',\n  'dominant'\n];\n\n/**\n * ignore\n */\n\nexports.object = {};\n\n/**\n * Safer helper for hasOwnProperty checks\n *\n * @param {Object} obj\n * @param {String} prop\n * @return {Boolean}\n * @api public\n */\n\nvar hop = Object.prototype.hasOwnProperty;\nexports.object.hasOwnProperty = function(obj, prop) {\n  return hop.call(obj, prop);\n};\n","/**\n * Types Supported By Schemas\n */\n\nmodule.exports = [\n  'string',\n  'text',\n  'integer',\n  'float',\n  'date',\n  'time',\n  'datetime',\n  'boolean',\n  'binary',\n  'array',\n  'json',\n  'mediumtext',\n  'longtext',\n  'objectid'\n];\n","/**\n * Lifecycle Callbacks Allowed\n */\n\nmodule.exports = [\n  'beforeValidate',\n  'afterValidate',\n  'beforeUpdate',\n  'afterUpdate',\n  'beforeCreate',\n  'afterCreate',\n  'beforeDestroy',\n  'afterDestroy'\n];\n","/**\n * Module dependencies\n */\n\nvar WLError = require('./WLError');\nvar WLUsageError = require('./WLUsageError');\nvar util = require('util');\nvar _ = require('lodash');\n\n\n\n/**\n * WLValidationError\n *\n * @extends WLError\n */\nfunction WLValidationError (properties) {\n\n  // Call superclass\n  WLValidationError.super_.call(this, properties);\n\n  // Ensure valid usage\n  if ( typeof this.invalidAttributes !== 'object' ) {\n    return new WLUsageError({\n      reason: 'An `invalidAttributes` object must be passed into the constructor for `WLValidationError`'\n    });\n  }\n  // if ( typeof this.model !== 'string' ) {\n  //   return new WLUsageError({\n  //     reason: 'A `model` string (the collection\\'s `globalId`) must be passed into the constructor for `WLValidationError`'\n  //   });\n  // }\n\n  // Customize the `reason` based on the # of invalid attributes\n  // (`reason` may not be overridden)\n  var isSingular = this.length === 1;\n  this.reason = util.format('%d attribute%s %s invalid',\n    this.length,\n    isSingular ? '' : 's',\n    isSingular ? 'is' : 'are');\n\n  // Always apply the 'E_VALIDATION' error code, even if it was overridden.\n  this.code = 'E_VALIDATION';\n\n  // Status may be overridden.\n  this.status = properties.status || 400;\n\n  // Model should always be set.\n  // (this should be the globalId of model, or \"collection\")\n  this.model = properties.model;\n\n  // Ensure messages exist for each invalidAttribute\n  this.invalidAttributes = _.mapValues(this.invalidAttributes, function (rules, attrName) {\n    return _.map(rules, function (rule) {\n      if (!rule.message) {\n        rule.message = util.format('A record with that `%s` already exists (`%s`).', attrName, rule.value);\n      }\n      return rule;\n    });\n  });\n\n  // Customize the `details`\n  this.details = util.format('Invalid attributes sent to %s:\\n',this.model) +\n  _.reduce(this.messages, function (memo, messages, attrName) {\n    memo += ' • ' + attrName + '\\n';\n    memo += _.reduce(messages, function (memo, message) {\n      memo += '   • ' + message + '\\n';\n      return memo;\n    }, '');\n    return memo;\n  }, '');\n\n}\nutil.inherits(WLValidationError, WLError);\n\n\n/**\n * `rules`\n *\n * @return {Object[Array[String]]} dictionary of validation rule ids, indexed by attribute\n */\nWLValidationError.prototype.__defineGetter__('rules', function(){\n  return _.mapValues(this.invalidAttributes, function (rules, attrName) {\n    return _.pluck(rules, 'rule');\n  });\n});\n\n\n\n\n/**\n * `messages` (aka `errors`)\n *\n * @return {Object[Array[String]]} dictionary of validation messages, indexed by attribute\n */\nWLValidationError.prototype.__defineGetter__('messages', function(){\n  return _.mapValues(this.invalidAttributes, function (rules, attrName) {\n    return _.pluck(rules, 'message');\n  });\n});\nWLValidationError.prototype.__defineGetter__('errors', function(){\n  return this.messages;\n});\n\n\n/**\n * `attributes` (aka `keys`)\n *\n * @return {Array[String]} of invalid attribute names\n */\nWLValidationError.prototype.__defineGetter__('attributes', function(){\n  return _.keys(this.invalidAttributes);\n});\nWLValidationError.prototype.__defineGetter__('keys', function(){\n  return this.attributes;\n});\n\n\n/**\n * `.length`\n *\n * @return {Integer} number of invalid attributes\n */\nWLValidationError.prototype.__defineGetter__('length', function(){\n  return this.attributes.length;\n});\n\n\n\n/**\n * `.ValidationError`\n * (backwards-compatibility)\n *\n * @return {Object[Array[Object]]} number of invalid attributes\n */\nWLValidationError.prototype.__defineGetter__('ValidationError', function(){\n  //\n  // TODO:\n  // Down the road- emit deprecation event here--\n  // (will log information about new error handling options)\n  //\n  return this.invalidAttributes;\n});\n\n\n\n/**\n * [toJSON description]\n * @type {[type]}\n */\nWLValidationError.prototype.toJSON =\nWLValidationError.prototype.toPOJO =\nfunction () {\n  return {\n    error: this.code,\n    status: this.status,\n    summary: this.reason,\n    model: this.model,\n    invalidAttributes: this.invalidAttributes\n  };\n};\n\n\nmodule.exports = WLValidationError;\n","/**\n * Create a nicely formatted usage error\n */\n\nmodule.exports = function(err, usage, cb) {\n  var message = err + '\\n==============================================\\nProper usage :: \\n' + usage + '\\n==============================================\\n';\n  if(cb) return cb(message);\n  throw new Error(message);\n};","var _ = require('lodash');\nvar util = require('./helpers');\nvar hop = util.object.hasOwnProperty;\nvar switchback = require('node-switchback');\nvar errorify = require('../error');\nvar WLUsageError = require('../error/WLUsageError');\n\nvar normalize = module.exports = {\n\n  // Expand Primary Key criteria into objects\n  expandPK: function(context, options) {\n\n    // Check if options is an integer or string and normalize criteria\n    // to object, using the specified primary key field.\n    if(_.isNumber(options) || _.isString(options) || Array.isArray(options)) {\n\n      // Default to id as primary key\n      var pk = 'id';\n\n      // If autoPK is not used, attempt to find a primary key\n      if (!context.autoPK) {\n        // Check which attribute is used as primary key\n        for(var key in context.attributes) {\n          if(!util.object.hasOwnProperty(context.attributes[key], 'primaryKey')) continue;\n\n          // Check if custom primaryKey value is falsy\n          if(!context.attributes[key].primaryKey) continue;\n\n          // If a custom primary key is defined, use it\n          pk = key;\n          break;\n        }\n      }\n\n      // Temporary store the given criteria\n      var pkCriteria = _.clone(options);\n\n      // Make the criteria object, with the primary key\n      options = {};\n      options[pk] = pkCriteria;\n    }\n\n    return options;\n  },\n\n  // Normalize the different ways of specifying criteria into a uniform object\n  criteria: function(origCriteria) {\n    var criteria = _.cloneDeep(origCriteria);\n\n    // If original criteria is already false, keep it that way.\n    if (criteria === false) return criteria;\n\n    if(!criteria) return {\n      where: null\n    };\n\n    // Let the calling method normalize array criteria. It could be an IN query\n    // where we need the PK of the collection or a .findOrCreateEach\n    if(Array.isArray(criteria)) return criteria;\n\n    // Empty undefined values from criteria object\n    _.each(criteria, function(val, key) {\n      if(_.isUndefined(val)) criteria[key] = null;\n    });\n\n    // Convert non-objects (ids) into a criteria\n    // TODO: use customizable primary key attribute\n    if(!_.isObject(criteria)) {\n      criteria = {\n        id: +criteria || criteria\n      };\n    }\n\n    if(_.isObject(criteria) && !criteria.where && criteria.where !== null) {\n      criteria = { where: criteria };\n    }\n\n    // Return string to indicate an error\n    if(!_.isObject(criteria)) throw new WLUsageError('Invalid options/criteria :: ' + criteria);\n\n    // If criteria doesn't seem to contain operational keys, assume all the keys are criteria\n    if(!criteria.where && !criteria.joins && !criteria.join && !criteria.limit && !criteria.skip &&\n      !criteria.sort && !criteria.sum && !criteria.average &&\n      !criteria.groupBy && !criteria.min && !criteria.max) {\n\n      // Delete any residuals and then use the remaining keys as attributes in a criteria query\n      delete criteria.where;\n      delete criteria.joins;\n      delete criteria.join;\n      delete criteria.limit;\n      delete criteria.skip;\n      delete criteria.sort;\n      criteria = {\n        where: criteria\n      };\n    }\n    // If where is null, turn it into an object\n    else if(_.isNull(criteria.where)) criteria.where = {};\n\n    // Move Limit, Skip, sort outside the where criteria\n    if(hop(criteria, 'where') && criteria.where !== null && hop(criteria.where, 'limit')) {\n      criteria.limit = parseInt(_.clone(criteria.where.limit), 10);\n      if(criteria.limit < 0) criteria.limit = 0;\n      delete criteria.where.limit;\n    }\n    else if(hop(criteria, 'limit')) {\n      criteria.limit = parseInt(criteria.limit, 10);\n      if(criteria.limit < 0) criteria.limit = 0;\n    }\n\n    if(hop(criteria, 'where') && criteria.where !== null && hop(criteria.where, 'skip')) {\n      criteria.skip = parseInt(_.clone(criteria.where.skip), 10);\n      if(criteria.skip < 0) criteria.skip = 0;\n      delete criteria.where.skip;\n    }\n    else if(hop(criteria, 'skip')) {\n      criteria.skip = parseInt(criteria.skip, 10);\n      if(criteria.skip < 0) criteria.skip = 0;\n    }\n\n    if(hop(criteria, 'where') && criteria.where !== null && hop(criteria.where, 'sort')) {\n      criteria.sort = _.clone(criteria.where.sort);\n      delete criteria.where.sort;\n    }\n\n    // Pull out aggregation keys from where key\n    if(hop(criteria, 'where') && criteria.where !== null && hop(criteria.where, 'sum')) {\n      criteria.sum = _.clone(criteria.where.sum);\n      delete criteria.where.sum;\n    }\n\n    if(hop(criteria, 'where') && criteria.where !== null && hop(criteria.where, 'average')) {\n      criteria.average = _.clone(criteria.where.average);\n      delete criteria.where.average;\n    }\n\n    if(hop(criteria, 'where') && criteria.where !== null && hop(criteria.where, 'groupBy')) {\n      criteria.groupBy = _.clone(criteria.where.groupBy);\n      delete criteria.where.groupBy;\n    }\n\n    if(hop(criteria, 'where') && criteria.where !== null && hop(criteria.where, 'min')) {\n      criteria.min = _.clone(criteria.where.min);\n      delete criteria.where.min;\n    }\n\n    if(hop(criteria, 'where') && criteria.where !== null && hop(criteria.where, 'max')) {\n      criteria.max = _.clone(criteria.where.max);\n      delete criteria.where.max;\n    }\n\n    // If WHERE is {}, always change it back to null\n    if(criteria.where && _.keys(criteria.where).length === 0) {\n      criteria.where = null;\n    }\n\n    // If an IN was specified in the top level query and is an empty array, we can return an\n    // empty object without running the query because nothing will match anyway. Let's return\n    // false from here so the query knows to exit out.\n    if(criteria.where) {\n      var falsy = false;\n      Object.keys(criteria.where).forEach(function(key) {\n        if(Array.isArray(criteria.where[key]) && criteria.where[key].length === 0) {\n          falsy = true;\n        }\n      });\n\n      if(falsy) return false;\n    }\n\n    // If an IN was specified inside an OR clause and is an empty array, remove it because nothing will\n    // match it anyway and it can prevent errors in the adapters\n    if(criteria.where && hop(criteria.where, 'or')) {\n\n      // Ensure `or` is an array\n      if (!_.isArray(criteria.where.or)) {\n        throw new WLUsageError('An `or` clause in a query should be specified as an array of subcriteria');\n      }\n\n      var _clone = _.cloneDeep(criteria.where.or);\n      criteria.where.or.forEach(function(clause, i) {\n        Object.keys(clause).forEach(function(key) {\n          if(Array.isArray(clause[key]) && clause[key].length === 0) {\n            _clone.splice(i, 1);\n          }\n        });\n      });\n\n      criteria.where.or = _clone;\n    }\n\n    // Normalize sort criteria\n    if(hop(criteria, 'sort') && criteria.sort !== null) {\n\n      // Split string into attr and sortDirection parts (default to 'asc')\n      if(_.isString(criteria.sort)) {\n        var parts = criteria.sort.split(' ');\n\n        // Set default sort to asc\n        parts[1] = parts[1] ? parts[1].toLowerCase() : 'asc';\n\n        // Throw error on invalid sort order\n        if(parts[1] !== 'asc' && parts[1] !== 'desc') {\n          throw new WLUsageError('Invalid sort criteria :: ' + criteria.sort);\n        }\n\n        // Expand criteria.sort into object\n        criteria.sort = {};\n        criteria.sort[parts[0]] = parts[1];\n      }\n\n      // normalize ASC/DESC notation\n      Object.keys(criteria.sort).forEach(function(attr) {\n        if(criteria.sort[attr] === 'asc') criteria.sort[attr] = 1;\n        if(criteria.sort[attr] === 'desc') criteria.sort[attr] = -1;\n      });\n\n      // normalize binary sorting criteria\n      Object.keys(criteria.sort).forEach(function(attr) {\n        if(criteria.sort[attr] === 0) criteria.sort[attr] = -1;\n      });\n\n      // Verify that user either specified a proper object\n      // or provided explicit comparator function\n      if(!_.isObject(criteria.sort) && !_.isFunction(criteria.sort)) {\n        throw new WLUsageError('Invalid sort criteria for ' + attrName + ' :: ' + direction);\n      }\n    }\n\n    return criteria;\n  },\n\n  // Normalize the capitalization and % wildcards in a like query\n  // Returns false if criteria is invalid,\n  // otherwise returns normalized criteria obj.\n  // Enhancer is an optional function to run on each criterion to preprocess the string\n  likeCriteria: function(criteria, attributes, enhancer) {\n\n    // Only accept criteria as an object\n    if(criteria !== Object(criteria)) return false;\n\n    criteria = _.clone(criteria);\n\n    if(!criteria.where) criteria = { where: criteria };\n\n    // Apply enhancer to each\n    if (enhancer) criteria.where = util.objMap(criteria.where, enhancer);\n\n    criteria.where = { like: criteria.where };\n\n    return criteria;\n  },\n\n\n  // Normalize a result set from an adapter\n  resultSet: function (resultSet) {\n\n    // Ensure that any numbers that can be parsed have been\n    return util.pluralize(resultSet, numberizeModel);\n  },\n\n\n  /**\n   * Normalize the different ways of specifying callbacks in built-in Waterline methods.\n   * Switchbacks vs. Callbacks (but not deferred objects/promises)\n   *\n   * @param  {Function|Handlers} cb\n   * @return {Handlers}\n   */\n  callback: function (cb) {\n\n    // Build modified callback:\n    // (only works for functions currently)\n    var wrappedCallback;\n    if (_.isFunction(cb)) {\n      wrappedCallback = function (err) {\n\n        // If no error occurred, immediately trigger the original callback\n        // without messing up the context or arguments:\n        if (!err) {\n          return applyInOriginalCtx(cb, arguments);\n        }\n\n        // If an error argument is present, upgrade it to a WLError\n        // (if it isn't one already)\n        err = errorify(err);\n\n        var modifiedArgs = Array.prototype.slice.call(arguments,1);\n        modifiedArgs.unshift(err);\n\n        // Trigger callback without messing up the context or arguments:\n        return applyInOriginalCtx(cb, modifiedArgs);\n      };\n    }\n\n\n\n\n\n    //\n    // TODO: Make it clear that switchback support it experimental.\n    //\n    // Push switchback support off until >= v0.11\n    // or at least add a warning about it being a `stage 1: experimental`\n    // feature.\n    //\n\n    if (!_.isFunction(cb)) wrappedCallback = cb;\n    return switchback(wrappedCallback, {\n      invalid: 'error', // Redirect 'invalid' handler to 'error' handler\n      error: function _defaultErrorHandler () {\n        console.error.apply(console, Array.prototype.slice.call(arguments));\n      }\n    });\n\n\n    // ????\n    // TODO: determine support target for 2-way switchback usage\n    // ????\n\n    // Allow callback to be -HANDLED- in different ways\n    // at the app-level.\n    // `cb` may be passed in (at app-level) as either:\n    //    => an object of handlers\n    //    => or a callback function\n    //\n    // If a callback function was provided, it will be\n    // automatically upgraded to a simplerhandler object.\n    // var cb_fromApp = switchback(cb);\n\n    // Allow callback to be -INVOKED- in different ways.\n    // (adapter def)\n    // var cb_fromAdapter = cb_fromApp;\n\n  }\n};\n\n// If any attribute looks like a number, but it's a string\n// cast it to a number\nfunction numberizeModel (model) {\n  return util.objMap(model, numberize);\n}\n\n\n// If specified attr looks like a number, but it's a string, cast it to a number\nfunction numberize (attr) {\n  if (_.isString(attr) && isNumbery(attr) && parseInt(attr,10) < Math.pow(2, 53)) return +attr;\n  else return attr;\n}\n\n// Returns whether this value can be successfully parsed as a finite number\nfunction isNumbery (value) {\n  return Math.pow(+value, 2) > 0;\n}\n\n// Replace % with %%%\nfunction escapeLikeQuery(likeCriterion) {\n  return likeCriterion.replace(/[^%]%[^%]/g, '%%%');\n}\n\n// Replace %%% with %\nfunction unescapeLikeQuery(likeCriterion) {\n  return likeCriterion.replace(/%%%/g, '%');\n}\n\n\n\n/**\n * Like _.partial, but accepts an array of arguments instead of\n * comma-seperated args (if _.partial is `call`, this is `apply`.)\n * The biggest difference from `_.partial`, other than the usage,\n * is that this helper actually CALLS the partially applied function.\n *\n * This helper is mainly useful for callbacks.\n *\n * @param  {Function} fn   [description]\n * @param  {[type]}   args [description]\n * @return {[type]}        [description]\n */\n\nfunction applyInOriginalCtx (fn, args) {\n  return (_.partial.apply(null, [fn].concat(Array.prototype.slice.call(args))))();\n}\n","/**\n * Module Dependencies\n */\n\nvar async = require('async');\n\n/**\n * Run Lifecycle Callbacks\n */\n\nvar runner = module.exports = {};\n\n\n/**\n * Run Validation Callbacks\n *\n * @param {Object} context\n * @param {Object} values\n * @param {Boolean} presentOnly\n * @param {Function} cb\n * @api public\n */\n\nrunner.validate = function(context, values, presentOnly, cb) {\n  context.validate(values, presentOnly, cb);\n};\n\n\n/**\n * Run Before Create Callbacks\n *\n * @param {Object} context\n * @param {Object} values\n * @param {Function} cb\n * @api public\n */\n\nrunner.beforeCreate = function(context, values, cb) {\n\n  var fn = function(item, next) {\n    item(values, next);\n  };\n\n  async.eachSeries(context._callbacks.beforeCreate, fn, cb);\n};\n\n\n/**\n * Run After Create Callbacks\n *\n * @param {Object} context\n * @param {Object} values\n * @param {Function} cb\n * @api public\n */\n\nrunner.afterCreate = function(context, values, cb) {\n\n  var fn = function(item, next) {\n    item(values, next);\n  };\n\n  async.eachSeries(context._callbacks.afterCreate, fn, cb);\n};\n\n\n/**\n * Run Before Update Callbacks\n *\n * @param {Object} context\n * @param {Object} values\n * @param {Function} cb\n * @api public\n */\n\nrunner.beforeUpdate = function(context, values, cb) {\n\n  var fn = function(item, next) {\n    item(values, next);\n  };\n\n  async.eachSeries(context._callbacks.beforeUpdate, fn, cb);\n};\n\n\n/**\n * Run After Update Callbacks\n *\n * @param {Object} context\n * @param {Object} values\n * @param {Function} cb\n * @api public\n */\n\nrunner.afterUpdate = function(context, values, cb) {\n\n  var fn = function(item, next) {\n    item(values, next);\n  };\n\n  async.eachSeries(context._callbacks.afterUpdate, fn, cb);\n};\n\n\n/**\n * Run Before Destroy Callbacks\n *\n * @param {Object} context\n * @param {Object} criteria\n * @param {Function} cb\n * @api public\n */\n\nrunner.beforeDestroy = function(context, criteria, cb) {\n\n  var fn = function(item, next) {\n    item(criteria, next);\n  };\n\n  async.eachSeries(context._callbacks.beforeDestroy, fn, cb);\n};\n\n\n/**\n * Run After Destroy Callbacks\n *\n * @param {Object} context\n * @param {Object} values\n * @param {Function} cb\n * @api public\n */\n\nrunner.afterDestroy = function(context, values, cb) {\n\n  var fn = function(item, next) {\n    item(values, next);\n  };\n\n  async.eachSeries(context._callbacks.afterDestroy, fn, cb);\n};\n","/**\n * Deferred Object\n *\n * Used for building up a Query\n */\n\nvar Q = require('q'),\n    _ = require('lodash'),\n    normalize = require('../utils/normalize'),\n    utils = require('../utils/helpers'),\n    acyclicTraversal = require('../utils/acyclicTraversal'),\n    hasOwnProperty = utils.object.hasOwnProperty;\n\nvar Deferred = module.exports = function(context, method, criteria, values) {\n\n  if(!context) return new Error('Must supply a context to a new Deferred object. Usage: new Deferred(context, method, criteria)');\n  if(!method) return new Error('Must supply a method to a new Deferred object. Usage: new Deferred(context, method, criteria)');\n\n  this._context = context;\n  this._method = method;\n  this._criteria = criteria;\n  this._values = values || null;\n\n  return this;\n};\n\n\n\n/**\n * Add join clause(s) to the criteria object to populate\n * the specified alias all the way down (or at least until a\n * circular pattern is detected.)\n *\n * @param  {String} keyName  [the initial alias aka named relation]\n * @param  {Object} criteria [optional]\n * @return this\n * @chainable\n */\nDeferred.prototype.populateDeep = function ( keyName, criteria ) {\n\n  // The identity of the initial model\n  var identity = this._context.identity;\n\n  // The input schema\n  var schema = this._context.waterline.schema;\n\n  // Kick off recursive function to traverse the schema graph.\n  var plan = acyclicTraversal(schema, identity, keyName);\n\n  // TODO: convert populate plan into a join plan\n  // this._criteria.joins = ....\n\n  // TODO: also merge criteria object into query\n\n  return this;\n};\n\n/**\n * Populate all associations of a collection.\n *\n * @return this\n * @chainable\n */\nDeferred.prototype.populateAll = function(criteria) {\n  var self = this;\n  this._context.associations.forEach(function(association) {\n    self.populate(association.alias, criteria);\n  });\n  return this;\n\n};\n\n/**\n * Add a `joins` clause to the criteria object.\n *\n * Used for populating associations.\n *\n * @param {String} key, the key to populate\n * @return this\n * @chainable\n */\n\nDeferred.prototype.populate = function(keyName, criteria) {\n  var self = this,\n      joins = this._criteria.joins || [],\n      pk = 'id',\n      attr,\n      join;\n\n  // Set the attr value to the generated schema attribute\n  attr = this._context.waterline.schema[this._context.identity].attributes[keyName];\n\n  // Get the current collection's primary key attribute\n  Object.keys(this._context._attributes).forEach(function(key) {\n    if(hasOwnProperty(self._context._attributes[key], 'primaryKey')) {\n      pk = self._context._attributes[key].columnName || key;\n    }\n  });\n\n  if(!attr) throw new Error('Attempting to populate an attribute that doesn\\'t exist');\n\n  // TODO:\n  // Create synonym for `.populate()` syntax using criteria object\n  // syntax.  i.e. instead of using `joins` key in criteria object\n  // at the app level.\n\n  // TODO:\n  // Support Mongoose-style `foo.bar.baz` syntax for nested `populate`s.\n  // (or something comparable.)\n  // One solution would be:\n  // .populate({\n  //   friends: {\n  //     where: { name: 'mike' },\n  //     populate: {\n  //       dentist: {\n  //         where: { name: 'rob' }\n  //       }\n  //     }\n  //   }\n  // }, optionalCriteria )\n\n\n  // Grab the key being populated to check if it is a has many to belongs to\n  // If it's a belongs_to the adapter needs to know that it should replace the foreign key\n  // with the associated value.\n  var parentKey = this._context.waterline.collections[this._context.identity].attributes[keyName];\n\n  // Build the initial join object that will link this collection to either another collection\n  // or to a junction table.\n  join = {\n    parent: this._context.identity,\n    parentKey: attr.columnName || pk,\n    child: attr.references,\n    childKey: attr.on,\n    select: Object.keys(this._context.waterline.schema[attr.references].attributes),\n    alias: keyName,\n    removeParentKey: parentKey.model ? true : false,\n    model: hasOwnProperty(parentKey, 'model') ? true : false,\n    collection: hasOwnProperty(parentKey, 'collection') ? true : false\n  };\n\n  // Build select object to use in the integrator\n  var select = [];\n  Object.keys(this._context.waterline.schema[attr.references].attributes).forEach(function(key) {\n    var obj = self._context.waterline.schema[attr.references].attributes[key];\n    if(!hasOwnProperty(obj, 'columnName')) {\n      select.push(key);\n      return;\n    }\n\n    select.push(obj.columnName);\n  });\n\n  join.select = select;\n\n  // If linking to a junction table the attributes shouldn't be included in the return value\n  if(this._context.waterline.schema[attr.references].junctionTable) join.select = false;\n\n  joins.push(join);\n\n  // If a junction table is used add an additional join to get the data\n  if(this._context.waterline.schema[attr.references].junctionTable && hasOwnProperty(attr, 'on')) {\n\n    // clone the reference attribute so we can mutate it\n    var reference = _.clone(this._context.waterline.schema[attr.references].attributes);\n\n    // Find the other key in the junction table\n    Object.keys(reference).forEach(function(key) {\n      var attribute = reference[key];\n\n      if(!hasOwnProperty(attribute, 'references')) {\n        delete reference[key];\n        return;\n      }\n\n      if(hasOwnProperty(attribute, 'columnName') && attribute.columnName === attr.on) {\n        delete reference[key];\n        return;\n      }\n\n      if(hasOwnProperty(attribute, 'columnName') && attribute.columnName !== attr.on) {\n        return;\n      }\n\n      if(key !== attr.on) delete reference[key];\n    });\n\n    // Get the only remaining key left\n    var ref = Object.keys(reference)[0];\n\n    if(ref) {\n\n      // Build out the second join object that will link a junction table with the\n      // values being populated\n      join = {\n        parent: attr.references,\n        parentKey: reference[ref].columnName,\n        child: reference[ref].references,\n        childKey: reference[ref].on,\n        select: Object.keys(this._context.waterline.schema[reference[ref].references].attributes),\n        alias: keyName,\n        junctionTable: true,\n        removeParentKey: parentKey.model ? true : false,\n        model: false,\n        collection: true\n      };\n\n      joins.push(join);\n    }\n  }\n\n  // Append the criteria to the correct join if available\n  if(criteria && joins.length > 1) {\n    joins[1].criteria = criteria;\n  } else if(criteria) {\n    joins[0].criteria = criteria;\n  }\n\n  // Set the criteria joins\n  this._criteria.joins = joins;\n\n  return this;\n};\n\n/**\n * Add a Where clause to the criteria object\n *\n * @param {Object} criteria to append\n * @return this\n */\n\nDeferred.prototype.where = function(criteria) {\n\n  if(!criteria) return this;\n\n  // Normalize criteria\n  criteria = normalize.criteria(criteria);\n\n  // Wipe out the existing WHERE clause if the specified criteria ends up `false`\n  // (since neither could match anything)\n  if (criteria === false){\n    this._criteria = false;\n  }\n\n  if(!criteria || !criteria.where) return this;\n\n  if(!this._criteria) this._criteria = {};\n  var where = this._criteria.where || {};\n\n  // Merge with existing WHERE clause\n  Object.keys(criteria.where).forEach(function(key) {\n    where[key] = criteria.where[key];\n  });\n\n  this._criteria.where = where;\n\n  return this;\n};\n\n/**\n * Add a Limit clause to the criteria object\n *\n * @param {Integer} number to limit\n * @return this\n */\n\nDeferred.prototype.limit = function(limit) {\n  this._criteria.limit = limit;\n\n  return this;\n};\n\n/**\n * Add a Skip clause to the criteria object\n *\n * @param {Integer} number to skip\n * @return this\n */\n\nDeferred.prototype.skip = function(skip) {\n  this._criteria.skip = skip;\n\n  return this;\n};\n\n/**\n * Add a Paginate clause to the criteria object\n *\n * This is syntatical sugar that calls skip and\n * limit from a single function.\n *\n * @param {Object} page and limit\n * @return this\n */\nDeferred.prototype.paginate = function(options) {\n  var defaultLimit = 10;\n\n  if(options === undefined) options = { page: 0, limit: defaultLimit };\n\n  var page  = options.page  || 0,\n      limit = options.limit || defaultLimit,\n      skip  = 0;\n\n  if (page > 0 && limit === 0) skip = page - 1;\n  if (page > 0 && limit > 0)  skip = (page * limit) - limit;\n\n  this\n  .skip(skip)\n  .limit(limit);\n\n  return this;\n};\n\n/**\n * Add a groupBy clause to the criteria object\n *\n * @param {Array|Arguments} Keys to group by\n * @return this\n */\nDeferred.prototype.groupBy = function() {\n  buildAggregate.call(this, 'groupBy', Array.prototype.slice.call(arguments));\n  return this;\n};\n\n\n/**\n * Add a Sort clause to the criteria object\n *\n * @param {String|Object} key and order\n * @return this\n */\n\nDeferred.prototype.sort = function(criteria) {\n\n  if(!criteria) return this;\n\n  // Normalize criteria\n  criteria = normalize.criteria({ sort: criteria });\n\n  var sort = this._criteria.sort || {};\n\n  Object.keys(criteria.sort).forEach(function(key) {\n    sort[key] = criteria.sort[key];\n  });\n\n  this._criteria.sort = sort;\n\n  return this;\n};\n\n/**\n * Add a Sum clause to the criteria object\n *\n * @param {Array|Arguments} Keys to sum over\n * @return this\n */\nDeferred.prototype.sum = function() {\n  buildAggregate.call(this, 'sum', Array.prototype.slice.call(arguments));\n  return this;\n};\n\n/**\n * Add an Average clause to the criteria object\n *\n * @param {Array|Arguments} Keys to average over\n * @return this\n */\nDeferred.prototype.average = function() {\n  buildAggregate.call(this, 'average', Array.prototype.slice.call(arguments));\n  return this;\n};\n\n/**\n * Add a min clause to the criteria object\n *\n * @param {Array|Arguments} Keys to min over\n * @return this\n */\nDeferred.prototype.min = function() {\n  buildAggregate.call(this, 'min', Array.prototype.slice.call(arguments));\n  return this;\n};\n\n/**\n * Add a min clause to the criteria object\n *\n * @param {Array|Arguments} Keys to min over\n * @return this\n */\nDeferred.prototype.max = function() {\n  buildAggregate.call(this, 'max', Array.prototype.slice.call(arguments));\n  return this;\n};\n\n\n\n/**\n * Add values to be used in update or create query\n *\n * @param {Object, Array} values\n * @return this\n */\n\nDeferred.prototype.set = function(values) {\n  this._values = values;\n\n  return this;\n};\n\n/**\n * Execute a Query using the method passed into the\n * constuctor.\n *\n * @param {Function} callback\n * @return callback with parameters (err, results)\n */\n\nDeferred.prototype.exec = function(cb) {\n\n  if(!cb) {\n    console.log( new Error('Error: No Callback supplied, you must define a callback.').message );\n    return;\n  }\n\n  // Normalize callback/switchback\n  cb = normalize.callback(cb);\n\n  // Set up arguments + callback\n  var args = [this._criteria, cb];\n  if(this._values) args.splice(1, 0, this._values);\n\n  // Pass control to the adapter with the appropriate arguments.\n  this._method.apply(this._context, args);\n};\n\n/**\n * Executes a Query, and returns a promise\n */\n\nDeferred.prototype.toPromise = function() {\n  var deferred = Q.defer();\n\n  this.exec(deferred.makeNodeResolver());\n\n  return deferred.promise;\n};\n\n/**\n * Executes a Query, and returns a promise that applies cb/ec to the\n * result/error.\n */\n\nDeferred.prototype.then = function(cb, ec) {\n  return this.toPromise().then(cb, ec);\n};\n\n/**\n * Applies results to function fn.apply, and returns a promise\n */\n\nDeferred.prototype.spread = function(cb) {\n  return this.toPromise().spread(cb);\n};\n\n/**\n * returns a promise and gets resolved with error\n */\n\nDeferred.prototype.fail = function(cb) {\n  return this.toPromise().fail(cb);\n};\n\n\n/**\n * Build An Aggregate Criteria Option\n *\n * @param {String} key\n * @api private\n */\n\nfunction buildAggregate(key, args) {\n\n  // If passed in a list, set that as the min criteria\n  if (args[0] instanceof Array) {\n    args = args[0];\n  }\n\n  this._criteria[key] = args || {};\n}\n","/**\n * Streams\n *\n * A Streaming API with support for Transformations\n */\n\nvar util = require('util'),\n    Stream = require('stream'),\n    Transformations = require('./transformations'),\n    _ = require('lodash');\n\nvar ModelStream = module.exports = function(transformation) {\n\n  // Use specified, or otherwise default, JSON transformation\n  this.transformation = transformation || Transformations.json;\n\n  // Reset write index\n  this.index = 0;\n\n  // Make stream writable\n  this.writable = true;\n};\n\nutil.inherits(ModelStream, Stream);\n\n/**\n * Write to stream\n *\n * Extracts args to write and emits them as data events\n *\n * @param {Object} model\n * @param {Function} cb\n */\n\nModelStream.prototype.write = function(model, cb) {\n  var self = this;\n\n  // Run transformation on this item\n  this.transformation.write(model, this.index, function writeToStream(err, transformedModel) {\n\n    // Increment index for next time\n    self.index++;\n\n    // Write transformed model to stream\n    self.emit('data', _.clone(transformedModel));\n\n    // Inform that we're finished\n    if(cb) return cb(err);\n  });\n\n};\n\n/**\n * End Stream\n */\n\nModelStream.prototype.end = function(err, cb) {\n  var self = this;\n\n  if(err) {\n    this.emit('error', err.message);\n    if(cb) return cb(err);\n    return;\n  }\n\n  this.transformation.end(function(err, suffix) {\n\n    if(err) {\n      self.emit('error', err);\n      if(cb) return cb(err);\n      return;\n    }\n\n    // Emit suffix if specified\n    if(suffix) self.emit('data', suffix);\n    self.emit('end');\n    if(cb) return cb();\n  });\n};\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","/**\n * Module Dependencies\n */\n\nvar _ = require('lodash');\n\n/**\n * Sort `data` (tuples) using `sortCriteria` (comparator)\n *\n * Based on method described here:\n * http://stackoverflow.com/a/4760279/909625\n *\n * @param  { Object[] } data         [tuples]\n * @param  { Object }   sortCriteria [mongo-style comparator object]\n * @return { Object[] }\n */\n\nmodule.exports = function sortData(data, sortCriteria) {\n\n  function dynamicSort(property) {\n    var sortOrder = 1;\n    if(property[0] === '-') {\n      sortOrder = -1;\n      property = property.substr(1);\n    }\n\n    return function (a,b) {\n      var result = (a[property] < b[property]) ? -1 : (a[property] > b[property]) ? 1 : 0;\n      return result * sortOrder;\n    };\n  }\n\n  function dynamicSortMultiple() {\n    var props = arguments;\n    return function (obj1, obj2) {\n      var i = 0, result = 0, numberOfProperties = props.length;\n\n      while(result === 0 && i < numberOfProperties) {\n        result = dynamicSort(props[i])(obj1, obj2);\n        i++;\n      }\n      return result;\n    };\n  }\n\n  // build sort criteria in the format ['firstName', '-lastName']\n  var sortArray = [];\n  _.each(_.keys(sortCriteria), function(key) {\n    if(sortCriteria[key] === -1) sortArray.push('-' + key);\n    else sortArray.push(key);\n  });\n\n  data.sort(dynamicSortMultiple.apply(null, sortArray));\n  return data;\n};\n","/**\n * Module Dependencies\n */\n\nvar _ = require('lodash');\n\n/**\n * Logic For Handling Joins inside a Query Results Object\n */\n\nvar Joins = module.exports = function(joins, values, schema, collections) {\n\n  // Hold Joins specified in the criteria\n  this.joins = joins || [];\n\n  // Hold the result values\n  this.values = values || [];\n\n  // Hold the overall schema\n  this.schema = schema || {};\n\n  // Hold all the Waterline collections so we can make models\n  this.collections = collections || {};\n\n  // Build up modelOptions\n  this.modelOptions();\n\n  // Modelize values\n  this.models = this.makeModels();\n\n  return this;\n};\n\n/**\n * Build up Join Options that will be passed down to a Model instance.\n *\n * @api private\n */\n\nJoins.prototype.modelOptions = function modelOptions() {\n\n  var self = this,\n      joins;\n\n  // Build Model Options, determines what associations to render in toObject\n  this.options = {\n    showJoins: this.joins ? true : false\n  };\n\n  // If no joins were used, just return\n  if(!this.joins) return;\n\n  // Map out join names to pass down to the model instance\n  joins = this.joins.filter(function(join) {\n\n    // If the value is not being selected, don't add it to the array\n    if(!join.select) return false;\n\n    return join;\n  });\n\n  // Map out join key names and attach to the options object.\n  // For normal assoiciations, use the child table name that is being joined. For many-to-many\n  // associations the child table name won't work so grab the alias used and use that for the\n  // join name. It will be the one that is transformed.\n  this.options.joins = joins.map(function(join) {\n    var child = [];\n    // If a junctionTable was not used, return the child table\n    if(!join.junctionTable) return join.child;\n\n    // Find the original alias for the join\n    self.joins.forEach(function(j) {\n      if(j.child !== join.parent) return;\n      child.push(j.alias);\n    });\n\n    // If a child was found, return it otherwise just return the original child join\n    if(child) return child;\n    return join.child;\n  });\n\n  // Flatten joins\n  this.options.joins = _.uniq(_.flatten(this.options.joins));\n};\n\n/**\n * Transform Values into instantiated Models.\n *\n * @return {Array}\n * @api private\n */\n\nJoins.prototype.makeModels = function makeModels() {\n\n  var self = this,\n      models = [],\n      model;\n\n  // If values are invalid (not an array), return them early.\n  if (!this.values || !this.values.forEach) return this.values;\n\n  // Make each result an instance of model\n  this.values.forEach(function(value) {\n    model = self.modelize(value);\n    models.push(model);\n  });\n\n  return models;\n};\n\n/**\n * Handle a single Result and inspect it's values for anything\n * that needs to become a Model instance.\n *\n * @param {Object} value\n * @return {Object}\n * @api private\n */\n\nJoins.prototype.modelize = function modelize(value) {\n  var self = this;\n\n  // Look at each key in the object and see if it was used in a join\n  Object.keys(value).forEach(function(key) {\n\n    var joinKey = false,\n        attr,\n        usedInJoin;\n\n    // If showJoins wasn't set or no joins were found there is nothing to modelize\n    if(!self.options.showJoins || !self.options.joins) return;\n\n    // Look at the schema for an attribute and check if it's a foreign key\n    // or a virtual hasMany collection attribute\n    attr = self.schema[key];\n\n    // If an attribute was found but it's not a model, this means it's a normal\n    // key/value attribute and not an association so there is no need to modelize it.\n    if(attr && !attr.hasOwnProperty('model')) return;\n\n    // If the attribute has a `model` property, the joinKey is the collection of the model\n    if(attr && attr.hasOwnProperty('model')) joinKey = attr.model;\n\n    // If the attribute is a foreign key but it was not populated, just leave the foreign key\n    // as it is and don't try and modelize it.\n    if(joinKey && self.options.joins.indexOf(joinKey) < 0) return;\n\n    // Check if the key was used in a join\n    usedInJoin = self.checkForJoin(key);\n\n    // If the attribute wasn't used in the join, don't turn it into a model instance.\n    // NOTE: Not sure if this is correct or not?\n    if(!usedInJoin.used) return;\n\n    // If the attribute is an array of child values, for each one make a model out of it.\n    if(Array.isArray(value[key])) {\n\n      var records = [];\n\n      value[key].forEach(function(val) {\n        var collection,\n            model;\n\n        // If there is a joinKey this means it's a belongsTo association so the collection\n        // containing the proper model will be the name of the joinKey model.\n        if(joinKey) {\n          collection = self.collections[joinKey];\n          val = collection._transformer.unserialize(val);\n          model = new collection._model(val, { showJoins: false });\n          return records.push(model);\n        }\n\n        // Otherwise look at the join used and determine which key should be used to get\n        // the proper model from the collections.\n        collection = self.collections[usedInJoin.join.child];\n        val = collection._transformer.unserialize(val);\n        model = new collection._model(val, { showJoins: false });\n        return records.push(model);\n      });\n\n      // Set the value to the array of model values\n      value[key] = records;\n      return;\n    }\n\n    // If the value isn't an array it's a populated foreign key so modelize it and attach\n    // it directly on the attribute\n    collection = self.collections[joinKey];\n    value[key] = collection._transformer.unserialize(value[key]);\n    value[key] = new collection._model(value[key], { showJoins: false });\n  });\n\n  return value;\n};\n\n/**\n * Test if an attribute was used in a join.\n * Requires generating a key to test against an attribute because the model process\n * will be run before any transformations have taken place.\n *\n * @param {String} key\n * @return {Object}\n * @api private\n */\n\nJoins.prototype.checkForJoin = function checkForJoin(key) {\n\n  var generatedKey,\n      usedInJoin = false,\n      relatedJoin;\n\n  // Loop through each join and see if the given key matches a join used\n  this.joins.forEach(function(join) {\n    if(join.alias !== key) return;\n    usedInJoin = true;\n    relatedJoin = join;\n  });\n\n  return { used: usedInJoin, join: relatedJoin };\n};\n","\n/**\n * Module Dependencies\n */\n\nvar _ = require('lodash'),\n    async = require('async'),\n    utils = require('../../utils/helpers'),\n    normalize = require('../../utils/normalize'),\n    hasOwnProperty = utils.object.hasOwnProperty;\n\n/**\n * Builds up a set of operations to perform based on search criteria.\n *\n * This allows the ability to do cross-adapter joins as well as fake joins\n * on adapters that haven't implemented the join interface yet.\n */\n\nvar Operations = module.exports = function(context, criteria, parent) {\n\n  // Build up a cache\n  this.cache = {};\n\n  // Set context\n  this.context = context;\n\n  // Set criteria\n  this.criteria = criteria;\n\n  // Set parent\n  this.parent = parent;\n\n  // Hold a default value for pre-combined results (native joins)\n  this.preCombined = false;\n\n  // Seed the Cache\n  this._seedCache();\n\n  // Build Up Operations\n  this.operations = this._buildOperations();\n\n  return this;\n};\n\n\n/***********************************************************************************\n * PUBLIC METHODS\n ***********************************************************************************/\n\n\n/**\n * Run Operations\n *\n * Execute a set of generated operations returning an array of results that can\n * joined in-memory to build out a valid results set.\n *\n * @param {Function} cb\n * @api public\n */\n\nOperations.prototype.run = function run(cb) {\n\n  var self = this;\n\n  // Grab the parent operation, it will always be the very first operation\n  var parentOp = this.operations.shift();\n\n  // Run The Parent Operation\n  this._runOperation(parentOp.collection, parentOp.method, parentOp.criteria, function(err, results) {\n\n    if(err) return cb(err);\n\n    // Set the cache values\n    self.cache[parentOp.collection] = results;\n\n    // If results are empty, nothing else to so do return\n    if(!results) return cb(null, { combined: true, cache: self.cache });\n\n    // Run child operations and populate the cache\n    self._execChildOpts(results, function(err) {\n      if(err) return cb(err);\n      cb(null, { combined: self.preCombined, cache: self.cache });\n    });\n\n  });\n\n};\n\n\n/***********************************************************************************\n * PRIVATE METHODS\n ***********************************************************************************/\n\n\n/**\n * Seed Cache with empty values.\n *\n * For each Waterline Collection set an empty array of values into the cache.\n *\n * @api private\n */\n\nOperations.prototype._seedCache = function _seedCache() {\n  var self = this;\n\n  // Fill the cache with empty values for each collection\n  Object.keys(this.context.waterline.schema).forEach(function(key) {\n    self.cache[key] = [];\n  });\n};\n\n/**\n * Build up the operations needed to perform the query based on criteria.\n *\n * @return {Array}\n * @api private\n */\n\nOperations.prototype._buildOperations = function _buildOperations() {\n\n  var self = this,\n      operations = [];\n\n  // Check if joins were used, if not only a single operation is needed on a single connection\n  if(!hasOwnProperty(this.criteria, 'joins')) {\n\n    // Grab the collection\n    var collection = this.context.waterline.collections[this.context.identity];\n\n    // Find the name of the connection to run the query on using the dictionary\n    var connectionName = collection.adapterDictionary[this.parent];\n    if(!connectionName) connectionName = collection.adapterDictionary.find;\n\n    operations.push({\n      connection: connectionName,\n      collection: this.context.identity,\n      method: this.parent,\n      criteria: this.criteria\n    });\n\n    return operations;\n  }\n\n  // Joins were used in this operation. Lets grab the connections needed for these queries. It may\n  // only be a single connection in a simple case or it could be multiple connections in some cases.\n  var connections = this._getConnections();\n\n  // Now that all the connections are created, build up operations needed to accomplish the end\n  // goal of getting all the results no matter which connection they are on. To do this,\n  // figure out if a connection supports joins and if so pass down a criteria object containing\n  // join instructions. If joins are not supported by a connection, build a series of operations\n  // to achieve the end result.\n  operations = this._stageOperations(connections);\n\n  return operations;\n};\n\n/**\n * Stage Operation Sets\n *\n * @param {Object} connections\n * @api private\n */\n\nOperations.prototype._stageOperations = function _stageOperations(connections) {\n\n  var self = this,\n      operations = [];\n\n  // Build the parent operation and set it as the first operation in the array\n  operations = operations.concat(this._createParentOperation(connections));\n\n  // Parent Connection Name\n  var parentConnection = this.context.adapterDictionary[this.parent];\n\n  // Parent Operation\n  var parentOperation = operations[0];\n\n  // For each additional connection build operations\n  Object.keys(connections).forEach(function(connection) {\n\n    // Ignore the connection used for the parent operation if a join can be used on it.\n    // This means all of the operations for the query can take place on a single connection\n    // using a single query.\n    if(connection === parentConnection && parentOperation.method === 'join') return;\n\n    // Operations are needed that will be run after the parent operation has been completed.\n    // If there are more than a single join, set the parent join and build up children operations.\n    // This occurs in a many-to-many relationship when a join table is needed.\n\n    // Criteria is omitted until after the parent operation has been run so that an IN query can\n    // be formed on child operations.\n\n    var localOpts = [];\n\n    connections[connection].joins.forEach(function(join, idx) {\n\n      var operation = {\n        connection: connection,\n        collection: join.child,\n        method: 'find',\n        join: join\n      };\n\n      // If this is the first join, it can't have any parents\n      if(idx === 0) {\n        localOpts.push(operation);\n        return;\n      }\n\n      // Look into the previous operations and see if this is a child of any of them\n      var child = false;\n      localOpts.forEach(function(localOpt) {\n        if(localOpt.join.child !== join.parent) return;\n        localOpt.child = operation;\n        child = true;\n      });\n\n      if(child) return;\n      localOpts.push(operation);\n    });\n\n    operations = operations.concat(localOpts);\n  });\n\n  return operations;\n};\n\n/**\n * Create The Parent Operation\n *\n * @param {Object} connections\n * @return {Object}\n * @api private\n */\n\nOperations.prototype._createParentOperation = function _createParentOperation(connections) {\n\n  var nativeJoin = this.context.adapter.hasJoin(),\n      operation,\n      connectionName,\n      connection;\n\n  // If the parent supports native joins, check if all the joins on the connection can be\n  // run on the same connection and if so just send the entire criteria down to the connection.\n  if(nativeJoin) {\n\n    connectionName = this.context.adapterDictionary.join;\n    connection = connections[connectionName];\n\n    // Hold any joins that can't be run natively on this connection\n    var unsupportedJoins = false;\n\n    // Pull out any unsupported joins\n    connection.joins.forEach(function(join) {\n      if(connection.collections.indexOf(join.child) > -1) return;\n      unsupportedJoins = true;\n    });\n\n    // If all the joins were supported then go ahead and build an operation.\n    if(!unsupportedJoins) {\n      operation = [{\n        connection: connectionName,\n        collection: this.context.identity,\n        method: 'join',\n        criteria: this.criteria\n      }];\n\n      // Set the preCombined flag\n      this.preCombined = true;\n\n      return operation;\n    }\n  }\n\n  // Remove the joins from the criteria object, this will be an in-memory join\n  var tmpCriteria = _.cloneDeep(this.criteria);\n  delete tmpCriteria.joins;\n\n  connectionName = this.context.adapterDictionary[this.parent];\n\n  // If findOne was used, use the same connection `find` is on.\n  if(this.parent === 'findOne' && !connectionName) {\n    connectionName = this.context.adapterDictionary.find;\n  }\n\n  connection = connections[connectionName];\n\n  operation = [{\n    connection: connectionName,\n    collection: this.context.identity,\n    method: this.parent,\n    criteria: tmpCriteria\n  }];\n\n  return operation;\n};\n\n\n/**\n * Get the connections used in this query and the join logic for each piece.\n *\n * @return {Object}\n * @api private\n */\n\nOperations.prototype._getConnections = function _getConnections() {\n\n  var self = this,\n      connections = {},\n      collection,\n      collectionName;\n\n  // Default structure for connection objects\n  var defaultConnection = {\n    collections: [],\n    children: [],\n    joins: []\n  };\n\n  // For each join build a connection item to build up an entire collection/connection registry\n  // for this query. Using this, queries should be able to be seperated into discrete queries\n  // which can be run on connections in parallel.\n  this.criteria.joins.forEach(function(join) {\n\n    var connection;\n\n    // If this join is a junctionTable, find the parent operation and add it to that connections\n    // children instead of creating a new operation on another connection. This allows cross-connection\n    // many-to-many joins to be used where the join relies on the results of the parent operation\n    // being run first.\n\n    if(join.junctionTable) {\n\n      // Grab the parent collection\n      collection = self.context.waterline.collections[join.parent];\n\n      // Find the connection object in the registry\n      connectionName = collection.adapterDictionary['find'];\n      connections[connectionName] = connections[connectionName] || _.clone(DefaultConnection);\n\n      // Update the registry with the join values\n      connections[connectionName].collections.push(join.child);\n      connections[connectionName].children.push(join.parent);\n\n      // Add the join to the joins array for this connection\n      connections[connectionName].joins = connections[connectionName].joins.concat(join);\n\n      return;\n    }\n\n    function updateRegistry(collName) {\n      collection = self.context.waterline.collections[collName];\n      connectionName = collection.adapterDictionary['find'];\n      connections[connectionName] = connections[connectionName] || _.clone(defaultConnection);\n\n      // Update the registry with the join values\n      connections[connectionName].collections.push(collection.identity);\n    }\n\n    updateRegistry(join.parent);\n    updateRegistry(join.child);\n\n    // Add the join to the joins array for this connection\n    connections[connectionName].joins = connections[connectionName].joins.concat(join);\n  });\n\n  return connections;\n};\n\n\n/**\n * Run An Operation\n *\n * Performs an operation and runs a supplied callback.\n *\n * @param {Object} collectionName\n * @param {String} method\n * @param {Object} criteria\n * @param {Function} cb\n *\n * @api private\n */\n\nOperations.prototype._runOperation = function _runOperation(collectionName, method, criteria, cb) {\n\n  // Ensure the collection exist\n  if(!hasOwnProperty(this.context.waterline.collections, collectionName)) {\n    return cb(new Error('Invalid Collection specfied in operation.'));\n  }\n\n  // Find the connection object to run the operation\n  var collection = this.context.waterline.collections[collectionName];\n\n  // Run the operation\n  collection.adapter[method](criteria, cb);\n\n};\n\n/**\n * Execute Child Operations\n *\n * If joins are used and an adapter doesn't support them, there will be child operations that will\n * need to be run. Parse each child operation and run them along with any tree joins and return\n * an array of children results that can be combined with the parent results.\n *\n * @param {Array} parentResults\n * @param {Function} cb\n */\n\nOperations.prototype._execChildOpts = function _execChildOpts(parentResults, cb) {\n\n  var self = this;\n\n  // Build up a set of child operations that will need to be run\n  // based on the results returned from the parent operation.\n  this._buildChildOpts(parentResults, function(err, opts) {\n    if(err) return cb(err);\n\n    // Run the generated operations in parallel\n    async.each(opts, function(item, next) {\n      self._collectChildResults(item, next);\n    }, cb);\n  });\n\n};\n\n/**\n * Build Child Operations\n *\n * Using the results of a parent operation, build up a set of operations that contain criteria\n * based on what is returned from a parent operation. These can be arrays containing more than\n * one operation for each child, which will happen when \"join tables\" would be used.\n *\n * Each set should be able to be run in parallel.\n *\n * @param {Array} parentResults\n * @param {Function} cb\n * @return {Array}\n * @api private\n */\n\nOperations.prototype._buildChildOpts = function _buildChildOpts(parentResults, cb) {\n\n  var self = this;\n  var opts = [];\n\n  // Build up operations that can be run in parallel using the results of the parent operation\n  async.each(this.operations, function(item, next) {\n\n    var localOpts = [],\n        parents = [],\n        idx = 0;\n\n    // Go through all the parent records and build up an array of keys to look in. This\n    // will be used in an IN query to grab all the records needed for the \"join\".\n    parentResults.forEach(function(result) {\n\n      if(!hasOwnProperty(result, item.join.parentKey)) return;\n      if(result[item.join.parentKey] === null || typeof result[item.join.parentKey] === undefined) return;\n      parents.push(result[item.join.parentKey]);\n\n    });\n\n    // If no parents match the join criteria, don't build up an operation\n    if(parents.length === 0) return next();\n\n    // Build up criteria that will be used inside an IN query\n    var criteria = {};\n    criteria[item.join.childKey] = parents;\n\n    var _tmpCriteria = {};\n\n    // Check if the join contains any criteria\n    if(item.join.criteria) {\n      var userCriteria = _.cloneDeep(item.join.criteria);\n      _tmpCriteria = _.cloneDeep(userCriteria);\n      _tmpCriteria = normalize.criteria(_tmpCriteria);\n\n      // Ensure `where` criteria is properly formatted\n      if(hasOwnProperty(userCriteria, 'where')) {\n        if(userCriteria.where === undefined) {\n          delete userCriteria.where;\n        }\n        else {\n\n          // If an array of primary keys was passed in, normalize the criteria\n          if(Array.isArray(userCriteria.where)) {\n            var pk = self.context.waterline.collections[item.join.child].primaryKey;\n            var obj = {};\n            obj[pk] = _.clone(userCriteria.where);\n            userCriteria.where = obj;\n          }\n\n          userCriteria = userCriteria.where;\n        }\n      }\n\n\n      criteria = _.merge(userCriteria, criteria);\n    }\n\n    // Normalize criteria\n    criteria = normalize.criteria(criteria);\n\n    // If criteria contains a skip or limit option, an operation will be needed for each parent.\n    if(hasOwnProperty(_tmpCriteria, 'skip') || hasOwnProperty(_tmpCriteria, 'limit')) {\n      parents.forEach(function(parent) {\n\n        var tmpCriteria = _.cloneDeep(criteria);\n        tmpCriteria.where[item.join.childKey] = parent;\n\n        // Mixin the user defined skip and limit\n        if(hasOwnProperty(_tmpCriteria, 'skip')) tmpCriteria.skip = _tmpCriteria.skip;\n        if(hasOwnProperty(_tmpCriteria, 'limit')) tmpCriteria.limit = _tmpCriteria.limit;\n\n        // Build a simple operation to run with criteria from the parent results.\n        // Give it an ID so that children operations can reference it if needed.\n        localOpts.push({\n          id: idx,\n          collection: item.collection,\n          method: item.method,\n          criteria: tmpCriteria,\n          join: item.join\n        });\n\n      });\n    } else {\n\n      // Build a simple operation to run with criteria from the parent results.\n      // Give it an ID so that children operations can reference it if needed.\n      localOpts.push({\n        id: idx,\n        collection: item.collection,\n        method: item.method,\n        criteria: criteria,\n        join: item.join\n      });\n\n    }\n\n    // If there are child records, add the opt but don't add the criteria\n    if(!item.child) {\n      opts.push(localOpts);\n      return next();\n    }\n\n    localOpts.push({\n      collection: item.child.collection,\n      method: item.child.method,\n      parent: idx,\n      join: item.child.join\n    });\n\n    // Add the local opt to the opts array\n    opts.push(localOpts);\n\n    next();\n  }, function(err) {\n    cb(err, opts);\n  });\n};\n\n/**\n * Collect Child Operation Results\n *\n * Run a set of child operations and return the results in a namespaced array\n * that can later be used to do an in-memory join.\n *\n * @param {Array} opts\n * @param {Function} cb\n * @api private\n */\n\nOperations.prototype._collectChildResults = function _collectChildResults(opts, cb) {\n\n  var self = this,\n      intermediateResults = [],\n      i = 0;\n\n  if(!opts || opts.length === 0) return cb(null, {});\n\n  // Run the operations and any child operations in series so that each can access the\n  // results of the previous operation.\n  async.eachSeries(opts, function(opt, next) {\n    self._runChildOperations(intermediateResults, opt, function(err, values) {\n      if(err) return next(err);\n\n      // If there are multiple operations and we are on the first one lets put the results\n      // into an intermediate results array\n      if(opts.length > 1 && i === 0) {\n        intermediateResults = intermediateResults.concat(values);\n      }\n\n      // Add values to the cache key\n      self.cache[opt.collection] = self.cache[opt.collection] || [];\n      self.cache[opt.collection] = self.cache[opt.collection].concat(values);\n\n      // Ensure the values are unique\n      var pk = self._findCollectionPK(opt.collection);\n      self.cache[opt.collection] = _.uniq(self.cache[opt.collection], pk);\n\n      i++;\n      next();\n    });\n  }, cb);\n\n};\n\n/**\n * Run A Child Operation\n *\n * Executes a child operation and appends the results as a namespaced object to the\n * main operation results object.\n *\n * @param {Object} optResults\n * @param {Object} opt\n * @param {Function} callback\n * @api private\n */\n\nOperations.prototype._runChildOperations = function _runChildOperations(intermediateResults, opt, cb) {\n  var self = this;\n\n  // Check if value has a parent, if so a join table was used and we need to build up dictionary\n  // values that can be used to join the parent and the children together.\n\n  // If the operation doesn't have a parent operation run it\n  if(!hasOwnProperty(opt, 'parent')) {\n    return self._runOperation(opt.collection, opt.method, opt.criteria, function(err, values) {\n      if(err) return cb(err);\n      cb(null, values);\n    });\n  }\n\n  // If the operation has a parent, look into the optResults and build up a criteria\n  // object using the results of a previous operation\n  var parents = [];\n\n  // Normalize to array\n  var res = _.cloneDeep(intermediateResults);\n\n  // Build criteria that can be used with an `in` query\n  res.forEach(function(result) {\n    parents.push(result[opt.join.parentKey]);\n  });\n\n  var criteria = {};\n  criteria[opt.join.childKey] = parents;\n\n  // Check if the join contains any criteria\n  if(opt.join.criteria) {\n    var userCriteria = _.cloneDeep(opt.join.criteria);\n\n    // Ensure `where` criteria is properly formatted\n    if(hasOwnProperty(userCriteria, 'where')) {\n      if(userCriteria.where === undefined) {\n        delete userCriteria.where;\n      }\n      else {\n        userCriteria = userCriteria.where;\n      }\n    }\n\n    delete userCriteria.sort;\n    criteria = _.extend(criteria, userCriteria);\n  }\n\n  criteria = normalize.criteria({ where: criteria });\n\n  // Empty the cache for the join table so we can only add values used\n  var cacheCopy = _.cloneDeep(self.cache[opt.join.parent]);\n  self.cache[opt.join.parent] = [];\n\n  self._runOperation(opt.collection, opt.method, criteria, function(err, values) {\n    if(err) return cb(err);\n\n    // Build up the new join table result\n    values.forEach(function(val) {\n      cacheCopy.forEach(function(copy) {\n        if(copy[opt.join.parentKey] === val[opt.join.childKey]) self.cache[opt.join.parent].push(copy);\n      });\n    });\n\n    // Ensure the values are unique\n    var pk = self._findCollectionPK(opt.join.parent);\n    self.cache[opt.join.parent] = _.uniq(self.cache[opt.join.parent], pk);\n\n    cb(null, values);\n  });\n};\n\n/**\n * Find A Collection's Primary Key\n *\n * @param {String} collectionName\n * @api private\n * @return {String}\n */\n\nOperations.prototype._findCollectionPK = function _findCollectionPK(collectionName) {\n  var pk;\n\n  for(var attribute in this.context.waterline.collections[collectionName]._attributes) {\n    var attr = this.context.waterline.collections[collectionName]._attributes[attribute];\n    if(!hasOwnProperty(attr, 'primaryKey')) continue;\n    pk = attr.columnName || attribute;\n  }\n\n  return pk || null;\n};\n","/**\n * Module Dependencies\n */\n\nvar normalize = require('../utils/normalize');\nvar schema = require('../utils/schema');\nvar hasOwnProperty = require('../utils/helpers').object.hasOwnProperty;\n\n\n\n\n/**\n * DQL Adapter Normalization\n */\nmodule.exports = {\n\n  hasJoin: function() {\n    return hasOwnProperty(this.dictionary, 'join');\n  },\n\n\n  /**\n   * join()\n   *\n   * If `join` is defined in the adapter, Waterline will use it to optimize\n   * the `.populate()` implementation when joining collections within the same\n   * database connection.\n   *\n   * @param  {[type]}   criteria\n   * @param  {Function} cb\n   */\n  join: function(criteria, cb) {\n\n    // Normalize Arguments\n    criteria = normalize.criteria(criteria);\n    cb = normalize.callback(cb);\n\n    // Build Default Error Message\n    var err = 'No join() method defined in adapter!';\n\n    // Find the connection to run this on\n    if(!hasOwnProperty(this.dictionary, 'join')) return cb(new Error(err));\n\n    var connName = this.dictionary.join;\n    var adapter = this.connections[connName]._adapter;\n\n    if(!hasOwnProperty(adapter, 'join')) return cb(new Error(err));\n\n    // Parse Join Criteria and set references to any collection tableName properties.\n    // This is done here so that everywhere else in the codebase can use the collection identity.\n    criteria = schema.serializeJoins(criteria, this.query.waterline.schema);\n\n    adapter.join(connName, this.collection, criteria, cb);\n  },\n\n\n  /**\n   * create()\n   *\n   * Create one or more models.\n   *\n   * @param  {[type]}   values [description]\n   * @param  {Function} cb     [description]\n   * @return {[type]}          [description]\n   */\n  create: function(values, cb) {\n\n    var globalId = this.query.globalId;\n\n    // Normalize Arguments\n    cb = normalize.callback(cb);\n\n    if(Array.isArray(values)) return this.createEach.call(this, values, cb);\n\n    // Build Default Error Message\n    var err = 'No create() method defined in adapter!';\n\n    // Find the connection to run this on\n    if(!hasOwnProperty(this.dictionary, 'create')) return cb(new Error(err));\n\n    var connName = this.dictionary.create;\n    var adapter = this.connections[connName]._adapter;\n\n    if(!hasOwnProperty(adapter, 'create')) return cb(new Error(err));\n    adapter.create(connName, this.collection, values, normalize.callback(function afterwards (err, createdRecord) {\n      if (err) {\n        if (typeof err === 'object') err.model = globalId;\n        return cb(err);\n      }\n      else return cb(null, createdRecord);\n    }));\n  },\n\n\n\n  /**\n   * find()\n   *\n   * Find a set of models.\n   *\n   * @param  {[type]}   criteria [description]\n   * @param  {Function} cb       [description]\n   * @return {[type]}            [description]\n   */\n  find: function(criteria, cb) {\n\n    // Normalize Arguments\n    criteria = normalize.criteria(criteria);\n    cb = normalize.callback(cb);\n\n    // Build Default Error Message\n    var err = 'No find() method defined in adapter!';\n\n    // Find the connection to run this on\n    if(!hasOwnProperty(this.dictionary, 'find')) return cb(new Error(err));\n\n    var connName = this.dictionary.find;\n    var adapter = this.connections[connName]._adapter;\n\n    if(!adapter.find) return cb(new Error(err));\n    adapter.find(connName, this.collection, criteria, cb);\n  },\n\n\n  /**\n   * findOne()\n   *\n   * Find exactly one model.\n   *\n   * @param  {[type]}   criteria [description]\n   * @param  {Function} cb       [description]\n   * @return {[type]}            [description]\n   */\n  findOne: function(criteria, cb) {\n\n    // Normalize Arguments\n    cb = normalize.callback(cb);\n\n    // Build Default Error Message\n    var err = '.findOne() requires a criteria. If you want the first record try .find().limit(1)';\n\n    // If no criteria is specified or where is empty return an error\n    if(!criteria || criteria.where === null) return cb(new Error(err));\n\n    // Enforce limit to 1\n    criteria.limit = 1;\n\n    this.find(criteria, function(err, models) {\n      if(!models) return cb(err);\n      if(models.length < 1) return cb(err);\n\n      cb(null, models);\n    });\n  },\n\n  /**\n   * [count description]\n   * @param  {[type]}   criteria [description]\n   * @param  {Function} cb       [description]\n   * @return {[type]}            [description]\n   */\n  count: function(criteria, cb) {\n    var connName;\n\n    // Normalize Arguments\n    cb = normalize.callback(cb);\n    criteria = normalize.criteria(criteria);\n\n    // Build Default Error Message\n    var err = '.count() requires the adapter define either a count method or a find method';\n\n    // Find the connection to run this on\n    if(!hasOwnProperty(this.dictionary, 'count')) {\n\n      // If a count method isn't defined make sure a find method is\n      if(!hasOwnProperty(this.dictionary, 'find')) return cb(new Error(err));\n\n      // Use the find method\n      connName = this.dictionary.find;\n    }\n\n    if(!connName) connName = this.dictionary.count;\n    var adapter = this.connections[connName]._adapter;\n\n    if(hasOwnProperty(adapter, 'count')) return adapter.count(connName, this.collection, criteria, cb);\n\n    this.find(criteria, function(err, models) {\n      cb(err, models.length);\n    });\n  },\n\n\n  /**\n   * [update description]\n   * @param  {[type]}   criteria [description]\n   * @param  {[type]}   values   [description]\n   * @param  {Function} cb       [description]\n   * @return {[type]}            [description]\n   */\n  update: function (criteria, values, cb) {\n    var globalId = this.query.globalId;\n\n\n    // Normalize Arguments\n    cb = normalize.callback(cb);\n    criteria = normalize.criteria(criteria);\n\n    if (criteria === false) {\n      return cb(null, []);\n    }\n    else if(!criteria) {\n      return cb(new Error('No criteria or id specified!'));\n    }\n\n    // Build Default Error Message\n    var err = 'No update() method defined in adapter!';\n\n    // Find the connection to run this on\n    if(!hasOwnProperty(this.dictionary, 'update')) return cb(new Error(err));\n\n    var connName = this.dictionary.update;\n    var adapter = this.connections[connName]._adapter;\n\n    adapter.update(connName, this.collection, criteria, values, normalize.callback(function afterwards (err, updatedRecords) {\n      if (err) {\n        if (typeof err === 'object') err.model = globalId;\n        return cb(err);\n      }\n      return cb(null, updatedRecords);\n    }));\n  },\n\n\n  /**\n   * [destroy description]\n   * @param  {[type]}   criteria [description]\n   * @param  {Function} cb       [description]\n   * @return {[type]}            [description]\n   */\n  destroy: function(criteria, cb) {\n\n    // Normalize Arguments\n    cb = normalize.callback(cb);\n    criteria = normalize.criteria(criteria);\n\n    if(!criteria) return cb(new Error('No criteria or id specified!'));\n\n    // Build Default Error Message\n    var err = 'No destroy() method defined in adapter!';\n\n    // Find the connection to run this on\n    if(!hasOwnProperty(this.dictionary, 'destroy')) return cb(new Error(err));\n\n    var connName = this.dictionary.destroy;\n    var adapter = this.connections[connName]._adapter;\n\n    adapter.destroy(connName, this.collection, criteria, cb);\n  }\n\n};\n","/**\n * Compound Queries Adapter Normalization\n */\n\nvar _ = require('lodash'),\n    normalize = require('../utils/normalize'),\n    hasOwnProperty = require('../utils/helpers').object.hasOwnProperty;\n\nmodule.exports = {\n\n  findOrCreate: function(criteria, values, cb) {\n    var self = this,\n        connName,\n        adapter;\n\n    // If no values were specified, use criteria\n    if (!values) values = criteria.where ? criteria.where : criteria;\n\n    // Normalize Arguments\n    criteria = normalize.criteria(criteria);\n    cb = normalize.callback(cb);\n\n    // Build Default Error Message\n    var err = \"No find() or create() method defined in adapter!\";\n\n    // Custom user adapter behavior\n    if(hasOwnProperty(this.dictionary, 'findOrCreate')) {\n      connName = this.dictionary.findOrCreate;\n      adapter = this.connections[connName]._adapter;\n\n      if(hasOwnProperty(adapter, 'findOrCreate')) {\n        return adapter.findOrCreate(connName, this.collection, values, cb);\n      }\n    }\n\n    // Default behavior\n    // WARNING: Not transactional!  (unless your data adapter is)\n    this.findOne(criteria, function(err, result) {\n      if(err) return cb(err);\n      if(result) return cb(null, result[0]);\n\n      self.create(values, cb);\n    });\n  }\n\n};\n","/**\n * Aggregate Queries Adapter Normalization\n */\n\nvar _ = require('lodash'),\n    async = require('async'),\n    normalize = require('../utils/normalize'),\n    hasOwnProperty = require('../utils/helpers').object.hasOwnProperty;\n\nmodule.exports = {\n\n  // If an optimized createEach exists, use it, otherwise use an asynchronous loop with create()\n  createEach: function(valuesList, cb) {\n    var self = this,\n        connName,\n        adapter;\n\n    // Normalize Arguments\n    cb = normalize.callback(cb);\n\n    // Build Default Error Message\n    var err = \"No createEach() or create() method defined in adapter!\";\n\n    // Custom user adapter behavior\n    if(hasOwnProperty(this.dictionary, 'createEach')) {\n      connName = this.dictionary.createEach;\n      adapter = this.connections[connName]._adapter;\n\n      if(hasOwnProperty(adapter, 'createEach')) {\n        return adapter.createEach(connName, this.collection, valuesList, cb);\n      }\n    }\n\n    // Default behavior\n    // WARNING: Not transactional!  (unless your data adapter is)\n    var results = [];\n\n    // Find the connection to run this on\n    if(!hasOwnProperty(this.dictionary, 'create')) return cb(new Error(err));\n\n    connName = this.dictionary.create;\n    adapter = this.connections[connName]._adapter;\n\n    if(!hasOwnProperty(adapter, 'create')) return cb(new Error(err));\n\n    async.forEachSeries(valuesList, function (values, cb) {\n      adapter.create(connName, self.collection, values, function(err, row) {\n        if(err) return cb(err);\n        results.push(row);\n        cb();\n      });\n    }, function(err) {\n      if(err) return cb(err);\n      cb(null, results);\n    });\n  },\n\n  // If an optimized findOrCreateEach exists, use it, otherwise use an asynchronous loop with create()\n  findOrCreateEach: function(attributesToCheck, valuesList, cb) {\n    var self = this,\n        connName,\n        adapter;\n\n    // Normalize Arguments\n    cb = normalize.callback(cb);\n\n    // Clone sensitive data\n    attributesToCheck = _.clone(attributesToCheck);\n    valuesList = _.clone(valuesList);\n\n    // Custom user adapter behavior\n    if(hasOwnProperty(this.dictionary, 'findOrCreateEach')) {\n      connName = this.dictionary.findOrCreateEach;\n      adapter = this.connections[connName]._adapter;\n\n      if(hasOwnProperty(adapter, 'findOrCreateEach')) {\n        return adapter.findOrCreateEach(connName, this.collection, valuesList, cb);\n      }\n    }\n\n    // Build a list of models\n    var models = [];\n\n    async.forEachSeries(valuesList, function (values, cb) {\n      if (!_.isObject(values)) return cb(new Error('findOrCreateEach: Unexpected value in valuesList.'));\n\n      // Check that each of the criteria keys match:\n      // build a criteria query\n      var criteria = {};\n      attributesToCheck.forEach(function (attrName) {\n        criteria[attrName] = values[attrName];\n      });\n\n      return self.findOrCreate.call(self, criteria, values, function (err, model) {\n        if(err) return cb(err);\n\n        // Add model to list\n        if(model) models.push(model);\n\n        cb(null, model);\n      });\n    }, function (err) {\n      if(err) return cb(err);\n      cb(null, models);\n    });\n  }\n\n};\n","/**\n * Setup and Teardown Adapter Normalization\n */\n\nmodule.exports = {\n\n  // Teardown is fired once-per-adapter\n  // Should tear down any open connections, etc. for each collection\n  // (i.e. tear down any remaining connections to the underlying data model)\n  // (i.e. flush data to disk before the adapter shuts down)\n  teardown: function(cb) {\n    if (this.adapter.teardown)\n      return this.adapter.teardown.apply(this, arguments);\n\n    cb();\n  }\n\n};\n","/**\n * Module Dependencies\n */\n\nvar normalize = require('../utils/normalize'),\n    hasOwnProperty = require('../utils/helpers').object.hasOwnProperty;\n\n/**\n * Stream Normalization\n */\n\nmodule.exports = {\n\n  // stream.write() is used to send data\n  // Must call stream.end() to complete stream\n  stream: function (criteria, stream) {\n\n    // Normalize Arguments\n    criteria = normalize.criteria(criteria);\n\n    // Build Default Error Message\n    var err = \"No stream() method defined in adapter!\";\n\n    // Find the connection to run this on\n    if(!hasOwnProperty(this.dictionary, 'stream')) return stream.end(new Error(err));\n\n    var connName = this.dictionary.stream;\n    var adapter = this.connections[connName]._adapter;\n\n    if(!hasOwnProperty(adapter, 'stream')) return stream.end(new Error(err));\n    adapter.stream(connName, this.collection, criteria, stream);\n  }\n\n};\n","\n/**\n * Handles an Association\n */\n\nvar Association = module.exports = function() {\n  this.addModels = [];\n  this.removeModels = [];\n  this.value = [];\n};\n\n/**\n * Set Value\n *\n * @param {Number|Object} value\n * @api private\n */\n\nAssociation.prototype._setValue = function(value) {\n  if(Array.isArray(value)) {\n    this.value = value;\n    return;\n  }\n\n  this.value = this.value = [value];\n};\n\n/**\n * Get Value\n *\n * @api private\n */\n\nAssociation.prototype._getValue = function() {\n  var self = this,\n      value = this.value;\n\n  // Attach association methods to values array\n  // This allows access using the getter and the desired\n  // API for synchronously adding and removing associations.\n\n  value.add = function add (obj) {\n    self.addModels.push(obj);\n  };\n\n  value.remove = function remove (obj) {\n    self.removeModels.push(obj);\n  };\n\n  return value;\n};\n","\n/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\nvar utils = require('../../../utils/helpers');\nvar nestedOperations = require('../../../utils/nestedOperations');\nvar hop = utils.object.hasOwnProperty;\n\n/**\n * Update the current instance with the currently set values\n *\n * Called in the model instance context.\n *\n * @param {Object} collection\n * @param {Object} proto\n * @param {Array} mutatedModels\n * @param {Function} callback\n */\n\nvar Update = module.exports = function(collection, proto, mutatedModels, cb) {\n\n  var values = typeof proto.toObject === 'function' ? proto.toObject() : proto;\n  var attributes = collection.waterline.schema[collection.identity].attributes;\n  var primaryKey = this.findPrimaryKey(attributes, values);\n\n  if(!primaryKey) return cb(new Error('No Primary Key set to update the record with! ' +\n    'Try setting an attribute as a primary key or include an ID property.'));\n\n  if(!values[primaryKey]) return cb(new Error('No Primary Key set to update the record with! ' +\n    'Primary Key must have a value, it can\\'t be an optional value.'));\n\n  // Build Search Criteria\n  var criteria = {};\n  criteria[primaryKey] = values[primaryKey];\n\n  // Clone values so they can be mutated\n  var _values = _.cloneDeep(values);\n\n  // For any nested model associations (objects not collection arrays) that were not changed,\n  // lets set the value to just the foreign key so that an update query is not performed on the\n  // associatied model.\n  var keys = _.keys(_values);\n  keys.forEach(function(key) {\n\n    // If the key was changed, keep it expanded\n    if(mutatedModels.indexOf(key) !== -1) return;\n\n    // Reduce it down to a foreign key value\n    var vals = {};\n    vals[key] = _values[key];\n\n    // Delete and replace the value with a reduced version\n    delete _values[key];\n    var reduced = nestedOperations.reduceAssociations(collection.identity, collection.waterline.schema, vals);\n    _values = _.merge(_values, reduced);\n  });\n\n  // Update the collection with the new values\n  collection.update(criteria, _values, cb);\n};\n\n\n/**\n * Find Primary Key\n *\n * @param {Object} attributes\n * @param {Object} values\n * @api private\n */\n\nUpdate.prototype.findPrimaryKey = function(attributes, values) {\n  var primaryKey = null;\n\n  for(var attribute in attributes) {\n    if(hop(attributes[attribute], 'primaryKey')) {\n      primaryKey = attribute;\n    }\n  }\n\n  // If no primary key check for an ID property\n  if(!primaryKey && hop(values, 'id')) primaryKey = 'id';\n\n  return primaryKey;\n};\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\nvar async = require('async');\nvar utils = require('../../../utils/helpers');\nvar hasOwnProperty = utils.object.hasOwnProperty;\n\n/**\n * Add associations for a model.\n *\n * If an object was used a new record should be created and linked to the parent.\n * If only a primary key was used then the record should only be linked to the parent.\n *\n * Called in the model instance context.\n *\n * @param {Object} collection\n * @param {Object} proto\n * @param {Object} records\n * @param {Function} callback\n */\n\nvar Add = module.exports = function(collection, proto, records, cb) {\n\n  this.collection = collection;\n  this.proto = proto;\n  this.failedTransactions = [];\n  this.primaryKey = null;\n\n  var values = proto.toObject();\n  var attributes = collection.waterline.schema[collection.identity].attributes;\n\n  this.primaryKey = this.findPrimaryKey(attributes, values);\n\n  if(!this.primaryKey) return cb(new Error('No Primary Key set to associate the record with! ' +\n      'Try setting an attribute as a primary key or include an ID property.'));\n\n  if(!proto.toObject()[this.primaryKey]) return cb(new Error('No Primary Key set to associate the record with! ' +\n      'Primary Key must have a value, it can\\'t be an optional value.'));\n\n  // Loop through each of the associations on this model and add any associations\n  // that have been specified. Do this in series and limit the actual saves to 10\n  // at a time so that connection pools are not exhausted.\n  //\n  // In the future when transactions are available this will all be done on a single\n  // connection and can be re-written.\n\n  this.createCollectionAssociations(records, cb);\n};\n\n/**\n * Find Primary Key\n *\n * @param {Object} attributes\n * @param {Object} values\n * @api private\n */\n\nAdd.prototype.findPrimaryKey = function(attributes, values) {\n  var primaryKey = null;\n\n  for(var attribute in attributes) {\n    if(hasOwnProperty(attributes[attribute], 'primaryKey')) {\n      primaryKey = attribute;\n    }\n  }\n\n  // If no primary key check for an ID property\n  if(!primaryKey && hasOwnProperty(values, 'id')) primaryKey = 'id';\n\n  return primaryKey;\n};\n\n/**\n * Create Collection Associations\n *\n * @param {Object} records\n * @param {Function} callback\n * @api private\n */\n\nAdd.prototype.createCollectionAssociations = function(records, cb) {\n  var self = this;\n\n  async.eachSeries(Object.keys(records), function(associationKey, next) {\n    self.createAssociations(associationKey, records[associationKey], next);\n  },\n\n  function(err) {\n    if(err || self.failedTransactions.length > 0) {\n      return cb(null, self.failedTransactions);\n    }\n\n    cb();\n  });\n};\n\n/**\n * Create Records for an Association property on a collection\n *\n * @param {String} key\n * @param {Array} records\n * @param {Function} callback\n * @api private\n */\n\nAdd.prototype.createAssociations = function(key, records, cb) {\n  var self = this;\n\n  // Grab the collection the attribute references\n  // this allows us to make a query on it\n  var attribute = this.collection._attributes[key];\n  var collectionName = attribute.collection.toLowerCase();\n  var associatedCollection = this.collection.waterline.collections[collectionName];\n  var schema = this.collection.waterline.schema[this.collection.identity].attributes[key];\n\n  // Limit Adds to 10 at a time to prevent the connection pool from being exhausted\n  async.eachLimit(records, 10, function(association, next) {\n\n    // If an object was passed in it should be created.\n    // This allows new records to be created through the association interface\n    if(typeof association === 'object' && Object.keys(association).length > 0) {\n\n      // Check if the record contains a primary key, if so just link the values\n      if(hasOwnProperty(association, associatedCollection.primaryKey)) {\n        var pk = associatedCollection.primaryKey;\n        return self.updateRecord(associatedCollection, schema, association[pk], next);\n      }\n\n      return self.createNewRecord(associatedCollection, schema, association, next);\n    }\n\n    // If the value is a primary key just update the association's foreign key\n    // This will either create the new association through a foreign key or re-associatiate\n    // with another collection.\n    self.updateRecord(associatedCollection, schema, association, next);\n\n  }, cb);\n};\n\n/**\n * Create A New Record\n *\n * @param {Object} collection\n * @param {Object} attribute\n * @param {Object} values\n * @param {Function} callback\n * @api private\n */\n\nAdd.prototype.createNewRecord = function(collection, attribute, values, cb) {\n  var self = this;\n\n  // Check if this is a many-to-many by looking at the junctionTable flag\n  var schema = this.collection.waterline.schema[attribute.collection.toLowerCase()];\n  var junctionTable = schema.junctionTable || false;\n\n  // If this isn't a many-to-many then add the foreign key in to the values\n  if(!junctionTable) values[attribute.on] = this.proto[this.primaryKey];\n\n  collection.create(values, function(err, record) {\n\n    if(err) {\n      self.failedTransactions.push({\n        type: 'insert',\n        collection: collection.identity,\n        values: values,\n        err: err.message\n      });\n    }\n\n    // if no junction table then return\n    if(!junctionTable) return cb();\n\n    // if junction table but there was an error don't try and link the records\n    if(err) return cb();\n\n    // Find the collection's Primary Key value\n    var primaryKey = self.findPrimaryKey(collection._attributes, record.toObject());\n\n    if(!primaryKey) {\n      self.failedTransactions.push({\n        type: 'insert',\n        collection: collection.identity,\n        values: {},\n        err: new Error('No Primary Key value was found on the joined collection').message\n      });\n    }\n\n    // Find the Many To Many Collection\n    var joinCollection = self.collection.waterline.collections[attribute.collection.toLowerCase()];\n\n    // The related record was created now the record in the junction table\n    // needs to be created to link the two records\n    self.createManyToMany(joinCollection, attribute, record[primaryKey], cb);\n  });\n};\n\n/**\n * Update A Record\n *\n * @param {Object} collection\n * @param {Object} attribute\n * @param {Object} values\n * @param {Function} callback\n * @api private\n */\n\nAdd.prototype.updateRecord = function(collection, attribute, values, cb) {\n\n  // Check if this is a many-to-many by looking at the junctionTable flag\n  var schema = this.collection.waterline.schema[attribute.collection.toLowerCase()];\n  var junctionTable = schema.junctionTable || false;\n\n  // If so build out the criteria and create a new record in the junction table\n  if(junctionTable) {\n    var joinCollection = this.collection.waterline.collections[attribute.collection.toLowerCase()];\n    return this.createManyToMany(joinCollection, attribute, values, cb);\n  }\n\n  // Grab the associated collection's primaryKey\n  var attributes = this.collection.waterline.schema[collection.identity].attributes;\n  var associationKey = this.findPrimaryKey(attributes, attributes);\n\n  if(!associationKey) return cb(new Error('No Primary Key defined on the child record you ' +\n    'are trying to associate the record with! Try setting an attribute as a primary key or ' +\n    'include an ID property.'));\n\n  // Build up criteria and updated values used to update the record\n  var criteria = {};\n  var _values = {};\n\n  criteria[associationKey] = values;\n  _values[attribute.on] = this.proto[this.primaryKey];\n\n  collection.update(criteria, _values, function(err) {\n\n    if(err) {\n      self.failedTransactions.push({\n        type: 'update',\n        collection: collection.identity,\n        criteria: criteria,\n        values: _values,\n        err: err.message\n      });\n    }\n\n    cb();\n  });\n};\n\n/**\n * Create A Many To Many Join Table Record\n *\n * @param {Object} collection\n * @param {Object} attribute\n * @param {Object} values\n * @param {Function} callback\n * @api private\n */\n\nAdd.prototype.createManyToMany = function(collection, attribute, pk, cb) {\n  var self = this;\n\n  // Grab the associated collection's primaryKey\n  var collectionAttributes = this.collection.waterline.schema[attribute.collection.toLowerCase()];\n  var associationKey = collectionAttributes.attributes[attribute.on].via;\n\n  if(!associationKey) return cb(new Error('No Primary Key set on the child record you ' +\n    'are trying to associate the record with! Try setting an attribute as a primary key or ' +\n    'include an ID property.'));\n\n  // Build up criteria and updated values used to create the record\n  var criteria = {};\n  var _values = {};\n\n  criteria[associationKey] = pk;\n  criteria[attribute.on] = this.proto[this.primaryKey];\n  _values = _.clone(criteria);\n\n  async.auto({\n\n    validateAssociation: function(next) {\n      var associatedCollectionName = collectionAttributes.attributes[associationKey].references;\n      var associatedCollection = self.collection.waterline.collections[associatedCollectionName];\n      var primaryKey = self.findPrimaryKey(associatedCollection.attributes, {});\n      var _criteria = {};\n      _criteria[primaryKey] = pk;\n\n      associatedCollection.findOne(_criteria, function(err, record) {\n        if(err) return next(err);\n        if(!record) return next(new Error(\"Associated Record For \" + associatedCollectionName +\n          \" with \" + primaryKey + \" = \" + pk + \" No Longer Exists\"));\n\n        next();\n      });\n    },\n\n    validateRecord: function(next) {\n\n      // First look up the record to ensure it doesn't exist\n      collection.findOne(criteria, function(err, val) {\n        if(err || val) {\n          return next(new Error(\"Trying to '.add()' an instance which already exists!\"));\n        }\n        next();\n      });\n    },\n\n    createRecord: ['validateAssociation', 'validateRecord', function(next) {\n      collection.create(_values, next);\n    }]\n\n  }, function(err) {\n\n    if(err) {\n      self.failedTransactions.push({\n        type: 'insert',\n        collection: collection.identity,\n        criteria: criteria,\n        values: _values,\n        err: err.message\n      });\n    }\n\n    return cb();\n\n  });\n};\n\n/**\n * Find Association Key\n *\n * @param {Object} collection\n * @return {String}\n * @api private\n */\n\nAdd.prototype.findAssociationKey = function(collection) {\n  var associationKey = null;\n\n  for(var attribute in collection.attributes) {\n    var attr = collection.attributes[attribute];\n    var identity = this.collection.identity;\n\n    if(!hasOwnProperty(attr, 'references')) continue;\n    var attrCollection = attr.references;\n\n    if(attrCollection !== identity) {\n      associationKey = attr.columnName;\n    }\n  }\n\n  return associationKey;\n};\n","var _ = require('lodash');\nvar async = require('async');\nvar utils = require('../../../utils/helpers');\nvar hasOwnProperty = utils.object.hasOwnProperty;\n\n/**\n * Remove associations from a model.\n *\n * Accepts a primary key value of an associated record that already exists in the database.\n *\n *\n * @param {Object} collection\n * @param {Object} proto\n * @param {Object} records\n * @param {Function} callback\n */\n\nvar Remove = module.exports = function(collection, proto, records, cb) {\n\n  this.collection = collection;\n  this.proto = proto;\n  this.failedTransactions = [];\n  this.primaryKey = null;\n\n  var values = proto.toObject();\n  var attributes = collection.waterline.schema[collection.identity].attributes;\n\n  this.primaryKey = this.findPrimaryKey(attributes, values);\n\n  if(!this.primaryKey) return cb(new Error('No Primary Key set to associate the record with! ' +\n      'Try setting an attribute as a primary key or include an ID property.'));\n\n  if(!proto.toObject()[this.primaryKey]) return cb(new Error('No Primary Key set to associate ' +\n      'the record with! Primary Key must have a value, it can\\'t be an optional value.'));\n\n  // Loop through each of the associations on this model and remove any associations\n  // that have been specified. Do this in series and limit the actual saves to 10\n  // at a time so that connection pools are not exhausted.\n  //\n  // In the future when transactions are available this will all be done on a single\n  // connection and can be re-written.\n  this.removeCollectionAssociations(records, cb);\n};\n\n/**\n * Find Primary Key\n *\n * @param {Object} attributes\n * @param {Object} values\n * @api private\n */\n\nRemove.prototype.findPrimaryKey = function(attributes, values) {\n  var primaryKey = null;\n\n  for(var attribute in attributes) {\n    if(hasOwnProperty(attributes[attribute], 'primaryKey')) {\n      primaryKey = attribute;\n    }\n  }\n\n  // If no primary key check for an ID property\n  if(!primaryKey && hasOwnProperty(values, 'id')) primaryKey = 'id';\n\n  return primaryKey;\n};\n\n/**\n * Remove Collection Associations\n *\n * @param {Object} records\n * @param {Function} callback\n * @api private\n */\n\nRemove.prototype.removeCollectionAssociations = function(records, cb) {\n  var self = this;\n\n  async.eachSeries(Object.keys(records), function(associationKey, next) {\n    self.removeAssociations(associationKey, records[associationKey], next);\n  },\n\n  function(err) {\n    if(err || self.failedTransactions.length > 0) {\n      return cb(null, self.failedTransactions);\n    }\n\n    cb();\n  });\n};\n\n/**\n * Remove Associations\n *\n * @param {String} key\n * @param {Array} records\n * @param {Function} callback\n * @api private\n */\n\nRemove.prototype.removeAssociations = function(key, records, cb) {\n  var self = this;\n\n  // Grab the collection the attribute references\n  // this allows us to make a query on it\n  var attribute = this.collection._attributes[key];\n  var collectionName = attribute.collection.toLowerCase();\n  var associatedCollection = this.collection.waterline.collections[collectionName];\n  var schema = this.collection.waterline.schema[this.collection.identity].attributes[key];\n\n  // Limit Removes to 10 at a time to prevent the connection pool from being exhausted\n  async.eachLimit(records, 10, function(association, next) {\n    self.removeRecord(associatedCollection, schema, association, next);\n  }, cb);\n\n};\n\n/**\n * Remove A Single Record\n *\n * @param {Object} collection\n * @param {Object} attribute\n * @param {Object} values\n * @param {Function} callback\n * @api private\n */\n\nRemove.prototype.removeRecord = function(collection, attribute, values, cb) {\n  var self = this;\n\n  // Validate `values` is a correct primary key format\n  var validAssociationKey = this.validatePrimaryKey(values);\n\n  if(!validAssociationKey) {\n    this.failedTransactions.push({\n      type: 'remove',\n      collection: collection.identity,\n      values: values,\n      err: new Error('Remove association only accepts a single primary key value').message\n    });\n\n    return cb();\n  }\n\n  // Check if this is a many-to-many by looking at the junctionTable flag\n  var schema = this.collection.waterline.schema[attribute.collection.toLowerCase()];\n  var junctionTable = schema.junctionTable || false;\n\n  // If so build out the criteria and remove a record from the junction table\n  if(junctionTable) {\n    var joinCollection = this.collection.waterline.collections[attribute.collection.toLowerCase()];\n    return this.removeManyToMany(joinCollection, attribute, values, cb);\n  }\n\n  // Grab the associated collection's primaryKey\n  var attributes = this.collection.waterline.schema[collection.identity].attributes;\n  var associationKey = this.findPrimaryKey(attributes, attributes);\n\n  if(!associationKey) return cb(new Error('No Primary Key defined on the child record you ' +\n    'are trying to un-associate the record with! Try setting an attribute as a primary key or ' +\n    'include an ID property.'));\n\n  // Build up criteria and updated values used to update the record\n  var criteria = {};\n  var _values = {};\n\n  criteria[associationKey] = values;\n  _values[attribute.on] = null;\n\n  collection.update(criteria, _values, function(err) {\n\n    if(err) {\n      self.failedTransactions.push({\n        type: 'update',\n        collection: collection.identity,\n        criteria: criteria,\n        values: _values,\n        err: err.message\n      });\n    }\n\n    cb();\n  });\n};\n\n/**\n * Validate A Primary Key\n *\n * Only support primary keys being passed in to the remove function. Check if it's a mongo\n * id or anything that has a toString method.\n *\n * @param {Integer|String} key\n * @return {Boolean}\n * @api private\n */\n\nRemove.prototype.validatePrimaryKey = function(key) {\n  var validAssociation = false;\n\n  // Attempt to see if the value is an ID and resembles a MongoID\n  if(_.isString(key) && utils.matchMongoId(key)) validAssociation = true;\n\n  // Check it can be turned into a string\n  if(key.toString() !== '[object Object]') validAssociation = true;\n\n  return validAssociation;\n};\n\n/**\n * Remove A Many To Many Join Table Record\n *\n * @param {Object} collection\n * @param {Object} attribute\n * @param {Object} values\n * @param {Function} callback\n * @api private\n */\n\nRemove.prototype.removeManyToMany = function(collection, attribute, pk, cb) {\n  var self = this;\n\n  // Grab the associated collection's primaryKey\n  var collectionAttributes = this.collection.waterline.schema[attribute.collection.toLowerCase()];\n  var associationKey = collectionAttributes.attributes[attribute.on].via;\n\n  if(!associationKey) return cb(new Error('No Primary Key set on the child record you ' +\n    'are trying to associate the record with! Try setting an attribute as a primary key or ' +\n    'include an ID property.'));\n\n  // Build up criteria and updated values used to create the record\n  var criteria = {};\n  criteria[associationKey] = pk;\n  criteria[attribute.on] = this.proto[this.primaryKey];\n\n  // Run a destroy on the join table record\n  collection.destroy(criteria, function(err) {\n\n    if(err) {\n      self.failedTransactions.push({\n        type: 'destroy',\n        collection: collection.identity,\n        criteria: criteria,\n        err: err.message\n      });\n    }\n\n    cb();\n  });\n};\n\n/**\n * Find Association Key\n *\n * @param {Object} collection\n * @return {String}\n * @api private\n */\n\nRemove.prototype.findAssociationKey = function(collection) {\n  var associationKey = null;\n\n  for(var attribute in collection.attributes) {\n    var attr = collection.attributes[attribute];\n    var identity = this.collection.identity;\n\n    if(!hasOwnProperty(attr, 'references')) continue;\n    var attrCollection = attr.references.toLowerCase();\n\n    if(attrCollection !== identity) {\n      associationKey = attr.columnName;\n    }\n  }\n\n  return associationKey;\n};\n","/**\n * Module Dependencies\n */\n\nvar async = require('async');\nvar _ = require('lodash');\nvar utils = require('../../utils/helpers');\nvar Deferred = require('../deferred');\nvar callbacks = require('../../utils/callbacksRunner');\nvar nestedOperations = require('../../utils/nestedOperations');\nvar hasOwnProperty = utils.object.hasOwnProperty;\n\n\n/**\n * Create a new record\n *\n * @param {Object || Array} values for single model or array of multiple values\n * @param {Function} callback\n * @return Deferred object if no callback\n */\n\nmodule.exports = function(values, cb) {\n\n  var self = this;\n\n  // Handle Deferred where it passes criteria first\n  if(arguments.length === 3) {\n    var args = Array.prototype.slice.call(arguments);\n    cb = args.pop();\n    values = args.pop();\n  }\n\n  // Return Deferred or pass to adapter\n  if(typeof cb !== 'function') {\n    return new Deferred(this, this.create, {}, values);\n  }\n\n  // Handle Array of values\n  if(Array.isArray(values)) {\n    return this.createEach(values, cb);\n  }\n\n  // Process Values\n  var valuesObject = processValues.call(this, values);\n\n  // Create any of the belongsTo associations and set the foreign key values\n  createBelongsTo.call(this, valuesObject, function(err) {\n    if(err) return cb(err);\n\n    beforeCallbacks.call(self, valuesObject, function(err) {\n      if(err) return cb(err);\n      createValues.call(self, valuesObject, cb);\n    });\n  });\n};\n\n\n/**\n * Process Values\n *\n * @param {Object} values\n * @return {Object}\n */\n\nfunction processValues(values) {\n\n  // Set Default Values if available\n  for(var key in this.attributes) {\n    if(!hasOwnProperty(values, key) && hasOwnProperty(this.attributes[key], 'defaultsTo')) {\n      var defaultsTo = this.attributes[key].defaultsTo;\n      values[key] = typeof defaultsTo === 'function' ? defaultsTo.call(values) : _.clone(defaultsTo);\n    }\n  }\n\n  // Pull out any associations in the values\n  var _values = _.cloneDeep(values);\n  var associations = nestedOperations.valuesParser.call(this, this.identity, this.waterline.schema, values);\n\n  // Replace associated models with their foreign key values if available\n  values = nestedOperations.reduceAssociations.call(this, this.identity, this.waterline.schema, values);\n\n  // Cast values to proper types (handle numbers as strings)\n  values = this._cast.run(values);\n\n  return { values: values, originalValues: _values, associations: associations };\n}\n\n/**\n * Create BelongsTo Records\n *\n */\n\nfunction createBelongsTo(valuesObject, cb) {\n  var self = this;\n\n  async.each(valuesObject.associations.models, function(item, next) {\n\n    // Check if value is an object. If not don't try and create it.\n    if(!_.isPlainObject(valuesObject.values[item])) return next();\n\n    var attribute = self._schema.schema[item];\n    var modelName;\n\n    if(hasOwnProperty(attribute, 'collection')) modelName = attribute.collection;\n    if(hasOwnProperty(attribute, 'model')) modelName = attribute.model;\n    if(!modelName) return next();\n\n    var model = self.waterline.collections[modelName];\n    var pkValue = valuesObject.originalValues[item][model.primaryKey];\n\n    var criteria = {};\n    criteria[model.primaryKey] = pkValue;\n\n    // If a pkValue if found, do a findOrCreate and look for a record matching the pk.\n    var query;\n    if(pkValue) {\n      query = model.findOrCreate(criteria, valuesObject.values[item]);\n    } else {\n      query = model.create(valuesObject.values[item]);\n    }\n\n    query.exec(function(err, val) {\n      if(err) return next(err);\n\n      // attach the new model's pk value to the original value's key\n      var pk = val[model.primaryKey];\n\n      valuesObject.values[item] = pk;\n      next();\n    });\n\n  }, cb);\n}\n\n/**\n * Run Before* Lifecycle Callbacks\n *\n * @param {Object} valuesObject\n * @param {Function} cb\n */\n\nfunction beforeCallbacks(valuesObject, cb) {\n  var self = this;\n\n  async.series([\n\n    // Run Validation with Validation LifeCycle Callbacks\n    function(cb) {\n      callbacks.validate(self, valuesObject.values, false, cb);\n    },\n\n    // Before Create Lifecycle Callback\n    function(cb) {\n      callbacks.beforeCreate(self, valuesObject.values, cb);\n    }\n\n  ], cb);\n\n}\n\n/**\n * Create Parent Record and any associated values\n *\n * @param {Object} valuesObject\n * @param {Function} cb\n */\n\nfunction createValues(valuesObject, cb) {\n\n  var self = this;\n\n  // Automatically add updatedAt and createdAt (if enabled)\n  if(self.autoCreatedAt && !valuesObject.values.createdAt) {\n    valuesObject.values.createdAt = new Date();\n  }\n\n  if(self.autoUpdatedAt && !valuesObject.values.updatedAt) {\n    valuesObject.values.updatedAt = new Date();\n  }\n\n  // Transform Values\n  valuesObject.values = self._transformer.serialize(valuesObject.values);\n\n  // Clean attributes\n  valuesObject.values = self._schema.cleanValues(valuesObject.values);\n\n  // Pass to adapter here\n  self.adapter.create(valuesObject.values, function(err, values) {\n    if (err) {\n      if (typeof err === 'object') { err.model = self._model.globalId; }\n      return cb(err);\n    }\n\n    // Unserialize values\n    values = self._transformer.unserialize(values);\n\n    // If no associations were used, run after\n    if(valuesObject.associations.collections.length === 0) return after(values);\n\n    var parentModel = new self._model(values);\n    nestedOperations.create.call(self, parentModel, valuesObject.originalValues, valuesObject.associations.collections, function(err) {\n      if(err) return cb(err);\n\n      return after(parentModel.toObject());\n    });\n\n\n    function after(values) {\n\n      // Run After Create Callbacks\n      callbacks.afterCreate(self, values, function(err) {\n        if(err) return cb(err);\n\n        // Return an instance of Model\n        var model = new self._model(values);\n        cb(null, model);\n      });\n    }\n\n  });\n}\n","/**\n * Module Dependencies\n */\n\nvar async = require('async');\nvar _ = require('lodash');\nvar usageError = require('../../utils/usageError');\nvar utils = require('../../utils/helpers');\nvar normalize = require('../../utils/normalize');\nvar Deferred = require('../deferred');\nvar getRelations = require('../../utils/getRelations');\nvar callbacks = require('../../utils/callbacksRunner');\nvar hasOwnProperty = utils.object.hasOwnProperty;\n\n/**\n * Destroy a Record\n *\n * @param {Object} criteria to destroy\n * @param {Function} callback\n * @return Deferred object if no callback\n */\n\nmodule.exports = function(criteria, cb) {\n  var self = this,\n      pk;\n\n  if(typeof criteria === 'function') {\n    cb = criteria;\n    criteria = {};\n  }\n\n  // Check if criteria is an integer or string and normalize criteria\n  // to object, using the specified primary key field.\n  criteria = normalize.expandPK(self, criteria);\n\n  // Normalize criteria\n  criteria = normalize.criteria(criteria);\n\n  // Return Deferred or pass to adapter\n  if(typeof cb !== 'function') {\n    return new Deferred(this, this.destroy, criteria);\n  }\n\n  var usage = utils.capitalize(this.identity) + '.destroy([options], callback)';\n\n  if(!criteria) return usageError('No options were defined!', usage, cb);\n  if(typeof cb !== 'function') return usageError('Invalid callback specified!', usage, cb);\n\n  callbacks.beforeDestroy(self, criteria, function(err) {\n    if(err) return cb(err);\n\n    // Transform Search Criteria\n    criteria = self._transformer.serialize(criteria);\n\n    // Pass to adapter\n    self.adapter.destroy(criteria, function(err, result) {\n      if (err) return cb(err);\n\n      // Look for any m:m associations and destroy the value in the join table\n      var relations = getRelations({\n        schema: self.waterline.schema,\n        parentCollection: self.identity\n      });\n\n      if(relations.length === 0) return after();\n\n      // Find the collection's primary key\n      for(var key in self.attributes) {\n        if(!self.attributes[key].hasOwnProperty('primaryKey')) continue;\n\n        // Check if custom primaryKey value is falsy\n        if(!self.attributes[key].primaryKey) continue;\n\n        pk = key;\n        break;\n      }\n\n      function destroyJoinTableRecords(item, next) {\n        var collection = self.waterline.collections[item];\n        var refKey;\n\n        Object.keys(collection._attributes).forEach(function(key) {\n          var attr = collection._attributes[key];\n          if(attr.references !== self.identity) return;\n          refKey = key;\n        });\n\n        // If no refKey return, this could leave orphaned join table values but it's better\n        // than crashing.\n        if(!refKey) return next();\n\n        var mappedValues = result.map(function(vals) { return vals[pk]; });\n        var criteria = {};\n\n        criteria[refKey] = mappedValues;\n        collection.destroy(criteria).exec(next);\n      }\n\n      async.each(relations, destroyJoinTableRecords, function(err) {\n        if(err) return cb(err);\n        after();\n      });\n\n      function after() {\n        callbacks.afterDestroy(self, result, function(err) {\n          if(err) return cb(err);\n          cb(null, result);\n        });\n      }\n\n    });\n  });\n};\n","/**\n * Module Dependencies\n */\n\nvar async = require('async');\nvar _ = require('lodash');\nvar usageError = require('../../utils/usageError');\nvar utils = require('../../utils/helpers');\nvar normalize = require('../../utils/normalize');\nvar Deferred = require('../deferred');\nvar callbacks = require('../../utils/callbacksRunner');\nvar nestedOperations = require('../../utils/nestedOperations');\nvar hasOwnProperty = utils.object.hasOwnProperty;\n\n\n/**\n * Update all records matching criteria\n *\n * @param {Object} criteria\n * @param {Object} values\n * @param {Function} cb\n * @return Deferred object if no callback\n */\n\nmodule.exports = function(criteria, values, cb) {\n\n  var self = this;\n\n  if(typeof criteria === 'function') {\n    cb = criteria;\n    criteria = null;\n  }\n\n  // Return Deferred or pass to adapter\n  if(typeof cb !== 'function') {\n    return new Deferred(this, this.update, criteria, values);\n  }\n\n  // Ensure proper function signature\n  var usage = utils.capitalize(this.identity) + '.update(criteria, values, callback)';\n  if(!values) return usageError('No updated values specified!', usage, cb);\n\n  // Format Criteria and Values\n  var valuesObject = prepareArguments.call(this, criteria, values);\n\n  // Create any of the belongsTo associations and set the foreign key values\n  createBelongsTo.call(this, valuesObject, function(err) {\n    if(err) return cb(err);\n\n    beforeCallbacks.call(self, valuesObject.values, function(err) {\n      if(err) return cb(err);\n      updateRecords.call(self, valuesObject, cb);\n    });\n  });\n};\n\n\n/**\n * Prepare Arguments\n *\n * @param {Object} criteria\n * @param {Object} values\n * @return {Object}\n */\n\nfunction prepareArguments(criteria, values) {\n\n  // Check if options is an integer or string and normalize criteria\n  // to object, using the specified primary key field.\n  criteria = normalize.expandPK(this, criteria);\n\n  // Normalize criteria\n  criteria = normalize.criteria(criteria);\n\n  // Pull out any associations in the values\n  var _values = _.cloneDeep(values);\n  var associations = nestedOperations.valuesParser.call(this, this.identity, this.waterline.schema, values);\n\n  // Replace associated models with their foreign key values if available\n  values = nestedOperations.reduceAssociations.call(this, this.identity, this.waterline.schema, values);\n\n  // Cast values to proper types (handle numbers as strings)\n  values = this._cast.run(values);\n\n  return {\n    criteria: criteria,\n    values: values,\n    originalValues: _values,\n    associations: associations\n  };\n}\n\n/**\n * Create BelongsTo Records\n *\n */\n\nfunction createBelongsTo(valuesObject, cb) {\n  var self = this;\n\n  async.each(valuesObject.associations.models, function(item, next) {\n\n    // Check if value is an object. If not don't try and create it.\n    if(!_.isPlainObject(valuesObject.values[item])) return next();\n\n    var attribute = self._schema.schema[item];\n    var modelName;\n\n    if(hasOwnProperty(attribute, 'collection')) modelName = attribute.collection;\n    if(hasOwnProperty(attribute, 'model')) modelName = attribute.model;\n    if(!modelName) return next();\n\n    var model = self.waterline.collections[modelName];\n    var pkValue = valuesObject.originalValues[item][model.primaryKey];\n\n    var criteria = {};\n    criteria[model.primaryKey] = pkValue;\n\n    // If a pkValue if found, do a findOrCreate and look for a record matching the pk.\n    var query;\n    if(pkValue) {\n      query = model.findOrCreate(criteria, valuesObject.values[item]);\n    } else {\n      query = model.create(valuesObject.values[item]);\n    }\n\n    query.exec(function(err, val) {\n      if(err) return next(err);\n\n      // attach the new model's pk value to the original value's key\n      var pk = val[model.primaryKey];\n\n      valuesObject.values[item] = pk;\n      next();\n    });\n\n  }, cb);\n}\n\n/**\n * Run Before* Lifecycle Callbacks\n *\n * @param {Object} values\n * @param {Function} cb\n */\n\nfunction beforeCallbacks(values, cb) {\n  var self = this;\n\n  async.series([\n\n    // Run Validation with Validation LifeCycle Callbacks\n    function(cb) {\n      callbacks.validate(self, values, true, cb);\n    },\n\n    // Before Update Lifecycle Callback\n    function(cb) {\n      callbacks.beforeUpdate(self, values, cb);\n    }\n\n  ], cb);\n}\n\n/**\n * Update Records\n *\n * @param {Object} valuesObjecy\n * @param {Function} cb\n */\n\nfunction updateRecords(valuesObject, cb) {\n  var self = this;\n\n  // Automatically change updatedAt (if enabled)\n  if(this.autoUpdatedAt) {\n    valuesObject.values.updatedAt = new Date();\n  }\n\n  // Transform Values\n  valuesObject.values = this._transformer.serialize(valuesObject.values);\n\n  // Clean attributes\n  valuesObject.values = this._schema.cleanValues(valuesObject.values);\n\n  // Transform Search Criteria\n  valuesObject.criteria = self._transformer.serialize(valuesObject.criteria);\n\n\n  // Pass to adapter\n  self.adapter.update(valuesObject.criteria, valuesObject.values, function(err, values) {\n    if (err) {\n      if (typeof err === 'object') { err.model = self._model.globalId; }\n      return cb(err);\n    }\n\n    // If values is not an array, return an array\n    if(!Array.isArray(values)) values = [values];\n\n    // Unserialize each value\n    var transformedValues = values.map(function(value) {\n      return self._transformer.unserialize(value);\n    });\n\n    // Update any nested associations and run afterUpdate lifecycle callbacks for each parent\n    updatedNestedAssociations.call(self, valuesObject, transformedValues, function(err) {\n      if (err) return cb(err);\n\n      async.each(transformedValues, function(record, callback) {\n        callbacks.afterUpdate(self, record, callback);\n      }, function(err) {\n        if(err) return cb(err);\n\n        var models = transformedValues.map(function(value) {\n          return new self._model(value);\n        });\n\n        cb(null, models);\n      });\n    });\n\n  });\n}\n\n/**\n * Update Nested Associations\n *\n * @param {Object} valuesObject\n * @param {Object} values\n * @param {Function} cb\n */\n\nfunction updatedNestedAssociations(valuesObject, values, cb) {\n\n  var self = this;\n  var associations = valuesObject.associations || {};\n\n  // Only attempt nested updates if values are an object or an array\n  associations.models = _.filter(associations.models, function(model) {\n    var vals = valuesObject.originalValues[model];\n    return _.isPlainObject(vals) || Array.isArray(vals) ? true : false;\n  });\n\n  // If no associations were used, return callback\n  if(associations.collections.length === 0 && associations.models.length === 0) {\n    return cb();\n  }\n\n  // Create an array of model instances for each parent\n  var parents = values.map(function(val) {\n    return new self._model(val);\n  });\n\n  // Update any nested associations found in the values object\n  var args = [parents, valuesObject.originalValues, valuesObject.associations, cb];\n  nestedOperations.update.apply(self, args);\n\n}\n","/**\n * Module Dependencies\n */\n\nvar _ = require('lodash');\nvar usageError = require('../../utils/usageError');\nvar utils = require('../../utils/helpers');\nvar normalize = require('../../utils/normalize');\nvar Deferred = require('../deferred');\n\n/**\n * Count of Records\n *\n * @param {Object} criteria\n * @param {Object} options\n * @param {Function} callback\n * @return Deferred object if no callback\n */\n\nmodule.exports = function(criteria, options, cb) {\n  var usage = utils.capitalize(this.identity) + '.count([criteria],[options],callback)';\n\n  if(typeof criteria === 'function') {\n    cb = criteria;\n    criteria = null;\n    options = null;\n  }\n\n  if(typeof options === 'function') {\n    cb = options;\n    options = null;\n  }\n\n  // Return Deferred or pass to adapter\n  if(typeof cb !== 'function') {\n    return new Deferred(this, this.count, criteria);\n  }\n\n  // Normalize criteria and fold in options\n  criteria = normalize.criteria(criteria);\n\n  if(_.isObject(options) && _.isObject(criteria)) {\n    criteria = _.extend({}, criteria, options);\n  }\n\n  if(_.isFunction(criteria) || _.isFunction(options)) {\n    return usageError('Invalid options specified!', usage, cb);\n  }\n\n  // Transform Search Criteria\n  criteria = this._transformer.serialize(criteria);\n\n  this.adapter.count(criteria, cb);\n};\n","/**\n * Join\n *\n * Join with another collection\n * (use optimized join in adapter if one was provided)\n */\n\nmodule.exports = function(collection, fk, pk, cb) {\n  this._adapter.join(collection, fk, pk, cb);\n};\n","/**\n * Module dependencies\n */\nvar anchor = require('anchor');\nvar _ = require('lodash');\nvar leftOuterJoin = require('./leftOuterJoin');\nvar innerJoin = require('./innerJoin');\nvar populate = require('./populate');\n\n\n\n/**\n * Query Integrator\n *\n * Combines the results from multiple child queries into\n * the final return format using an in-memory join.\n * Final step in fulfilling a `.find()` with one or more\n * `populate(alias[n])` modifiers.\n *\n *    > Why is this asynchronous?\n *    >\n *    > While this function isn't doing anything strictly\n *    > asynchronous, it still expects a callback to enable\n *    > future use of `process[setImmediate|nextTick]()` as\n *    > an optimization.\n *\n * @param  {Object}   cache\n * @param  {Array}    joinInstructions      - see JOIN_INSTRUCTIONS.md\n * @callback  {Function} cb(err, results)\n *           @param {Error}\n *           @param {Array}  [results, complete w/ populations]\n *\n * @throws {Error} on invalid input\n * @asynchronous\n */\nmodule.exports = function integrate(cache, joinInstructions, primaryKey, cb) {\n\n  // Ensure valid usage\n  var invalid = false;\n  invalid = invalid || anchor(cache).to({ type: 'object' });\n  invalid = invalid || anchor(joinInstructions).to({ type: 'array' });\n  invalid = invalid || anchor(joinInstructions[0]).to({ type: 'object' });\n  invalid = invalid || anchor(joinInstructions[0].parent).to({ type: 'string' });\n  invalid = invalid || anchor(cache[joinInstructions[0].parent]).to({ type: 'object' });\n  invalid = invalid || typeof primaryKey !== 'string';\n  invalid = invalid || typeof cb !== 'function';\n  if (invalid) return cb(invalid);\n\n\n  // Constant: String prepended to child attribute keys for use in namespacing.\n  var CHILD_ATTR_PREFIX = '.';\n  var GRANDCHILD_ATTR_PREFIX = '..';\n\n\n  // We'll reuse the cached data from the `parent` table modifying it in-place\n  // and returning it as our result set. (`results`)\n  var results = cache[ joinInstructions[0].parent ];\n\n  // Group the joinInstructions array by alias, then interate over each one\n  // s.t. `instructions` in our lambda function contains a list of join instructions\n  // for the particular `populate` on the specified key (i.e. alias).\n  //\n  // Below, `results` are mutated inline.\n  _.each( _.groupBy(joinInstructions, 'alias'),\n    function eachAssociation( instructions, alias ) {\n\n      var parentPK, fkToParent, fkToChild, childPK;\n\n      var childSelect;\n\n      // N..N Association\n      if ( instructions.length === 2 ) {\n\n        // Name keys explicitly\n        // (makes it easier to see what's going on)\n        parentPK = instructions[0].parentKey;\n        fkToParent = instructions[0].childKey;\n        fkToChild = instructions[1].parentKey;\n        childPK = instructions[1].childKey;\n\n        // Modifiers\n        childSelect = instructions[1].select;\n\n        // Prefix target child attributes\n        childSelect = _.map(childSelect, function (attr) {\n          return GRANDCHILD_ATTR_PREFIX + attr;\n        });\n\n        // console.log('\\n\\n------------:: n..m leftOuterJoin ::--------\\n',\n        //   leftOuterJoin({\n        //     left: cache[instructions[0].parent],\n        //     right: cache[instructions[0].child],\n        //     leftKey: parentPK,\n        //     rightKey: fkToParent\n        //   })\n        // );\n        // console.log('------------:: / ::--------\\n');\n\n        // console.log('\\n\\n------------:: n..m childRows ::--------\\n',innerJoin({\n        //   left: leftOuterJoin({\n        //     left: cache[instructions[0].parent],\n        //     right: cache[instructions[0].child],\n        //     leftKey: parentPK,\n        //     rightKey: fkToParent\n        //   }),\n        //   right: cache[instructions[1].child],\n        //   leftKey: CHILD_ATTR_PREFIX+fkToChild,\n        //   rightKey: childPK,\n        //   childNamespace: GRANDCHILD_ATTR_PREFIX\n        // }));\n        // console.log('------------:: / ::--------\\n');\n\n        // Calculate and sanitize join data,\n        // then shove it into the parent results under `alias`\n        populate({\n          parentRows: results,\n          alias: alias,\n\n          childRows: innerJoin({\n            left: leftOuterJoin({\n              left: cache[instructions[0].parent],\n              right: cache[instructions[0].child],\n              leftKey: parentPK,\n              rightKey: fkToParent\n            }),\n            right: cache[instructions[1].child],\n            leftKey: CHILD_ATTR_PREFIX+fkToChild,\n            rightKey: childPK,\n            childNamespace: GRANDCHILD_ATTR_PREFIX\n          }),\n\n          parentPK: parentPK,   // e.g. `id` (of message)\n          fkToChild: CHILD_ATTR_PREFIX+fkToChild, // e.g. `user_id` (of join table)\n          childPK: GRANDCHILD_ATTR_PREFIX+childPK,      // e.g. `id` (of user)\n\n          select: childSelect,\n          childNamespace: GRANDCHILD_ATTR_PREFIX\n        });\n      }\n\n      // 1..N Association\n      else if ( instructions.length === 1 ) {\n\n        // Name keys explicitly\n        // (makes it easier to see what's going on)\n        parentPK = primaryKey;\n        fkToParent = parentPK;\n        fkToChild = instructions[0].parentKey;\n        childPK = instructions[0].childKey;\n\n        // Determine if this is a \"hasOne\" or a \"belongsToMany\"\n        // if the parent's primary key is the same as the fkToChild, it must be belongsToMany\n        if (parentPK === fkToChild) {\n          // In belongsToMany case, fkToChild needs prefix because it's actually the\n          // console.log('belongsToMany');\n          fkToChild = CHILD_ATTR_PREFIX + fkToChild;\n        }\n        // \"hasOne\" case\n        else {\n          // console.log('hasOne');\n        }\n\n        // Modifiers\n        childSelect = instructions[0].select;\n\n        // Prefix target child attributes\n        childSelect = _.map(childSelect, function (attr) {\n          return CHILD_ATTR_PREFIX + attr;\n        });\n        // console.log('childSelect', childSelect);\n\n        // var childRows = innerJoin({\n        //   left: cache[instructions[0].parent],\n        //   right: cache[instructions[0].child],\n        //   leftKey: instructions[0].parentKey,\n        //   rightKey: instructions[0].childKey\n        // });\n\n        // console.log('1..N JOIN--------------\\n',instructions,'\\n^^^^^^^^^^^^^^^^^^^^^^');\n        // console.log('1..N KEYS--------------\\n',{\n        //   parentPK: parentPK,\n        //   fkToParent: fkToParent,\n        //   fkToChild: fkToChild,\n        //   childPK: childPK,\n        // },'\\n^^^^^^^^^^^^^^^^^^^^^^');\n        // console.log('1..N CHILD ROWS--------\\n',childRows);\n\n        // Calculate and sanitize join data,\n        // then shove it into the parent results under `alias`\n        populate({\n          parentRows: results,\n          alias: alias,\n\n          childRows: innerJoin({\n            left: cache[instructions[0].parent],\n            right: cache[instructions[0].child],\n            leftKey: instructions[0].parentKey,\n            rightKey: instructions[0].childKey\n          }),\n\n          parentPK: fkToParent,  // e.g. `id` (of message)\n          fkToChild: fkToChild,  // e.g. `from`\n          childPK: childPK,      // e.g. `id` (of user)\n\n          select: childSelect,\n          childNamespace: CHILD_ATTR_PREFIX\n        });\n        // console.log('1..N Results--------\\n',results);\n      }\n\n    }\n  );\n\n\n  // And call the callback\n  // (the final joined data is in the cache -- also referenced by `results`)\n  return cb(null, results);\n\n};\n\n\n\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash'),\n    normalize = require('../../utils/normalize'),\n    getRelations = require('../../utils/getRelations'),\n    hasOwnProperty = require('../../utils/helpers').object.hasOwnProperty;\n\n\n\n/**\n * DDL Adapter Normalization\n */\n\nmodule.exports = {\n\n  define: function(cb) {\n    var self = this;\n\n    // Normalize Arguments\n    cb = normalize.callback(cb);\n\n    // Build Default Error Message\n    var errMsg = 'No define() method defined in adapter!';\n\n    // Grab attributes from definition\n    var schema = _.clone(this.query._schema.schema) || {};\n\n    // Find any junctionTables that reference this collection\n    var relations = getRelations({\n      schema: self.query.waterline.schema,\n      parentCollection: self.collection\n    });\n\n    //\n    // TODO: if junction tables don't exist, define them\n    // console.log(relations);\n    //\n\n    // Verify that collection doesn't already exist\n    // and then define it and trigger callback\n    this.describe(function(err, existingAttributes) {\n      if(err) return cb(err);\n      if(existingAttributes) return cb(new Error('Trying to define a collection (' + self.collection + ') which already exists.'));\n\n      // Remove hasMany association keys before sending down to adapter\n      Object.keys(schema).forEach(function(key) {\n        if(schema[key].type) return;\n        delete schema[key];\n      });\n\n      // Find the connection to run this on\n      if(!hasOwnProperty(self.dictionary, 'define')) return cb();\n\n      var connName = self.dictionary.define;\n      var adapter = self.connections[connName]._adapter;\n\n      if(!hasOwnProperty(adapter, 'define')) return cb(new Error(errMsg));\n      adapter.define(connName, self.collection, schema, cb);\n    });\n  },\n\n  describe: function(cb) {\n\n    // Normalize Arguments\n    cb = normalize.callback(cb);\n\n    // Build Default Error Message\n    var err = 'No describe() method defined in adapter!';\n\n    // Find the connection to run this on\n    // NOTE: if `describe` doesn't exist, an error is not being returned.\n    if(!hasOwnProperty(this.dictionary, 'describe')) return cb();\n\n    var connName = this.dictionary.describe;\n    var adapter = this.connections[connName]._adapter;\n\n    if(!hasOwnProperty(adapter, 'describe')) return cb(new Error(err));\n    adapter.describe(connName, this.collection, cb);\n  },\n\n  drop: function(relations, cb) {\n    // Allow relations to be optional\n    if(typeof relations === 'function') {\n      cb = relations;\n      relations = [];\n    }\n\n    relations = [];\n\n    //\n    // TODO:\n    // Use a more normalized strategy to get relations so we can omit the extra argument above.\n    // e.g. getRelations({ schema: self.query.waterline.schema, parentCollection: self.collection });\n    //\n\n    // Normalize Arguments\n    cb = normalize.callback(cb);\n\n    // Build Default Error Message\n    var err = 'No drop() method defined in adapter!';\n\n    // Find the connection to run this on\n    if(!hasOwnProperty(this.dictionary, 'drop')) return cb(new Error(err));\n\n    var connName = this.dictionary.drop;\n    var adapter = this.connections[connName]._adapter;\n\n    if(!hasOwnProperty(adapter, 'drop')) return cb(new Error(err));\n    adapter.drop(connName, this.collection, relations, cb);\n  },\n\n  alter: function (cb) {\n\n    // Normalize arguments\n    cb = normalize.callback(cb);\n\n    // Build Default Error Message\n    var err = 'No alter() method defined in adapter!';\n\n    // Find the connection to run this on\n    if(!hasOwnProperty(this.dictionary, 'alter')) return cb(new Error(err));\n\n    var connName = this.dictionary.alter;\n    var adapter = this.connections[connName]._adapter;\n\n    if(!hasOwnProperty(adapter, 'alter')) return cb(new Error(err));\n    adapter.alter(connName, this.collection, cb);\n  }\n\n};\n","// TODO: probably can eliminate this file\nmodule.exports = {\n  migrateDrop: require('./strategies/drop.js'),\n  migrateAlter: require('./strategies/alter.js'),\n  migrateSafe: require('./strategies/safe.js')\n};\n","/**\n * Module dependencies\n */\n\nvar util = require('util');\nvar _ = require('lodash');\n\n\n\n/**\n * WLError\n *\n * All errors passed to a query callback in Waterline extend\n * from this base error class.\n *\n * @param  {Object} properties\n * @constructor {WLError}\n */\nfunction WLError( properties ) {\n\n  // Call super constructor (Error)\n  WLError.super_.call(this);\n\n  // Fold defined properties into the new WLError instance.\n  properties = properties||{};\n  _.extend(this, properties);\n\n  // Generate stack trace\n  // (or use `originalError` if it is a true error instance)\n  if (_.isObject(this.originalError) && this.originalError instanceof Error) {\n    this._e = this.originalError;\n  }\n  else this._e = new Error();\n\n  // Doctor up a modified version of the stack trace called `rawStack`:\n  this.rawStack = (this._e.stack.replace(/^Error(\\r|\\n)*(\\r|\\n)*/, ''));\n\n\n  // Customize `details`:\n  // Try to dress up the wrapped \"original\" error as much as possible.\n  // @type {String} a detailed explanation of this error\n  if (typeof this.originalError === 'string') {\n    this.details = this.originalError;\n  }\n  // Run toString() on Errors:\n  else if ( this.originalError && util.isError(this.originalError) ) {\n    this.details = this.originalError.toString();\n  }\n  // But for other objects, use util.inspect()\n  else if (this.originalError) {\n    this.details = util.inspect(this.originalError);\n  }\n\n  // If `details` is set, prepend it with \"Details:\"\n  if (this.details) {\n    this.details = 'Details:  '+this.details +'\\n';\n  }\n\n}\nutil.inherits(WLError, Error);\n\n\n// Default properties\nWLError.prototype.status =\n500;\nWLError.prototype.code =\n'E_UNKNOWN';\nWLError.prototype.reason =\n'Encountered an unexpected error';\nWLError.prototype.details =\n'';\n\n\n/**\n * Override JSON serialization.\n * (i.e. when this error is passed to `res.json()` or `JSON.stringify`)\n *\n * For example:\n * ```json\n * {\n *   status: 500,\n *   code: 'E_UNKNOWN'\n * }\n * ```\n *\n * @return {Object}\n */\nWLError.prototype.toJSON =\nWLError.prototype.toPOJO =\nfunction () {\n  var obj = {\n    error: this.code,\n    status: this.status,\n    summary: this.reason,\n    raw: this.originalError\n  };\n\n  // Only include `raw` if its truthy.\n  if (!obj.raw) delete obj.raw;\n\n  return obj;\n};\n\n\n\n/**\n * Override output for `sails.log[.*]`\n *\n * @return {String}\n *\n * For example:\n * ```sh\n * Waterline: ORM encountered an unexpected error:\n * { ValidationError: { name: [ [Object], [Object] ] } }\n * ```\n */\nWLError.prototype.toLog = function () {\n  return this.inspect();\n};\n\n\n/**\n * Override output for `util.inspect`\n * (also when this error is logged using `console.log`)\n *\n * @return {String}\n */\nWLError.prototype.inspect = function () {\n  return util.format('Error (%s) :: %s\\n%s\\n\\n%s', this.code, this.reason, this.rawStack, this.details);\n};\n\n\n\n/**\n * @return {String}\n */\nWLError.prototype.toString = function () {\n  return util.format('[Error (%s) %s]', this.code, this.reason, this.details);\n};\n\n\n\nmodule.exports = WLError;\n","/**\n * Module dependencies\n */\n\nvar WLError = require('./WLError');\nvar util = require('util');\nvar _ = require('lodash');\n\n\n\n/**\n * WLUsageError\n *\n * @extends WLError\n */\nfunction WLUsageError (properties) {\n\n  // Call superclass\n  WLUsageError.super_.call(this, properties);\n}\nutil.inherits(WLUsageError, WLError);\n\n\n// Override WLError defaults with WLUsageError properties.\nWLUsageError.prototype.code =\n'E_USAGE';\nWLUsageError.prototype.status =\n0;\nWLUsageError.prototype.reason =\n'Invalid usage';\n\n\nmodule.exports = WLUsageError;\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\n\n\n\n/**\n * Traverse the shema to build a populate plan object\n * that will populate every relation, sub-relation, and so on\n * reachable from the initial model and relation at least once\n * (perhaps most notable is that this provides access to most\n * related data without getting caught in loops.)\n *\n * @param  {[type]} schema          [description]\n * @param  {[type]} initialModel    [description]\n * @param  {[type]} initialRelation [description]\n * @return {[type]}                 [description]\n */\nmodule.exports = function acyclicTraversal(schema, initialModel, initialRelation) {\n\n\t// Track the edges which have already been traversed\n\tvar alreadyTraversed = [\n\t\t// {\n\t\t//   relation: initialRelation,\n\t\t//   model: initialModel\n\t\t// }\n\t];\n\n\treturn traverseSchemaGraph(initialModel, initialRelation);\n\n\t/**\n\t * Recursive function\n\t * @param  {[type]} modelIdentity  [description]\n\t * @param  {[type]} nameOfRelation [description]\n\t * @return {[type]}                [description]\n\t */\n\tfunction traverseSchemaGraph(modelIdentity, nameOfRelation) {\n\n\t\tvar currentModel = schema[modelIdentity];\n\t\tvar currentAttributes = currentModel.attributes;\n\n\t\tvar isRedundant;\n\n\t\t// If this relation has already been traversed, return.\n\t\t// (i.e. `schema.attributes.modelIdentity.nameOfRelation`)\n\t\tisRedundant = _.findWhere(alreadyTraversed, {\n\t\t\talias: nameOfRelation,\n\t\t\tmodel: modelIdentity\n\t\t});\n\t\t\t\t\n\t\tif (isRedundant) return;\n\n\t\t// Push this relation onto the `alreadyTraversed` stack.\n\t\talreadyTraversed.push({\n\t\t\talias: nameOfRelation,\n\t\t\tmodel: modelIdentity\n\t\t});\n\n\n\t\tvar relation = currentAttributes[nameOfRelation];\n\t\tif (!relation) throw new Error('Unknown relation in schema: ' + modelIdentity + '.' + nameOfRelation);\n\t\tvar identityOfRelatedModel = relation.model || relation.collection;\n\n\t\t// Get the related model\n\t\tvar relatedModel = schema[identityOfRelatedModel];\n\n\t\t// If this relation is a collection with a `via` back-reference,\n\t\t// push it on to the `alreadyTraversed` stack.\n\t\t// (because the information therein is probably redundant)\n\t\t// TODO: evaluate this-- it may or may not be a good idea\n\t\t// (but I think it's a nice touch)\n\t\tif (relation.via) {\n\t\t\talreadyTraversed.push({\n\t\t\t\talias: relation.via,\n\t\t\t\tmodel: identityOfRelatedModel\n\t\t\t});\n\t\t}\n\n\t\t// Lookup ALL the relations OF THE RELATED model.\n\t\tvar relations =\n\t\t\t_(relatedModel.attributes).reduce(function buildSubsetOfAssociations(relations, attrDef, attrName) {\n\t\t\t\tif (_.isObject(attrDef) && (attrDef.model || attrDef.collection)) {\n\t\t\t\t\trelations.push(_.merge({\n\t\t\t\t\t\talias: attrName,\n\t\t\t\t\t\tidentity: attrDef.model || attrDef.collection,\n\t\t\t\t\t\tcardinality: attrDef.model ? 'model' : 'collection'\n\t\t\t\t\t}, attrDef));\n\t\t\t\t\treturn relations;\n\t\t\t\t}\n\t\t\t\treturn relations;\n\t\t\t}, []);\n\n\t\t// Return a piece of the result plan by calling `traverseSchemaGraph`\n\t\t// on each of the RELATED model's relations.\n\t\treturn _.reduce(relations, function (resultPlanPart, relation) {\n\n\t\t\t// Recursive step\n\t\t\tresultPlanPart[relation.alias] = traverseSchemaGraph(identityOfRelatedModel, relation.alias);\n\n\t\t\t// Trim undefined result plan parts\n\t\t\tif (resultPlanPart[relation.alias] === undefined) {\n\t\t\t\tdelete resultPlanPart[relation.alias];\n\t\t\t}\n\n\t\t\treturn resultPlanPart;\n\t\t}, {});\n\t}\n\n};","/**\n * Transformations\n */\n\nvar Transformations = module.exports = {};\n\n// Add JSON Transformation methods\nTransformations.json = {};\n\n/**\n * Write Method Transformations\n *\n * Used to stream back valid JSON from Waterline\n */\n\nTransformations.json.write = function(model, index, cb) {\n  var transformedModel;\n\n  if(!model) transformedModel = '';\n\n  // Transform to JSON\n  if(model) {\n    try {\n      transformedModel = JSON.stringify(model);\n    } catch (e) {\n      return cb(e);\n    }\n  }\n\n  // Prefix with opening [\n  if (index === 0) { transformedModel = '['; }\n\n  // Prefix with comma after first model\n  if (index > 1) transformedModel = ',' + transformedModel;\n\n  cb(null, transformedModel);\n};\n\n/**\n * Close off JSON Array\n */\nTransformations.json.end = function(cb) {\n  var suffix = ']';\n  cb(null, suffix);\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nmodule.exports = Stream;\n\nvar EE = require('events').EventEmitter;\nvar inherits = require('inherits');\n\ninherits(Stream, EE);\nStream.Readable = require('readable-stream/readable.js');\nStream.Writable = require('readable-stream/writable.js');\nStream.Duplex = require('readable-stream/duplex.js');\nStream.Transform = require('readable-stream/transform.js');\nStream.PassThrough = require('readable-stream/passthrough.js');\n\n// Backwards-compat with node 0.4.x\nStream.Stream = Stream;\n\n\n\n// old-style streams.  Note that the pipe method (the only relevant\n// part of this class) is overridden in the Readable class.\n\nfunction Stream() {\n  EE.call(this);\n}\n\nStream.prototype.pipe = function(dest, options) {\n  var source = this;\n\n  function ondata(chunk) {\n    if (dest.writable) {\n      if (false === dest.write(chunk) && source.pause) {\n        source.pause();\n      }\n    }\n  }\n\n  source.on('data', ondata);\n\n  function ondrain() {\n    if (source.readable && source.resume) {\n      source.resume();\n    }\n  }\n\n  dest.on('drain', ondrain);\n\n  // If the 'end' option is not supplied, dest.end() will be called when\n  // source gets the 'end' or 'close' events.  Only dest.end() once.\n  if (!dest._isStdio && (!options || options.end !== false)) {\n    source.on('end', onend);\n    source.on('close', onclose);\n  }\n\n  var didOnEnd = false;\n  function onend() {\n    if (didOnEnd) return;\n    didOnEnd = true;\n\n    dest.end();\n  }\n\n\n  function onclose() {\n    if (didOnEnd) return;\n    didOnEnd = true;\n\n    if (typeof dest.destroy === 'function') dest.destroy();\n  }\n\n  // don't leave dangling pipes when there are errors.\n  function onerror(er) {\n    cleanup();\n    if (EE.listenerCount(this, 'error') === 0) {\n      throw er; // Unhandled stream error in pipe.\n    }\n  }\n\n  source.on('error', onerror);\n  dest.on('error', onerror);\n\n  // remove all the event listeners that were added.\n  function cleanup() {\n    source.removeListener('data', ondata);\n    dest.removeListener('drain', ondrain);\n\n    source.removeListener('end', onend);\n    source.removeListener('close', onclose);\n\n    source.removeListener('error', onerror);\n    dest.removeListener('error', onerror);\n\n    source.removeListener('end', cleanup);\n    source.removeListener('close', cleanup);\n\n    dest.removeListener('close', cleanup);\n  }\n\n  source.on('end', cleanup);\n  source.on('close', cleanup);\n\n  dest.on('close', cleanup);\n\n  dest.emit('pipe', source);\n\n  // Allow for unix-like usage: A.pipe(B).pipe(C)\n  return dest;\n};\n","/**\n * Module dependencies\n */\n\nvar util = require('util'),\n  _ = require('lodash'),\n  WLError = require('./WLError');\n  WLValidationError = require('./WLValidationError');\n\n\n/**\n * A classifier which normalizes a mystery error into a simple,\n * consistent format.  This ensures that our instance which is\n * \"new\"-ed up belongs to one of a handful of distinct categories\n * and has a predictable method signature and properties.\n *\n * The returned error instance will always be or extend from\n * `WLError` (which extends from `Error`)\n *\n * NOTE:\n * This method should eventually be deprecated in a\n * future version of Waterline.  It exists to help\n * w/ error type negotiation.  In general, Waterline\n * should use WLError, or errors which extend from it\n * to construct error objects of the appropriate type.\n * In other words, no ** new ** errors should need to\n * be wrapped in a call to `errorify` - instead, code\n * necessary to handle any new error conditions should\n * construct a `WLError` directly and return that.\n *\n * @param  {???} err\n * @return {WLError}\n */\nmodule.exports = function errorify(err) {\n\n  // If specified `err` is already a WLError, just return it.\n  if (typeof err === 'object' && err instanceof WLError) return err;\n\n  return duckType(err);\n};\n\n\n\n/**\n * Determine which type of error we're working with.\n * Err... using hacks.\n *\n * @return {[type]} [description]\n */\nfunction duckType(err) {\n\n  // Validation or constraint violation error (`E_VALIDATION`)\n  //\n  // i.e. detected before talking to adapter, like `minLength`\n  // i.e. constraint violation reported by adapter, like `unique`\n  if (/*_isValidationError(err) || */_isConstraintViolation(err)) {\n\n    // Dress `unique` rule violations to be consistent with other\n    // validation errors.\n    return new WLValidationError(err);\n  }\n\n  // Unexpected miscellaneous error  (`E_UNKNOWN`)\n  //\n  // (i.e. helmet fire. The database crashed or something. Or there's an adapter\n  //  bug. Or a bug in WL core.)\n  return new WLError({\n    originalError: err\n  });\n}\n\n\n/**\n * @param  {?} err\n * @return {Boolean} whether this is an adapter-level constraint\n * violation (e.g. `unique`)\n */\nfunction _isConstraintViolation(err) {\n\n  // If a proper error code is specified, this error can be classified.\n  if (err && typeof err === 'object' && err.code === 'E_UNIQUE') {\n    return true;\n  }\n\n  // Otherwise, there is not enough information to call this a\n  // constraint violation error and provide proper explanation to\n  // the architect.\n  else return false;\n}\n\n\n// /**\n//  * @param  {?} err\n//  * @return {Boolean} whether this is a validation error (e.g. minLength exceeded for attribute)\n//  */\n// function _isValidationError(err) {\n//   return _.isObject(err) && err.ValidationError;\n// }\n\n","/**\n * getRelations\n *\n * Find any `junctionTables` that reference the parent collection.\n * \n * @param  {[type]} options [description]\n *    @option parentCollection\n *    @option schema\n * @return {[type]}         [relations]\n */\n\nmodule.exports = function getRelations(options) {\n\n  var schema = options.schema;\n  var relations = [];\n\n  Object.keys(schema).forEach(function(collection) {\n    var collectionSchema = schema[collection];\n    if (!collectionSchema.hasOwnProperty('junctionTable')) return;\n\n    Object.keys(collectionSchema.attributes).forEach(function(key) {\n      if (!collectionSchema.attributes[key].hasOwnProperty('foreignKey')) return;\n      if (collectionSchema.attributes[key].references !== options.parentCollection) return;\n      relations.push(collection);\n    });\n  });\n\n  return relations;\n};\n","/**\n * Module dependencies\n */\nvar join = require('./_join');\n\n\n/**\n * Left outer join\n *\n * Return a result set with data from child and parent\n * merged on childKey===parentKey, where t.e. at least one\n * entry for each row of parent (unmatched columns in child are null).\n *\n * @option {Array} parent       [rows from the \"lefthand table\"]\n * @option {Array} child        [rows from the \"righthand table\"]\n * @option {String} parentKey   [primary key of the \"lefthand table\"]\n * @option {String} childKey    [foreign key from the \"righthand table\" to the \"lefthand table\"]\n * @return {Array}              [a new array of joined row data]\n *\n * @throws {Error} on invalid input\n * @synchronous\n */\nmodule.exports = function leftOuterJoin(options) {\n  options.outer = 'left';\n  return join(options);\n};\n","/**\n * Module dependencies\n */\nvar join = require('./_join');\n\n\n/**\n * Inner join\n *\n * Return a result set with data from child and parent\n * merged on childKey===parentKey, where t.e. exactly one\n * entry for each match.\n *\n * @option {Array} parent    [rows from the \"lefthand table\"]\n * @option {Array} child   [rows from the \"righthand table\"]\n * @option {String} parentKey     [primary key of the \"lefthand table\"]\n * @option {String} childKey     [foreign key from the \"righthand table\" to the \"lefthand table\"]\n * @return {Array}          [a new array of joined row data]\n *\n * @throws {Error} on invalid input\n * @synchronous\n */\nmodule.exports = function leftOuterJoin(options) {\n  options.outer = false;\n  return join(options);\n};\n","/**\n * Module dependencies\n */\nvar _ = require('lodash');\n\n\n\n/**\n * populate()\n *\n * Destructive mapping of `parentRows` to include a new key, `alias`,\n * which is an ordered array of child rows.\n *\n * @option [{Object}] parentRows    - the parent rows the joined rows will be folded into\n * @option {String} alias           - the alias of the association\n * @option [{Object}] childRows     - the unfolded result set from the joins\n *\n * @option {String} parentPK        - the primary key of the parent table (optional- only needed for M..N associations)\n * @option {String} fkToChild       - the foreign key associating a row with the child table\n * @option {String} childPK         - the primary key of the child table\n *\n * @option [{String}] select        - attributes to keep\n * @option [{String}] childNamespace- attributes to keep\n *\n * @return {*Object} reference to `parentRows`\n */\nmodule.exports = function populate (options) {\n\n  var parentRows = options.parentRows;\n  var alias = options.alias;\n  var childRows = options.childRows;\n\n  var parentPK = options.parentPK;\n  var childPK = options.childPK;\n  var fkToChild = options.fkToChild;\n  var fkToParent = parentPK;// At least for all use cases currently, `fkToParent` <=> `parentPK`\n\n  var select = options.select;\n  var childNamespace = options.childNamespace || '';\n\n  return _.map(parentRows, function _insertJoinedResults (parentRow) {\n\n    // Gather the subset of child rows associated with the current parent row\n    var associatedChildRows = _.where(childRows,\n      //{ (parentPK): (parentRow[(parentPK)]) }, e.g. { id: 3 }\n      _cons(fkToParent, parentRow[parentPK])\n    );\n\n    // Clone the `associatedChildRows` to avoid mutating the original\n    // `childRows` in the cache.\n    associatedChildRows = _.cloneDeep(associatedChildRows);\n\n    // Stuff the sanitized associated child rows into the parent row.\n    parentRow[alias] =\n    _.reduce(associatedChildRows, function (memo, childRow) {\n\n      // Ignore child rows without an appropriate foreign key\n      // to an instance in the REAL child collection.\n      if (!childRow[childNamespace + childPK] && !childRow[childPK]) return memo;\n\n      // Rename childRow's [fkToChild] key to [childPK]\n      // (so that it will have the proper primary key attribute for its collection)\n      var childPKValue = childRow[fkToChild];\n      childRow[childPK] = childPKValue;\n\n      // If specified, pick a subset of attributes from child row\n      if (select) {\n        childRow = _.pick(childRow, select);\n        var _origChildRow = childRow;\n\n        // Strip off childNamespace prefix\n        childRow = {};\n        var PREFIX_REGEXP = new RegExp('^' + childNamespace + '');\n        _.each(_origChildRow, function (attrValue, attrName) {\n          var unprefixedKey = attrName.replace(PREFIX_REGEXP, '');\n          // console.log('unprefixedKey',unprefixedKey,attrName);\n          childRow[unprefixedKey] = attrValue;\n        });\n      }\n\n      // Build the set of rows to stuff into our parent row.\n      memo.push(childRow);\n      return memo;\n    }, []);\n\n    return parentRow;\n  });\n};\n\n\n\n\n/**\n * Dumb little helper because I hate naming anonymous objects just to use them once.\n *\n * @return {Object} [a tuple]\n * @api private\n */\nfunction _cons(key, value) {\n  var obj = {};\n  obj[key] = value;\n  return obj;\n}\n\n\n\n\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash'),\n  getRelations = require('../../../utils/getRelations');\n\n\n\n/**\n * Drop and recreate collection\n *\n * @param  {Function} cb\n */\n\nmodule.exports = function drop (cb) {\n  var self = this;\n\n  //\n  // TODO:\n  // Refuse to run this migration strategy in production.\n  //\n\n  // Find any junctionTables that reference this collection\n  // var relations = getRelations({\n  //   schema: self.query.waterline.schema,\n  //   parentCollection: self.collection\n  // });\n\n  // Pass along relations to the drop method\n  // console.log('Dropping ' + self.collection);\n  this.drop(function afterDrop(err, data) {\n    if (err) return cb(err);\n\n    self.define(function () {\n      cb.apply(null, Array.prototype.slice.call(arguments));\n    });\n  });\n};\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash'),\n  async = require('async'),\n  getRelations = require('../../../utils/getRelations');\n\n\n\n/**\n * Try and synchronize the underlying physical-layer schema\n * to work with our app's collections. (i.e. models)\n *\n * @param  {Function} cb\n */\nmodule.exports = function(cb) {\n  var self = this;\n\n\n  //\n  // TODO:\n  // Refuse to run this migration strategy in production.\n  //\n\n  // Find any junctionTables that reference this collection\n  var relations = getRelations({\n    schema: self.query.waterline.schema,\n    parentCollection: self.collection\n  });\n\n  var backupData;\n\n  // Check that collection exists--\n  self.describe(function afterDescribe(err, attrs) {\n    if(err) return cb(err);\n\n    // if it doesn't go ahead and add it and get out\n    if(!attrs) return self.define(cb);\n\n\n    //\n    // TODO:\n    // Take a look and see if anything important has changed.\n    // If it has (at all), we still have to follow the naive strategy below,\n    // but it will at least save time in the general case.\n    // (because it really sucks to have to wait for all of this to happen\n    //  every time you initialize Waterline.)\n    //\n\n\n    //\n    // OK so we have to fix up the schema and migrate the data...\n    //\n    // ... we'll let Waterline do it for us.\n    //\n    // Load all data from this collection into memory.\n    // If this doesn't work, crash to avoid corrupting any data.\n    // (see `waterline/lib/adapter/ddl/README.md` for more info about this)\n    //\n    self.find({}, function (err, existingData) {\n      if (err) {\n        //\n        // TODO:\n        // If this was a memory error, log a more useful error\n        // explaining what happened.\n        //\n        return cb(err);\n      }\n\n      // If the collection exists but is empty, then do nothing.\n      if (existingData.length === 0) return cb();\n\n      //\n      // From this point forward, we must be very careful.\n      //\n      backupData = _.cloneDeep(existingData);\n\n      // Check to see if there is anything obviously troublesome\n      // that will cause the drop and redefinition of our schemaful\n      // collections to fail.\n      // (i.e. violation of uniqueness constraints)\n      var attrs = self.query.waterline.collections[self.identity]._attributes;\n      var pk = self.query.waterline.collections[self.identity].primaryKey;\n      var attrsAsArray = _.reduce(_.cloneDeep(attrs), function (memo,attrDef,attrName) {\n        attrDef.name = attrName;\n        memo.push(attrDef);\n        return memo;\n      }, []);\n      var uniqueAttrs = _.where(attrsAsArray, {unique: true});\n      async.each(uniqueAttrs, function (uniqueAttr, each_cb) {\n        var uniqueData = _.uniq(_.pluck(existingData, uniqueAttr.name));\n\n        // Remove any unique values who have their values set to undefined or null\n        var cleansedExistingData = _.filter(existingData, function(val) {\n          return [undefined, null].indexOf(val[uniqueAttr.name]) < 0;\n        });\n\n        // Remove any undefined or null values from the unique data\n        var cleansedUniqueData = _.filter(uniqueData, function(val) {\n          return [undefined, null].indexOf(val) < 0;\n        });\n\n        if (cleansedUniqueData.length < cleansedExistingData.length) {\n          // Some existing data violates a new uniqueness constraint\n          prompt = require('prompt');\n          prompt.start();\n          console.log(\n            'One or more existing records in your database violate '+\n            'a new uniqueness constraint\\n'+\n            'on `'+uniqueAttr.name+'` '+\n            'in your `'+self.identity+'` model.');\n          console.log();\n          console.log('Should we automatically remove duplicates?');\n          console.log();\n          console.log('** WARNING: DO NOT TYPE \"y\" IF YOU ARE WORKING WITH PRODUCTION DATA **');\n          // var laptimer = setInterval(function beepbeepbeepbeep(){\n          //   process.stdout.write('\\u0007');\n          // }, 1500);\n          prompt.get(['y/n'], function (err, results) {\n            // clearInterval(laptimer);\n            if (err) return each_cb(err);\n            var wasConfirmedByUser = _.isString(results['y/n']) && results['y/n'].match(/y/);\n            if (wasConfirmedByUser) {\n\n              // Wipe out duplicate records in `backupData` and continue\n              // to perform the automigration\n              var diff = _.difference(existingData, _.uniq(existingData, false, uniqueAttr.name));\n\n              var destroyCriteria = {};\n              destroyCriteria[pk] = _.pluck(diff, pk);\n              // console.log(diff, '\\n', destroyCriteria);\n              backupData = _.remove(backupData, function (datum) {\n                return !_.contains(destroyCriteria[pk], datum[pk]);\n              });\n              return each_cb();\n              // console.log(backupData);\n              // throw new Error();\n              // self.query.waterline.collections[self.collection].destroy(destroyCriteria).exec(each_cb);\n            }\n            else return each_cb(new Error('Auto-migration aborted. Please migrate your data manually and then try this again.'));\n          });\n        }\n        else return each_cb();\n      }, function afterAsyncEach (err) {\n        if (err) return cb(err);\n\n        // Now we'll drop the collection.\n        self.drop(relations, function (err) {\n          if (err) return uhoh(err, backupData, cb);\n\n          // Now we'll redefine the collection.\n          self.define(function (err) {\n            if (err) return uhoh(err, backupData, cb);\n\n            // Now we'll create the `backupData` again,\n            // being careful not to run any lifecycle callbacks\n            // and disable automatic updating of `createdAt` and\n            // `updatedAt` attributes:\n            //\n            // ((((TODO: actually be careful about said things))))\n            //\n            self.createEach(backupData, function(err) {\n              if (err) return uhoh(err, backupData, cb);\n\n              // Done.\n              return cb();\n            });\n\n          }); // </define>\n        }); // </drop>\n      }); // </find>\n    });\n\n\n\n\n\n    //\n    // The old way-- (doesn't always work, and is way more\n    // complex than we should spend time on for now)\n    //\n    //   ||      ||      ||      ||      ||      ||\n    //   \\/      \\/      \\/      \\/      \\/      \\/\n    //\n    // Otherwise, if it *DOES* exist, we'll try and guess what changes need to be made\n    // self.alter(function(err) {\n    //   if(err) return cb(err);\n    //   cb();\n    // });\n\n  });\n};\n\n\n\n\n\n\n/**\n * uh oh.\n *\n * If we can't persist the data again, we'll log an error message, then\n * stream the data to stdout as JSON to make sure that it gets persisted\n * SOMEWHERE at least.\n *\n * (this is another reason this automigration strategy cannot be used in\n * production currently..)\n *\n * @param  {[type]}   err        [description]\n * @param  {[type]}   backupData [description]\n * @param  {Function} cb         [description]\n * @return {[type]}              [description]\n */\n\nfunction uhoh (err, backupData, cb) {\n\n  console.error('Waterline encountered a fatal error when trying to perform the `alter` auto-migration strategy.');\n  console.error('In a couple of seconds, the data (cached in memory) will be logged to stdout.');\n  console.error('(a failsafe put in place to preserve development data)');\n  console.error();\n  console.error('In the mean time, here\\'s the error:');\n  console.error();\n  console.error(err);\n  console.error();\n  console.error();\n\n  setTimeout(function () {\n    console.error('================================');\n    console.error('Data backup:');\n    console.error('================================');\n    console.error('');\n    console.log(backupData);\n    return cb(err);\n  }, 1200);\n\n}\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\n\n\n\n/**\n * Do absolutely nothing to the schema of the underlying datastore.\n *\n * @param  {Function} cb\n */\nmodule.exports = function(cb) {\n  cb();\n};\n","/**\n * Handlers for parsing nested associations within create/update values.\n */\n\nmodule.exports = {\n  reduceAssociations: require('./reduceAssociations'),\n  valuesParser: require('./valuesParser'),\n  create: require('./create'),\n  update: require('./update')\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        throw TypeError('Uncaught, unspecified \"error\" event.');\n      }\n      return false;\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        len = arguments.length;\n        args = new Array(len - 1);\n        for (i = 1; i < len; i++)\n          args[i - 1] = arguments[i];\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    len = arguments.length;\n    args = new Array(len - 1);\n    for (i = 1; i < len; i++)\n      args[i - 1] = arguments[i];\n\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    var m;\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  var ret;\n  if (!emitter._events || !emitter._events[type])\n    ret = 0;\n  else if (isFunction(emitter._events[type]))\n    ret = 1;\n  else\n    ret = emitter._events[type].length;\n  return ret;\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","/**\n * Module dependencies\n */\nvar anchor = require('anchor'),\n  _ = require('lodash'),\n  partialJoin = require('./_partialJoin');\n\n\n/**\n * _join\n *\n * @api private\n *\n * Helper method- can perform and inner -OR- outer join.\n *\n * @option {String|Boolean} outer    [whether to do an outer join, and if so the direction (\"left\"|\"right\")]\n * @option {Array} parent            [rows from the \"lefthand table\"]\n * @option {Array} child             [rows from the \"righthand table\"]\n * @option {String} parentKey        [primary key of the \"lefthand table\"]\n * @option {String} childKey         [foreign key from the \"righthand table\" to the \"lefthand table\"]\n * @option {String} childNamespace   [string prepended to child attribute keys (default='.')]\n *\n * @return {Array} new joined row data\n *\n * @throws {Error} on invalid input\n *\n * @synchronous\n */\nmodule.exports = function _join(options) {\n\n\n  // Usage\n  var invalid = false;\n  invalid = invalid || anchor(options).to({\n    type: 'object'\n  });\n\n  // Tolerate `right` and `left` usage\n  _.defaults(options, {\n    parent: options.left,\n    child: options.right,\n    parentKey: options.leftKey,\n    childKey: options.rightKey,\n    childNamespace: options.childNamespace || '.',\n  });\n\n  invalid = invalid || anchor(options.parent).to({\n    type: 'array'\n  });\n  invalid = invalid || anchor(options.child).to({\n    type: 'array'\n  });\n  invalid = invalid || anchor(options.parentKey).to({\n    type: 'string'\n  });\n  invalid = invalid || anchor(options.childKey).to({\n    type: 'string'\n  });\n\n  invalid = invalid || (options.outer === 'right' ?\n    new Error('Right joins not supported yet.') : false);\n\n  if (invalid) throw invalid;\n\n\n\n\n  var resultSet = _.reduce(options.parent, function eachParentRow (memo, parentRow) {\n\n    // For each childRow whose childKey matches\n    // this parentRow's parentKey...\n    var foundMatch = _.reduce(options.child, function eachChildRow (hasFoundMatchYet, childRow) {\n\n      var newRow = partialJoin({\n        parentRow: parentRow,\n        childRow: childRow,\n        parentKey: options.parentKey,\n        childKey: options.childKey,\n        childNamespace: options.childNamespace\n      });\n\n      // console.log('PARENT ROW: ', parentRow);\n      // console.log('CHILD ROW: ', childRow);\n      // console.log('JOIN ROW: ', newRow);\n\n      // Save the new row for the join result if it exists\n      // and mark the match as found\n      if (newRow) {\n        memo.push(newRow);\n        return true;\n      }\n      return hasFoundMatchYet;\n    }, false);\n\n    // If this is a left outer join and we didn't find a match\n    // for this parentRow, add it to the result set anyways\n    if ( !foundMatch && options.outer === 'left') {\n        memo.push(_.cloneDeep(parentRow));\n    }\n\n    return memo;\n  }, []);\n\n  // console.log('JOIN RESULT SET::', resultSet);\n  return resultSet;\n\n};\n","/**\n * Module dependencies\n */\n\nvar util = require('lodash');\nvar sanitize = require('validator').sanitize;\n\n\n\n\n/**\n * Public access\n */\n\nmodule.exports = function (entity) {\n\treturn new Anchor(entity);\n};\n\n\n\n\n\n/**\n * Constructor of individual instance of Anchor\n * Specify the function, object, or list to be anchored\n */\n\nfunction Anchor (entity) {\n\tif (util.isFunction(entity)) {\n\t\tthis.fn = entity;\n\t\tthrow new Error ('Anchor does not support functions yet!');\n\t}\n\telse this.data = entity;\n\n\treturn this;\n}\n\n\n\n\n\n/**\n * Built-in data type rules\n */\n\nAnchor.prototype.rules = require('./lib/match/rules');\n\n\n\n\n\n/**\n * Enforce that the data matches the specified ruleset\n */\n\nAnchor.prototype.to = function (ruleset, context) {\n\n\tvar errors = [];\n\n\t// If ruleset doesn't contain any explicit rule keys,\n\t// assume that this is a type\n\n\n\t// Look for explicit rules\n\tfor (var rule in ruleset) {\n\n\t\tif (rule === 'type') {\n\n\t\t\t// Use deep match to descend into the collection and verify each item and/or key\n\t\t\t// Stop at default maxDepth (50) to prevent infinite loops in self-associations\n\t\t\terrors = errors.concat(Anchor.match.type.call(context, this.data, ruleset['type']));\n\t\t}\n\n\t\t// Validate a non-type rule\n\t\telse {\n\t\t\terrors = errors.concat(Anchor.match.rule.call(context, this.data, rule, ruleset[rule]));\n\t\t}\n\t}\n\n\t// If errors exist, return the list of them\n\tif (errors.length) {\n\t\treturn errors;\n\t}\n\n\t// No errors, so return false\n\telse return false;\n\n};\nAnchor.prototype.hasErrors = Anchor.prototype.to;\n\n\n\n\n\n/**\n * Coerce the data to the specified ruleset if possible\n * otherwise throw an error\n * Priority: this should probably provide the default\n * implementation in Waterline core.  Currently it's completely\n * up to the adapter to define type coercion.\n *\n * Which is fine!.. but complicates custom CRUD adapter development.\n * Much handier would be an evented architecture, that allows\n * for adapter developers to write:\n *\n\t{\n\t\t// Called before find() receives criteria\n\t\t// Here, criteria refers to just attributes (the `where`)\n\t\t// limit, skip, and sort are not included\n\t\tcoerceCriteria: function (criteria) {\n\t\t\treturn criteria;\n\t\t},\n\n\t\t// Called before create() or update() receive values\n\t\tcoerceValues: function () {}\n\n\t}\n *\n * Adapter developers would be able to use Anchor.prototype.cast()\n * to declaritively define these type coercions.\n\n * Down the line, we could take this further for an even nicer API,\n * but for now, this alone would be a nice improvement.\n *\n */\n\nAnchor.prototype.cast = function (ruleset) {\n\ttodo();\n};\n\n\n\n\n/**\n * Coerce the data to the specified ruleset no matter what\n */\n\nAnchor.prototype.hurl = function (ruleset) {\n\n\t// Iterate trough given data attributes\n\t// to check if they exist in the ruleset\n\tfor (var attr in this.data) {\n\t\tif (this.data.hasOwnProperty(attr)) {\n\n\t\t\t// If it doesnt...\n\t\t\tif (!ruleset[attr]) {\n\n\t\t\t\t// Declaring err here as error helpers live in match.js\n\t\t\t\tvar err = new Error('Validation error: Attribute \\\"' + attr + '\\\" is not in the ruleset.');\n\n\t\t\t\t// just throw it\n\t\t\t\tthrow err;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Once we make sure that attributes match\n\t// we can just proceed to deepMatch\n\tAnchor.match(this.data, ruleset, this);\n};\n\n\n\n\n\n/**\n * Specify default values to automatically populated when undefined\n */\n\nAnchor.prototype.defaults = function (ruleset) {\n\ttodo();\n};\n\n\n\n\n\n/**\n * Declare a custom data type\n * If function definition is specified, `name` is required.\n * Otherwise, if dictionary-type `definition` is specified,\n * `name` must not be present.\n *\n * @param {String} name\t\t\t\t[optional]\n * @param {Object|Function}\tdefinition\n */\n\nAnchor.prototype.define = function (name, definition) {\n\n\t// check to see if we have an dictionary\n\tif ( util.isObject(name) ) {\n\n\t\t// if so all the attributes should be validation functions\n\t\tfor (var attr in name){\n\t\t\tif(!util.isFunction(name[attr])){\n\t\t\t\tthrow new Error('Definition error: \\\"' + attr + '\\\" does not have a definition');\n\t\t\t}\n\t\t}\n\n\t\t// add the new custom data types\n\t\tutil.extend(Anchor.prototype.rules, name);\n\n\t\treturn this;\n\n\t}\n\n\tif ( util.isFunction(definition) && util.isString(name) ) {\n\n\t\t// Add a single data type\n\t\tAnchor.prototype.rules[name] = definition;\n\n\t\treturn this;\n\n\t}\n\n\tthrow new Error('Definition error: \\\"' + name + '\\\" is not a valid definition.');\n};\n\n\n\n\n\n/**\n * Specify custom ruleset\n */\n\nAnchor.prototype.as = function (ruleset) {\n\ttodo();\n};\n\n\n\n\n/**\n * Specify named arguments and their rulesets as an object\n */\n\nAnchor.prototype.args = function (args) {\n\ttodo();\n};\n\n\n\n\n/**\n * Specify each of the permitted usages for this function\n */\n\nAnchor.prototype.usage = function () {\n\tvar usages = util.toArray(arguments);\n\ttodo();\n};\n\n\n\n\n/**\n * Deep-match a complex collection or model against a schema\n */\n\nAnchor.match = require('./lib/match');\n\n\n\n\n\n/**\n * Expose `define` so it can be used globally\n */\n\nmodule.exports.define = Anchor.prototype.define;\n\n\n\n\n\nfunction todo() {\n\tthrow new Error('Not implemented yet! If you\\'d like to contribute, tweet @mikermcneil.');\n}\n","exports = module.exports = require('./lib/_stream_readable.js');\nexports.Readable = exports;\nexports.Writable = require('./lib/_stream_writable.js');\nexports.Duplex = require('./lib/_stream_duplex.js');\nexports.Transform = require('./lib/_stream_transform.js');\nexports.PassThrough = require('./lib/_stream_passthrough.js');\n","module.exports = require(\"./lib/_stream_writable.js\")\n","module.exports = require(\"./lib/_stream_transform.js\")\n","module.exports = require(\"./lib/_stream_duplex.js\")\n","module.exports = require(\"./lib/_stream_passthrough.js\")\n","/**\n * Module Dependencies\n */\n\nvar hop = require('../helpers').object.hasOwnProperty;\nvar _ = require('lodash');\nvar assert = require('assert');\nvar util = require('util');\n\n/**\n * Traverse an object representing values replace associated objects with their\n * foreign keys.\n *\n * @param {String} model\n * @param {Object} schema\n * @param {Object} values\n * @return {Object}\n * @api private\n */\n\n\nmodule.exports = function(model, schema, values) {\n\n  Object.keys(values).forEach(function(key) {\n\n    // Check to see if this key is a foreign key\n    var attribute = schema[model].attributes[key];\n\n    // If not a plainObject, check if this is a model instance and has a toObject method\n    if(!_.isPlainObject(values[key])) {\n      if(_.isObject(values[key]) && !Array.isArray(values[key]) && values[key].toObject && typeof values[key].toObject === 'function') {\n        values[key] = values[key].toObject();\n      } else {\n        return;\n      }\n    }\n\n    // Check that this user-specified value is not NULL\n    if(values[key] === null) return;\n\n    // Check that this user-specified value actually exists\n    // as an attribute in `model`'s schema.\n    // If it doesn't- just ignore it\n    if (typeof attribute !== 'object') return;\n\n    if(!hop(values[key], attribute.on)) return;\n    var fk = values[key][attribute.on];\n    values[key] = fk;\n  });\n\n  return values;\n};\n","/**\n * Module Dependencies\n */\n\nvar hasOwnProperty = require('../helpers').object.hasOwnProperty;\n\n/**\n * Traverse an object representing values and map out any associations.\n *\n * @param {String} model\n * @param {Object} schema\n * @param {Object} values\n * @return {Object}\n * @api private\n */\n\n\nmodule.exports = function(model, schema, values) {\n  var self = this;\n\n  // Pick out the top level associations\n  var associations = {\n    collections: [],\n    models: []\n  };\n\n  Object.keys(values).forEach(function(key) {\n\n    // Ignore values equal to null\n    if(values[key] === null) return;\n\n    // Ignore joinTables\n    if(hasOwnProperty(schema[model], 'junctionTable')) return;\n    if(!hasOwnProperty(schema[model].attributes, key)) return;\n\n    var attribute = schema[model].attributes[key];\n    if(!hasOwnProperty(attribute, 'collection') && !hasOwnProperty(attribute, 'foreignKey')) return;\n\n    if(hasOwnProperty(attribute, 'collection')) associations.collections.push(key);\n    if(hasOwnProperty(attribute, 'foreignKey')) associations.models.push(key);\n\n  });\n\n  return associations;\n};\n","/**\n * Module Dependencies\n */\n\nvar _ = require('lodash');\nvar hasOwnProperty = require('../helpers').object.hasOwnProperty;\n\n/**\n * Queue up .add() operations on a model instance for any nested association\n * values in a .create() query.\n *\n * @param {Object} parentModel\n * @param {Object} values\n * @param {Object} associations\n * @param {Function} cb\n * @api private\n */\n\nmodule.exports = function(parentModel, values, associations, cb) {\n  var self = this;\n\n  // For each association, grab the primary key value and normalize into model.add methods\n  associations.forEach(function(association) {\n    var attribute = self.waterline.schema[self.identity].attributes[association];\n    var modelName;\n\n    if(hasOwnProperty(attribute, 'collection')) modelName = attribute.collection;\n\n    if(!modelName) return;\n\n    var pk = self.waterline.collections[modelName].primaryKey;\n\n    var optValues = values[association];\n    if(!optValues) return;\n    optValues.forEach(function(val) {\n\n      // If value is not an object, queue up an add\n      if(!_.isPlainObject(val)) return parentModel[association].add(val);\n\n      // If value is an object, check if a primary key is defined\n      if(hasOwnProperty(val, pk)) return parentModel[associations].add(val[pk]);\n\n      parentModel[association].add(val);\n    });\n  });\n\n  // Save the parent model\n  parentModel.save(cb);\n};\n","/**\n * Module Dependencies\n */\n\nvar _ = require('lodash');\nvar async = require('async');\nvar hop = require('../helpers').object.hasOwnProperty;\n\n\n/**\n * Update nested associations. Will take a values object and perform updating and\n * creating of all the nested associations. It's the same as syncing so it will first\n * remove any associations related to the parent and then \"sync\" the new associations.\n *\n * @param {Array} parents\n * @param {Object} values\n * @param {Object} associations\n * @param {Function} cb\n */\n\nmodule.exports = function(parents, values, associations, cb) {\n\n  var self = this;\n\n  // Cache parents\n  this.parents = parents;\n\n  // Combine model and collection associations\n  associations = associations.collections.concat(associations.models);\n\n  // Build up .add and .update operations for each association\n  var operations = buildOperations.call(self, associations, values);\n\n  // Now that our operations are built, lets go through and run any updates.\n  // Then for each parent, find all the current associations and remove them then add\n  // all the new associations in using .add()\n  sync.call(self, operations, cb);\n\n};\n\n\n/**\n * Build Up Operations (add and update)\n *\n * @param {Array} associations\n * @param {Object} values\n * @return {Object}\n */\n\nfunction buildOperations(associations, values) {\n\n  var self = this;\n  var operations = {};\n\n  // For each association, grab the primary key value and normalize into model.add methods\n  associations.forEach(function(association) {\n\n    var optValues = values[association];\n\n    // If values are being nulled out just return. This is used when removing foreign\n    // keys on the parent model.\n    if(optValues === null) return;\n\n    // Pull out any association values that have primary keys, these will need to be updated. All\n    // values can be added for each parent however.\n    operations[association] = {\n      add: [],\n      update: []\n    };\n\n    // Normalize optValues to an array\n    if(!Array.isArray(optValues)) optValues = [optValues];\n    queueOperations.call(self, association, operations[association], optValues);\n  });\n\n  return operations;\n}\n\n/**\n * Queue Up Operations.\n *\n * Takes the array normalized association values and queues up\n * operations for the specific association.\n *\n * @param {String} association\n * @param {Object} operation\n * @param {Array} values\n */\n\nfunction queueOperations(association, operation, values) {\n\n  var self = this;\n  var attribute = self.waterline.schema[self.identity].attributes[association];\n  var modelName;\n\n  if(hop(attribute, 'collection')) modelName = attribute.collection;\n  if(hop(attribute, 'foreignKey')) modelName = attribute.references;\n  if(!modelName) return;\n\n  var collection = self.waterline.collections[modelName];\n  var modelPk = collection.primaryKey;\n\n  // If this is a join table, we can just queue up operations on the parent\n  // for this association.\n  if(collection.junctionTable) {\n\n    // For each parent, queue up any .add() operations\n    self.parents.forEach(function(parent) {\n      values.forEach(function(val) {\n        if(!hop(parent, association)) return;\n        if(typeof parent[association].add !== 'function') return;\n        parent[association].add(val);\n      });\n    });\n\n    return;\n  }\n\n  values.forEach(function(val) {\n\n    // Check the values and see if the model's primary key is given. If so look into\n    // the schema attribute and check if this is a collection or model attribute. If it's\n    // a collection attribute lets update the child record and if it's a model attribute,\n    // update the child and set the parent's foreign key value to the new primary key.\n    if(!hop(val, modelPk)) {\n      operation.add.push(val);\n      return;\n    }\n\n    // Build up the criteria that will be used to update the child record\n    var criteria = {};\n    criteria[modelPk] = val[modelPk];\n\n    // Queue up the update operation\n    operation.update.push({ model: modelName, criteria: criteria, values: val });\n\n    // Check if the parents foreign key needs to be updated\n    if(!hop(attribute, 'foreignKey')) {\n      operation.add.push(val[modelPk]);\n      return;\n    }\n\n    // Set the new foreign key value for each parent\n    self.parents.forEach(function(parent) {\n      parent[association] = val[modelPk];\n    });\n\n  });\n}\n\n/**\n * Sync Associated Data\n *\n * Using the operations, lets go through and run any updates on any nested object with\n * primary keys. This ensures that all the data passed up is persisted. Then for each parent,\n * find all the current associations and unlink them and then add all the new associations\n * in using .add(). This ensures that whatever is passed in to an update is what the value will\n * be when queried again.\n *\n * @param {Object} operations\n * @param {Function} cb\n */\n\nfunction sync(operations, cb) {\n  var self = this;\n\n  async.auto({\n\n    // Update any nested associations\n    update: function(next) {\n      updateRunner.call(self, operations, next);\n    },\n\n    // For each parent, unlink all the associations currently set\n    unlink: ['update', function(next) {\n      unlinkRunner.call(self, operations, next);\n    }],\n\n    // For each parent found, link any associations passed in by either creating\n    // the new record or linking an existing record\n    link: ['unlink', function(next) {\n      linkRunner.call(self, operations, next);\n    }]\n\n  }, cb);\n}\n\n\n////////////////////////////////////////////////////////////////////////////////////////\n// .sync() - Async Auto Runners\n////////////////////////////////////////////////////////////////////////////////////////\n\n\n/**\n * Run Update Operations.\n *\n * Uses the information stored in an operation to perform a .update() on the\n * associated model using the new values.\n *\n * @param {Object} operation\n * @param {Function} cb\n */\n\nfunction updateRunner(operations, cb) {\n\n  var self = this;\n\n  // There will be an array of update operations inside of a namespace. Use this to run\n  // an update on the model instance of the association.\n  function associationLoop(association, next) {\n    async.each(operations[association].update, update, next);\n  }\n\n  function update(operation, next) {\n    var model = self.waterline.collections[operation.model];\n    model.update(operation.criteria, operation.values).exec(next);\n  }\n\n  // Operations are namespaced under an association key. So run each association's updates\n  // in parallel for now. May need to be limited in the future but all adapters should\n  // support connection pooling.\n  async.each(Object.keys(operations), associationLoop, cb);\n\n}\n\n\n/**\n * Unlink Associated Records.\n *\n * For each association passed in to the update we are essentially replacing the\n * association's value. In order to do this we first need to clear out any associations\n * that currently exist.\n *\n * @param {Object} operations\n * @param {Function} cb\n */\n\nfunction unlinkRunner(operations, cb) {\n\n  var self = this;\n\n  // Given a parent, build up remove operations and run them.\n  function unlinkParentAssociations(parent, next) {\n    var opts = buildParentRemoveOperations.call(self, parent, operations);\n    removeOperationRunner.call(self, opts, next);\n  }\n\n  async.each(this.parents, unlinkParentAssociations, cb);\n}\n\n\n/**\n * Link Associated Records\n *\n * Given a set of operations, associate the records with the parent records. This\n * can be done by either creating join table records or by setting foreign keys.\n * It defaults to a parent.add() method for most situations.\n *\n * @param {Object} operations\n * @param {Function} cb\n */\n\nfunction linkRunner(operations, cb) {\n\n  var self = this;\n\n  function linkChildRecords(parent, next) {\n\n    // Queue up `.add()` operations on the parent model and figure out\n    // which records need to be created.\n    //\n    // If an .add() method is available always use it. If this is a nested model an .add()\n    // method won't be available so queue up a create operation.\n    var recordsToCreate = buildParentLinkOperations.call(self, parent, operations);\n\n    // Create the new records and update the parent with the new foreign key\n    // values that may have been set when creating child records.\n    createNewRecords.call(self, parent, recordsToCreate, function(err) {\n      if(err) return next(err);\n      updateParentRecord(parent, cb);\n    });\n  }\n\n  // Update the parent record one last time. This ensures a model attribute (single object)\n  // on the parent can create a new record and then set the parent's foreign key value to\n  // the newly created child record's primary key.\n  //\n  // Example:\n  // Parent.update({\n  //   name: 'foo',\n  //   nestedModel: {\n  //     name: 'bar'\n  //   }\n  // })\n  //\n  // The above query would create the new nested model and then set the parent's nestedModel\n  // value to the newly created model's primary key.\n  //\n  // We then run a .save() to persist any .add() records that may have been used. The update and\n  // .save() are used instead of a find and then save because it's the same amount of queries\n  // and it's easier to take advantage of all that the .add() method gives us.\n  //\n  //\n  // TO-DO:\n  // Make this much smarter to reduce the amount of queries that need to be run. We should probably\n  // be able to at least cut this in half!\n  //\n  function updateParentRecord(parent, next) {\n\n    var criteria = {};\n    var model = self.waterline.collections[self.identity];\n\n    criteria[self.primaryKey] = parent[self.primaryKey];\n    var pValues = parent.toObject();\n\n    model.update(criteria, pValues).exec(function(err) {\n      if(err) return next(err);\n\n      // Call .save() to persist any .add() functions that may have been used.\n      parent.save(next);\n    });\n  }\n\n  async.each(this.parents, linkChildRecords, cb);\n}\n\n\n////////////////////////////////////////////////////////////////////////////////////////\n// .sync() - Helper Functions\n////////////////////////////////////////////////////////////////////////////////////////\n\n\n/**\n * Build up operations for performing unlinks.\n *\n * Given a parent and a set of operations, queue up operations to either\n * remove join table records or null out any foreign keys on an child model.\n *\n * @param {Object} parent\n * @param {Object} operations\n * @return {Array}\n */\n\nfunction buildParentRemoveOperations(parent, operations) {\n\n  var self = this;\n  var opts = [];\n\n  // Inspect the association and see if this relationship has a joinTable.\n  // If so create an operation criteria that clears all matching records from the\n  // table. If it doesn't have a join table, build an operation criteria that\n  // nulls out the foreign key on matching records.\n  Object.keys(operations).forEach(function(association) {\n\n    var criteria = {};\n    var searchCriteria = {};\n    var attribute = self.waterline.schema[self.identity].attributes[association];\n\n    /////////////////////////////////////////////////////////////////////////\n    // Parent Record:\n    // If the foreign key is stored on the parent side, null it out\n    /////////////////////////////////////////////////////////////////////////\n\n    if(hop(attribute, 'foreignKey')) {\n\n      // Set search criteria where primary key is equal to the parents primary key\n      searchCriteria[self.primaryKey] = parent[self.primaryKey];\n\n      // Store any information we may need to build up an operation.\n      // Use the `nullify` key to show we want to perform an update and not a destroy.\n      criteria = {\n        model: self.identity,\n        criteria: searchCriteria,\n        keyName: association,\n        nullify: true\n      };\n\n      opts.push(criteria);\n      return;\n    }\n\n    /////////////////////////////////////////////////////////////////////////\n    // Child Record:\n    // Lookup the attribute on the other side of the association on in the\n    // case of a m:m association the child table will be the join table.\n    /////////////////////////////////////////////////////////////////////////\n\n    var child = self.waterline.schema[attribute.collection];\n    var childAttribute = child.attributes[attribute.on];\n\n    // Set the search criteria to use the collection's `via` key and the parent's primary key.\n    searchCriteria[attribute.on] = parent[self.primaryKey];\n\n    // If the childAttribute stores the foreign key, find all children with the\n    // foreignKey equal to the parent's primary key and null them out or in the case of\n    // a `junctionTable` flag destroy them.\n    if(hop(childAttribute, 'foreignKey')) {\n\n      // Store any information needed to perform the query. Set nullify to false if\n      // a `junctionTable` property is found.\n      criteria = {\n        model: child.identity,\n        criteria: searchCriteria,\n        keyName: attribute.on,\n        nullify: hop(child, 'junctionTable') ? false : true\n      };\n\n      opts.push(criteria);\n      return;\n    }\n  });\n\n  return opts;\n}\n\n\n/**\n * Remove Operation Runner\n *\n * Given a criteria object matching a remove operation, perform the\n * operation using waterline collection instances.\n *\n * @param {Array} operations\n * @param {Function} callback\n */\n\nfunction removeOperationRunner(operations, cb) {\n\n  var self = this;\n\n  function runner(operation, next) {\n    var values = {};\n\n    // If nullify is false, run a destroy method using the criteria to destroy\n    // the join table records.\n    if(!operation.nullify) {\n      self.waterline.collections[operation.model].destroy(operation.criteria).exec(next);\n      return;\n    }\n\n    // Run an update operation to set the foreign key to null on all the\n    // associated child records.\n    values[operation.keyName] = null;\n\n    self.waterline.collections[operation.model].update(operation.criteria, values).exec(next);\n  }\n\n\n  // Run the operations\n  async.each(operations, runner, cb);\n}\n\n\n/**\n * Build up operations for performing links.\n *\n * Given a parent and a set of operations, queue up operations to associate two\n * records together. This could be using the parent's `.add()` method which handles\n * the logic for us or building up a `create` operation that we can run to create the\n * associated record with the correct foreign key set.\n *\n * @param {Object} parent\n * @param {Object} operations\n * @return {Object}\n */\n\nfunction buildParentLinkOperations(parent, operations) {\n\n  var recordsToCreate = {};\n\n  // Determine whether to use the parent association's `.add()` function\n  // or whether to queue up a create operation.\n  function determineOperation(association, opt) {\n\n    // Check if the association has an `add` method, if so use it.\n    if(hop(parent[association], 'add')) {\n      parent[association].add(opt);\n      return;\n    }\n\n    recordsToCreate[association] = recordsToCreate[association] || [];\n    recordsToCreate[association].push(opt);\n  }\n\n  // For each operation look at all the .add operations and determine\n  // what to do with them.\n  Object.keys(operations).forEach(function(association) {\n    operations[association].add.forEach(function(opt) {\n      determineOperation(association, opt);\n    });\n  });\n\n  return recordsToCreate;\n}\n\n\n/**\n * Create New Records.\n *\n * Given an object of association records to create, perform a create\n * on the child model and set the parent's foreign key to the newly\n * created record's primary key.\n *\n * @param {Object} parent\n * @param {Object} recordsToCreate\n * @param {Function} cb\n */\n\nfunction createNewRecords(parent, recordsToCreate, cb) {\n\n  var self = this;\n\n  // For each association, run the createRecords function\n  // in the model context.\n  function mapAssociations(association, next) {\n    var model = self.waterline.collections[association];\n    var records = recordsToCreate[association];\n\n    function createRunner(record, nextRecord) {\n      var args = [parent, association, record, nextRecord];\n      createRecord.apply(model, args);\n    }\n\n    async.each(records, createRunner, next);\n  }\n\n  // Create a record and set the parent's foreign key to the\n  // newly created record's primary key.\n  function createRecord(parent, association, record, next) {\n    var self = this;\n\n    this.create(record).exec(function(err, val) {\n      if(err) return next(err);\n      parent[association] = val[self.primaryKey];\n      next();\n    });\n  }\n\n\n  async.each(Object.keys(recordsToCreate), mapAssociations, cb);\n}\n","module.exports = require('./lib');","/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\nvar validator = require('validator');\n\n\n\n/**\n * Type rules\n */\n\nmodule.exports = {\n\n\t'empty'\t\t: _.isEmpty,\n\n\t'required'\t: function (x) {\n\t\t// Transform data to work properly with node validator\n\t\tif(!x && x !== 0) x = '';\n\t\telse if(typeof x.toString !== 'undefined') x = x.toString();\n\t\telse x = '' + x;\n\n\t\treturn !validator.isNull(x);\n\t},\n\n\t'notEmpty'\t: function (x) {\n\n\t\t// Transform data to work properly with node validator\n\t\tif (!x) x = '';\n\t\telse if (typeof x.toString !== 'undefined') x = x.toString();\n\t\telse x = '' + x;\n\n\t\treturn !validator.isNull(x);\n\t},\n\n\t'undefined'\t: _.isUndefined,\n\n\t'object'  : _.isObject,\n\t'json'    : function (x) {\n\t\tif (_.isUndefined(x)) return false;\n\t\ttry { JSON.stringify(x); }\n\t\tcatch(err) { return false; }\n\t\treturn true;\n\t},\n\n\t'text'\t\t: _.isString,\n\t'string'\t: _.isString,\n\t'alpha'\t\t: validator.isAlpha,\n\t'alphadashed': function (x) {return (/^[a-zA-Z-_]*$/).test(x); },\n\t'numeric'\t: validator.isNumeric,\n\t'alphanumeric': validator.isAlphanumeric,\n\t'alphanumericdashed': function (x) {return (/^[a-zA-Z0-9-_]*$/).test(x); },\n\t'email'\t\t: validator.isEmail,\n\t'url'\t\t\t: validator.isURL,\n\t'urlish'\t: /^\\s([^\\/]+\\.)+.+\\s*$/g,\n\t'ip'\t\t\t: validator.isIP,\n\t'ipv4'\t\t: validator.isIPv4,\n\t'ipv6'\t\t: validator.isIPv6,\n\t'creditcard': validator.isCreditCard,\n\t'uuid'\t\t: validator.isUUID,\n\t'uuidv3'\t: function (x){ return validator.isUUID(x, 3);},\n\t'uuidv4'\t: function (x){ return validator.isUUID(x, 4);},\n\n\t'int'\t\t\t: validator.isInt,\n\t'integer'\t: validator.isInt,\n\t'number'\t: _.isNumber,\n\t'finite'\t: _.isFinite,\n\n\t'decimal'\t: validator.isFloat,\n\t'float'\t\t: validator.isFloat,\n\n\t'falsey'\t: function (x) { return !x; },\n\t'truthy'\t: function (x) { return !!x; },\n\t'null'\t\t: _.isNull,\n\t'notNull'\t: function (x) { return !validator.isNull(x); },\n\n\t'boolean'\t: _.isBoolean,\n\n\t'array'\t\t: _.isArray,\n\n\t'binary'\t: function (x) { return Buffer.isBuffer(x) || _.isString(x); },\n\n\t'date'\t\t: validator.isDate,\n\t'datetime': validator.isDate,\n\n\t'hexadecimal': validator.hexadecimal,\n\t'hexColor': validator.isHexColor,\n\n\t'lowercase': validator.lowercase,\n\t'uppercase': validator.uppercase,\n\n\t// Miscellaneous rules\n\t'after'\t\t: validator.isAfter,\n\t'before'\t: validator.isBefore,\n\n\t'equals'\t: validator.equals,\n\t'contains': validator.contains,\n\t'notContains': function (x, str) { return !validator.contains(x, str); },\n\t'len'\t\t\t: function (x, min, max) { return validator.len(x, min, max); },\n\t'in'\t\t\t: validator.isIn,\n\t'notIn'\t\t: function (x, arrayOrString) { return !validator.isIn(x, arrayOrString); },\n\t'max'\t\t\t: function (x, val) {\n\t\tvar number = parseFloat(x);\n\t\treturn isNaN(number) || number <= val;\n\t},\n\t'min'\t\t\t: function (x, val) {\n\t\tvar number = parseFloat(x);\n\t\treturn isNaN(number) || number >= val;\n\t},\n\t'minLength'\t: function (x, min) { return validator.isLength(x, min); },\n\t'maxLength'\t: function (x, max) { return validator.isLength(x, 0, max); },\n\n\t'regex' : function (x, regex) { return validator.matches(x, regex); },\n\t'notRegex' : function (x, regex) { return !validator.matches(x, regex); }\n\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nmodule.exports = Readable;\n\n/*<replacement>*/\nvar isArray = require('isarray');\n/*</replacement>*/\n\n\n/*<replacement>*/\nvar Buffer = require('buffer').Buffer;\n/*</replacement>*/\n\nReadable.ReadableState = ReadableState;\n\nvar EE = require('events').EventEmitter;\n\n/*<replacement>*/\nif (!EE.listenerCount) EE.listenerCount = function(emitter, type) {\n  return emitter.listeners(type).length;\n};\n/*</replacement>*/\n\nvar Stream = require('stream');\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nvar StringDecoder;\n\nutil.inherits(Readable, Stream);\n\nfunction ReadableState(options, stream) {\n  options = options || {};\n\n  // the point at which it stops calling _read() to fill the buffer\n  // Note: 0 is a valid value, means \"don't call _read preemptively ever\"\n  var hwm = options.highWaterMark;\n  this.highWaterMark = (hwm || hwm === 0) ? hwm : 16 * 1024;\n\n  // cast to ints.\n  this.highWaterMark = ~~this.highWaterMark;\n\n  this.buffer = [];\n  this.length = 0;\n  this.pipes = null;\n  this.pipesCount = 0;\n  this.flowing = false;\n  this.ended = false;\n  this.endEmitted = false;\n  this.reading = false;\n\n  // In streams that never have any data, and do push(null) right away,\n  // the consumer can miss the 'end' event if they do some I/O before\n  // consuming the stream.  So, we don't emit('end') until some reading\n  // happens.\n  this.calledRead = false;\n\n  // a flag to be able to tell if the onwrite cb is called immediately,\n  // or on a later tick.  We set this to true at first, becuase any\n  // actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first write call.\n  this.sync = true;\n\n  // whenever we return null, then we set a flag to say\n  // that we're awaiting a 'readable' event emission.\n  this.needReadable = false;\n  this.emittedReadable = false;\n  this.readableListening = false;\n\n\n  // object stream flag. Used to make read(n) ignore n and to\n  // make all the buffer merging and length checks go away\n  this.objectMode = !!options.objectMode;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // when piping, we only care about 'readable' events that happen\n  // after read()ing all the bytes and not getting any pushback.\n  this.ranOut = false;\n\n  // the number of writers that are awaiting a drain event in .pipe()s\n  this.awaitDrain = 0;\n\n  // if true, a maybeReadMore has been scheduled\n  this.readingMore = false;\n\n  this.decoder = null;\n  this.encoding = null;\n  if (options.encoding) {\n    if (!StringDecoder)\n      StringDecoder = require('string_decoder/').StringDecoder;\n    this.decoder = new StringDecoder(options.encoding);\n    this.encoding = options.encoding;\n  }\n}\n\nfunction Readable(options) {\n  if (!(this instanceof Readable))\n    return new Readable(options);\n\n  this._readableState = new ReadableState(options, this);\n\n  // legacy\n  this.readable = true;\n\n  Stream.call(this);\n}\n\n// Manually shove something into the read() buffer.\n// This returns true if the highWaterMark has not been hit yet,\n// similar to how Writable.write() returns true if you should\n// write() some more.\nReadable.prototype.push = function(chunk, encoding) {\n  var state = this._readableState;\n\n  if (typeof chunk === 'string' && !state.objectMode) {\n    encoding = encoding || state.defaultEncoding;\n    if (encoding !== state.encoding) {\n      chunk = new Buffer(chunk, encoding);\n      encoding = '';\n    }\n  }\n\n  return readableAddChunk(this, state, chunk, encoding, false);\n};\n\n// Unshift should *always* be something directly out of read()\nReadable.prototype.unshift = function(chunk) {\n  var state = this._readableState;\n  return readableAddChunk(this, state, chunk, '', true);\n};\n\nfunction readableAddChunk(stream, state, chunk, encoding, addToFront) {\n  var er = chunkInvalid(state, chunk);\n  if (er) {\n    stream.emit('error', er);\n  } else if (chunk === null || chunk === undefined) {\n    state.reading = false;\n    if (!state.ended)\n      onEofChunk(stream, state);\n  } else if (state.objectMode || chunk && chunk.length > 0) {\n    if (state.ended && !addToFront) {\n      var e = new Error('stream.push() after EOF');\n      stream.emit('error', e);\n    } else if (state.endEmitted && addToFront) {\n      var e = new Error('stream.unshift() after end event');\n      stream.emit('error', e);\n    } else {\n      if (state.decoder && !addToFront && !encoding)\n        chunk = state.decoder.write(chunk);\n\n      // update the buffer info.\n      state.length += state.objectMode ? 1 : chunk.length;\n      if (addToFront) {\n        state.buffer.unshift(chunk);\n      } else {\n        state.reading = false;\n        state.buffer.push(chunk);\n      }\n\n      if (state.needReadable)\n        emitReadable(stream);\n\n      maybeReadMore(stream, state);\n    }\n  } else if (!addToFront) {\n    state.reading = false;\n  }\n\n  return needMoreData(state);\n}\n\n\n\n// if it's past the high water mark, we can push in some more.\n// Also, if we have no data yet, we can stand some\n// more bytes.  This is to work around cases where hwm=0,\n// such as the repl.  Also, if the push() triggered a\n// readable event, and the user called read(largeNumber) such that\n// needReadable was set, then we ought to push more, so that another\n// 'readable' event will be triggered.\nfunction needMoreData(state) {\n  return !state.ended &&\n         (state.needReadable ||\n          state.length < state.highWaterMark ||\n          state.length === 0);\n}\n\n// backwards compatibility.\nReadable.prototype.setEncoding = function(enc) {\n  if (!StringDecoder)\n    StringDecoder = require('string_decoder/').StringDecoder;\n  this._readableState.decoder = new StringDecoder(enc);\n  this._readableState.encoding = enc;\n};\n\n// Don't raise the hwm > 128MB\nvar MAX_HWM = 0x800000;\nfunction roundUpToNextPowerOf2(n) {\n  if (n >= MAX_HWM) {\n    n = MAX_HWM;\n  } else {\n    // Get the next highest power of 2\n    n--;\n    for (var p = 1; p < 32; p <<= 1) n |= n >> p;\n    n++;\n  }\n  return n;\n}\n\nfunction howMuchToRead(n, state) {\n  if (state.length === 0 && state.ended)\n    return 0;\n\n  if (state.objectMode)\n    return n === 0 ? 0 : 1;\n\n  if (isNaN(n) || n === null) {\n    // only flow one buffer at a time\n    if (state.flowing && state.buffer.length)\n      return state.buffer[0].length;\n    else\n      return state.length;\n  }\n\n  if (n <= 0)\n    return 0;\n\n  // If we're asking for more than the target buffer level,\n  // then raise the water mark.  Bump up to the next highest\n  // power of 2, to prevent increasing it excessively in tiny\n  // amounts.\n  if (n > state.highWaterMark)\n    state.highWaterMark = roundUpToNextPowerOf2(n);\n\n  // don't have that much.  return null, unless we've ended.\n  if (n > state.length) {\n    if (!state.ended) {\n      state.needReadable = true;\n      return 0;\n    } else\n      return state.length;\n  }\n\n  return n;\n}\n\n// you can override either this method, or the async _read(n) below.\nReadable.prototype.read = function(n) {\n  var state = this._readableState;\n  state.calledRead = true;\n  var nOrig = n;\n\n  if (typeof n !== 'number' || n > 0)\n    state.emittedReadable = false;\n\n  // if we're doing read(0) to trigger a readable event, but we\n  // already have a bunch of data in the buffer, then just trigger\n  // the 'readable' event and move on.\n  if (n === 0 &&\n      state.needReadable &&\n      (state.length >= state.highWaterMark || state.ended)) {\n    emitReadable(this);\n    return null;\n  }\n\n  n = howMuchToRead(n, state);\n\n  // if we've ended, and we're now clear, then finish it up.\n  if (n === 0 && state.ended) {\n    if (state.length === 0)\n      endReadable(this);\n    return null;\n  }\n\n  // All the actual chunk generation logic needs to be\n  // *below* the call to _read.  The reason is that in certain\n  // synthetic stream cases, such as passthrough streams, _read\n  // may be a completely synchronous operation which may change\n  // the state of the read buffer, providing enough data when\n  // before there was *not* enough.\n  //\n  // So, the steps are:\n  // 1. Figure out what the state of things will be after we do\n  // a read from the buffer.\n  //\n  // 2. If that resulting state will trigger a _read, then call _read.\n  // Note that this may be asynchronous, or synchronous.  Yes, it is\n  // deeply ugly to write APIs this way, but that still doesn't mean\n  // that the Readable class should behave improperly, as streams are\n  // designed to be sync/async agnostic.\n  // Take note if the _read call is sync or async (ie, if the read call\n  // has returned yet), so that we know whether or not it's safe to emit\n  // 'readable' etc.\n  //\n  // 3. Actually pull the requested chunks out of the buffer and return.\n\n  // if we need a readable event, then we need to do some reading.\n  var doRead = state.needReadable;\n\n  // if we currently have less than the highWaterMark, then also read some\n  if (state.length - n <= state.highWaterMark)\n    doRead = true;\n\n  // however, if we've ended, then there's no point, and if we're already\n  // reading, then it's unnecessary.\n  if (state.ended || state.reading)\n    doRead = false;\n\n  if (doRead) {\n    state.reading = true;\n    state.sync = true;\n    // if the length is currently zero, then we *need* a readable event.\n    if (state.length === 0)\n      state.needReadable = true;\n    // call internal read method\n    this._read(state.highWaterMark);\n    state.sync = false;\n  }\n\n  // If _read called its callback synchronously, then `reading`\n  // will be false, and we need to re-evaluate how much data we\n  // can return to the user.\n  if (doRead && !state.reading)\n    n = howMuchToRead(nOrig, state);\n\n  var ret;\n  if (n > 0)\n    ret = fromList(n, state);\n  else\n    ret = null;\n\n  if (ret === null) {\n    state.needReadable = true;\n    n = 0;\n  }\n\n  state.length -= n;\n\n  // If we have nothing in the buffer, then we want to know\n  // as soon as we *do* get something into the buffer.\n  if (state.length === 0 && !state.ended)\n    state.needReadable = true;\n\n  // If we happened to read() exactly the remaining amount in the\n  // buffer, and the EOF has been seen at this point, then make sure\n  // that we emit 'end' on the very next tick.\n  if (state.ended && !state.endEmitted && state.length === 0)\n    endReadable(this);\n\n  return ret;\n};\n\nfunction chunkInvalid(state, chunk) {\n  var er = null;\n  if (!Buffer.isBuffer(chunk) &&\n      'string' !== typeof chunk &&\n      chunk !== null &&\n      chunk !== undefined &&\n      !state.objectMode &&\n      !er) {\n    er = new TypeError('Invalid non-string/buffer chunk');\n  }\n  return er;\n}\n\n\nfunction onEofChunk(stream, state) {\n  if (state.decoder && !state.ended) {\n    var chunk = state.decoder.end();\n    if (chunk && chunk.length) {\n      state.buffer.push(chunk);\n      state.length += state.objectMode ? 1 : chunk.length;\n    }\n  }\n  state.ended = true;\n\n  // if we've ended and we have some data left, then emit\n  // 'readable' now to make sure it gets picked up.\n  if (state.length > 0)\n    emitReadable(stream);\n  else\n    endReadable(stream);\n}\n\n// Don't emit readable right away in sync mode, because this can trigger\n// another read() call => stack overflow.  This way, it might trigger\n// a nextTick recursion warning, but that's not so bad.\nfunction emitReadable(stream) {\n  var state = stream._readableState;\n  state.needReadable = false;\n  if (state.emittedReadable)\n    return;\n\n  state.emittedReadable = true;\n  if (state.sync)\n    process.nextTick(function() {\n      emitReadable_(stream);\n    });\n  else\n    emitReadable_(stream);\n}\n\nfunction emitReadable_(stream) {\n  stream.emit('readable');\n}\n\n\n// at this point, the user has presumably seen the 'readable' event,\n// and called read() to consume some data.  that may have triggered\n// in turn another _read(n) call, in which case reading = true if\n// it's in progress.\n// However, if we're not ended, or reading, and the length < hwm,\n// then go ahead and try to read some more preemptively.\nfunction maybeReadMore(stream, state) {\n  if (!state.readingMore) {\n    state.readingMore = true;\n    process.nextTick(function() {\n      maybeReadMore_(stream, state);\n    });\n  }\n}\n\nfunction maybeReadMore_(stream, state) {\n  var len = state.length;\n  while (!state.reading && !state.flowing && !state.ended &&\n         state.length < state.highWaterMark) {\n    stream.read(0);\n    if (len === state.length)\n      // didn't get any data, stop spinning.\n      break;\n    else\n      len = state.length;\n  }\n  state.readingMore = false;\n}\n\n// abstract method.  to be overridden in specific implementation classes.\n// call cb(er, data) where data is <= n in length.\n// for virtual (non-string, non-buffer) streams, \"length\" is somewhat\n// arbitrary, and perhaps not very meaningful.\nReadable.prototype._read = function(n) {\n  this.emit('error', new Error('not implemented'));\n};\n\nReadable.prototype.pipe = function(dest, pipeOpts) {\n  var src = this;\n  var state = this._readableState;\n\n  switch (state.pipesCount) {\n    case 0:\n      state.pipes = dest;\n      break;\n    case 1:\n      state.pipes = [state.pipes, dest];\n      break;\n    default:\n      state.pipes.push(dest);\n      break;\n  }\n  state.pipesCount += 1;\n\n  var doEnd = (!pipeOpts || pipeOpts.end !== false) &&\n              dest !== process.stdout &&\n              dest !== process.stderr;\n\n  var endFn = doEnd ? onend : cleanup;\n  if (state.endEmitted)\n    process.nextTick(endFn);\n  else\n    src.once('end', endFn);\n\n  dest.on('unpipe', onunpipe);\n  function onunpipe(readable) {\n    if (readable !== src) return;\n    cleanup();\n  }\n\n  function onend() {\n    dest.end();\n  }\n\n  // when the dest drains, it reduces the awaitDrain counter\n  // on the source.  This would be more elegant with a .once()\n  // handler in flow(), but adding and removing repeatedly is\n  // too slow.\n  var ondrain = pipeOnDrain(src);\n  dest.on('drain', ondrain);\n\n  function cleanup() {\n    // cleanup event handlers once the pipe is broken\n    dest.removeListener('close', onclose);\n    dest.removeListener('finish', onfinish);\n    dest.removeListener('drain', ondrain);\n    dest.removeListener('error', onerror);\n    dest.removeListener('unpipe', onunpipe);\n    src.removeListener('end', onend);\n    src.removeListener('end', cleanup);\n\n    // if the reader is waiting for a drain event from this\n    // specific writer, then it would cause it to never start\n    // flowing again.\n    // So, if this is awaiting a drain, then we just call it now.\n    // If we don't know, then assume that we are waiting for one.\n    if (!dest._writableState || dest._writableState.needDrain)\n      ondrain();\n  }\n\n  // if the dest has an error, then stop piping into it.\n  // however, don't suppress the throwing behavior for this.\n  function onerror(er) {\n    unpipe();\n    dest.removeListener('error', onerror);\n    if (EE.listenerCount(dest, 'error') === 0)\n      dest.emit('error', er);\n  }\n  // This is a brutally ugly hack to make sure that our error handler\n  // is attached before any userland ones.  NEVER DO THIS.\n  if (!dest._events || !dest._events.error)\n    dest.on('error', onerror);\n  else if (isArray(dest._events.error))\n    dest._events.error.unshift(onerror);\n  else\n    dest._events.error = [onerror, dest._events.error];\n\n\n\n  // Both close and finish should trigger unpipe, but only once.\n  function onclose() {\n    dest.removeListener('finish', onfinish);\n    unpipe();\n  }\n  dest.once('close', onclose);\n  function onfinish() {\n    dest.removeListener('close', onclose);\n    unpipe();\n  }\n  dest.once('finish', onfinish);\n\n  function unpipe() {\n    src.unpipe(dest);\n  }\n\n  // tell the dest that it's being piped to\n  dest.emit('pipe', src);\n\n  // start the flow if it hasn't been started already.\n  if (!state.flowing) {\n    // the handler that waits for readable events after all\n    // the data gets sucked out in flow.\n    // This would be easier to follow with a .once() handler\n    // in flow(), but that is too slow.\n    this.on('readable', pipeOnReadable);\n\n    state.flowing = true;\n    process.nextTick(function() {\n      flow(src);\n    });\n  }\n\n  return dest;\n};\n\nfunction pipeOnDrain(src) {\n  return function() {\n    var dest = this;\n    var state = src._readableState;\n    state.awaitDrain--;\n    if (state.awaitDrain === 0)\n      flow(src);\n  };\n}\n\nfunction flow(src) {\n  var state = src._readableState;\n  var chunk;\n  state.awaitDrain = 0;\n\n  function write(dest, i, list) {\n    var written = dest.write(chunk);\n    if (false === written) {\n      state.awaitDrain++;\n    }\n  }\n\n  while (state.pipesCount && null !== (chunk = src.read())) {\n\n    if (state.pipesCount === 1)\n      write(state.pipes, 0, null);\n    else\n      forEach(state.pipes, write);\n\n    src.emit('data', chunk);\n\n    // if anyone needs a drain, then we have to wait for that.\n    if (state.awaitDrain > 0)\n      return;\n  }\n\n  // if every destination was unpiped, either before entering this\n  // function, or in the while loop, then stop flowing.\n  //\n  // NB: This is a pretty rare edge case.\n  if (state.pipesCount === 0) {\n    state.flowing = false;\n\n    // if there were data event listeners added, then switch to old mode.\n    if (EE.listenerCount(src, 'data') > 0)\n      emitDataEvents(src);\n    return;\n  }\n\n  // at this point, no one needed a drain, so we just ran out of data\n  // on the next readable event, start it over again.\n  state.ranOut = true;\n}\n\nfunction pipeOnReadable() {\n  if (this._readableState.ranOut) {\n    this._readableState.ranOut = false;\n    flow(this);\n  }\n}\n\n\nReadable.prototype.unpipe = function(dest) {\n  var state = this._readableState;\n\n  // if we're not piping anywhere, then do nothing.\n  if (state.pipesCount === 0)\n    return this;\n\n  // just one destination.  most common case.\n  if (state.pipesCount === 1) {\n    // passed in one, but it's not the right one.\n    if (dest && dest !== state.pipes)\n      return this;\n\n    if (!dest)\n      dest = state.pipes;\n\n    // got a match.\n    state.pipes = null;\n    state.pipesCount = 0;\n    this.removeListener('readable', pipeOnReadable);\n    state.flowing = false;\n    if (dest)\n      dest.emit('unpipe', this);\n    return this;\n  }\n\n  // slow case. multiple pipe destinations.\n\n  if (!dest) {\n    // remove all.\n    var dests = state.pipes;\n    var len = state.pipesCount;\n    state.pipes = null;\n    state.pipesCount = 0;\n    this.removeListener('readable', pipeOnReadable);\n    state.flowing = false;\n\n    for (var i = 0; i < len; i++)\n      dests[i].emit('unpipe', this);\n    return this;\n  }\n\n  // try to find the right one.\n  var i = indexOf(state.pipes, dest);\n  if (i === -1)\n    return this;\n\n  state.pipes.splice(i, 1);\n  state.pipesCount -= 1;\n  if (state.pipesCount === 1)\n    state.pipes = state.pipes[0];\n\n  dest.emit('unpipe', this);\n\n  return this;\n};\n\n// set up data events if they are asked for\n// Ensure readable listeners eventually get something\nReadable.prototype.on = function(ev, fn) {\n  var res = Stream.prototype.on.call(this, ev, fn);\n\n  if (ev === 'data' && !this._readableState.flowing)\n    emitDataEvents(this);\n\n  if (ev === 'readable' && this.readable) {\n    var state = this._readableState;\n    if (!state.readableListening) {\n      state.readableListening = true;\n      state.emittedReadable = false;\n      state.needReadable = true;\n      if (!state.reading) {\n        this.read(0);\n      } else if (state.length) {\n        emitReadable(this, state);\n      }\n    }\n  }\n\n  return res;\n};\nReadable.prototype.addListener = Readable.prototype.on;\n\n// pause() and resume() are remnants of the legacy readable stream API\n// If the user uses them, then switch into old mode.\nReadable.prototype.resume = function() {\n  emitDataEvents(this);\n  this.read(0);\n  this.emit('resume');\n};\n\nReadable.prototype.pause = function() {\n  emitDataEvents(this, true);\n  this.emit('pause');\n};\n\nfunction emitDataEvents(stream, startPaused) {\n  var state = stream._readableState;\n\n  if (state.flowing) {\n    // https://github.com/isaacs/readable-stream/issues/16\n    throw new Error('Cannot switch to old mode now.');\n  }\n\n  var paused = startPaused || false;\n  var readable = false;\n\n  // convert to an old-style stream.\n  stream.readable = true;\n  stream.pipe = Stream.prototype.pipe;\n  stream.on = stream.addListener = Stream.prototype.on;\n\n  stream.on('readable', function() {\n    readable = true;\n\n    var c;\n    while (!paused && (null !== (c = stream.read())))\n      stream.emit('data', c);\n\n    if (c === null) {\n      readable = false;\n      stream._readableState.needReadable = true;\n    }\n  });\n\n  stream.pause = function() {\n    paused = true;\n    this.emit('pause');\n  };\n\n  stream.resume = function() {\n    paused = false;\n    if (readable)\n      process.nextTick(function() {\n        stream.emit('readable');\n      });\n    else\n      this.read(0);\n    this.emit('resume');\n  };\n\n  // now make it start, just in case it hadn't already.\n  stream.emit('readable');\n}\n\n// wrap an old-style stream as the async data source.\n// This is *not* part of the readable stream interface.\n// It is an ugly unfortunate mess of history.\nReadable.prototype.wrap = function(stream) {\n  var state = this._readableState;\n  var paused = false;\n\n  var self = this;\n  stream.on('end', function() {\n    if (state.decoder && !state.ended) {\n      var chunk = state.decoder.end();\n      if (chunk && chunk.length)\n        self.push(chunk);\n    }\n\n    self.push(null);\n  });\n\n  stream.on('data', function(chunk) {\n    if (state.decoder)\n      chunk = state.decoder.write(chunk);\n    if (!chunk || !state.objectMode && !chunk.length)\n      return;\n\n    var ret = self.push(chunk);\n    if (!ret) {\n      paused = true;\n      stream.pause();\n    }\n  });\n\n  // proxy all the other methods.\n  // important when wrapping filters and duplexes.\n  for (var i in stream) {\n    if (typeof stream[i] === 'function' &&\n        typeof this[i] === 'undefined') {\n      this[i] = function(method) { return function() {\n        return stream[method].apply(stream, arguments);\n      }}(i);\n    }\n  }\n\n  // proxy certain important events.\n  var events = ['error', 'close', 'destroy', 'pause', 'resume'];\n  forEach(events, function(ev) {\n    stream.on(ev, self.emit.bind(self, ev));\n  });\n\n  // when we try to consume some more bytes, simply unpause the\n  // underlying stream.\n  self._read = function(n) {\n    if (paused) {\n      paused = false;\n      stream.resume();\n    }\n  };\n\n  return self;\n};\n\n\n\n// exposed for testing purposes only.\nReadable._fromList = fromList;\n\n// Pluck off n bytes from an array of buffers.\n// Length is the combined lengths of all the buffers in the list.\nfunction fromList(n, state) {\n  var list = state.buffer;\n  var length = state.length;\n  var stringMode = !!state.decoder;\n  var objectMode = !!state.objectMode;\n  var ret;\n\n  // nothing in the list, definitely empty.\n  if (list.length === 0)\n    return null;\n\n  if (length === 0)\n    ret = null;\n  else if (objectMode)\n    ret = list.shift();\n  else if (!n || n >= length) {\n    // read it all, truncate the array.\n    if (stringMode)\n      ret = list.join('');\n    else\n      ret = Buffer.concat(list, length);\n    list.length = 0;\n  } else {\n    // read just some of it.\n    if (n < list[0].length) {\n      // just take a part of the first list item.\n      // slice is the same for buffers and strings.\n      var buf = list[0];\n      ret = buf.slice(0, n);\n      list[0] = buf.slice(n);\n    } else if (n === list[0].length) {\n      // first list is a perfect match\n      ret = list.shift();\n    } else {\n      // complex case.\n      // we have enough to cover it, but it spans past the first buffer.\n      if (stringMode)\n        ret = '';\n      else\n        ret = new Buffer(n);\n\n      var c = 0;\n      for (var i = 0, l = list.length; i < l && c < n; i++) {\n        var buf = list[0];\n        var cpy = Math.min(n - c, buf.length);\n\n        if (stringMode)\n          ret += buf.slice(0, cpy);\n        else\n          buf.copy(ret, c, 0, cpy);\n\n        if (cpy < buf.length)\n          list[0] = buf.slice(cpy);\n        else\n          list.shift();\n\n        c += cpy;\n      }\n    }\n  }\n\n  return ret;\n}\n\nfunction endReadable(stream) {\n  var state = stream._readableState;\n\n  // If we get here before consuming all the bytes, then that is a\n  // bug in node.  Should never happen.\n  if (state.length > 0)\n    throw new Error('endReadable called on non-empty stream');\n\n  if (!state.endEmitted && state.calledRead) {\n    state.ended = true;\n    process.nextTick(function() {\n      // Check that we didn't get one last unshift.\n      if (!state.endEmitted && state.length === 0) {\n        state.endEmitted = true;\n        stream.readable = false;\n        stream.emit('end');\n      }\n    });\n  }\n}\n\nfunction forEach (xs, f) {\n  for (var i = 0, l = xs.length; i < l; i++) {\n    f(xs[i], i);\n  }\n}\n\nfunction indexOf (xs, x) {\n  for (var i = 0, l = xs.length; i < l; i++) {\n    if (xs[i] === x) return i;\n  }\n  return -1;\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// A bit simpler than readable streams.\n// Implement an async ._write(chunk, cb), and it'll handle all\n// the drain event emission and buffering.\n\nmodule.exports = Writable;\n\n/*<replacement>*/\nvar Buffer = require('buffer').Buffer;\n/*</replacement>*/\n\nWritable.WritableState = WritableState;\n\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\n\nvar Stream = require('stream');\n\nutil.inherits(Writable, Stream);\n\nfunction WriteReq(chunk, encoding, cb) {\n  this.chunk = chunk;\n  this.encoding = encoding;\n  this.callback = cb;\n}\n\nfunction WritableState(options, stream) {\n  options = options || {};\n\n  // the point at which write() starts returning false\n  // Note: 0 is a valid value, means that we always return false if\n  // the entire buffer is not flushed immediately on write()\n  var hwm = options.highWaterMark;\n  this.highWaterMark = (hwm || hwm === 0) ? hwm : 16 * 1024;\n\n  // object stream flag to indicate whether or not this stream\n  // contains buffers or objects.\n  this.objectMode = !!options.objectMode;\n\n  // cast to ints.\n  this.highWaterMark = ~~this.highWaterMark;\n\n  this.needDrain = false;\n  // at the start of calling end()\n  this.ending = false;\n  // when end() has been called, and returned\n  this.ended = false;\n  // when 'finish' is emitted\n  this.finished = false;\n\n  // should we decode strings into buffers before passing to _write?\n  // this is here so that some node-core streams can optimize string\n  // handling at a lower level.\n  var noDecode = options.decodeStrings === false;\n  this.decodeStrings = !noDecode;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // not an actual buffer we keep track of, but a measurement\n  // of how much we're waiting to get pushed to some underlying\n  // socket or file.\n  this.length = 0;\n\n  // a flag to see when we're in the middle of a write.\n  this.writing = false;\n\n  // a flag to be able to tell if the onwrite cb is called immediately,\n  // or on a later tick.  We set this to true at first, becuase any\n  // actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first write call.\n  this.sync = true;\n\n  // a flag to know if we're processing previously buffered items, which\n  // may call the _write() callback in the same tick, so that we don't\n  // end up in an overlapped onwrite situation.\n  this.bufferProcessing = false;\n\n  // the callback that's passed to _write(chunk,cb)\n  this.onwrite = function(er) {\n    onwrite(stream, er);\n  };\n\n  // the callback that the user supplies to write(chunk,encoding,cb)\n  this.writecb = null;\n\n  // the amount that is being written when _write is called.\n  this.writelen = 0;\n\n  this.buffer = [];\n\n  // True if the error was already emitted and should not be thrown again\n  this.errorEmitted = false;\n}\n\nfunction Writable(options) {\n  var Duplex = require('./_stream_duplex');\n\n  // Writable ctor is applied to Duplexes, though they're not\n  // instanceof Writable, they're instanceof Readable.\n  if (!(this instanceof Writable) && !(this instanceof Duplex))\n    return new Writable(options);\n\n  this._writableState = new WritableState(options, this);\n\n  // legacy.\n  this.writable = true;\n\n  Stream.call(this);\n}\n\n// Otherwise people can pipe Writable streams, which is just wrong.\nWritable.prototype.pipe = function() {\n  this.emit('error', new Error('Cannot pipe. Not readable.'));\n};\n\n\nfunction writeAfterEnd(stream, state, cb) {\n  var er = new Error('write after end');\n  // TODO: defer error events consistently everywhere, not just the cb\n  stream.emit('error', er);\n  process.nextTick(function() {\n    cb(er);\n  });\n}\n\n// If we get something that is not a buffer, string, null, or undefined,\n// and we're not in objectMode, then that's an error.\n// Otherwise stream chunks are all considered to be of length=1, and the\n// watermarks determine how many objects to keep in the buffer, rather than\n// how many bytes or characters.\nfunction validChunk(stream, state, chunk, cb) {\n  var valid = true;\n  if (!Buffer.isBuffer(chunk) &&\n      'string' !== typeof chunk &&\n      chunk !== null &&\n      chunk !== undefined &&\n      !state.objectMode) {\n    var er = new TypeError('Invalid non-string/buffer chunk');\n    stream.emit('error', er);\n    process.nextTick(function() {\n      cb(er);\n    });\n    valid = false;\n  }\n  return valid;\n}\n\nWritable.prototype.write = function(chunk, encoding, cb) {\n  var state = this._writableState;\n  var ret = false;\n\n  if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n\n  if (Buffer.isBuffer(chunk))\n    encoding = 'buffer';\n  else if (!encoding)\n    encoding = state.defaultEncoding;\n\n  if (typeof cb !== 'function')\n    cb = function() {};\n\n  if (state.ended)\n    writeAfterEnd(this, state, cb);\n  else if (validChunk(this, state, chunk, cb))\n    ret = writeOrBuffer(this, state, chunk, encoding, cb);\n\n  return ret;\n};\n\nfunction decodeChunk(state, chunk, encoding) {\n  if (!state.objectMode &&\n      state.decodeStrings !== false &&\n      typeof chunk === 'string') {\n    chunk = new Buffer(chunk, encoding);\n  }\n  return chunk;\n}\n\n// if we're already writing something, then just put this\n// in the queue, and wait our turn.  Otherwise, call _write\n// If we return false, then we need a drain event, so set that flag.\nfunction writeOrBuffer(stream, state, chunk, encoding, cb) {\n  chunk = decodeChunk(state, chunk, encoding);\n  if (Buffer.isBuffer(chunk))\n    encoding = 'buffer';\n  var len = state.objectMode ? 1 : chunk.length;\n\n  state.length += len;\n\n  var ret = state.length < state.highWaterMark;\n  // we must ensure that previous needDrain will not be reset to false.\n  if (!ret)\n    state.needDrain = true;\n\n  if (state.writing)\n    state.buffer.push(new WriteReq(chunk, encoding, cb));\n  else\n    doWrite(stream, state, len, chunk, encoding, cb);\n\n  return ret;\n}\n\nfunction doWrite(stream, state, len, chunk, encoding, cb) {\n  state.writelen = len;\n  state.writecb = cb;\n  state.writing = true;\n  state.sync = true;\n  stream._write(chunk, encoding, state.onwrite);\n  state.sync = false;\n}\n\nfunction onwriteError(stream, state, sync, er, cb) {\n  if (sync)\n    process.nextTick(function() {\n      cb(er);\n    });\n  else\n    cb(er);\n\n  stream._writableState.errorEmitted = true;\n  stream.emit('error', er);\n}\n\nfunction onwriteStateUpdate(state) {\n  state.writing = false;\n  state.writecb = null;\n  state.length -= state.writelen;\n  state.writelen = 0;\n}\n\nfunction onwrite(stream, er) {\n  var state = stream._writableState;\n  var sync = state.sync;\n  var cb = state.writecb;\n\n  onwriteStateUpdate(state);\n\n  if (er)\n    onwriteError(stream, state, sync, er, cb);\n  else {\n    // Check if we're actually ready to finish, but don't emit yet\n    var finished = needFinish(stream, state);\n\n    if (!finished && !state.bufferProcessing && state.buffer.length)\n      clearBuffer(stream, state);\n\n    if (sync) {\n      process.nextTick(function() {\n        afterWrite(stream, state, finished, cb);\n      });\n    } else {\n      afterWrite(stream, state, finished, cb);\n    }\n  }\n}\n\nfunction afterWrite(stream, state, finished, cb) {\n  if (!finished)\n    onwriteDrain(stream, state);\n  cb();\n  if (finished)\n    finishMaybe(stream, state);\n}\n\n// Must force callback to be called on nextTick, so that we don't\n// emit 'drain' before the write() consumer gets the 'false' return\n// value, and has a chance to attach a 'drain' listener.\nfunction onwriteDrain(stream, state) {\n  if (state.length === 0 && state.needDrain) {\n    state.needDrain = false;\n    stream.emit('drain');\n  }\n}\n\n\n// if there's something in the buffer waiting, then process it\nfunction clearBuffer(stream, state) {\n  state.bufferProcessing = true;\n\n  for (var c = 0; c < state.buffer.length; c++) {\n    var entry = state.buffer[c];\n    var chunk = entry.chunk;\n    var encoding = entry.encoding;\n    var cb = entry.callback;\n    var len = state.objectMode ? 1 : chunk.length;\n\n    doWrite(stream, state, len, chunk, encoding, cb);\n\n    // if we didn't call the onwrite immediately, then\n    // it means that we need to wait until it does.\n    // also, that means that the chunk and cb are currently\n    // being processed, so move the buffer counter past them.\n    if (state.writing) {\n      c++;\n      break;\n    }\n  }\n\n  state.bufferProcessing = false;\n  if (c < state.buffer.length)\n    state.buffer = state.buffer.slice(c);\n  else\n    state.buffer.length = 0;\n}\n\nWritable.prototype._write = function(chunk, encoding, cb) {\n  cb(new Error('not implemented'));\n};\n\nWritable.prototype.end = function(chunk, encoding, cb) {\n  var state = this._writableState;\n\n  if (typeof chunk === 'function') {\n    cb = chunk;\n    chunk = null;\n    encoding = null;\n  } else if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n\n  if (typeof chunk !== 'undefined' && chunk !== null)\n    this.write(chunk, encoding);\n\n  // ignore unnecessary end() calls.\n  if (!state.ending && !state.finished)\n    endWritable(this, state, cb);\n};\n\n\nfunction needFinish(stream, state) {\n  return (state.ending &&\n          state.length === 0 &&\n          !state.finished &&\n          !state.writing);\n}\n\nfunction finishMaybe(stream, state) {\n  var need = needFinish(stream, state);\n  if (need) {\n    state.finished = true;\n    stream.emit('finish');\n  }\n  return need;\n}\n\nfunction endWritable(stream, state, cb) {\n  state.ending = true;\n  finishMaybe(stream, state);\n  if (cb) {\n    if (state.finished)\n      process.nextTick(cb);\n    else\n      stream.once('finish', cb);\n  }\n  state.ended = true;\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a duplex stream is just a stream that is both readable and writable.\n// Since JS doesn't have multiple prototypal inheritance, this class\n// prototypally inherits from Readable, and then parasitically from\n// Writable.\n\nmodule.exports = Duplex;\n\n/*<replacement>*/\nvar objectKeys = Object.keys || function (obj) {\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  return keys;\n}\n/*</replacement>*/\n\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nvar Readable = require('./_stream_readable');\nvar Writable = require('./_stream_writable');\n\nutil.inherits(Duplex, Readable);\n\nforEach(objectKeys(Writable.prototype), function(method) {\n  if (!Duplex.prototype[method])\n    Duplex.prototype[method] = Writable.prototype[method];\n});\n\nfunction Duplex(options) {\n  if (!(this instanceof Duplex))\n    return new Duplex(options);\n\n  Readable.call(this, options);\n  Writable.call(this, options);\n\n  if (options && options.readable === false)\n    this.readable = false;\n\n  if (options && options.writable === false)\n    this.writable = false;\n\n  this.allowHalfOpen = true;\n  if (options && options.allowHalfOpen === false)\n    this.allowHalfOpen = false;\n\n  this.once('end', onend);\n}\n\n// the no-half-open enforcer\nfunction onend() {\n  // if we allow half-open state, or if the writable side ended,\n  // then we're ok.\n  if (this.allowHalfOpen || this._writableState.ended)\n    return;\n\n  // no more data can be written.\n  // But allow more writes to happen in this tick.\n  process.nextTick(this.end.bind(this));\n}\n\nfunction forEach (xs, f) {\n  for (var i = 0, l = xs.length; i < l; i++) {\n    f(xs[i], i);\n  }\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n\n// a transform stream is a readable/writable stream where you do\n// something with the data.  Sometimes it's called a \"filter\",\n// but that's not a great name for it, since that implies a thing where\n// some bits pass through, and others are simply ignored.  (That would\n// be a valid example of a transform, of course.)\n//\n// While the output is causally related to the input, it's not a\n// necessarily symmetric or synchronous transformation.  For example,\n// a zlib stream might take multiple plain-text writes(), and then\n// emit a single compressed chunk some time in the future.\n//\n// Here's how this works:\n//\n// The Transform stream has all the aspects of the readable and writable\n// stream classes.  When you write(chunk), that calls _write(chunk,cb)\n// internally, and returns false if there's a lot of pending writes\n// buffered up.  When you call read(), that calls _read(n) until\n// there's enough pending readable data buffered up.\n//\n// In a transform stream, the written data is placed in a buffer.  When\n// _read(n) is called, it transforms the queued up data, calling the\n// buffered _write cb's as it consumes chunks.  If consuming a single\n// written chunk would result in multiple output chunks, then the first\n// outputted bit calls the readcb, and subsequent chunks just go into\n// the read buffer, and will cause it to emit 'readable' if necessary.\n//\n// This way, back-pressure is actually determined by the reading side,\n// since _read has to be called to start processing a new chunk.  However,\n// a pathological inflate type of transform can cause excessive buffering\n// here.  For example, imagine a stream where every byte of input is\n// interpreted as an integer from 0-255, and then results in that many\n// bytes of output.  Writing the 4 bytes {ff,ff,ff,ff} would result in\n// 1kb of data being output.  In this case, you could write a very small\n// amount of input, and end up with a very large amount of output.  In\n// such a pathological inflating mechanism, there'd be no way to tell\n// the system to stop doing the transform.  A single 4MB write could\n// cause the system to run out of memory.\n//\n// However, even in such a pathological case, only a single written chunk\n// would be consumed, and then the rest would wait (un-transformed) until\n// the results of the previous transformed chunk were consumed.\n\nmodule.exports = Transform;\n\nvar Duplex = require('./_stream_duplex');\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nutil.inherits(Transform, Duplex);\n\n\nfunction TransformState(options, stream) {\n  this.afterTransform = function(er, data) {\n    return afterTransform(stream, er, data);\n  };\n\n  this.needTransform = false;\n  this.transforming = false;\n  this.writecb = null;\n  this.writechunk = null;\n}\n\nfunction afterTransform(stream, er, data) {\n  var ts = stream._transformState;\n  ts.transforming = false;\n\n  var cb = ts.writecb;\n\n  if (!cb)\n    return stream.emit('error', new Error('no writecb in Transform class'));\n\n  ts.writechunk = null;\n  ts.writecb = null;\n\n  if (data !== null && data !== undefined)\n    stream.push(data);\n\n  if (cb)\n    cb(er);\n\n  var rs = stream._readableState;\n  rs.reading = false;\n  if (rs.needReadable || rs.length < rs.highWaterMark) {\n    stream._read(rs.highWaterMark);\n  }\n}\n\n\nfunction Transform(options) {\n  if (!(this instanceof Transform))\n    return new Transform(options);\n\n  Duplex.call(this, options);\n\n  var ts = this._transformState = new TransformState(options, this);\n\n  // when the writable side finishes, then flush out anything remaining.\n  var stream = this;\n\n  // start out asking for a readable event once data is transformed.\n  this._readableState.needReadable = true;\n\n  // we have implemented the _read method, and done the other things\n  // that Readable wants before the first _read call, so unset the\n  // sync guard flag.\n  this._readableState.sync = false;\n\n  this.once('finish', function() {\n    if ('function' === typeof this._flush)\n      this._flush(function(er) {\n        done(stream, er);\n      });\n    else\n      done(stream);\n  });\n}\n\nTransform.prototype.push = function(chunk, encoding) {\n  this._transformState.needTransform = false;\n  return Duplex.prototype.push.call(this, chunk, encoding);\n};\n\n// This is the part where you do stuff!\n// override this function in implementation classes.\n// 'chunk' is an input chunk.\n//\n// Call `push(newChunk)` to pass along transformed output\n// to the readable side.  You may call 'push' zero or more times.\n//\n// Call `cb(err)` when you are done with this chunk.  If you pass\n// an error, then that'll put the hurt on the whole operation.  If you\n// never call cb(), then you'll never get another chunk.\nTransform.prototype._transform = function(chunk, encoding, cb) {\n  throw new Error('not implemented');\n};\n\nTransform.prototype._write = function(chunk, encoding, cb) {\n  var ts = this._transformState;\n  ts.writecb = cb;\n  ts.writechunk = chunk;\n  ts.writeencoding = encoding;\n  if (!ts.transforming) {\n    var rs = this._readableState;\n    if (ts.needTransform ||\n        rs.needReadable ||\n        rs.length < rs.highWaterMark)\n      this._read(rs.highWaterMark);\n  }\n};\n\n// Doesn't matter what the args are here.\n// _transform does all the work.\n// That we got here means that the readable side wants more data.\nTransform.prototype._read = function(n) {\n  var ts = this._transformState;\n\n  if (ts.writechunk !== null && ts.writecb && !ts.transforming) {\n    ts.transforming = true;\n    this._transform(ts.writechunk, ts.writeencoding, ts.afterTransform);\n  } else {\n    // mark that we need a transform, so that any data that comes in\n    // will get processed, now that we've asked for it.\n    ts.needTransform = true;\n  }\n};\n\n\nfunction done(stream, er) {\n  if (er)\n    return stream.emit('error', er);\n\n  // if there's nothing in the write buffer, then that means\n  // that nothing more will ever be provided\n  var ws = stream._writableState;\n  var rs = stream._readableState;\n  var ts = stream._transformState;\n\n  if (ws.length)\n    throw new Error('calling transform done when ws.length != 0');\n\n  if (ts.transforming)\n    throw new Error('calling transform done when still transforming');\n\n  return stream.push(null);\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a passthrough stream.\n// basically just the most minimal sort of Transform stream.\n// Every written chunk gets output as-is.\n\nmodule.exports = PassThrough;\n\nvar Transform = require('./_stream_transform');\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nutil.inherits(PassThrough, Transform);\n\nfunction PassThrough(options) {\n  if (!(this instanceof PassThrough))\n    return new PassThrough(options);\n\n  Transform.call(this, options);\n}\n\nPassThrough.prototype._transform = function(chunk, encoding, cb) {\n  cb(null, chunk);\n};\n","// vim:ts=4:sts=4:sw=4:\n/*!\n *\n * Copyright 2009-2012 Kris Kowal under the terms of the MIT\n * license found at http://github.com/kriskowal/q/raw/master/LICENSE\n *\n * With parts by Tyler Close\n * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found\n * at http://www.opensource.org/licenses/mit-license.html\n * Forked at ref_send.js version: 2009-05-11\n *\n * With parts by Mark Miller\n * Copyright (C) 2011 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n(function (definition) {\n    // Turn off strict mode for this function so we can assign to global.Q\n    /* jshint strict: false */\n\n    // This file will function properly as a <script> tag, or a module\n    // using CommonJS and NodeJS or RequireJS module formats.  In\n    // Common/Node/RequireJS, the module exports the Q API and when\n    // executed as a simple <script>, it creates a Q global instead.\n\n    // Montage Require\n    if (typeof bootstrap === \"function\") {\n        bootstrap(\"promise\", definition);\n\n    // CommonJS\n    } else if (typeof exports === \"object\") {\n        module.exports = definition();\n\n    // RequireJS\n    } else if (typeof define === \"function\" && define.amd) {\n        define(definition);\n\n    // SES (Secure EcmaScript)\n    } else if (typeof ses !== \"undefined\") {\n        if (!ses.ok()) {\n            return;\n        } else {\n            ses.makeQ = definition;\n        }\n\n    // <script>\n    } else {\n        Q = definition();\n    }\n\n})(function () {\n\"use strict\";\n\nvar hasStacks = false;\ntry {\n    throw new Error();\n} catch (e) {\n    hasStacks = !!e.stack;\n}\n\n// All code after this point will be filtered from stack traces reported\n// by Q.\nvar qStartingLine = captureLine();\nvar qFileName;\n\n// shims\n\n// used for fallback in \"allResolved\"\nvar noop = function () {};\n\n// Use the fastest possible means to execute a task in a future turn\n// of the event loop.\nvar nextTick =(function () {\n    // linked list of tasks (single, with head node)\n    var head = {task: void 0, next: null};\n    var tail = head;\n    var flushing = false;\n    var requestTick = void 0;\n    var isNodeJS = false;\n\n    function flush() {\n        /* jshint loopfunc: true */\n\n        while (head.next) {\n            head = head.next;\n            var task = head.task;\n            head.task = void 0;\n            var domain = head.domain;\n\n            if (domain) {\n                head.domain = void 0;\n                domain.enter();\n            }\n\n            try {\n                task();\n\n            } catch (e) {\n                if (isNodeJS) {\n                    // In node, uncaught exceptions are considered fatal errors.\n                    // Re-throw them synchronously to interrupt flushing!\n\n                    // Ensure continuation if the uncaught exception is suppressed\n                    // listening \"uncaughtException\" events (as domains does).\n                    // Continue in next event to avoid tick recursion.\n                    if (domain) {\n                        domain.exit();\n                    }\n                    setTimeout(flush, 0);\n                    if (domain) {\n                        domain.enter();\n                    }\n\n                    throw e;\n\n                } else {\n                    // In browsers, uncaught exceptions are not fatal.\n                    // Re-throw them asynchronously to avoid slow-downs.\n                    setTimeout(function() {\n                       throw e;\n                    }, 0);\n                }\n            }\n\n            if (domain) {\n                domain.exit();\n            }\n        }\n\n        flushing = false;\n    }\n\n    nextTick = function (task) {\n        tail = tail.next = {\n            task: task,\n            domain: isNodeJS && process.domain,\n            next: null\n        };\n\n        if (!flushing) {\n            flushing = true;\n            requestTick();\n        }\n    };\n\n    if (typeof process !== \"undefined\" && process.nextTick) {\n        // Node.js before 0.9. Note that some fake-Node environments, like the\n        // Mocha test runner, introduce a `process` global without a `nextTick`.\n        isNodeJS = true;\n\n        requestTick = function () {\n            process.nextTick(flush);\n        };\n\n    } else if (typeof setImmediate === \"function\") {\n        // In IE10, Node.js 0.9+, or https://github.com/NobleJS/setImmediate\n        if (typeof window !== \"undefined\") {\n            requestTick = setImmediate.bind(window, flush);\n        } else {\n            requestTick = function () {\n                setImmediate(flush);\n            };\n        }\n\n    } else if (typeof MessageChannel !== \"undefined\") {\n        // modern browsers\n        // http://www.nonblocking.io/2011/06/windownexttick.html\n        var channel = new MessageChannel();\n        // At least Safari Version 6.0.5 (8536.30.1) intermittently cannot create\n        // working message ports the first time a page loads.\n        channel.port1.onmessage = function () {\n            requestTick = requestPortTick;\n            channel.port1.onmessage = flush;\n            flush();\n        };\n        var requestPortTick = function () {\n            // Opera requires us to provide a message payload, regardless of\n            // whether we use it.\n            channel.port2.postMessage(0);\n        };\n        requestTick = function () {\n            setTimeout(flush, 0);\n            requestPortTick();\n        };\n\n    } else {\n        // old browsers\n        requestTick = function () {\n            setTimeout(flush, 0);\n        };\n    }\n\n    return nextTick;\n})();\n\n// Attempt to make generics safe in the face of downstream\n// modifications.\n// There is no situation where this is necessary.\n// If you need a security guarantee, these primordials need to be\n// deeply frozen anyway, and if you don’t need a security guarantee,\n// this is just plain paranoid.\n// However, this **might** have the nice side-effect of reducing the size of\n// the minified code by reducing x.call() to merely x()\n// See Mark Miller’s explanation of what this does.\n// http://wiki.ecmascript.org/doku.php?id=conventions:safe_meta_programming\nvar call = Function.call;\nfunction uncurryThis(f) {\n    return function () {\n        return call.apply(f, arguments);\n    };\n}\n// This is equivalent, but slower:\n// uncurryThis = Function_bind.bind(Function_bind.call);\n// http://jsperf.com/uncurrythis\n\nvar array_slice = uncurryThis(Array.prototype.slice);\n\nvar array_reduce = uncurryThis(\n    Array.prototype.reduce || function (callback, basis) {\n        var index = 0,\n            length = this.length;\n        // concerning the initial value, if one is not provided\n        if (arguments.length === 1) {\n            // seek to the first value in the array, accounting\n            // for the possibility that is is a sparse array\n            do {\n                if (index in this) {\n                    basis = this[index++];\n                    break;\n                }\n                if (++index >= length) {\n                    throw new TypeError();\n                }\n            } while (1);\n        }\n        // reduce\n        for (; index < length; index++) {\n            // account for the possibility that the array is sparse\n            if (index in this) {\n                basis = callback(basis, this[index], index);\n            }\n        }\n        return basis;\n    }\n);\n\nvar array_indexOf = uncurryThis(\n    Array.prototype.indexOf || function (value) {\n        // not a very good shim, but good enough for our one use of it\n        for (var i = 0; i < this.length; i++) {\n            if (this[i] === value) {\n                return i;\n            }\n        }\n        return -1;\n    }\n);\n\nvar array_map = uncurryThis(\n    Array.prototype.map || function (callback, thisp) {\n        var self = this;\n        var collect = [];\n        array_reduce(self, function (undefined, value, index) {\n            collect.push(callback.call(thisp, value, index, self));\n        }, void 0);\n        return collect;\n    }\n);\n\nvar object_create = Object.create || function (prototype) {\n    function Type() { }\n    Type.prototype = prototype;\n    return new Type();\n};\n\nvar object_hasOwnProperty = uncurryThis(Object.prototype.hasOwnProperty);\n\nvar object_keys = Object.keys || function (object) {\n    var keys = [];\n    for (var key in object) {\n        if (object_hasOwnProperty(object, key)) {\n            keys.push(key);\n        }\n    }\n    return keys;\n};\n\nvar object_toString = uncurryThis(Object.prototype.toString);\n\nfunction isObject(value) {\n    return value === Object(value);\n}\n\n// generator related shims\n\n// FIXME: Remove this function once ES6 generators are in SpiderMonkey.\nfunction isStopIteration(exception) {\n    return (\n        object_toString(exception) === \"[object StopIteration]\" ||\n        exception instanceof QReturnValue\n    );\n}\n\n// FIXME: Remove this helper and Q.return once ES6 generators are in\n// SpiderMonkey.\nvar QReturnValue;\nif (typeof ReturnValue !== \"undefined\") {\n    QReturnValue = ReturnValue;\n} else {\n    QReturnValue = function (value) {\n        this.value = value;\n    };\n}\n\n// long stack traces\n\nvar STACK_JUMP_SEPARATOR = \"From previous event:\";\n\nfunction makeStackTraceLong(error, promise) {\n    // If possible, transform the error stack trace by removing Node and Q\n    // cruft, then concatenating with the stack trace of `promise`. See #57.\n    if (hasStacks &&\n        promise.stack &&\n        typeof error === \"object\" &&\n        error !== null &&\n        error.stack &&\n        error.stack.indexOf(STACK_JUMP_SEPARATOR) === -1\n    ) {\n        var stacks = [];\n        for (var p = promise; !!p; p = p.source) {\n            if (p.stack) {\n                stacks.unshift(p.stack);\n            }\n        }\n        stacks.unshift(error.stack);\n\n        var concatedStacks = stacks.join(\"\\n\" + STACK_JUMP_SEPARATOR + \"\\n\");\n        error.stack = filterStackString(concatedStacks);\n    }\n}\n\nfunction filterStackString(stackString) {\n    var lines = stackString.split(\"\\n\");\n    var desiredLines = [];\n    for (var i = 0; i < lines.length; ++i) {\n        var line = lines[i];\n\n        if (!isInternalFrame(line) && !isNodeFrame(line) && line) {\n            desiredLines.push(line);\n        }\n    }\n    return desiredLines.join(\"\\n\");\n}\n\nfunction isNodeFrame(stackLine) {\n    return stackLine.indexOf(\"(module.js:\") !== -1 ||\n           stackLine.indexOf(\"(node.js:\") !== -1;\n}\n\nfunction getFileNameAndLineNumber(stackLine) {\n    // Named functions: \"at functionName (filename:lineNumber:columnNumber)\"\n    // In IE10 function name can have spaces (\"Anonymous function\") O_o\n    var attempt1 = /at .+ \\((.+):(\\d+):(?:\\d+)\\)$/.exec(stackLine);\n    if (attempt1) {\n        return [attempt1[1], Number(attempt1[2])];\n    }\n\n    // Anonymous functions: \"at filename:lineNumber:columnNumber\"\n    var attempt2 = /at ([^ ]+):(\\d+):(?:\\d+)$/.exec(stackLine);\n    if (attempt2) {\n        return [attempt2[1], Number(attempt2[2])];\n    }\n\n    // Firefox style: \"function@filename:lineNumber or @filename:lineNumber\"\n    var attempt3 = /.*@(.+):(\\d+)$/.exec(stackLine);\n    if (attempt3) {\n        return [attempt3[1], Number(attempt3[2])];\n    }\n}\n\nfunction isInternalFrame(stackLine) {\n    var fileNameAndLineNumber = getFileNameAndLineNumber(stackLine);\n\n    if (!fileNameAndLineNumber) {\n        return false;\n    }\n\n    var fileName = fileNameAndLineNumber[0];\n    var lineNumber = fileNameAndLineNumber[1];\n\n    return fileName === qFileName &&\n        lineNumber >= qStartingLine &&\n        lineNumber <= qEndingLine;\n}\n\n// discover own file name and line number range for filtering stack\n// traces\nfunction captureLine() {\n    if (!hasStacks) {\n        return;\n    }\n\n    try {\n        throw new Error();\n    } catch (e) {\n        var lines = e.stack.split(\"\\n\");\n        var firstLine = lines[0].indexOf(\"@\") > 0 ? lines[1] : lines[2];\n        var fileNameAndLineNumber = getFileNameAndLineNumber(firstLine);\n        if (!fileNameAndLineNumber) {\n            return;\n        }\n\n        qFileName = fileNameAndLineNumber[0];\n        return fileNameAndLineNumber[1];\n    }\n}\n\nfunction deprecate(callback, name, alternative) {\n    return function () {\n        if (typeof console !== \"undefined\" &&\n            typeof console.warn === \"function\") {\n            console.warn(name + \" is deprecated, use \" + alternative +\n                         \" instead.\", new Error(\"\").stack);\n        }\n        return callback.apply(callback, arguments);\n    };\n}\n\n// end of shims\n// beginning of real work\n\n/**\n * Constructs a promise for an immediate reference, passes promises through, or\n * coerces promises from different systems.\n * @param value immediate reference or promise\n */\nfunction Q(value) {\n    // If the object is already a Promise, return it directly.  This enables\n    // the resolve function to both be used to created references from objects,\n    // but to tolerably coerce non-promises to promises.\n    if (isPromise(value)) {\n        return value;\n    }\n\n    // assimilate thenables\n    if (isPromiseAlike(value)) {\n        return coerce(value);\n    } else {\n        return fulfill(value);\n    }\n}\nQ.resolve = Q;\n\n/**\n * Performs a task in a future turn of the event loop.\n * @param {Function} task\n */\nQ.nextTick = nextTick;\n\n/**\n * Controls whether or not long stack traces will be on\n */\nQ.longStackSupport = false;\n\n/**\n * Constructs a {promise, resolve, reject} object.\n *\n * `resolve` is a callback to invoke with a more resolved value for the\n * promise. To fulfill the promise, invoke `resolve` with any value that is\n * not a thenable. To reject the promise, invoke `resolve` with a rejected\n * thenable, or invoke `reject` with the reason directly. To resolve the\n * promise to another thenable, thus putting it in the same state, invoke\n * `resolve` with that other thenable.\n */\nQ.defer = defer;\nfunction defer() {\n    // if \"messages\" is an \"Array\", that indicates that the promise has not yet\n    // been resolved.  If it is \"undefined\", it has been resolved.  Each\n    // element of the messages array is itself an array of complete arguments to\n    // forward to the resolved promise.  We coerce the resolution value to a\n    // promise using the `resolve` function because it handles both fully\n    // non-thenable values and other thenables gracefully.\n    var messages = [], progressListeners = [], resolvedPromise;\n\n    var deferred = object_create(defer.prototype);\n    var promise = object_create(Promise.prototype);\n\n    promise.promiseDispatch = function (resolve, op, operands) {\n        var args = array_slice(arguments);\n        if (messages) {\n            messages.push(args);\n            if (op === \"when\" && operands[1]) { // progress operand\n                progressListeners.push(operands[1]);\n            }\n        } else {\n            nextTick(function () {\n                resolvedPromise.promiseDispatch.apply(resolvedPromise, args);\n            });\n        }\n    };\n\n    // XXX deprecated\n    promise.valueOf = function () {\n        if (messages) {\n            return promise;\n        }\n        var nearerValue = nearer(resolvedPromise);\n        if (isPromise(nearerValue)) {\n            resolvedPromise = nearerValue; // shorten chain\n        }\n        return nearerValue;\n    };\n\n    promise.inspect = function () {\n        if (!resolvedPromise) {\n            return { state: \"pending\" };\n        }\n        return resolvedPromise.inspect();\n    };\n\n    if (Q.longStackSupport && hasStacks) {\n        try {\n            throw new Error();\n        } catch (e) {\n            // NOTE: don't try to use `Error.captureStackTrace` or transfer the\n            // accessor around; that causes memory leaks as per GH-111. Just\n            // reify the stack trace as a string ASAP.\n            //\n            // At the same time, cut off the first line; it's always just\n            // \"[object Promise]\\n\", as per the `toString`.\n            promise.stack = e.stack.substring(e.stack.indexOf(\"\\n\") + 1);\n        }\n    }\n\n    // NOTE: we do the checks for `resolvedPromise` in each method, instead of\n    // consolidating them into `become`, since otherwise we'd create new\n    // promises with the lines `become(whatever(value))`. See e.g. GH-252.\n\n    function become(newPromise) {\n        resolvedPromise = newPromise;\n        promise.source = newPromise;\n\n        array_reduce(messages, function (undefined, message) {\n            nextTick(function () {\n                newPromise.promiseDispatch.apply(newPromise, message);\n            });\n        }, void 0);\n\n        messages = void 0;\n        progressListeners = void 0;\n    }\n\n    deferred.promise = promise;\n    deferred.resolve = function (value) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        become(Q(value));\n    };\n\n    deferred.fulfill = function (value) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        become(fulfill(value));\n    };\n    deferred.reject = function (reason) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        become(reject(reason));\n    };\n    deferred.notify = function (progress) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        array_reduce(progressListeners, function (undefined, progressListener) {\n            nextTick(function () {\n                progressListener(progress);\n            });\n        }, void 0);\n    };\n\n    return deferred;\n}\n\n/**\n * Creates a Node-style callback that will resolve or reject the deferred\n * promise.\n * @returns a nodeback\n */\ndefer.prototype.makeNodeResolver = function () {\n    var self = this;\n    return function (error, value) {\n        if (error) {\n            self.reject(error);\n        } else if (arguments.length > 2) {\n            self.resolve(array_slice(arguments, 1));\n        } else {\n            self.resolve(value);\n        }\n    };\n};\n\n/**\n * @param resolver {Function} a function that returns nothing and accepts\n * the resolve, reject, and notify functions for a deferred.\n * @returns a promise that may be resolved with the given resolve and reject\n * functions, or rejected by a thrown exception in resolver\n */\nQ.Promise = promise; // ES6\nQ.promise = promise;\nfunction promise(resolver) {\n    if (typeof resolver !== \"function\") {\n        throw new TypeError(\"resolver must be a function.\");\n    }\n    var deferred = defer();\n    try {\n        resolver(deferred.resolve, deferred.reject, deferred.notify);\n    } catch (reason) {\n        deferred.reject(reason);\n    }\n    return deferred.promise;\n}\n\npromise.race = race; // ES6\npromise.all = all; // ES6\npromise.reject = reject; // ES6\npromise.resolve = Q; // ES6\n\n// XXX experimental.  This method is a way to denote that a local value is\n// serializable and should be immediately dispatched to a remote upon request,\n// instead of passing a reference.\nQ.passByCopy = function (object) {\n    //freeze(object);\n    //passByCopies.set(object, true);\n    return object;\n};\n\nPromise.prototype.passByCopy = function () {\n    //freeze(object);\n    //passByCopies.set(object, true);\n    return this;\n};\n\n/**\n * If two promises eventually fulfill to the same value, promises that value,\n * but otherwise rejects.\n * @param x {Any*}\n * @param y {Any*}\n * @returns {Any*} a promise for x and y if they are the same, but a rejection\n * otherwise.\n *\n */\nQ.join = function (x, y) {\n    return Q(x).join(y);\n};\n\nPromise.prototype.join = function (that) {\n    return Q([this, that]).spread(function (x, y) {\n        if (x === y) {\n            // TODO: \"===\" should be Object.is or equiv\n            return x;\n        } else {\n            throw new Error(\"Can't join: not the same: \" + x + \" \" + y);\n        }\n    });\n};\n\n/**\n * Returns a promise for the first of an array of promises to become fulfilled.\n * @param answers {Array[Any*]} promises to race\n * @returns {Any*} the first promise to be fulfilled\n */\nQ.race = race;\nfunction race(answerPs) {\n    return promise(function(resolve, reject) {\n        // Switch to this once we can assume at least ES5\n        // answerPs.forEach(function(answerP) {\n        //     Q(answerP).then(resolve, reject);\n        // });\n        // Use this in the meantime\n        for (var i = 0, len = answerPs.length; i < len; i++) {\n            Q(answerPs[i]).then(resolve, reject);\n        }\n    });\n}\n\nPromise.prototype.race = function () {\n    return this.then(Q.race);\n};\n\n/**\n * Constructs a Promise with a promise descriptor object and optional fallback\n * function.  The descriptor contains methods like when(rejected), get(name),\n * set(name, value), post(name, args), and delete(name), which all\n * return either a value, a promise for a value, or a rejection.  The fallback\n * accepts the operation name, a resolver, and any further arguments that would\n * have been forwarded to the appropriate method above had a method been\n * provided with the proper name.  The API makes no guarantees about the nature\n * of the returned object, apart from that it is usable whereever promises are\n * bought and sold.\n */\nQ.makePromise = Promise;\nfunction Promise(descriptor, fallback, inspect) {\n    if (fallback === void 0) {\n        fallback = function (op) {\n            return reject(new Error(\n                \"Promise does not support operation: \" + op\n            ));\n        };\n    }\n    if (inspect === void 0) {\n        inspect = function () {\n            return {state: \"unknown\"};\n        };\n    }\n\n    var promise = object_create(Promise.prototype);\n\n    promise.promiseDispatch = function (resolve, op, args) {\n        var result;\n        try {\n            if (descriptor[op]) {\n                result = descriptor[op].apply(promise, args);\n            } else {\n                result = fallback.call(promise, op, args);\n            }\n        } catch (exception) {\n            result = reject(exception);\n        }\n        if (resolve) {\n            resolve(result);\n        }\n    };\n\n    promise.inspect = inspect;\n\n    // XXX deprecated `valueOf` and `exception` support\n    if (inspect) {\n        var inspected = inspect();\n        if (inspected.state === \"rejected\") {\n            promise.exception = inspected.reason;\n        }\n\n        promise.valueOf = function () {\n            var inspected = inspect();\n            if (inspected.state === \"pending\" ||\n                inspected.state === \"rejected\") {\n                return promise;\n            }\n            return inspected.value;\n        };\n    }\n\n    return promise;\n}\n\nPromise.prototype.toString = function () {\n    return \"[object Promise]\";\n};\n\nPromise.prototype.then = function (fulfilled, rejected, progressed) {\n    var self = this;\n    var deferred = defer();\n    var done = false;   // ensure the untrusted promise makes at most a\n                        // single call to one of the callbacks\n\n    function _fulfilled(value) {\n        try {\n            return typeof fulfilled === \"function\" ? fulfilled(value) : value;\n        } catch (exception) {\n            return reject(exception);\n        }\n    }\n\n    function _rejected(exception) {\n        if (typeof rejected === \"function\") {\n            makeStackTraceLong(exception, self);\n            try {\n                return rejected(exception);\n            } catch (newException) {\n                return reject(newException);\n            }\n        }\n        return reject(exception);\n    }\n\n    function _progressed(value) {\n        return typeof progressed === \"function\" ? progressed(value) : value;\n    }\n\n    nextTick(function () {\n        self.promiseDispatch(function (value) {\n            if (done) {\n                return;\n            }\n            done = true;\n\n            deferred.resolve(_fulfilled(value));\n        }, \"when\", [function (exception) {\n            if (done) {\n                return;\n            }\n            done = true;\n\n            deferred.resolve(_rejected(exception));\n        }]);\n    });\n\n    // Progress propagator need to be attached in the current tick.\n    self.promiseDispatch(void 0, \"when\", [void 0, function (value) {\n        var newValue;\n        var threw = false;\n        try {\n            newValue = _progressed(value);\n        } catch (e) {\n            threw = true;\n            if (Q.onerror) {\n                Q.onerror(e);\n            } else {\n                throw e;\n            }\n        }\n\n        if (!threw) {\n            deferred.notify(newValue);\n        }\n    }]);\n\n    return deferred.promise;\n};\n\n/**\n * Registers an observer on a promise.\n *\n * Guarantees:\n *\n * 1. that fulfilled and rejected will be called only once.\n * 2. that either the fulfilled callback or the rejected callback will be\n *    called, but not both.\n * 3. that fulfilled and rejected will not be called in this turn.\n *\n * @param value      promise or immediate reference to observe\n * @param fulfilled  function to be called with the fulfilled value\n * @param rejected   function to be called with the rejection exception\n * @param progressed function to be called on any progress notifications\n * @return promise for the return value from the invoked callback\n */\nQ.when = when;\nfunction when(value, fulfilled, rejected, progressed) {\n    return Q(value).then(fulfilled, rejected, progressed);\n}\n\nPromise.prototype.thenResolve = function (value) {\n    return this.then(function () { return value; });\n};\n\nQ.thenResolve = function (promise, value) {\n    return Q(promise).thenResolve(value);\n};\n\nPromise.prototype.thenReject = function (reason) {\n    return this.then(function () { throw reason; });\n};\n\nQ.thenReject = function (promise, reason) {\n    return Q(promise).thenReject(reason);\n};\n\n/**\n * If an object is not a promise, it is as \"near\" as possible.\n * If a promise is rejected, it is as \"near\" as possible too.\n * If it’s a fulfilled promise, the fulfillment value is nearer.\n * If it’s a deferred promise and the deferred has been resolved, the\n * resolution is \"nearer\".\n * @param object\n * @returns most resolved (nearest) form of the object\n */\n\n// XXX should we re-do this?\nQ.nearer = nearer;\nfunction nearer(value) {\n    if (isPromise(value)) {\n        var inspected = value.inspect();\n        if (inspected.state === \"fulfilled\") {\n            return inspected.value;\n        }\n    }\n    return value;\n}\n\n/**\n * @returns whether the given object is a promise.\n * Otherwise it is a fulfilled value.\n */\nQ.isPromise = isPromise;\nfunction isPromise(object) {\n    return isObject(object) &&\n        typeof object.promiseDispatch === \"function\" &&\n        typeof object.inspect === \"function\";\n}\n\nQ.isPromiseAlike = isPromiseAlike;\nfunction isPromiseAlike(object) {\n    return isObject(object) && typeof object.then === \"function\";\n}\n\n/**\n * @returns whether the given object is a pending promise, meaning not\n * fulfilled or rejected.\n */\nQ.isPending = isPending;\nfunction isPending(object) {\n    return isPromise(object) && object.inspect().state === \"pending\";\n}\n\nPromise.prototype.isPending = function () {\n    return this.inspect().state === \"pending\";\n};\n\n/**\n * @returns whether the given object is a value or fulfilled\n * promise.\n */\nQ.isFulfilled = isFulfilled;\nfunction isFulfilled(object) {\n    return !isPromise(object) || object.inspect().state === \"fulfilled\";\n}\n\nPromise.prototype.isFulfilled = function () {\n    return this.inspect().state === \"fulfilled\";\n};\n\n/**\n * @returns whether the given object is a rejected promise.\n */\nQ.isRejected = isRejected;\nfunction isRejected(object) {\n    return isPromise(object) && object.inspect().state === \"rejected\";\n}\n\nPromise.prototype.isRejected = function () {\n    return this.inspect().state === \"rejected\";\n};\n\n//// BEGIN UNHANDLED REJECTION TRACKING\n\n// This promise library consumes exceptions thrown in handlers so they can be\n// handled by a subsequent promise.  The exceptions get added to this array when\n// they are created, and removed when they are handled.  Note that in ES6 or\n// shimmed environments, this would naturally be a `Set`.\nvar unhandledReasons = [];\nvar unhandledRejections = [];\nvar trackUnhandledRejections = true;\n\nfunction resetUnhandledRejections() {\n    unhandledReasons.length = 0;\n    unhandledRejections.length = 0;\n\n    if (!trackUnhandledRejections) {\n        trackUnhandledRejections = true;\n    }\n}\n\nfunction trackRejection(promise, reason) {\n    if (!trackUnhandledRejections) {\n        return;\n    }\n\n    unhandledRejections.push(promise);\n    if (reason && typeof reason.stack !== \"undefined\") {\n        unhandledReasons.push(reason.stack);\n    } else {\n        unhandledReasons.push(\"(no stack) \" + reason);\n    }\n}\n\nfunction untrackRejection(promise) {\n    if (!trackUnhandledRejections) {\n        return;\n    }\n\n    var at = array_indexOf(unhandledRejections, promise);\n    if (at !== -1) {\n        unhandledRejections.splice(at, 1);\n        unhandledReasons.splice(at, 1);\n    }\n}\n\nQ.resetUnhandledRejections = resetUnhandledRejections;\n\nQ.getUnhandledReasons = function () {\n    // Make a copy so that consumers can't interfere with our internal state.\n    return unhandledReasons.slice();\n};\n\nQ.stopUnhandledRejectionTracking = function () {\n    resetUnhandledRejections();\n    trackUnhandledRejections = false;\n};\n\nresetUnhandledRejections();\n\n//// END UNHANDLED REJECTION TRACKING\n\n/**\n * Constructs a rejected promise.\n * @param reason value describing the failure\n */\nQ.reject = reject;\nfunction reject(reason) {\n    var rejection = Promise({\n        \"when\": function (rejected) {\n            // note that the error has been handled\n            if (rejected) {\n                untrackRejection(this);\n            }\n            return rejected ? rejected(reason) : this;\n        }\n    }, function fallback() {\n        return this;\n    }, function inspect() {\n        return { state: \"rejected\", reason: reason };\n    });\n\n    // Note that the reason has not been handled.\n    trackRejection(rejection, reason);\n\n    return rejection;\n}\n\n/**\n * Constructs a fulfilled promise for an immediate reference.\n * @param value immediate reference\n */\nQ.fulfill = fulfill;\nfunction fulfill(value) {\n    return Promise({\n        \"when\": function () {\n            return value;\n        },\n        \"get\": function (name) {\n            return value[name];\n        },\n        \"set\": function (name, rhs) {\n            value[name] = rhs;\n        },\n        \"delete\": function (name) {\n            delete value[name];\n        },\n        \"post\": function (name, args) {\n            // Mark Miller proposes that post with no name should apply a\n            // promised function.\n            if (name === null || name === void 0) {\n                return value.apply(void 0, args);\n            } else {\n                return value[name].apply(value, args);\n            }\n        },\n        \"apply\": function (thisp, args) {\n            return value.apply(thisp, args);\n        },\n        \"keys\": function () {\n            return object_keys(value);\n        }\n    }, void 0, function inspect() {\n        return { state: \"fulfilled\", value: value };\n    });\n}\n\n/**\n * Converts thenables to Q promises.\n * @param promise thenable promise\n * @returns a Q promise\n */\nfunction coerce(promise) {\n    var deferred = defer();\n    nextTick(function () {\n        try {\n            promise.then(deferred.resolve, deferred.reject, deferred.notify);\n        } catch (exception) {\n            deferred.reject(exception);\n        }\n    });\n    return deferred.promise;\n}\n\n/**\n * Annotates an object such that it will never be\n * transferred away from this process over any promise\n * communication channel.\n * @param object\n * @returns promise a wrapping of that object that\n * additionally responds to the \"isDef\" message\n * without a rejection.\n */\nQ.master = master;\nfunction master(object) {\n    return Promise({\n        \"isDef\": function () {}\n    }, function fallback(op, args) {\n        return dispatch(object, op, args);\n    }, function () {\n        return Q(object).inspect();\n    });\n}\n\n/**\n * Spreads the values of a promised array of arguments into the\n * fulfillment callback.\n * @param fulfilled callback that receives variadic arguments from the\n * promised array\n * @param rejected callback that receives the exception if the promise\n * is rejected.\n * @returns a promise for the return value or thrown exception of\n * either callback.\n */\nQ.spread = spread;\nfunction spread(value, fulfilled, rejected) {\n    return Q(value).spread(fulfilled, rejected);\n}\n\nPromise.prototype.spread = function (fulfilled, rejected) {\n    return this.all().then(function (array) {\n        return fulfilled.apply(void 0, array);\n    }, rejected);\n};\n\n/**\n * The async function is a decorator for generator functions, turning\n * them into asynchronous generators.  Although generators are only part\n * of the newest ECMAScript 6 drafts, this code does not cause syntax\n * errors in older engines.  This code should continue to work and will\n * in fact improve over time as the language improves.\n *\n * ES6 generators are currently part of V8 version 3.19 with the\n * --harmony-generators runtime flag enabled.  SpiderMonkey has had them\n * for longer, but under an older Python-inspired form.  This function\n * works on both kinds of generators.\n *\n * Decorates a generator function such that:\n *  - it may yield promises\n *  - execution will continue when that promise is fulfilled\n *  - the value of the yield expression will be the fulfilled value\n *  - it returns a promise for the return value (when the generator\n *    stops iterating)\n *  - the decorated function returns a promise for the return value\n *    of the generator or the first rejected promise among those\n *    yielded.\n *  - if an error is thrown in the generator, it propagates through\n *    every following yield until it is caught, or until it escapes\n *    the generator function altogether, and is translated into a\n *    rejection for the promise returned by the decorated generator.\n */\nQ.async = async;\nfunction async(makeGenerator) {\n    return function () {\n        // when verb is \"send\", arg is a value\n        // when verb is \"throw\", arg is an exception\n        function continuer(verb, arg) {\n            var result;\n\n            // Until V8 3.19 / Chromium 29 is released, SpiderMonkey is the only\n            // engine that has a deployed base of browsers that support generators.\n            // However, SM's generators use the Python-inspired semantics of\n            // outdated ES6 drafts.  We would like to support ES6, but we'd also\n            // like to make it possible to use generators in deployed browsers, so\n            // we also support Python-style generators.  At some point we can remove\n            // this block.\n\n            if (typeof StopIteration === \"undefined\") {\n                // ES6 Generators\n                try {\n                    result = generator[verb](arg);\n                } catch (exception) {\n                    return reject(exception);\n                }\n                if (result.done) {\n                    return result.value;\n                } else {\n                    return when(result.value, callback, errback);\n                }\n            } else {\n                // SpiderMonkey Generators\n                // FIXME: Remove this case when SM does ES6 generators.\n                try {\n                    result = generator[verb](arg);\n                } catch (exception) {\n                    if (isStopIteration(exception)) {\n                        return exception.value;\n                    } else {\n                        return reject(exception);\n                    }\n                }\n                return when(result, callback, errback);\n            }\n        }\n        var generator = makeGenerator.apply(this, arguments);\n        var callback = continuer.bind(continuer, \"next\");\n        var errback = continuer.bind(continuer, \"throw\");\n        return callback();\n    };\n}\n\n/**\n * The spawn function is a small wrapper around async that immediately\n * calls the generator and also ends the promise chain, so that any\n * unhandled errors are thrown instead of forwarded to the error\n * handler. This is useful because it's extremely common to run\n * generators at the top-level to work with libraries.\n */\nQ.spawn = spawn;\nfunction spawn(makeGenerator) {\n    Q.done(Q.async(makeGenerator)());\n}\n\n// FIXME: Remove this interface once ES6 generators are in SpiderMonkey.\n/**\n * Throws a ReturnValue exception to stop an asynchronous generator.\n *\n * This interface is a stop-gap measure to support generator return\n * values in older Firefox/SpiderMonkey.  In browsers that support ES6\n * generators like Chromium 29, just use \"return\" in your generator\n * functions.\n *\n * @param value the return value for the surrounding generator\n * @throws ReturnValue exception with the value.\n * @example\n * // ES6 style\n * Q.async(function* () {\n *      var foo = yield getFooPromise();\n *      var bar = yield getBarPromise();\n *      return foo + bar;\n * })\n * // Older SpiderMonkey style\n * Q.async(function () {\n *      var foo = yield getFooPromise();\n *      var bar = yield getBarPromise();\n *      Q.return(foo + bar);\n * })\n */\nQ[\"return\"] = _return;\nfunction _return(value) {\n    throw new QReturnValue(value);\n}\n\n/**\n * The promised function decorator ensures that any promise arguments\n * are settled and passed as values (`this` is also settled and passed\n * as a value).  It will also ensure that the result of a function is\n * always a promise.\n *\n * @example\n * var add = Q.promised(function (a, b) {\n *     return a + b;\n * });\n * add(Q(a), Q(B));\n *\n * @param {function} callback The function to decorate\n * @returns {function} a function that has been decorated.\n */\nQ.promised = promised;\nfunction promised(callback) {\n    return function () {\n        return spread([this, all(arguments)], function (self, args) {\n            return callback.apply(self, args);\n        });\n    };\n}\n\n/**\n * sends a message to a value in a future turn\n * @param object* the recipient\n * @param op the name of the message operation, e.g., \"when\",\n * @param args further arguments to be forwarded to the operation\n * @returns result {Promise} a promise for the result of the operation\n */\nQ.dispatch = dispatch;\nfunction dispatch(object, op, args) {\n    return Q(object).dispatch(op, args);\n}\n\nPromise.prototype.dispatch = function (op, args) {\n    var self = this;\n    var deferred = defer();\n    nextTick(function () {\n        self.promiseDispatch(deferred.resolve, op, args);\n    });\n    return deferred.promise;\n};\n\n/**\n * Gets the value of a property in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of property to get\n * @return promise for the property value\n */\nQ.get = function (object, key) {\n    return Q(object).dispatch(\"get\", [key]);\n};\n\nPromise.prototype.get = function (key) {\n    return this.dispatch(\"get\", [key]);\n};\n\n/**\n * Sets the value of a property in a future turn.\n * @param object    promise or immediate reference for object object\n * @param name      name of property to set\n * @param value     new value of property\n * @return promise for the return value\n */\nQ.set = function (object, key, value) {\n    return Q(object).dispatch(\"set\", [key, value]);\n};\n\nPromise.prototype.set = function (key, value) {\n    return this.dispatch(\"set\", [key, value]);\n};\n\n/**\n * Deletes a property in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of property to delete\n * @return promise for the return value\n */\nQ.del = // XXX legacy\nQ[\"delete\"] = function (object, key) {\n    return Q(object).dispatch(\"delete\", [key]);\n};\n\nPromise.prototype.del = // XXX legacy\nPromise.prototype[\"delete\"] = function (key) {\n    return this.dispatch(\"delete\", [key]);\n};\n\n/**\n * Invokes a method in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of method to invoke\n * @param value     a value to post, typically an array of\n *                  invocation arguments for promises that\n *                  are ultimately backed with `resolve` values,\n *                  as opposed to those backed with URLs\n *                  wherein the posted value can be any\n *                  JSON serializable object.\n * @return promise for the return value\n */\n// bound locally because it is used by other methods\nQ.mapply = // XXX As proposed by \"Redsandro\"\nQ.post = function (object, name, args) {\n    return Q(object).dispatch(\"post\", [name, args]);\n};\n\nPromise.prototype.mapply = // XXX As proposed by \"Redsandro\"\nPromise.prototype.post = function (name, args) {\n    return this.dispatch(\"post\", [name, args]);\n};\n\n/**\n * Invokes a method in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of method to invoke\n * @param ...args   array of invocation arguments\n * @return promise for the return value\n */\nQ.send = // XXX Mark Miller's proposed parlance\nQ.mcall = // XXX As proposed by \"Redsandro\"\nQ.invoke = function (object, name /*...args*/) {\n    return Q(object).dispatch(\"post\", [name, array_slice(arguments, 2)]);\n};\n\nPromise.prototype.send = // XXX Mark Miller's proposed parlance\nPromise.prototype.mcall = // XXX As proposed by \"Redsandro\"\nPromise.prototype.invoke = function (name /*...args*/) {\n    return this.dispatch(\"post\", [name, array_slice(arguments, 1)]);\n};\n\n/**\n * Applies the promised function in a future turn.\n * @param object    promise or immediate reference for target function\n * @param args      array of application arguments\n */\nQ.fapply = function (object, args) {\n    return Q(object).dispatch(\"apply\", [void 0, args]);\n};\n\nPromise.prototype.fapply = function (args) {\n    return this.dispatch(\"apply\", [void 0, args]);\n};\n\n/**\n * Calls the promised function in a future turn.\n * @param object    promise or immediate reference for target function\n * @param ...args   array of application arguments\n */\nQ[\"try\"] =\nQ.fcall = function (object /* ...args*/) {\n    return Q(object).dispatch(\"apply\", [void 0, array_slice(arguments, 1)]);\n};\n\nPromise.prototype.fcall = function (/*...args*/) {\n    return this.dispatch(\"apply\", [void 0, array_slice(arguments)]);\n};\n\n/**\n * Binds the promised function, transforming return values into a fulfilled\n * promise and thrown errors into a rejected one.\n * @param object    promise or immediate reference for target function\n * @param ...args   array of application arguments\n */\nQ.fbind = function (object /*...args*/) {\n    var promise = Q(object);\n    var args = array_slice(arguments, 1);\n    return function fbound() {\n        return promise.dispatch(\"apply\", [\n            this,\n            args.concat(array_slice(arguments))\n        ]);\n    };\n};\nPromise.prototype.fbind = function (/*...args*/) {\n    var promise = this;\n    var args = array_slice(arguments);\n    return function fbound() {\n        return promise.dispatch(\"apply\", [\n            this,\n            args.concat(array_slice(arguments))\n        ]);\n    };\n};\n\n/**\n * Requests the names of the owned properties of a promised\n * object in a future turn.\n * @param object    promise or immediate reference for target object\n * @return promise for the keys of the eventually settled object\n */\nQ.keys = function (object) {\n    return Q(object).dispatch(\"keys\", []);\n};\n\nPromise.prototype.keys = function () {\n    return this.dispatch(\"keys\", []);\n};\n\n/**\n * Turns an array of promises into a promise for an array.  If any of\n * the promises gets rejected, the whole array is rejected immediately.\n * @param {Array*} an array (or promise for an array) of values (or\n * promises for values)\n * @returns a promise for an array of the corresponding values\n */\n// By Mark Miller\n// http://wiki.ecmascript.org/doku.php?id=strawman:concurrency&rev=1308776521#allfulfilled\nQ.all = all;\nfunction all(promises) {\n    return when(promises, function (promises) {\n        var countDown = 0;\n        var deferred = defer();\n        array_reduce(promises, function (undefined, promise, index) {\n            var snapshot;\n            if (\n                isPromise(promise) &&\n                (snapshot = promise.inspect()).state === \"fulfilled\"\n            ) {\n                promises[index] = snapshot.value;\n            } else {\n                ++countDown;\n                when(\n                    promise,\n                    function (value) {\n                        promises[index] = value;\n                        if (--countDown === 0) {\n                            deferred.resolve(promises);\n                        }\n                    },\n                    deferred.reject,\n                    function (progress) {\n                        deferred.notify({ index: index, value: progress });\n                    }\n                );\n            }\n        }, void 0);\n        if (countDown === 0) {\n            deferred.resolve(promises);\n        }\n        return deferred.promise;\n    });\n}\n\nPromise.prototype.all = function () {\n    return all(this);\n};\n\n/**\n * Waits for all promises to be settled, either fulfilled or\n * rejected.  This is distinct from `all` since that would stop\n * waiting at the first rejection.  The promise returned by\n * `allResolved` will never be rejected.\n * @param promises a promise for an array (or an array) of promises\n * (or values)\n * @return a promise for an array of promises\n */\nQ.allResolved = deprecate(allResolved, \"allResolved\", \"allSettled\");\nfunction allResolved(promises) {\n    return when(promises, function (promises) {\n        promises = array_map(promises, Q);\n        return when(all(array_map(promises, function (promise) {\n            return when(promise, noop, noop);\n        })), function () {\n            return promises;\n        });\n    });\n}\n\nPromise.prototype.allResolved = function () {\n    return allResolved(this);\n};\n\n/**\n * @see Promise#allSettled\n */\nQ.allSettled = allSettled;\nfunction allSettled(promises) {\n    return Q(promises).allSettled();\n}\n\n/**\n * Turns an array of promises into a promise for an array of their states (as\n * returned by `inspect`) when they have all settled.\n * @param {Array[Any*]} values an array (or promise for an array) of values (or\n * promises for values)\n * @returns {Array[State]} an array of states for the respective values.\n */\nPromise.prototype.allSettled = function () {\n    return this.then(function (promises) {\n        return all(array_map(promises, function (promise) {\n            promise = Q(promise);\n            function regardless() {\n                return promise.inspect();\n            }\n            return promise.then(regardless, regardless);\n        }));\n    });\n};\n\n/**\n * Captures the failure of a promise, giving an oportunity to recover\n * with a callback.  If the given promise is fulfilled, the returned\n * promise is fulfilled.\n * @param {Any*} promise for something\n * @param {Function} callback to fulfill the returned promise if the\n * given promise is rejected\n * @returns a promise for the return value of the callback\n */\nQ.fail = // XXX legacy\nQ[\"catch\"] = function (object, rejected) {\n    return Q(object).then(void 0, rejected);\n};\n\nPromise.prototype.fail = // XXX legacy\nPromise.prototype[\"catch\"] = function (rejected) {\n    return this.then(void 0, rejected);\n};\n\n/**\n * Attaches a listener that can respond to progress notifications from a\n * promise's originating deferred. This listener receives the exact arguments\n * passed to ``deferred.notify``.\n * @param {Any*} promise for something\n * @param {Function} callback to receive any progress notifications\n * @returns the given promise, unchanged\n */\nQ.progress = progress;\nfunction progress(object, progressed) {\n    return Q(object).then(void 0, void 0, progressed);\n}\n\nPromise.prototype.progress = function (progressed) {\n    return this.then(void 0, void 0, progressed);\n};\n\n/**\n * Provides an opportunity to observe the settling of a promise,\n * regardless of whether the promise is fulfilled or rejected.  Forwards\n * the resolution to the returned promise when the callback is done.\n * The callback can return a promise to defer completion.\n * @param {Any*} promise\n * @param {Function} callback to observe the resolution of the given\n * promise, takes no arguments.\n * @returns a promise for the resolution of the given promise when\n * ``fin`` is done.\n */\nQ.fin = // XXX legacy\nQ[\"finally\"] = function (object, callback) {\n    return Q(object)[\"finally\"](callback);\n};\n\nPromise.prototype.fin = // XXX legacy\nPromise.prototype[\"finally\"] = function (callback) {\n    callback = Q(callback);\n    return this.then(function (value) {\n        return callback.fcall().then(function () {\n            return value;\n        });\n    }, function (reason) {\n        // TODO attempt to recycle the rejection with \"this\".\n        return callback.fcall().then(function () {\n            throw reason;\n        });\n    });\n};\n\n/**\n * Terminates a chain of promises, forcing rejections to be\n * thrown as exceptions.\n * @param {Any*} promise at the end of a chain of promises\n * @returns nothing\n */\nQ.done = function (object, fulfilled, rejected, progress) {\n    return Q(object).done(fulfilled, rejected, progress);\n};\n\nPromise.prototype.done = function (fulfilled, rejected, progress) {\n    var onUnhandledError = function (error) {\n        // forward to a future turn so that ``when``\n        // does not catch it and turn it into a rejection.\n        nextTick(function () {\n            makeStackTraceLong(error, promise);\n            if (Q.onerror) {\n                Q.onerror(error);\n            } else {\n                throw error;\n            }\n        });\n    };\n\n    // Avoid unnecessary `nextTick`ing via an unnecessary `when`.\n    var promise = fulfilled || rejected || progress ?\n        this.then(fulfilled, rejected, progress) :\n        this;\n\n    if (typeof process === \"object\" && process && process.domain) {\n        onUnhandledError = process.domain.bind(onUnhandledError);\n    }\n\n    promise.then(void 0, onUnhandledError);\n};\n\n/**\n * Causes a promise to be rejected if it does not get fulfilled before\n * some milliseconds time out.\n * @param {Any*} promise\n * @param {Number} milliseconds timeout\n * @param {String} custom error message (optional)\n * @returns a promise for the resolution of the given promise if it is\n * fulfilled before the timeout, otherwise rejected.\n */\nQ.timeout = function (object, ms, message) {\n    return Q(object).timeout(ms, message);\n};\n\nPromise.prototype.timeout = function (ms, message) {\n    var deferred = defer();\n    var timeoutId = setTimeout(function () {\n        deferred.reject(new Error(message || \"Timed out after \" + ms + \" ms\"));\n    }, ms);\n\n    this.then(function (value) {\n        clearTimeout(timeoutId);\n        deferred.resolve(value);\n    }, function (exception) {\n        clearTimeout(timeoutId);\n        deferred.reject(exception);\n    }, deferred.notify);\n\n    return deferred.promise;\n};\n\n/**\n * Returns a promise for the given value (or promised value), some\n * milliseconds after it resolved. Passes rejections immediately.\n * @param {Any*} promise\n * @param {Number} milliseconds\n * @returns a promise for the resolution of the given promise after milliseconds\n * time has elapsed since the resolution of the given promise.\n * If the given promise rejects, that is passed immediately.\n */\nQ.delay = function (object, timeout) {\n    if (timeout === void 0) {\n        timeout = object;\n        object = void 0;\n    }\n    return Q(object).delay(timeout);\n};\n\nPromise.prototype.delay = function (timeout) {\n    return this.then(function (value) {\n        var deferred = defer();\n        setTimeout(function () {\n            deferred.resolve(value);\n        }, timeout);\n        return deferred.promise;\n    });\n};\n\n/**\n * Passes a continuation to a Node function, which is called with the given\n * arguments provided as an array, and returns a promise.\n *\n *      Q.nfapply(FS.readFile, [__filename])\n *      .then(function (content) {\n *      })\n *\n */\nQ.nfapply = function (callback, args) {\n    return Q(callback).nfapply(args);\n};\n\nPromise.prototype.nfapply = function (args) {\n    var deferred = defer();\n    var nodeArgs = array_slice(args);\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.fapply(nodeArgs).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * Passes a continuation to a Node function, which is called with the given\n * arguments provided individually, and returns a promise.\n * @example\n * Q.nfcall(FS.readFile, __filename)\n * .then(function (content) {\n * })\n *\n */\nQ.nfcall = function (callback /*...args*/) {\n    var args = array_slice(arguments, 1);\n    return Q(callback).nfapply(args);\n};\n\nPromise.prototype.nfcall = function (/*...args*/) {\n    var nodeArgs = array_slice(arguments);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.fapply(nodeArgs).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * Wraps a NodeJS continuation passing function and returns an equivalent\n * version that returns a promise.\n * @example\n * Q.nfbind(FS.readFile, __filename)(\"utf-8\")\n * .then(console.log)\n * .done()\n */\nQ.nfbind =\nQ.denodeify = function (callback /*...args*/) {\n    var baseArgs = array_slice(arguments, 1);\n    return function () {\n        var nodeArgs = baseArgs.concat(array_slice(arguments));\n        var deferred = defer();\n        nodeArgs.push(deferred.makeNodeResolver());\n        Q(callback).fapply(nodeArgs).fail(deferred.reject);\n        return deferred.promise;\n    };\n};\n\nPromise.prototype.nfbind =\nPromise.prototype.denodeify = function (/*...args*/) {\n    var args = array_slice(arguments);\n    args.unshift(this);\n    return Q.denodeify.apply(void 0, args);\n};\n\nQ.nbind = function (callback, thisp /*...args*/) {\n    var baseArgs = array_slice(arguments, 2);\n    return function () {\n        var nodeArgs = baseArgs.concat(array_slice(arguments));\n        var deferred = defer();\n        nodeArgs.push(deferred.makeNodeResolver());\n        function bound() {\n            return callback.apply(thisp, arguments);\n        }\n        Q(bound).fapply(nodeArgs).fail(deferred.reject);\n        return deferred.promise;\n    };\n};\n\nPromise.prototype.nbind = function (/*thisp, ...args*/) {\n    var args = array_slice(arguments, 0);\n    args.unshift(this);\n    return Q.nbind.apply(void 0, args);\n};\n\n/**\n * Calls a method of a Node-style object that accepts a Node-style\n * callback with a given array of arguments, plus a provided callback.\n * @param object an object that has the named method\n * @param {String} name name of the method of object\n * @param {Array} args arguments to pass to the method; the callback\n * will be provided by Q and appended to these arguments.\n * @returns a promise for the value or error\n */\nQ.nmapply = // XXX As proposed by \"Redsandro\"\nQ.npost = function (object, name, args) {\n    return Q(object).npost(name, args);\n};\n\nPromise.prototype.nmapply = // XXX As proposed by \"Redsandro\"\nPromise.prototype.npost = function (name, args) {\n    var nodeArgs = array_slice(args || []);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.dispatch(\"post\", [name, nodeArgs]).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * Calls a method of a Node-style object that accepts a Node-style\n * callback, forwarding the given variadic arguments, plus a provided\n * callback argument.\n * @param object an object that has the named method\n * @param {String} name name of the method of object\n * @param ...args arguments to pass to the method; the callback will\n * be provided by Q and appended to these arguments.\n * @returns a promise for the value or error\n */\nQ.nsend = // XXX Based on Mark Miller's proposed \"send\"\nQ.nmcall = // XXX Based on \"Redsandro's\" proposal\nQ.ninvoke = function (object, name /*...args*/) {\n    var nodeArgs = array_slice(arguments, 2);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    Q(object).dispatch(\"post\", [name, nodeArgs]).fail(deferred.reject);\n    return deferred.promise;\n};\n\nPromise.prototype.nsend = // XXX Based on Mark Miller's proposed \"send\"\nPromise.prototype.nmcall = // XXX Based on \"Redsandro's\" proposal\nPromise.prototype.ninvoke = function (name /*...args*/) {\n    var nodeArgs = array_slice(arguments, 1);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.dispatch(\"post\", [name, nodeArgs]).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * If a function would like to support both Node continuation-passing-style and\n * promise-returning-style, it can end its internal promise chain with\n * `nodeify(nodeback)`, forwarding the optional nodeback argument.  If the user\n * elects to use a nodeback, the result will be sent there.  If they do not\n * pass a nodeback, they will receive the result promise.\n * @param object a result (or a promise for a result)\n * @param {Function} nodeback a Node.js-style callback\n * @returns either the promise or nothing\n */\nQ.nodeify = nodeify;\nfunction nodeify(object, nodeback) {\n    return Q(object).nodeify(nodeback);\n}\n\nPromise.prototype.nodeify = function (nodeback) {\n    if (nodeback) {\n        this.then(function (value) {\n            nextTick(function () {\n                nodeback(null, value);\n            });\n        }, function (error) {\n            nextTick(function () {\n                nodeback(error);\n            });\n        });\n    } else {\n        return this;\n    }\n};\n\n// All code before this point will be filtered from stack traces.\nvar qEndingLine = captureLine();\n\nreturn Q;\n\n});\n","/**\n * Module dependencies\n */\nvar assert = require('assert'),\n  _ = require('lodash');\n\n\n\n/**\n * _partialJoin\n *\n * @api private\n *\n * Check whether two rows match on the specified keys,\n * and if they do, merge `parentRow` into a copy of `childRow`\n * and return it (omit `childRow`'s key, since it === `parentRow`'s).\n *\n * Hypothetically, this function could be operated by a stream,\n * but in the case of a left outer join, at least, the final\n * result set cannot be accurately known until both the complete\n * contents of both the `left` and `right` data set have been checked.\n *\n * An optimization from polynomial to logarithmic computational\n * complexity could potentially be achieved by taking advantage\n * of the known L[k..l] and R[m..n] values as each new L[i] or R[j]\n * arrives from a stream, but a comparably-sized cache would have to\n * be maintained, so we'd still be stuck with polynomial memory usage.\n * i.e. O( |R|*|L| )  This could be resolved by batching-- e.g. grab the\n * first 3000 parent and child rows, join matches together, discard\n * the unneeded data, and repeat.\n *\n * Anyways, worth investigating, since this is a hot code path for\n * cross-adapter joins.\n *\n *\n * Usage:\n *\n * partialJoin({\n *   parentRow: { id: 5, name: 'Lucy', email: 'lucy@fakemail.org' }\n *   childRow:  { owner_id: 5, name: 'Rover', breed: 'Australian Shepherd' }\n *   parentKey: 'id'\n *   childKey:  'owner_id',\n *   childNamespace:  '.'\n * })\n *\n * @param  {Object} options\n * @return {Object|False}   If false, don't save the join row.\n * @synchronous\n */\nmodule.exports = function partialJoin (options) {\n\n  // Usage\n  var invalid = false;\n  invalid = invalid || !_.isObject(options);\n  invalid = invalid || !_.isString(options.parentKey);\n  invalid = invalid || !_.isString(options.childKey);\n  invalid = invalid || !_.isObject(options.parentRow);\n  invalid = invalid || !_.isObject(options.childRow);\n  assert(!invalid);\n\n  var CHILD_ATTR_PREFIX = (options.childNamespace || '.');\n\n  // If the rows aren't a match, bail out\n  if (\n    options.childRow[options.childKey] !==\n    options.parentRow[options.parentKey]\n    ) {\n    return false;\n  }\n\n  // deep clone the childRow, then delete `childKey` in the copy.\n  var newJoinRow = _.cloneDeep(options.childRow);\n  // console.log('deleting childKEy :: ',options.childKey);\n  // var _childKeyValue = newJoinRow[options.childKey];\n  // delete newJoinRow[options.childKey];\n\n  // namespace the remaining attributes in childRow\n  var namespacedJoinRow = {};\n  _.each(newJoinRow, function (value, key) {\n    var namespacedKey = CHILD_ATTR_PREFIX + key;\n    namespacedJoinRow[namespacedKey] = value;\n  });\n\n\n  // Merge namespaced values from current parentRow into the copy.\n  _.merge(namespacedJoinRow, options.parentRow);\n\n\n  // Return the newly joined row.\n  return namespacedJoinRow;\n};\n\n","module.exports = {\n  type: require('./matchType'),\n  rule: require('./matchRule')\n};\n","/**\n * Module dependencies\n */\nvar _ = require('lodash');\nvar util = require('util');\nvar factory = require('./factory');\nvar normalize = require('./normalize');\nvar redirect = require('./redirect');\nvar wildcard = require('./wildcard');\nvar constants = require('./constants');\n\n\n/**\n * `switchback`\n *\n * Switching utility which builds and returns a handler which is capable\n * calling one of several callbacks.\n *\n * @param {Object|Function} callback\n *\t\t\t- a switchback definition obj or a standard 1|2-ary node callback function.\n * @param {Object} [defaultHandlers]\n *\t\t\t- '*': supply a special callback for when none of the other handlers match\n *\t\t\t- a string can be supplied, e.g. {'invalid': 'error'}, to \"forward\" one handler to another\n *\t\t\t- otherwise a function should be supplied, e.g. { 'error': res.serverError }\n * @param {Object} [callbackContext]\n *\t\t\t- optional `this` context for callbacks\n */\n\nvar switchback = function ( callback, defaultHandlers, callbackContext ) {\n\n\t// If callback is not a function or an object, I don't know wtf it is,\n\t// so let's just return early before anything bad happens, hmm?\n\tif (!_.isObject(callback) && !_.isFunction(callback)) {\n\t\treturn callback;\n\t}\n\n\tvar Switchback = factory(callbackContext);\n\n\t// Normalize `callback` to a switchback definition object.\n\tcallback = normalize.callback(callback);\n\n\t// Attach specified handlers\n\t_.extend(Switchback, callback);\n\n\n\n\t// Supply a handful of default handlers to provide better error messages.\n\tvar getWildcardCaseHandler = function ( caseName, err ) {\n\t\treturn function unknownCase ( /* ... */ ) {\n\t\t\tvar args = Array.prototype.slice.call(arguments);\n\t\t\terr = (args[0] ? util.inspect(args[0])+'        ' : '') + (err ? '('+(err||'')+')' : '');\n\n\t\t\tif ( _.isObject(defaultHandlers) && _.isFunction(defaultHandlers['*']) ) {\n\t\t\t\treturn defaultHandlers['*'](err);\n\t\t\t}\n\t\t\telse throw new Error(err);\n\t\t};\n\t};\n\n\t// redirect any handler defaults specified as strings\n\tif (_.isObject(defaultHandlers)) {\n\t\tdefaultHandlers = _.mapValues(defaultHandlers, function (handler, name) {\n\t\t\tif (_.isFunction(handler)) return handler;\n\n\t\t\t// Closure which will resolve redirected handler\n\t\t\treturn function () {\n\t\t\t\tvar runtimeHandler = handler;\n\t\t\t\tvar runtimeArgs = Array.prototype.slice.call(arguments);\n\t\t\t\tvar runtimeCtx = callbackContext || this;\n\n\t\t\t\t// Track previous handler to make usage error messages more useful.\n\t\t\t\tvar prevHandler;\n\n\t\t\t\t// No more than 5 \"redirects\" allowed (prevents never-ending loop)\n\t\t\t\tvar MAX_FORWARDS = 5;\n\t\t\t\tvar numIterations = 0;\n\t\t\t\tdo {\n\t\t\t\t\tprevHandler = runtimeHandler;\n\t\t\t\t\truntimeHandler = Switchback[runtimeHandler];\n\t\t\t\t\t// console.log('redirecting '+name+' to \"'+prevHandler +'\"-- got ' + runtimeHandler);\n\t\t\t\t\tnumIterations++;\n\t\t\t\t}\n\t\t\t\twhile ( _.isString(runtimeHandler) && numIterations <= MAX_FORWARDS);\n\t\t\t\t\n\t\t\t\tif (numIterations > MAX_FORWARDS) {\n\t\t\t\t\tthrow new Error('Default handlers object ('+util.inspect(defaultHandlers)+') has a cyclic redirect.');\n\t\t\t\t}\n\n\t\t\t\t// Redirects to unknown handler\n\t\t\t\tif (!_.isFunction(runtimeHandler)) {\n\t\t\t\t\truntimeHandler = getWildcardCaseHandler(runtimeHandler, '`' + name + '` case triggered, but no handler was implemented.');\n\t\t\t\t}\n\n\t\t\t\t// Invoke final runtime function\n\t\t\t\truntimeHandler.apply(runtimeCtx, runtimeArgs);\n\t\t\t};\n\t\t});\n\t}\n\n\t_.defaults(Switchback, defaultHandlers, {\n\t\tsuccess: getWildcardCaseHandler('success', '`success` case triggered, but no handler was implemented.'),\n\t\terror: getWildcardCaseHandler('error', '`error` case triggered, but no handler was implemented.'),\n\t\tinvalid: getWildcardCaseHandler('invalid', '`invalid` case triggered, but no handler was implemented.')\n\t});\n\n\treturn Switchback;\n};\n\n\n/**\n * `isSwitchback`\n * \n * @param  {*}  something\n * @return {Boolean}           [whether `something` is a valid switchback instance]\n */\nswitchback.isSwitchback = function (something) {\n\treturn _.isObject(something) && something[constants.telltale.key] === constants.telltale.value;\n};\n\n\nmodule.exports = switchback;\n","// http://wiki.commonjs.org/wiki/Unit_Testing/1.0\n//\n// THIS IS NOT TESTED NOR LIKELY TO WORK OUTSIDE V8!\n//\n// Originally from narwhal.js (http://narwhaljs.org)\n// Copyright (c) 2009 Thomas Robinson <280north.com>\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the 'Software'), to\n// deal in the Software without restriction, including without limitation the\n// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n// sell copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n// ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// when used in node, this will actually load the util module we depend on\n// versus loading the builtin util module as happens otherwise\n// this is a bug in node module loading as far as I am concerned\nvar util = require('util/');\n\nvar pSlice = Array.prototype.slice;\nvar hasOwn = Object.prototype.hasOwnProperty;\n\n// 1. The assert module provides functions that throw\n// AssertionError's when particular conditions are not met. The\n// assert module must conform to the following interface.\n\nvar assert = module.exports = ok;\n\n// 2. The AssertionError is defined in assert.\n// new assert.AssertionError({ message: message,\n//                             actual: actual,\n//                             expected: expected })\n\nassert.AssertionError = function AssertionError(options) {\n  this.name = 'AssertionError';\n  this.actual = options.actual;\n  this.expected = options.expected;\n  this.operator = options.operator;\n  if (options.message) {\n    this.message = options.message;\n    this.generatedMessage = false;\n  } else {\n    this.message = getMessage(this);\n    this.generatedMessage = true;\n  }\n  var stackStartFunction = options.stackStartFunction || fail;\n\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, stackStartFunction);\n  }\n  else {\n    // non v8 browsers so we can have a stacktrace\n    var err = new Error();\n    if (err.stack) {\n      var out = err.stack;\n\n      // try to strip useless frames\n      var fn_name = stackStartFunction.name;\n      var idx = out.indexOf('\\n' + fn_name);\n      if (idx >= 0) {\n        // once we have located the function frame\n        // we need to strip out everything before it (and its line)\n        var next_line = out.indexOf('\\n', idx + 1);\n        out = out.substring(next_line + 1);\n      }\n\n      this.stack = out;\n    }\n  }\n};\n\n// assert.AssertionError instanceof Error\nutil.inherits(assert.AssertionError, Error);\n\nfunction replacer(key, value) {\n  if (util.isUndefined(value)) {\n    return '' + value;\n  }\n  if (util.isNumber(value) && (isNaN(value) || !isFinite(value))) {\n    return value.toString();\n  }\n  if (util.isFunction(value) || util.isRegExp(value)) {\n    return value.toString();\n  }\n  return value;\n}\n\nfunction truncate(s, n) {\n  if (util.isString(s)) {\n    return s.length < n ? s : s.slice(0, n);\n  } else {\n    return s;\n  }\n}\n\nfunction getMessage(self) {\n  return truncate(JSON.stringify(self.actual, replacer), 128) + ' ' +\n         self.operator + ' ' +\n         truncate(JSON.stringify(self.expected, replacer), 128);\n}\n\n// At present only the three keys mentioned above are used and\n// understood by the spec. Implementations or sub modules can pass\n// other keys to the AssertionError's constructor - they will be\n// ignored.\n\n// 3. All of the following functions must throw an AssertionError\n// when a corresponding condition is not met, with a message that\n// may be undefined if not provided.  All assertion methods provide\n// both the actual and expected values to the assertion error for\n// display purposes.\n\nfunction fail(actual, expected, message, operator, stackStartFunction) {\n  throw new assert.AssertionError({\n    message: message,\n    actual: actual,\n    expected: expected,\n    operator: operator,\n    stackStartFunction: stackStartFunction\n  });\n}\n\n// EXTENSION! allows for well behaved errors defined elsewhere.\nassert.fail = fail;\n\n// 4. Pure assertion tests whether a value is truthy, as determined\n// by !!guard.\n// assert.ok(guard, message_opt);\n// This statement is equivalent to assert.equal(true, !!guard,\n// message_opt);. To test strictly for the value true, use\n// assert.strictEqual(true, guard, message_opt);.\n\nfunction ok(value, message) {\n  if (!value) fail(value, true, message, '==', assert.ok);\n}\nassert.ok = ok;\n\n// 5. The equality assertion tests shallow, coercive equality with\n// ==.\n// assert.equal(actual, expected, message_opt);\n\nassert.equal = function equal(actual, expected, message) {\n  if (actual != expected) fail(actual, expected, message, '==', assert.equal);\n};\n\n// 6. The non-equality assertion tests for whether two objects are not equal\n// with != assert.notEqual(actual, expected, message_opt);\n\nassert.notEqual = function notEqual(actual, expected, message) {\n  if (actual == expected) {\n    fail(actual, expected, message, '!=', assert.notEqual);\n  }\n};\n\n// 7. The equivalence assertion tests a deep equality relation.\n// assert.deepEqual(actual, expected, message_opt);\n\nassert.deepEqual = function deepEqual(actual, expected, message) {\n  if (!_deepEqual(actual, expected)) {\n    fail(actual, expected, message, 'deepEqual', assert.deepEqual);\n  }\n};\n\nfunction _deepEqual(actual, expected) {\n  // 7.1. All identical values are equivalent, as determined by ===.\n  if (actual === expected) {\n    return true;\n\n  } else if (util.isBuffer(actual) && util.isBuffer(expected)) {\n    if (actual.length != expected.length) return false;\n\n    for (var i = 0; i < actual.length; i++) {\n      if (actual[i] !== expected[i]) return false;\n    }\n\n    return true;\n\n  // 7.2. If the expected value is a Date object, the actual value is\n  // equivalent if it is also a Date object that refers to the same time.\n  } else if (util.isDate(actual) && util.isDate(expected)) {\n    return actual.getTime() === expected.getTime();\n\n  // 7.3 If the expected value is a RegExp object, the actual value is\n  // equivalent if it is also a RegExp object with the same source and\n  // properties (`global`, `multiline`, `lastIndex`, `ignoreCase`).\n  } else if (util.isRegExp(actual) && util.isRegExp(expected)) {\n    return actual.source === expected.source &&\n           actual.global === expected.global &&\n           actual.multiline === expected.multiline &&\n           actual.lastIndex === expected.lastIndex &&\n           actual.ignoreCase === expected.ignoreCase;\n\n  // 7.4. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if (!util.isObject(actual) && !util.isObject(expected)) {\n    return actual == expected;\n\n  // 7.5 For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else {\n    return objEquiv(actual, expected);\n  }\n}\n\nfunction isArguments(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n}\n\nfunction objEquiv(a, b) {\n  if (util.isNullOrUndefined(a) || util.isNullOrUndefined(b))\n    return false;\n  // an identical 'prototype' property.\n  if (a.prototype !== b.prototype) return false;\n  //~~~I've managed to break Object.keys through screwy arguments passing.\n  //   Converting to array solves the problem.\n  if (isArguments(a)) {\n    if (!isArguments(b)) {\n      return false;\n    }\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return _deepEqual(a, b);\n  }\n  try {\n    var ka = objectKeys(a),\n        kb = objectKeys(b),\n        key, i;\n  } catch (e) {//happens when one is a string literal and the other isn't\n    return false;\n  }\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length != kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!_deepEqual(a[key], b[key])) return false;\n  }\n  return true;\n}\n\n// 8. The non-equivalence assertion tests for any deep inequality.\n// assert.notDeepEqual(actual, expected, message_opt);\n\nassert.notDeepEqual = function notDeepEqual(actual, expected, message) {\n  if (_deepEqual(actual, expected)) {\n    fail(actual, expected, message, 'notDeepEqual', assert.notDeepEqual);\n  }\n};\n\n// 9. The strict equality assertion tests strict equality, as determined by ===.\n// assert.strictEqual(actual, expected, message_opt);\n\nassert.strictEqual = function strictEqual(actual, expected, message) {\n  if (actual !== expected) {\n    fail(actual, expected, message, '===', assert.strictEqual);\n  }\n};\n\n// 10. The strict non-equality assertion tests for strict inequality, as\n// determined by !==.  assert.notStrictEqual(actual, expected, message_opt);\n\nassert.notStrictEqual = function notStrictEqual(actual, expected, message) {\n  if (actual === expected) {\n    fail(actual, expected, message, '!==', assert.notStrictEqual);\n  }\n};\n\nfunction expectedException(actual, expected) {\n  if (!actual || !expected) {\n    return false;\n  }\n\n  if (Object.prototype.toString.call(expected) == '[object RegExp]') {\n    return expected.test(actual);\n  } else if (actual instanceof expected) {\n    return true;\n  } else if (expected.call({}, actual) === true) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction _throws(shouldThrow, block, expected, message) {\n  var actual;\n\n  if (util.isString(expected)) {\n    message = expected;\n    expected = null;\n  }\n\n  try {\n    block();\n  } catch (e) {\n    actual = e;\n  }\n\n  message = (expected && expected.name ? ' (' + expected.name + ').' : '.') +\n            (message ? ' ' + message : '.');\n\n  if (shouldThrow && !actual) {\n    fail(actual, expected, 'Missing expected exception' + message);\n  }\n\n  if (!shouldThrow && expectedException(actual, expected)) {\n    fail(actual, expected, 'Got unwanted exception' + message);\n  }\n\n  if ((shouldThrow && actual && expected &&\n      !expectedException(actual, expected)) || (!shouldThrow && actual)) {\n    throw actual;\n  }\n}\n\n// 11. Expected to throw an error:\n// assert.throws(block, Error_opt, message_opt);\n\nassert.throws = function(block, /*optional*/error, /*optional*/message) {\n  _throws.apply(this, [true].concat(pSlice.call(arguments)));\n};\n\n// EXTENSION! This is annoying to write outside this module.\nassert.doesNotThrow = function(block, /*optional*/message) {\n  _throws.apply(this, [false].concat(pSlice.call(arguments)));\n};\n\nassert.ifError = function(err) { if (err) {throw err;}};\n\nvar objectKeys = Object.keys || function (obj) {\n  var keys = [];\n  for (var key in obj) {\n    if (hasOwn.call(obj, key)) keys.push(key);\n  }\n  return keys;\n};\n",";(function(undefined) {\n\t\"use strict\";\n\n\tvar $scope\n\t, conflict, conflictResolution = [];\n\tif (typeof global == 'object' && global) {\n\t\t$scope = global;\n\t} else if (typeof window !== 'undefined'){\n\t\t$scope = window;\n\t} else {\n\t\t$scope = {};\n\t}\n\tconflict = $scope.DeepDiff;\n\tif (conflict) {\n\t\tconflictResolution.push(\n\t\t\tfunction() {\n\t\t\t\tif ('undefined' !== typeof conflict && $scope.DeepDiff === accumulateDiff) {\n\t\t\t\t\t$scope.DeepDiff = conflict;\n\t\t\t\t\tconflict = undefined;\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\t// nodejs compatible on server side and in the browser.\n  function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor;\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  }\n\n  function Diff(kind, path) {\n  \tObject.defineProperty(this, 'kind', { value: kind, enumerable: true });\n  \tif (path && path.length) {\n  \t\tObject.defineProperty(this, 'path', { value: path, enumerable: true });\n  \t}\n  }\n\n  function DiffEdit(path, origin, value) {\n  \tDiffEdit.super_.call(this, 'E', path);\n  \tObject.defineProperty(this, 'lhs', { value: origin, enumerable: true });\n  \tObject.defineProperty(this, 'rhs', { value: value, enumerable: true });\n  }\n  inherits(DiffEdit, Diff);\n\n  function DiffNew(path, value) {\n  \tDiffNew.super_.call(this, 'N', path);\n  \tObject.defineProperty(this, 'rhs', { value: value, enumerable: true });\n  }\n  inherits(DiffNew, Diff);\n\n  function DiffDeleted(path, value) {\n  \tDiffDeleted.super_.call(this, 'D', path);\n  \tObject.defineProperty(this, 'lhs', { value: value, enumerable: true });\n  }\n  inherits(DiffDeleted, Diff);\n\n  function DiffArray(path, index, item) {\n  \tDiffArray.super_.call(this, 'A', path);\n  \tObject.defineProperty(this, 'index', { value: index, enumerable: true });\n  \tObject.defineProperty(this, 'item', { value: item, enumerable: true });\n  }\n  inherits(DiffArray, Diff);\n\n  function arrayRemove(arr, from, to) {\n  \tvar rest = arr.slice((to || from) + 1 || arr.length);\n  \tarr.length = from < 0 ? arr.length + from : from;\n  \tarr.push.apply(arr, rest);\n  \treturn arr;\n  }\n\n  function deepDiff(lhs, rhs, changes, prefilter, path, key, stack) {\n  \tpath = path || [];\n  \tvar currentPath = path.slice(0);\n  \tif (key) {\n  \t\tif (prefilter && prefilter(currentPath, key)) return;\n  \t\tcurrentPath.push(key);\n  \t}\n  \tvar ltype = typeof lhs;\n  \tvar rtype = typeof rhs;\n  \tif (ltype === 'undefined') {\n  \t\tif (rtype !== 'undefined') {\n  \t\t\tchanges(new DiffNew(currentPath, rhs ));\n  \t\t}\n  \t} else if (rtype === 'undefined') {\n  \t\tchanges(new DiffDeleted(currentPath, lhs));\n  \t} else if (ltype !== rtype) {\n  \t\tchanges(new DiffEdit(currentPath, lhs, rhs));\n  \t} else if (lhs instanceof Date && rhs instanceof Date && ((lhs-rhs) != 0) ) {\n  \t\tchanges(new DiffEdit(currentPath, lhs, rhs));\n  \t} else if (ltype === 'object' && lhs != null && rhs != null) {\n  \t\tstack = stack || [];\n  \t\tif (stack.indexOf(lhs) < 0) {\n  \t\t\tstack.push(lhs);\n  \t\t\tif (Array.isArray(lhs)) {\n  \t\t\t\tvar i\n  \t\t\t\t, len = lhs.length\n  \t\t\t\t, ea = function(d) {\n  \t\t\t\t\tchanges(new DiffArray(currentPath, i, d));\n  \t\t\t\t};\n  \t\t\t\tfor(i = 0; i < lhs.length; i++) {\n  \t\t\t\t\tif (i >= rhs.length) {\n  \t\t\t\t\t\tchanges(new DiffArray(currentPath, i, new DiffDeleted(undefined, lhs[i])));\n  \t\t\t\t\t} else {\n  \t\t\t\t\t\tdeepDiff(lhs[i], rhs[i], ea, prefilter, [], null, stack);\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t\twhile(i < rhs.length) {\n  \t\t\t\t\tchanges(new DiffArray(currentPath, i, new DiffNew(undefined, rhs[i++])));\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tvar akeys = Object.keys(lhs);\n  \t\t\t\tvar pkeys = Object.keys(rhs);\n  \t\t\t\takeys.forEach(function(k) {\n  \t\t\t\t\tvar i = pkeys.indexOf(k);\n  \t\t\t\t\tif (i >= 0) {\n  \t\t\t\t\t\tdeepDiff(lhs[k], rhs[k], changes, prefilter, currentPath, k, stack);\n  \t\t\t\t\t\tpkeys = arrayRemove(pkeys, i);\n  \t\t\t\t\t} else {\n  \t\t\t\t\t\tdeepDiff(lhs[k], undefined, changes, prefilter, currentPath, k, stack);\n  \t\t\t\t\t}\n  \t\t\t\t});\n  \t\t\t\tpkeys.forEach(function(k) {\n  \t\t\t\t\tdeepDiff(undefined, rhs[k], changes, prefilter, currentPath, k, stack);\n  \t\t\t\t});\n  \t\t\t}\n  \t\t\tstack.length = stack.length - 1;\n  \t\t}\n  \t} else if (lhs !== rhs) {\n      if(!(ltype === \"number\" && isNaN(lhs) && isNaN(rhs))) {\n  \t\t  changes(new DiffEdit(currentPath, lhs, rhs));\n      }\n  \t}\n  }\n\n  function accumulateDiff(lhs, rhs, prefilter, accum) {\n  \taccum = accum || [];\n  \tdeepDiff(lhs, rhs,\n  \t\tfunction(diff) {\n  \t\t\tif (diff) {\n  \t\t\t\taccum.push(diff);\n  \t\t\t}\n  \t\t},\n  \t\tprefilter);\n  \treturn (accum.length) ? accum : undefined;\n  }\n\n\tfunction applyArrayChange(arr, index, change) {\n\t\tif (change.path && change.path.length) {\n\t\t\t// the structure of the object at the index has changed...\n\t\t\tvar it = arr[index], i, u = change.path.length - 1;\n\t\t\tfor(i = 0; i < u; i++){\n\t\t\t\tit = it[change.path[i]];\n\t\t\t}\n\t\t\tswitch(change.kind) {\n\t\t\t\tcase 'A':\n\t\t\t\t\t// Array was modified...\n\t\t\t\t\t// it will be an array...\n\t\t\t\t\tapplyArrayChange(it[change.path[i]], change.index, change.item);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\t// Item was deleted...\n\t\t\t\t\tdelete it[change.path[i]];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'E':\n\t\t\t\tcase 'N':\n\t\t\t\t\t// Item was edited or is new...\n\t\t\t\t\tit[change.path[i]] = change.rhs;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t} else {\n\t\t\t// the array item is different...\n\t\t\tswitch(change.kind) {\n\t\t\t\tcase 'A':\n\t\t\t\t\t// Array was modified...\n\t\t\t\t\t// it will be an array...\n\t\t\t\t\tapplyArrayChange(arr[index], change.index, change.item);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\t// Item was deleted...\n\t\t\t\t\tarr = arrayRemove(arr, index);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'E':\n\t\t\t\tcase 'N':\n\t\t\t\t\t// Item was edited or is new...\n\t\t\t\t\tarr[index] = change.rhs;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn arr;\n\t}\n\n\tfunction applyChange(target, source, change) {\n\t\tif (!(change instanceof Diff)) {\n\t\t\tthrow new TypeError('[Object] change must be instanceof Diff');\n\t\t}\n\t\tif (target && source && change) {\n\t\t\tvar it = target, i, u;\n\t\t\tu = change.path.length - 1;\n\t\t\tfor(i = 0; i < u; i++){\n\t\t\t\tif (typeof it[change.path[i]] === 'undefined') {\n\t\t\t\t\tit[change.path[i]] = {};\n\t\t\t\t}\n\t\t\t\tit = it[change.path[i]];\n\t\t\t}\n\t\t\tswitch(change.kind) {\n\t\t\t\tcase 'A':\n\t\t\t\t\t// Array was modified...\n\t\t\t\t\t// it will be an array...\n\t\t\t\t\tapplyArrayChange(it[change.path[i]], change.index, change.item);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\t// Item was deleted...\n\t\t\t\t\tdelete it[change.path[i]];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'E':\n\t\t\t\tcase 'N':\n\t\t\t\t\t// Item was edited or is new...\n\t\t\t\t\tit[change.path[i]] = change.rhs;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\tfunction applyDiff(target, source, filter) {\n\t\tif (target && source) {\n\t\t\tvar onChange = function(change) {\n\t\t\t\tif (!filter || filter(target, source, change)) {\n\t\t\t\t\tapplyChange(target, source, change);\n\t\t\t\t}\n\t\t\t};\n\t\t\tdeepDiff(target, source, onChange);\n\t\t}\n\t}\n\n\tObject.defineProperties(accumulateDiff, {\n\n\t\tdiff: { value: accumulateDiff, enumerable:true },\n\t\tobservableDiff: { value: deepDiff, enumerable:true },\n\t\tapplyDiff: { value: applyDiff, enumerable:true },\n\t\tapplyChange: { value: applyChange, enumerable:true },\n\t\tisConflict: { get: function() { return 'undefined' !== typeof conflict; }, enumerable: true },\n\t\tnoConflict: {\n\t\t\tvalue: function () {\n\t\t\t\tif (conflictResolution) {\n\t\t\t\t\tconflictResolution.forEach(function (it) { it(); });\n\t\t\t\t\tconflictResolution = null;\n\t\t\t\t}\n\t\t\t\treturn accumulateDiff;\n\t\t\t},\n\t\t\tenumerable: true\n\t\t}\n\t});\n\n\tif (typeof module != 'undefined' && module && typeof exports == 'object' && exports && module.exports === exports) {\n\t\tmodule.exports = accumulateDiff; // nodejs\n\t} else {\n\t\t$scope.DeepDiff = accumulateDiff; // other... browser?\n\t}\n}());\n\n","/*!\n * Copyright (c) 2014 Chris O'Hara <cohara87@gmail.com>\n *\n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the\n * \"Software\"), to deal in the Software without restriction, including\n * without limitation the rights to use, copy, modify, merge, publish,\n * distribute, sublicense, and/or sell copies of the Software, and to\n * permit persons to whom the Software is furnished to do so, subject to\n * the following conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\n * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\n(function (name, definition) {\n    if (typeof module !== 'undefined') {\n        module.exports = definition();\n    } else if (typeof define === 'function' && typeof define.amd === 'object') {\n        define(definition);\n    } else {\n        this[name] = definition();\n    }\n})('validator', function (validator) {\n\n    'use strict';\n\n    validator = { version: '3.3.0' };\n\n    var email = /^(?:[\\w\\!\\#\\$\\%\\&\\'\\*\\+\\-\\/\\=\\?\\^\\`\\{\\|\\}\\~]+\\.)*[\\w\\!\\#\\$\\%\\&\\'\\*\\+\\-\\/\\=\\?\\^\\`\\{\\|\\}\\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\\-](?!\\.)){0,61}[a-zA-Z0-9]?\\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\\[(?:(?:[01]?\\d{1,2}|2[0-4]\\d|25[0-5])\\.){3}(?:[01]?\\d{1,2}|2[0-4]\\d|25[0-5])\\]))$/;\n\n    var creditCard = /^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\\d{3})\\d{11})$/;\n\n    var isbn10Maybe = /^(?:[0-9]{9}X|[0-9]{10})$/\n      , isbn13Maybe = /^(?:[0-9]{13})$/;\n\n    var ipv4Maybe = /^(\\d?\\d?\\d)\\.(\\d?\\d?\\d)\\.(\\d?\\d?\\d)\\.(\\d?\\d?\\d)$/\n      , ipv6 = /^::|^::1|^([a-fA-F0-9]{1,4}::?){1,7}([a-fA-F0-9]{1,4})$/;\n\n    var uuid = {\n        '3': /^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i\n      , '4': /^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i\n      , '5': /^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i\n      , all: /^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i\n    };\n\n    var alpha = /^[a-zA-Z]+$/\n      , alphanumeric = /^[a-zA-Z0-9]+$/\n      , numeric = /^-?[0-9]+$/\n      , int = /^(?:-?(?:0|[1-9][0-9]*))$/\n      , float = /^(?:-?(?:[0-9]+))?(?:\\.[0-9]*)?(?:[eE][\\+\\-]?(?:[0-9]+))?$/\n      , hexadecimal = /^[0-9a-fA-F]+$/\n      , hexcolor = /^#?([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/;\n\n    validator.extend = function (name, fn) {\n        validator[name] = function () {\n            var args = Array.prototype.slice.call(arguments);\n            args[0] = validator.toString(args[0]);\n            return fn.apply(validator, args);\n        };\n    };\n\n    validator.noCoerce = ['toString', 'toDate', 'extend', 'init', 'flatten', 'merge'];\n\n    //Right before exporting the validator object, pass each of the builtins\n    //through extend() so that their first argument is coerced to a string\n    validator.init = function () {\n        for (var name in validator) {\n            if (typeof validator[name] !== 'function' || validator.noCoerce.indexOf(name) >= 0) {\n                continue;\n            }\n            validator.extend(name, validator[name]);\n        }\n    };\n\n    validator.toString = function (input) {\n        if (input === null || typeof input === 'undefined' || (isNaN(input) && !input.length)) {\n            input = '';\n        } else if (typeof input === 'object' && input.toString) {\n            input = input.toString();\n        } else if (typeof input !== 'string') {\n            input += '';\n        }\n        return input;\n    };\n\n    validator.toDate = function (date) {\n        if (Object.prototype.toString.call(date) === '[object Date]') {\n            return date;\n        }\n        date = Date.parse(date);\n        return !isNaN(date) ? new Date(date) : null;\n    };\n\n    validator.toFloat = function (str) {\n        return parseFloat(str);\n    };\n\n    validator.toInt = function (str, radix) {\n        return parseInt(str, radix || 10);\n    };\n\n    validator.toBoolean = function (str, strict) {\n        if (strict) {\n            return str === '1' || str === 'true';\n        }\n        return str !== '0' && str !== 'false' && str !== '';\n    };\n\n    validator.flatten = function (array, separator) {\n        if (!array) {\n            return '';\n        }\n        var str = array[0];\n        for (var i = 1; i < array.length; i++) {\n            str += separator + array[i];\n        }\n        return str;\n    };\n\n    validator.merge = function (obj, defaults) {\n        obj = obj || {};\n        for (var key in defaults) {\n            if (typeof obj[key] === 'undefined') {\n                obj[key] = defaults[key];\n            }\n        }\n        return obj;\n    };\n\n    validator.equals = function (str, comparison) {\n        return str === validator.toString(comparison);\n    };\n\n    validator.contains = function (str, elem) {\n        return str.indexOf(validator.toString(elem)) >= 0;\n    };\n\n    validator.matches = function (str, pattern, modifiers) {\n        if (Object.prototype.toString.call(pattern) !== '[object RegExp]') {\n            pattern = new RegExp(pattern, modifiers);\n        }\n        return pattern.test(str);\n    };\n\n    validator.isEmail = function (str) {\n        return email.test(str);\n    };\n\n    var default_url_options = {\n        protocols: [ 'http', 'https', 'ftp' ]\n      , require_tld: true\n    };\n\n    validator.isURL = function (str, options) {\n        options = validator.merge(options, default_url_options);\n        var url = new RegExp('^(?!mailto:)(?:(?:' + validator.flatten(options.protocols, '|') + ')://)?(?:\\\\S+(?::\\\\S*)?@)?(?:(?:(?:[1-9]\\\\d?|1\\\\d\\\\d|2[01]\\\\d|22[0-3])(?:\\\\.(?:1?\\\\d{1,2}|2[0-4]\\\\d|25[0-5])){2}(?:\\\\.(?:[0-9]\\\\d?|1\\\\d\\\\d|2[0-4]\\\\d|25[0-4]))|(?:(?:[a-z\\\\u00a1-\\\\uffff0-9]+-?)*[a-z\\\\u00a1-\\\\uffff0-9]+)(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff0-9]+-?)*[a-z\\\\u00a1-\\\\uffff0-9]+)*(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff]{2,}))' + (options.require_tld ? '' : '?') + ')|localhost)(?::\\\\d{2,5})?(?:(/|\\\\?|#)[^\\\\s]*)?$', 'i');\n        return str.length < 2083 && url.test(str);\n    };\n\n    validator.isIP = function (str, version) {\n        version = validator.toString(version);\n        if (!version) {\n            return validator.isIP(str, 4) || validator.isIP(str, 6);\n        } else if (version === '4') {\n            if (!ipv4Maybe.test(str)) {\n                return false;\n            }\n            var parts = str.split('.').sort();\n            return parts[3] <= 255;\n        }\n        return version === '6' && ipv6.test(str);\n    };\n\n    validator.isAlpha = function (str) {\n        return alpha.test(str);\n    };\n\n    validator.isAlphanumeric = function (str) {\n        return alphanumeric.test(str);\n    };\n\n    validator.isNumeric = function (str) {\n        return numeric.test(str);\n    };\n\n    validator.isHexadecimal = function (str) {\n        return hexadecimal.test(str);\n    };\n\n    validator.isHexColor = function (str) {\n        return hexcolor.test(str);\n    };\n\n    validator.isLowercase = function (str) {\n        return str === str.toLowerCase();\n    };\n\n    validator.isUppercase = function (str) {\n        return str === str.toUpperCase();\n    };\n\n    validator.isInt = function (str) {\n        return int.test(str);\n    };\n\n    validator.isFloat = function (str) {\n        return str !== '' && float.test(str);\n    };\n\n    validator.isDivisibleBy = function (str, num) {\n        return validator.toFloat(str) % validator.toInt(num) === 0;\n    };\n\n    validator.isNull = function (str) {\n        return str.length === 0;\n    };\n\n    validator.isLength = function (str, min, max) {\n        return str.length >= min && (typeof max === 'undefined' || str.length <= max);\n    };\n\n    validator.isUUID = function (str, version) {\n        var pattern = uuid[version ? version : 'all'];\n        return pattern && pattern.test(str);\n    };\n\n    validator.isDate = function (str) {\n        return !isNaN(Date.parse(str));\n    };\n\n    validator.isAfter = function (str, date) {\n        var comparison = validator.toDate(date || new Date())\n          , original = validator.toDate(str);\n        return original && comparison && original > comparison;\n    };\n\n    validator.isBefore = function (str, date) {\n        var comparison = validator.toDate(date || new Date())\n          , original = validator.toDate(str);\n        return original && comparison && original < comparison;\n    };\n\n    validator.isIn = function (str, options) {\n        if (!options || typeof options.indexOf !== 'function') {\n            return false;\n        }\n        if (Object.prototype.toString.call(options) === '[object Array]') {\n            var array = [];\n            for (var i = 0, len = options.length; i < len; i++) {\n                array[i] = validator.toString(options[i]);\n            }\n            options = array;\n        }\n        return options.indexOf(str) >= 0;\n    };\n\n    validator.isCreditCard = function (str) {\n        var sanitized = str.replace(/[^0-9]+/g, '');\n        if (!creditCard.test(sanitized)) {\n            return false;\n        }\n        var sum = 0, digit, tmpNum, shouldDouble;\n        for (var i = sanitized.length - 1; i >= 0; i--) {\n            digit = sanitized.substring(i, (i + 1));\n            tmpNum = parseInt(digit, 10);\n            if (shouldDouble) {\n                tmpNum *= 2;\n                if (tmpNum >= 10) {\n                    sum += ((tmpNum % 10) + 1);\n                } else {\n                    sum += tmpNum;\n                }\n            } else {\n                sum += tmpNum;\n            }\n            shouldDouble = !shouldDouble;\n        }\n        return (sum % 10) === 0 ? sanitized : false;\n    };\n\n    validator.isISBN = function (str, version) {\n        version = validator.toString(version);\n        if (!version) {\n            return validator.isISBN(str, 10) || validator.isISBN(str, 13);\n        }\n        var sanitized = str.replace(/[\\s-]+/g, '')\n          , checksum = 0, i;\n        if (version === '10') {\n            if (!isbn10Maybe.test(sanitized)) {\n                return false;\n            }\n            for (i = 0; i < 9; i++) {\n                checksum += (i + 1) * sanitized.charAt(i);\n            }\n            if (sanitized.charAt(9) === 'X') {\n                checksum += 10 * 10;\n            } else {\n                checksum += 10 * sanitized.charAt(9);\n            }\n            if ((checksum % 11) === 0) {\n                return sanitized;\n            }\n        } else  if (version === '13') {\n            if (!isbn13Maybe.test(sanitized)) {\n                return false;\n            }\n            var factor = [ 1, 3 ];\n            for (i = 0; i < 12; i++) {\n                checksum += factor[i % 2] * sanitized.charAt(i);\n            }\n            if (sanitized.charAt(12) - ((10 - (checksum % 10)) % 10) === 0) {\n                return sanitized;\n            }\n        }\n        return false;\n    };\n\n    validator.ltrim = function (str, chars) {\n        var pattern = chars ? new RegExp('^[' + chars + ']+', 'g') : /^\\s+/g;\n        return str.replace(pattern, '');\n    };\n\n    validator.rtrim = function (str, chars) {\n        var pattern = chars ? new RegExp('[' + chars + ']+$', 'g') : /\\s+$/g;\n        return str.replace(pattern, '');\n    };\n\n    validator.trim = function (str, chars) {\n        var pattern = chars ? new RegExp('^[' + chars + ']+|[' + chars + ']+$', 'g') : /^\\s+|\\s+$/g;\n        return str.replace(pattern, '');\n    };\n\n    validator.escape = function (str) {\n        return (str.replace(/&/g, '&amp;')\n            .replace(/\"/g, '&quot;')\n            .replace(/</g, '&lt;')\n            .replace(/>/g, '&gt;'));\n    };\n\n    validator.whitelist = function (str, chars) {\n        return str.replace(new RegExp('[^' + chars + ']+', 'g'), '');\n    };\n\n    validator.blacklist = function (str, chars) {\n        return str.replace(new RegExp('[' + chars + ']+', 'g'), '');\n    };\n\n    validator.init();\n\n    return validator;\n\n});\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\nvar util = require('util');\nvar path = require('path');\n\n\nmodule.exports = _.extend(\n\n  // Provide all-in-one top-level function\n  require('./query'),\n\n  // but also expose direct access\n  // to all filters and projections.\n  {\n    where: require('./filters/where'),\n    limit: require('./filters/limit'),\n    skip: require('./filters/skip'),\n    sort: require('./sort'),\n\n    // Projections and aggregations are not-yet-officially supported:\n    groupBy: require('./projections/groupBy'),\n    select: require('./projections/select')\n\n    // Joins are currently supported by Waterline core:\n    // , populate : require('./projections/populate')\n    // , leftJoin : require('./projections/leftJoin')\n    // , join     : require('./projections/join')\n    // , rightJoin : require('./projections/rightJoin')\n\n  });\n\n\n\n/**\n * Load CommonJS submodules from the specified\n * relative path.\n *\n * @return {Object}\n */\nfunction loadSubModules(relPath) {\n  return require('include-all')({\n    dirname: path.resolve(__dirname, relPath),\n    filter: /(.+)\\.js$/\n  });\n}\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = Buffer\nexports.INSPECT_MAX_BYTES = 50\nBuffer.poolSize = 8192\n\n/**\n * If `Buffer._useTypedArrays`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (compatible down to IE6)\n */\nBuffer._useTypedArrays = (function () {\n  // Detect if browser supports Typed Arrays. Supported browsers are IE 10+, Firefox 4+,\n  // Chrome 7+, Safari 5.1+, Opera 11.6+, iOS 4.2+. If the browser does not support adding\n  // properties to `Uint8Array` instances, then that's the same as no `Uint8Array` support\n  // because we need to be able to add all the node Buffer API methods. This is an issue\n  // in Firefox 4-29. Now fixed: https://bugzilla.mozilla.org/show_bug.cgi?id=695438\n  try {\n    var buf = new ArrayBuffer(0)\n    var arr = new Uint8Array(buf)\n    arr.foo = function () { return 42 }\n    return 42 === arr.foo() &&\n        typeof arr.subarray === 'function' // Chrome 9-10 lack `subarray`\n  } catch (e) {\n    return false\n  }\n})()\n\n/**\n * Class: Buffer\n * =============\n *\n * The Buffer constructor returns instances of `Uint8Array` that are augmented\n * with function properties for all the node `Buffer` API functions. We use\n * `Uint8Array` so that square bracket notation works as expected -- it returns\n * a single octet.\n *\n * By augmenting the instances, we can avoid modifying the `Uint8Array`\n * prototype.\n */\nfunction Buffer (subject, encoding, noZero) {\n  if (!(this instanceof Buffer))\n    return new Buffer(subject, encoding, noZero)\n\n  var type = typeof subject\n\n  // Workaround: node's base64 implementation allows for non-padded strings\n  // while base64-js does not.\n  if (encoding === 'base64' && type === 'string') {\n    subject = stringtrim(subject)\n    while (subject.length % 4 !== 0) {\n      subject = subject + '='\n    }\n  }\n\n  // Find the length\n  var length\n  if (type === 'number')\n    length = coerce(subject)\n  else if (type === 'string')\n    length = Buffer.byteLength(subject, encoding)\n  else if (type === 'object')\n    length = coerce(subject.length) // assume that object is array-like\n  else\n    throw new Error('First argument needs to be a number, array or string.')\n\n  var buf\n  if (Buffer._useTypedArrays) {\n    // Preferred: Return an augmented `Uint8Array` instance for best performance\n    buf = Buffer._augment(new Uint8Array(length))\n  } else {\n    // Fallback: Return THIS instance of Buffer (created by `new`)\n    buf = this\n    buf.length = length\n    buf._isBuffer = true\n  }\n\n  var i\n  if (Buffer._useTypedArrays && typeof subject.byteLength === 'number') {\n    // Speed optimization -- use set if we're copying from a typed array\n    buf._set(subject)\n  } else if (isArrayish(subject)) {\n    // Treat array-ish objects as a byte array\n    for (i = 0; i < length; i++) {\n      if (Buffer.isBuffer(subject))\n        buf[i] = subject.readUInt8(i)\n      else\n        buf[i] = subject[i]\n    }\n  } else if (type === 'string') {\n    buf.write(subject, 0, encoding)\n  } else if (type === 'number' && !Buffer._useTypedArrays && !noZero) {\n    for (i = 0; i < length; i++) {\n      buf[i] = 0\n    }\n  }\n\n  return buf\n}\n\n// STATIC METHODS\n// ==============\n\nBuffer.isEncoding = function (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'binary':\n    case 'base64':\n    case 'raw':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.isBuffer = function (b) {\n  return !!(b !== null && b !== undefined && b._isBuffer)\n}\n\nBuffer.byteLength = function (str, encoding) {\n  var ret\n  str = str.toString()\n  switch (encoding || 'utf8') {\n    case 'hex':\n      ret = str.length / 2\n      break\n    case 'utf8':\n    case 'utf-8':\n      ret = utf8ToBytes(str).length\n      break\n    case 'ascii':\n    case 'binary':\n    case 'raw':\n      ret = str.length\n      break\n    case 'base64':\n      ret = base64ToBytes(str).length\n      break\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      ret = str.length * 2\n      break\n    default:\n      throw new Error('Unknown encoding')\n  }\n  return ret\n}\n\nBuffer.concat = function (list, totalLength) {\n  assert(isArray(list), 'Usage: Buffer.concat(list[, length])')\n\n  if (list.length === 0) {\n    return new Buffer(0)\n  } else if (list.length === 1) {\n    return list[0]\n  }\n\n  var i\n  if (totalLength === undefined) {\n    totalLength = 0\n    for (i = 0; i < list.length; i++) {\n      totalLength += list[i].length\n    }\n  }\n\n  var buf = new Buffer(totalLength)\n  var pos = 0\n  for (i = 0; i < list.length; i++) {\n    var item = list[i]\n    item.copy(buf, pos)\n    pos += item.length\n  }\n  return buf\n}\n\nBuffer.compare = function (a, b) {\n  assert(Buffer.isBuffer(a) && Buffer.isBuffer(b), 'Arguments must be Buffers')\n  var x = a.length\n  var y = b.length\n  for (var i = 0, len = Math.min(x, y); i < len && a[i] === b[i]; i++) {}\n  if (i !== len) {\n    x = a[i]\n    y = b[i]\n  }\n  if (x < y) {\n    return -1\n  }\n  if (y < x) {\n    return 1\n  }\n  return 0\n}\n\n// BUFFER INSTANCE METHODS\n// =======================\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  assert(strLen % 2 === 0, 'Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; i++) {\n    var byte = parseInt(string.substr(i * 2, 2), 16)\n    assert(!isNaN(byte), 'Invalid hex string')\n    buf[offset + i] = byte\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  var charsWritten = blitBuffer(utf8ToBytes(string), buf, offset, length)\n  return charsWritten\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  var charsWritten = blitBuffer(asciiToBytes(string), buf, offset, length)\n  return charsWritten\n}\n\nfunction binaryWrite (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  var charsWritten = blitBuffer(base64ToBytes(string), buf, offset, length)\n  return charsWritten\n}\n\nfunction utf16leWrite (buf, string, offset, length) {\n  var charsWritten = blitBuffer(utf16leToBytes(string), buf, offset, length)\n  return charsWritten\n}\n\nBuffer.prototype.write = function (string, offset, length, encoding) {\n  // Support both (string, offset, length, encoding)\n  // and the legacy (string, encoding, offset, length)\n  if (isFinite(offset)) {\n    if (!isFinite(length)) {\n      encoding = length\n      length = undefined\n    }\n  } else {  // legacy\n    var swap = encoding\n    encoding = offset\n    offset = length\n    length = swap\n  }\n\n  offset = Number(offset) || 0\n  var remaining = this.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n  encoding = String(encoding || 'utf8').toLowerCase()\n\n  var ret\n  switch (encoding) {\n    case 'hex':\n      ret = hexWrite(this, string, offset, length)\n      break\n    case 'utf8':\n    case 'utf-8':\n      ret = utf8Write(this, string, offset, length)\n      break\n    case 'ascii':\n      ret = asciiWrite(this, string, offset, length)\n      break\n    case 'binary':\n      ret = binaryWrite(this, string, offset, length)\n      break\n    case 'base64':\n      ret = base64Write(this, string, offset, length)\n      break\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      ret = utf16leWrite(this, string, offset, length)\n      break\n    default:\n      throw new Error('Unknown encoding')\n  }\n  return ret\n}\n\nBuffer.prototype.toString = function (encoding, start, end) {\n  var self = this\n\n  encoding = String(encoding || 'utf8').toLowerCase()\n  start = Number(start) || 0\n  end = (end === undefined) ? self.length : Number(end)\n\n  // Fastpath empty strings\n  if (end === start)\n    return ''\n\n  var ret\n  switch (encoding) {\n    case 'hex':\n      ret = hexSlice(self, start, end)\n      break\n    case 'utf8':\n    case 'utf-8':\n      ret = utf8Slice(self, start, end)\n      break\n    case 'ascii':\n      ret = asciiSlice(self, start, end)\n      break\n    case 'binary':\n      ret = binarySlice(self, start, end)\n      break\n    case 'base64':\n      ret = base64Slice(self, start, end)\n      break\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      ret = utf16leSlice(self, start, end)\n      break\n    default:\n      throw new Error('Unknown encoding')\n  }\n  return ret\n}\n\nBuffer.prototype.toJSON = function () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nBuffer.prototype.equals = function (b) {\n  assert(Buffer.isBuffer(b), 'Argument must be a Buffer')\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.compare = function (b) {\n  assert(Buffer.isBuffer(b), 'Argument must be a Buffer')\n  return Buffer.compare(this, b)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function (target, target_start, start, end) {\n  var source = this\n\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (!target_start) target_start = 0\n\n  // Copy 0 bytes; we're done\n  if (end === start) return\n  if (target.length === 0 || source.length === 0) return\n\n  // Fatal error conditions\n  assert(end >= start, 'sourceEnd < sourceStart')\n  assert(target_start >= 0 && target_start < target.length,\n      'targetStart out of bounds')\n  assert(start >= 0 && start < source.length, 'sourceStart out of bounds')\n  assert(end >= 0 && end <= source.length, 'sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length)\n    end = this.length\n  if (target.length - target_start < end - start)\n    end = target.length - target_start + start\n\n  var len = end - start\n\n  if (len < 100 || !Buffer._useTypedArrays) {\n    for (var i = 0; i < len; i++) {\n      target[i + target_start] = this[i + start]\n    }\n  } else {\n    target._set(this.subarray(start, start + len), target_start)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  var res = ''\n  var tmp = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; i++) {\n    if (buf[i] <= 0x7F) {\n      res += decodeUtf8Char(tmp) + String.fromCharCode(buf[i])\n      tmp = ''\n    } else {\n      tmp += '%' + buf[i].toString(16)\n    }\n  }\n\n  return res + decodeUtf8Char(tmp)\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; i++) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction binarySlice (buf, start, end) {\n  return asciiSlice(buf, start, end)\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; i++) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function (start, end) {\n  var len = this.length\n  start = clamp(start, len, 0)\n  end = clamp(end, len, len)\n\n  if (Buffer._useTypedArrays) {\n    return Buffer._augment(this.subarray(start, end))\n  } else {\n    var sliceLen = end - start\n    var newBuf = new Buffer(sliceLen, undefined, true)\n    for (var i = 0; i < sliceLen; i++) {\n      newBuf[i] = this[i + start]\n    }\n    return newBuf\n  }\n}\n\n// `get` will be removed in Node 0.13+\nBuffer.prototype.get = function (offset) {\n  console.log('.get() is deprecated. Access using array indexes instead.')\n  return this.readUInt8(offset)\n}\n\n// `set` will be removed in Node 0.13+\nBuffer.prototype.set = function (v, offset) {\n  console.log('.set() is deprecated. Access using array indexes instead.')\n  return this.writeUInt8(v, offset)\n}\n\nBuffer.prototype.readUInt8 = function (offset, noAssert) {\n  if (!noAssert) {\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset < this.length, 'Trying to read beyond buffer length')\n  }\n\n  if (offset >= this.length)\n    return\n\n  return this[offset]\n}\n\nfunction readUInt16 (buf, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 1 < buf.length, 'Trying to read beyond buffer length')\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  var val\n  if (littleEndian) {\n    val = buf[offset]\n    if (offset + 1 < len)\n      val |= buf[offset + 1] << 8\n  } else {\n    val = buf[offset] << 8\n    if (offset + 1 < len)\n      val |= buf[offset + 1]\n  }\n  return val\n}\n\nBuffer.prototype.readUInt16LE = function (offset, noAssert) {\n  return readUInt16(this, offset, true, noAssert)\n}\n\nBuffer.prototype.readUInt16BE = function (offset, noAssert) {\n  return readUInt16(this, offset, false, noAssert)\n}\n\nfunction readUInt32 (buf, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 3 < buf.length, 'Trying to read beyond buffer length')\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  var val\n  if (littleEndian) {\n    if (offset + 2 < len)\n      val = buf[offset + 2] << 16\n    if (offset + 1 < len)\n      val |= buf[offset + 1] << 8\n    val |= buf[offset]\n    if (offset + 3 < len)\n      val = val + (buf[offset + 3] << 24 >>> 0)\n  } else {\n    if (offset + 1 < len)\n      val = buf[offset + 1] << 16\n    if (offset + 2 < len)\n      val |= buf[offset + 2] << 8\n    if (offset + 3 < len)\n      val |= buf[offset + 3]\n    val = val + (buf[offset] << 24 >>> 0)\n  }\n  return val\n}\n\nBuffer.prototype.readUInt32LE = function (offset, noAssert) {\n  return readUInt32(this, offset, true, noAssert)\n}\n\nBuffer.prototype.readUInt32BE = function (offset, noAssert) {\n  return readUInt32(this, offset, false, noAssert)\n}\n\nBuffer.prototype.readInt8 = function (offset, noAssert) {\n  if (!noAssert) {\n    assert(offset !== undefined && offset !== null,\n        'missing offset')\n    assert(offset < this.length, 'Trying to read beyond buffer length')\n  }\n\n  if (offset >= this.length)\n    return\n\n  var neg = this[offset] & 0x80\n  if (neg)\n    return (0xff - this[offset] + 1) * -1\n  else\n    return this[offset]\n}\n\nfunction readInt16 (buf, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 1 < buf.length, 'Trying to read beyond buffer length')\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  var val = readUInt16(buf, offset, littleEndian, true)\n  var neg = val & 0x8000\n  if (neg)\n    return (0xffff - val + 1) * -1\n  else\n    return val\n}\n\nBuffer.prototype.readInt16LE = function (offset, noAssert) {\n  return readInt16(this, offset, true, noAssert)\n}\n\nBuffer.prototype.readInt16BE = function (offset, noAssert) {\n  return readInt16(this, offset, false, noAssert)\n}\n\nfunction readInt32 (buf, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 3 < buf.length, 'Trying to read beyond buffer length')\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  var val = readUInt32(buf, offset, littleEndian, true)\n  var neg = val & 0x80000000\n  if (neg)\n    return (0xffffffff - val + 1) * -1\n  else\n    return val\n}\n\nBuffer.prototype.readInt32LE = function (offset, noAssert) {\n  return readInt32(this, offset, true, noAssert)\n}\n\nBuffer.prototype.readInt32BE = function (offset, noAssert) {\n  return readInt32(this, offset, false, noAssert)\n}\n\nfunction readFloat (buf, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset + 3 < buf.length, 'Trying to read beyond buffer length')\n  }\n\n  return ieee754.read(buf, offset, littleEndian, 23, 4)\n}\n\nBuffer.prototype.readFloatLE = function (offset, noAssert) {\n  return readFloat(this, offset, true, noAssert)\n}\n\nBuffer.prototype.readFloatBE = function (offset, noAssert) {\n  return readFloat(this, offset, false, noAssert)\n}\n\nfunction readDouble (buf, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset + 7 < buf.length, 'Trying to read beyond buffer length')\n  }\n\n  return ieee754.read(buf, offset, littleEndian, 52, 8)\n}\n\nBuffer.prototype.readDoubleLE = function (offset, noAssert) {\n  return readDouble(this, offset, true, noAssert)\n}\n\nBuffer.prototype.readDoubleBE = function (offset, noAssert) {\n  return readDouble(this, offset, false, noAssert)\n}\n\nBuffer.prototype.writeUInt8 = function (value, offset, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset < this.length, 'trying to write beyond buffer length')\n    verifuint(value, 0xff)\n  }\n\n  if (offset >= this.length) return\n\n  this[offset] = value\n  return offset + 1\n}\n\nfunction writeUInt16 (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 1 < buf.length, 'trying to write beyond buffer length')\n    verifuint(value, 0xffff)\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  for (var i = 0, j = Math.min(len - offset, 2); i < j; i++) {\n    buf[offset + i] =\n        (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n            (littleEndian ? i : 1 - i) * 8\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16LE = function (value, offset, noAssert) {\n  return writeUInt16(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeUInt16BE = function (value, offset, noAssert) {\n  return writeUInt16(this, value, offset, false, noAssert)\n}\n\nfunction writeUInt32 (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 3 < buf.length, 'trying to write beyond buffer length')\n    verifuint(value, 0xffffffff)\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  for (var i = 0, j = Math.min(len - offset, 4); i < j; i++) {\n    buf[offset + i] =\n        (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32LE = function (value, offset, noAssert) {\n  return writeUInt32(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeUInt32BE = function (value, offset, noAssert) {\n  return writeUInt32(this, value, offset, false, noAssert)\n}\n\nBuffer.prototype.writeInt8 = function (value, offset, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset < this.length, 'Trying to write beyond buffer length')\n    verifsint(value, 0x7f, -0x80)\n  }\n\n  if (offset >= this.length)\n    return\n\n  if (value >= 0)\n    this.writeUInt8(value, offset, noAssert)\n  else\n    this.writeUInt8(0xff + value + 1, offset, noAssert)\n  return offset + 1\n}\n\nfunction writeInt16 (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 1 < buf.length, 'Trying to write beyond buffer length')\n    verifsint(value, 0x7fff, -0x8000)\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  if (value >= 0)\n    writeUInt16(buf, value, offset, littleEndian, noAssert)\n  else\n    writeUInt16(buf, 0xffff + value + 1, offset, littleEndian, noAssert)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16LE = function (value, offset, noAssert) {\n  return writeInt16(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeInt16BE = function (value, offset, noAssert) {\n  return writeInt16(this, value, offset, false, noAssert)\n}\n\nfunction writeInt32 (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 3 < buf.length, 'Trying to write beyond buffer length')\n    verifsint(value, 0x7fffffff, -0x80000000)\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  if (value >= 0)\n    writeUInt32(buf, value, offset, littleEndian, noAssert)\n  else\n    writeUInt32(buf, 0xffffffff + value + 1, offset, littleEndian, noAssert)\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32LE = function (value, offset, noAssert) {\n  return writeInt32(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeInt32BE = function (value, offset, noAssert) {\n  return writeInt32(this, value, offset, false, noAssert)\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 3 < buf.length, 'Trying to write beyond buffer length')\n    verifIEEE754(value, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 7 < buf.length,\n        'Trying to write beyond buffer length')\n    verifIEEE754(value, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// fill(value, start=0, end=buffer.length)\nBuffer.prototype.fill = function (value, start, end) {\n  if (!value) value = 0\n  if (!start) start = 0\n  if (!end) end = this.length\n\n  assert(end >= start, 'end < start')\n\n  // Fill 0 bytes; we're done\n  if (end === start) return\n  if (this.length === 0) return\n\n  assert(start >= 0 && start < this.length, 'start out of bounds')\n  assert(end >= 0 && end <= this.length, 'end out of bounds')\n\n  var i\n  if (typeof value === 'number') {\n    for (i = start; i < end; i++) {\n      this[i] = value\n    }\n  } else {\n    var bytes = utf8ToBytes(value.toString())\n    var len = bytes.length\n    for (i = start; i < end; i++) {\n      this[i] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\nBuffer.prototype.inspect = function () {\n  var out = []\n  var len = this.length\n  for (var i = 0; i < len; i++) {\n    out[i] = toHex(this[i])\n    if (i === exports.INSPECT_MAX_BYTES) {\n      out[i + 1] = '...'\n      break\n    }\n  }\n  return '<Buffer ' + out.join(' ') + '>'\n}\n\n/**\n * Creates a new `ArrayBuffer` with the *copied* memory of the buffer instance.\n * Added in Node 0.12. Only available in browsers that support ArrayBuffer.\n */\nBuffer.prototype.toArrayBuffer = function () {\n  if (typeof Uint8Array !== 'undefined') {\n    if (Buffer._useTypedArrays) {\n      return (new Buffer(this)).buffer\n    } else {\n      var buf = new Uint8Array(this.length)\n      for (var i = 0, len = buf.length; i < len; i += 1) {\n        buf[i] = this[i]\n      }\n      return buf.buffer\n    }\n  } else {\n    throw new Error('Buffer.toArrayBuffer not supported in this browser')\n  }\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar BP = Buffer.prototype\n\n/**\n * Augment a Uint8Array *instance* (not the Uint8Array class!) with Buffer methods\n */\nBuffer._augment = function (arr) {\n  arr._isBuffer = true\n\n  // save reference to original Uint8Array get/set methods before overwriting\n  arr._get = arr.get\n  arr._set = arr.set\n\n  // deprecated, will be removed in node 0.13+\n  arr.get = BP.get\n  arr.set = BP.set\n\n  arr.write = BP.write\n  arr.toString = BP.toString\n  arr.toLocaleString = BP.toString\n  arr.toJSON = BP.toJSON\n  arr.equals = BP.equals\n  arr.compare = BP.compare\n  arr.copy = BP.copy\n  arr.slice = BP.slice\n  arr.readUInt8 = BP.readUInt8\n  arr.readUInt16LE = BP.readUInt16LE\n  arr.readUInt16BE = BP.readUInt16BE\n  arr.readUInt32LE = BP.readUInt32LE\n  arr.readUInt32BE = BP.readUInt32BE\n  arr.readInt8 = BP.readInt8\n  arr.readInt16LE = BP.readInt16LE\n  arr.readInt16BE = BP.readInt16BE\n  arr.readInt32LE = BP.readInt32LE\n  arr.readInt32BE = BP.readInt32BE\n  arr.readFloatLE = BP.readFloatLE\n  arr.readFloatBE = BP.readFloatBE\n  arr.readDoubleLE = BP.readDoubleLE\n  arr.readDoubleBE = BP.readDoubleBE\n  arr.writeUInt8 = BP.writeUInt8\n  arr.writeUInt16LE = BP.writeUInt16LE\n  arr.writeUInt16BE = BP.writeUInt16BE\n  arr.writeUInt32LE = BP.writeUInt32LE\n  arr.writeUInt32BE = BP.writeUInt32BE\n  arr.writeInt8 = BP.writeInt8\n  arr.writeInt16LE = BP.writeInt16LE\n  arr.writeInt16BE = BP.writeInt16BE\n  arr.writeInt32LE = BP.writeInt32LE\n  arr.writeInt32BE = BP.writeInt32BE\n  arr.writeFloatLE = BP.writeFloatLE\n  arr.writeFloatBE = BP.writeFloatBE\n  arr.writeDoubleLE = BP.writeDoubleLE\n  arr.writeDoubleBE = BP.writeDoubleBE\n  arr.fill = BP.fill\n  arr.inspect = BP.inspect\n  arr.toArrayBuffer = BP.toArrayBuffer\n\n  return arr\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\n// slice(start, end)\nfunction clamp (index, len, defaultValue) {\n  if (typeof index !== 'number') return defaultValue\n  index = ~~index;  // Coerce to integer.\n  if (index >= len) return len\n  if (index >= 0) return index\n  index += len\n  if (index >= 0) return index\n  return 0\n}\n\nfunction coerce (length) {\n  // Coerce length to a number (possibly NaN), round up\n  // in case it's fractional (e.g. 123.456) then do a\n  // double negate to coerce a NaN to 0. Easy, right?\n  length = ~~Math.ceil(+length)\n  return length < 0 ? 0 : length\n}\n\nfunction isArray (subject) {\n  return (Array.isArray || function (subject) {\n    return Object.prototype.toString.call(subject) === '[object Array]'\n  })(subject)\n}\n\nfunction isArrayish (subject) {\n  return isArray(subject) || Buffer.isBuffer(subject) ||\n      subject && typeof subject === 'object' &&\n      typeof subject.length === 'number'\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; i++) {\n    var b = str.charCodeAt(i)\n    if (b <= 0x7F) {\n      byteArray.push(b)\n    } else {\n      var start = i\n      if (b >= 0xD800 && b <= 0xDFFF) i++\n      var h = encodeURIComponent(str.slice(start, i+1)).substr(1).split('%')\n      for (var j = 0; j < h.length; j++) {\n        byteArray.push(parseInt(h[j], 16))\n      }\n    }\n  }\n  return byteArray\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; i++) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; i++) {\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(str)\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; i++) {\n    if ((i + offset >= dst.length) || (i >= src.length))\n      break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction decodeUtf8Char (str) {\n  try {\n    return decodeURIComponent(str)\n  } catch (err) {\n    return String.fromCharCode(0xFFFD) // UTF 8 invalid char\n  }\n}\n\n/*\n * We have to make sure that the value is a valid integer. This means that it\n * is non-negative. It has no fractional component and that it does not\n * exceed the maximum allowed value.\n */\nfunction verifuint (value, max) {\n  assert(typeof value === 'number', 'cannot write a non-number as a number')\n  assert(value >= 0, 'specified a negative value for writing an unsigned value')\n  assert(value <= max, 'value is larger than maximum value for type')\n  assert(Math.floor(value) === value, 'value has a fractional component')\n}\n\nfunction verifsint (value, max, min) {\n  assert(typeof value === 'number', 'cannot write a non-number as a number')\n  assert(value <= max, 'value larger than maximum allowed value')\n  assert(value >= min, 'value smaller than minimum allowed value')\n  assert(Math.floor(value) === value, 'value has a fractional component')\n}\n\nfunction verifIEEE754 (value, max, min) {\n  assert(typeof value === 'number', 'cannot write a non-number as a number')\n  assert(value <= max, 'value larger than maximum allowed value')\n  assert(value >= min, 'value smaller than minimum allowed value')\n}\n\nfunction assert (test, message) {\n  if (!test) throw new Error(message || 'Failed assertion')\n}\n","/**\n * Module dependencies\n */\nvar _ = require('lodash');\nvar util = require('util');\nvar constants = require('./constants');\n\n\n/**\n * factory\n * \n * @return {Switchback}\n * \n * An anonymous function is used as the base for switchbacks so that\n * they are both dereferenceable AND callable.  This allows functions\n * which accept switchback definitions to maintain compatibility with \n * standard node callback conventions (which are better for many situations).\n * \n * This also means that instantiated switchbacks may be passed interchangably\n * into functions expecting traditional node callbacks, and everything will\n * \"just work\".\n */\n\nmodule.exports = function (callbackContext) {\n\n\tvar _switch = function( /* err, arg1, arg2, ..., argN */ ) {\n\t\tvar args = Array.prototype.slice.call(arguments);\n\n\t\t// Trigger error handler\n\t\tvar err = args[0];\n\t\tif (err) {\n\t\t\treturn _switch.error.apply(callbackContext || this, args);\n\t\t}\n\t\treturn _switch.success.apply(callbackContext || this, args.slice(1));\n\t};\n\n\t// Mark switchback function so it can be identified for tests\n\t_switch[constants.telltale.key] = constants.telltale.value;\n\n\treturn _switch;\n};\n\n","/**\n * Module dependencies\n */\nvar _ = require('lodash');\nvar util = require('util');\n\n\n\nmodule.exports = {\n\n\n\t/**\n\t * `normalize.callback( callback )`\n\t *\n\t * If `callback` is provided as a function, transform it into\n\t * a \"Switchback Definition Object\" by using modified copies\n\t * of the original callback function as error/success handlers.\n\t * \n\t * @param  {Function|Object} callback [cb function or switchback def]\n\t * @return {Object}                   [switchback def]\n\t */\n\tcallback: function _normalizeCallback (callback, callbackContext) {\n\n\t\tif (_.isFunction(callback)) {\n\t\t\tvar _originalCallbackFn = callback;\n\t\t\tcallback = {\n\t\t\t\tsuccess: function() {\n\t\t\t\t\t// Shift arguments over (prepend a `null` first argument)\n\t\t\t\t\t// so this will never be perceived as an `err` when it's \n\t\t\t\t\t// used as a traditional callback\n\t\t\t\t\tvar args = Array.prototype.slice.call(arguments);\n\t\t\t\t\targs.unshift(null);\n\t\t\t\t\t_originalCallbackFn.apply(callbackContext || this, args);\n\t\t\t\t},\n\t\t\t\terror: function() {\n\t\t\t\t\t// Ensure a first arg exists (err)\n\t\t\t\t\t// (if not, prepend an anonymous Error)\n\t\t\t\t\tvar args = Array.prototype.slice.call(arguments);\n\t\t\t\t\tif (!args[0]) {\n\t\t\t\t\t\targs[0] = new Error();\n\t\t\t\t\t}\n\t\t\t\t\t_originalCallbackFn.apply(callbackContext || this, args);\n\t\t\t\t}\n\t\t\t};\n\t\t\tcallback = callback || {};\n\t\t}\n\t\treturn callback;\n\t}\n};\n","module.exports = {\n\n\t// Used to identify a function as a switchback.\n\ttelltale: {\n\t\tkey: '_TELLTALE',\n\t\tvalue: 'a94hgd9gal2gl2bmc,=1aga'\n\t}\n};\n","/**\n * Module dependencies\n */\n\nvar util = require('util');\nvar _ = require('lodash');\nvar rules = require('./rules');\nvar errorFactory = require('./errorFactory');\n\n// var JSValidationError\n\n// Exposes `matchType` as `deepMatchType`.\nmodule.exports = deepMatchType;\n\n\nvar RESERVED_KEYS = {\n  $validate: '$validate',\n  $message: '$message'\n};\n\n// Max depth value\nvar MAX_DEPTH = 50;\n\n\n\n/**\n * Match a complex collection or model against a schema\n *\n * @param {?} data\n * @param {?} ruleset\n * @param {Numeric} depth\n * @param {String} keyName\n * @param {String} customMessage\n *                   (optional)\n * \n * @returns a list of errors (or an empty list if no errors were found)\n */\n\nfunction deepMatchType(data, ruleset, depth, keyName, customMessage) {\n\n  var self = this;\n\n  // Prevent infinite recursion\n  depth = depth || 0;\n  if (depth > MAX_DEPTH) {\n    return [\n      new Error({ message: 'Exceeded MAX_DEPTH when validating object.  Maybe it\\'s recursively referencing itself?'})\n    ];\n  }\n\n  // (1) Base case - primitive\n  // ----------------------------------------------------\n  // If ruleset is not an object or array, use the provided function to validate\n  if (!_.isObject(ruleset)) {\n    return matchType.call(self, data, ruleset, keyName, customMessage);\n  }\n\n\n  // (2) Recursive case - Array\n  // ----------------------------------------------------\n  // If this is a schema rule, check each item in the data collection\n  else if (_.isArray(ruleset)) {\n    if (ruleset.length !== 0) {\n      if (ruleset.length > 1) {\n        return [\n          new Error({ message: '[] (or schema) rules must contain exactly one item.'})\n        ];\n      }\n\n      // Handle plurals (arrays with a schema rule)\n      // Match each object in data array against ruleset until error is detected\n      return _.reduce(data, function getErrors(errors, datum) {\n        errors = errors.concat(deepMatchType.call(self, datum, ruleset[0], depth + 1, keyName, customMessage));\n        return errors;\n      }, []);\n    }\n    // Leaf rules land here and execute the iterator fn\n    else return matchType.call(self, data, ruleset, keyName, customMessage);\n  }\n\n  // (3) Recursive case - POJO\n  // ----------------------------------------------------\n  // If the current rule is an object, check each key\n  else {\n\n    // Note:\n    // \n    // We take advantage of a couple of preconditions at this point:\n    // (a) ruleset must be an Object\n    // (b) ruleset must NOT be an Array\n\n\n    //  *** Check for special reserved keys ***\n\n    // { $message: '...' } specified as data type\n    // uses supplied message instead of the default\n    var _customMessage = ruleset[RESERVED_KEYS.$message];\n\n    // { $validate: {...} } specified as data type\n    // runs a sub-validation (recursive)\n    var subValidation = ruleset[RESERVED_KEYS.$validate];\n\n    // Don't allow a `$message` without a `$validate`\n    if (_customMessage) {\n      if (!subValidation) {\n        return [{\n          code: 'E_USAGE',\n          status: 500,\n          $message: _customMessage,\n          property: keyName,\n          message: 'Custom messages ($message) require a subvalidation - please specify a `$validate` option on `'+keyName+'`'\n        }];\n      }\n      else {\n        // Use the specified message as the `customMessage`\n        customMessage = _customMessage;\n      }\n    }\n\n    // Execute subvalidation rules\n    if (subValidation) {\n      if (!subValidation.type) {\n        return [\n          new Error({message: 'Sub-validation rules (i.e. using $validate) other than `type` are not currently supported'})\n        ];\n      }\n\n      return deepMatchType.call(self, data, subValidation.type, depth+1, keyName, customMessage);\n    }\n    \n\n\n    \n\n    // Don't treat empty object as a ruleset\n    // Instead, treat it as 'object'\n    if (_.keys(ruleset).length === 0) {\n      return matchType.call(self, data, ruleset, keyName, customMessage);\n    } else {\n      // Iterate through rules in dictionary until error is detected\n      return _.reduce(ruleset, function(errors, subRule, key) {\n\n        // Prevent throwing when encountering unexpectedly \"shallow\" data\n        // (instead- this should be pushed as an error where \"undefined\" is\n        // not of the expected type: \"object\")\n        if (!_.isObject(data)) {\n          return errors.concat(errorFactory(data, 'object', key, customMessage));\n        } else {\n          return errors.concat(deepMatchType.call(self, data[key], ruleset[key], depth + 1, key, customMessage));\n        }\n      }, []);\n    }\n  }\n}\n\n\n\n/**\n * `matchType()`\n * \n * Return whether a piece of data matches a rule\n *\n * @param {?} datum\n * @param {Array|Object|String|Regexp} ruleName\n * @param {String} keyName\n * @param {String} customMessage\n *                      (optional)\n *\n * @returns a list of errors, or an empty list in the absense of them\n * @api private\n */\n\nfunction matchType(datum, ruleName, keyName, customMessage) {\n\n  var self = this;\n\n  try {\n    var rule;\n    var outcome;\n\n    // Determine rule\n    if (_.isEqual(ruleName, [])) {\n      // [] specified as data type checks for an array\n      rule = _.isArray;\n    }\n    else if (_.isEqual(ruleName, {})) {\n      // {} specified as data type checks for any object\n      rule = _.isObject;\n    }\n    else if (_.isRegExp(ruleName)) {\n      // Allow regexes to be used\n      rule = function(x) {\n        // If argument to regex rule is not a string,\n        // fail on 'string' validation\n        if (!_.isString(x)) {\n          rule = rules['string'];\n        } else x.match.call(self, ruleName);\n      };\n    }\n    // Lookup rule\n    else rule = rules[ruleName];\n\n\n    // Determine outcome\n    if (!rule) {\n      return [\n        new Error({message:'Unknown rule: ' + ruleName})\n      ];\n    }\n    else outcome = rule.call(self, datum);\n\n    // If validation failed, return an error\n    if (!outcome) {\n      return errorFactory(datum, ruleName, keyName, customMessage);\n    }\n\n    // If everything is ok, return an empty list\n    else return [];\n  }\n  catch (e) {\n    return errorFactory(datum, ruleName, keyName, customMessage);\n  }\n\n}\n\n","/**\n * Module dependencies\n */\n\nvar util = require('util');\nvar _ = require('lodash');\nvar rules = require('./rules');\n\n\n/**\n * Match a miscellaneous rule\n * Returns an empty list on success,\n * or a list of errors if things go wrong\n */\n\nmodule.exports = function matchRule (data, ruleName, args) {\n  var self = this,\n    errors = [];\n\n  // if args is an array we need to make it a nested array\n  if (Array.isArray(args)) {\n    args = [args];\n  }\n\n  // Ensure args is a list, then prepend it with data\n  if (!_.isArray(args)) {\n    args = [args];\n  }\n\n  // push data on to front\n  args.unshift(data);\n\n  // Lookup rule and determine outcome\n  var outcome;\n  var rule = rules[ruleName];\n  if (!rule) {\n    throw new Error('Unknown rule: ' + ruleName);\n  }\n  try {\n    outcome = rule.apply(self, args);\n  } catch (e) {\n    outcome = false;\n  }\n\n  // If outcome is false, an error occurred\n  if (!outcome) {\n    return [{\n      rule: ruleName,\n      data: data,\n      message: util.format('\"%s\" validation rule failed for input: %s', ruleName, util.inspect(data))\n    }];\n  }\n  else {\n    return [];\n  }\n\n};\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\nvar util = require('util');\nvar _where = require('./filters/where');\nvar _limit = require('./filters/limit');\nvar _skip = require('./filters/skip');\nvar _select = require('./projections/select');\nvar _groupBy = require('./projections/groupBy');\nvar _sort = require('./sort');\n\n\n\n/**\n * Filter/aggregate/partition/map the tuples known as `classifier`\n * in `data` using `criteria` (a Waterline criteria object)\n * \n * @param  { Object[] }           data\n * @param  { Object }             criteria         [the Waterline criteria object- complete w/ `where`, `limit`, `sort, `skip`, and `joins`]\n * \n * @return { Integer | Object | Object[] }\n */\n\nmodule.exports = function query ( /* classifier|tuples, data|criteria [, criteria] */ ) {\n  \n  // Embed an `INDEX_IN_ORIG_DATA` for each tuple to remember its original index\n  // within `data`.  At the end, we'll lookup the `INDEX_IN_ORIG_DATA` for each tuple\n  // and expose it as part of our results.\n  var INDEX_IN_ORIG_DATA = '.(ørigindex)';\n\n  var tuples, classifier, data, criteria;\n\n  // If no classifier is provided, and data was specified as an array\n  // instead of an object, infer tuples from the array\n  if (_.isArray(arguments[0]) && !arguments[2]) {\n    tuples = arguments[0];\n    criteria = arguments[1];\n  }\n  // If all three arguments were supplied:\n  // get tuples of type `classifier` (i.e. SELECT * FROM __________)\n  // and clone 'em.\n  else {\n    classifier = arguments[0];\n    data = arguments[1];\n    criteria = arguments[2];\n    tuples = data[classifier];\n  }\n\n  // Clone tuples to avoid dirtying things up\n  tuples = _.cloneDeep(tuples);\n\n  // Embed `INDEX_IN_ORIG_DATA` in each tuple\n  _.each(tuples, function(tuple, i) {\n    tuple[INDEX_IN_ORIG_DATA] = i;\n  });\n\n  // Ensure criteria object exists\n  criteria = criteria || {};\n\n  // Query and return result set using criteria\n  tuples = _where(tuples, criteria.where);\n  tuples = _sort(tuples, criteria.sort);\n  tuples = _skip(tuples, criteria.skip);\n  tuples = _limit(tuples, criteria.limit);\n  tuples = _select(tuples, criteria.select);\n  \n  // TODO:\n  // tuples = _groupBy(tuples, criteria.groupBy);\n\n  // Grab the INDEX_IN_ORIG_DATA from each matched tuple\n  // this is typically used to update the tuples in the external source data.\n  var originalIndices = _.pluck(tuples, INDEX_IN_ORIG_DATA);\n\n  // Remove INDEX_IN_ORIG_DATA from each tuple--\n  // it is no longer needed.\n  _.each(tuples, function(tuple) {\n    delete tuple[INDEX_IN_ORIG_DATA];\n  });\n\n  return {\n    results: tuples,\n    indices: originalIndices\n  };\n};\n\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\nvar X_ISO_DATE = require('../X_ISO_DATE.constant');\n\n\n\n/**\n * Apply a(nother) `where` filter to `data`\n *\n * @param  { Object[] }  data\n * @param  { Object }    where\n * @return { Object[] }\n */\nmodule.exports = function (data, where) {\n  if( !data ) return data;\n  return _.filter(data, function(tuple) {\n    return matchSet(tuple, where);\n  });\n};\n\n\n\n\n\n\n//////////////////////////\n///\n/// private methods   ||\n///                   \\/\n///\n//////////////////////////\n\n\n// Match a model against each criterion in a criteria query\nfunction matchSet(model, criteria, parentKey) {\n\n  // Null or {} WHERE query always matches everything\n  if(!criteria || _.isEqual(criteria, {})) return true;\n\n  // By default, treat entries as AND\n  return _.all(criteria, function(criterion, key) {\n    return matchItem(model, key, criterion, parentKey);\n  });\n}\n\n\nfunction matchOr(model, disjuncts) {\n  var outcomes = [];\n  _.each(disjuncts, function(criteria) {\n    if(matchSet(model, criteria)) outcomes.push(true);\n  });\n\n  var outcome = outcomes.length > 0 ? true : false;\n  return outcome;\n}\n\nfunction matchAnd(model, conjuncts) {\n  var outcome = true;\n  _.each(conjuncts, function(criteria) {\n    if(!matchSet(model, criteria)) outcome = false;\n  });\n  return outcome;\n}\n\nfunction matchLike(model, criteria) {\n  for(var key in criteria) {\n    // Return false if no match is found\n    if (!checkLike(model[key], criteria[key])) return false;\n  }\n  return true;\n}\n\nfunction matchNot(model, criteria) {\n  return !matchSet(model, criteria);\n}\n\nfunction matchItem(model, key, criterion, parentKey) {\n\n  // Handle special attr query\n  if (parentKey) {\n\n    if (key === 'equals' || key === '=' || key === 'equal') {\n      return matchLiteral(model,parentKey,criterion, compare['=']);\n    }\n    else if (key === 'not' || key === '!') {\n\n      // Check for Not In\n      if(Array.isArray(criterion)) {\n\n        var match = false;\n        criterion.forEach(function(val) {\n          if(compare['='](model[parentKey], val)) {\n            match = true;\n          }\n        });\n\n        return match ? false : true;\n      }\n\n      return matchLiteral(model,parentKey,criterion, compare['!']);\n    }\n    else if (key === 'greaterThan' || key === '>') {\n      return matchLiteral(model,parentKey,criterion, compare['>']);\n    }\n    else if (key === 'greaterThanOrEqual' || key === '>=')  {\n      return matchLiteral(model,parentKey,criterion, compare['>=']);\n    }\n    else if (key === 'lessThan' || key === '<')  {\n      return matchLiteral(model,parentKey,criterion, compare['<']);\n    }\n    else if (key === 'lessThanOrEqual' || key === '<=')  {\n      return matchLiteral(model,parentKey,criterion, compare['<=']);\n    }\n    else if (key === 'startsWith') return matchLiteral(model,parentKey,criterion, checkStartsWith);\n    else if (key === 'endsWith') return matchLiteral(model,parentKey,criterion, checkEndsWith);\n    else if (key === 'contains') return matchLiteral(model,parentKey,criterion, checkContains);\n    else if (key === 'like') return matchLiteral(model,parentKey,criterion, checkLike);\n    else throw new Error ('Invalid query syntax!');\n  }\n  else if(key.toLowerCase() === 'or') {\n    return matchOr(model, criterion);\n  } else if(key.toLowerCase() === 'not') {\n    return matchNot(model, criterion);\n  } else if(key.toLowerCase() === 'and') {\n    return matchAnd(model, criterion);\n  } else if(key.toLowerCase() === 'like') {\n    return matchLike(model, criterion);\n  }\n  // IN query\n  else if(_.isArray(criterion)) {\n    return _.any(criterion, function(val) {\n      return compare['='](model[key], val);\n    });\n  }\n\n  // Special attr query\n  else if (_.isObject(criterion) && validSubAttrCriteria(criterion)) {\n    // Attribute is being checked in a specific way\n    return matchSet(model, criterion, key);\n  }\n\n  // Otherwise, try a literal match\n  else return matchLiteral(model,key,criterion, compare['=']);\n\n}\n\n// Comparison fns\nvar compare = {\n\n  // Equalish\n  '=' : function (a,b) {\n    var x = normalizeComparison(a,b);\n    return x[0] == x[1];\n  },\n\n  // Not equalish\n  '!' : function (a,b) {\n    var x = normalizeComparison(a,b);\n    return x[0] != x[1];\n  },\n  '>' : function (a,b) {\n    var x = normalizeComparison(a,b);\n    return x[0] > x[1];\n  },\n  '>=': function (a,b) {\n    var x = normalizeComparison(a,b);\n    return x[0] >= x[1];\n  },\n  '<' : function (a,b) {\n    var x = normalizeComparison(a,b);\n    return x[0] < x[1];\n  },\n  '<=': function (a,b) {\n    var x = normalizeComparison(a,b);\n    return x[0] <= x[1];\n  }\n};\n\n// Prepare two values for comparison\nfunction normalizeComparison(a,b) {\n\n  if(_.isUndefined(a) || a === null) a = '';\n  if(_.isUndefined(b) || b === null) b = '';\n\n  if (_.isString(a) && _.isString(b)) {\n    a = a.toLowerCase();\n    b = b.toLowerCase();\n  }\n\n  // If Comparing dates, keep them as dates\n  if(_.isDate(a) && _.isDate(b)) {\n    return [a,b];\n  }\n  // Otherwise convert them to ISO strings\n  if (_.isDate(a)) { a = a.toISOString(); }\n  if (_.isDate(b)) { b = b.toISOString(); }\n\n\n  // Stringify for comparisons- except for numbers, null, and undefined\n  if (!_.isNumber(a)) {\n    a = typeof a.toString !== 'undefined' ? a.toString() : '' + a;\n  }\n  if (!_.isNumber(b)) {\n    b = typeof b.toString !== 'undefined' ? b.toString() : '' + b;\n  }\n\n  // If comparing date-like things, treat them like dates\n  if (_.isString(a) && _.isString(b) && a.match(X_ISO_DATE) && b.match(X_ISO_DATE)) {\n    return ([new Date(a), new Date(b)]);\n  }\n\n  return [a,b];\n}\n\n// Return whether this criteria is valid as an object inside of an attribute\nfunction validSubAttrCriteria(c) {\n\n  if(!_.isObject(c)) return false;\n\n  var valid = false;\n  var validAttributes = ['not', 'greaterThan', 'lessThan', 'greaterThanOrEqual', 'lessThanOrEqual',\n    '<', '<=', '!', '>', '>=', 'startsWith', 'endsWith', 'contains', 'like'];\n\n  _.each(validAttributes, function(attr) {\n    if(hasOwnProperty(c, attr)) valid = true;\n  });\n\n  return valid;\n}\n\n// Returns whether this value can be successfully parsed as a finite number\nfunction isNumbery (value) {\n  if(_.isDate(value)) return false;\n  return Math.pow(+value, 2) > 0;\n}\n\n// matchFn => the function that will be run to check for a match between the two literals\nfunction matchLiteral(model, key, criterion, matchFn) {\n\n  var val = _.cloneDeep(model[key]);\n\n  // If the criterion are both parsable finite numbers, cast them\n  if(isNumbery(criterion) && isNumbery(val)) {\n    criterion = +criterion;\n    val = +val;\n  }\n\n  // ensure the key attr exists in model\n  if(!model.hasOwnProperty(key)) return false;\n  if(_.isUndefined(criterion)) return false;\n\n  // ensure the key attr matches model attr in model\n  if((!matchFn(val,criterion))) {\n    return false;\n  }\n\n  // Otherwise this is a match\n  return true;\n}\n\n\nfunction checkStartsWith (value, matchString) {\n  // console.log('CheCKING startsWith ', value, 'against matchString:', matchString, 'result:',sqlLikeMatch(value, matchString));\n  return sqlLikeMatch(value, matchString + '%');\n}\nfunction checkEndsWith (value, matchString) {\n  return sqlLikeMatch(value, '%' + matchString);\n}\nfunction checkContains (value, matchString) {\n  return sqlLikeMatch(value, '%' + matchString + '%');\n}\nfunction checkLike (value, matchString) {\n  // console.log('CheCKING  ', value, 'against matchString:', matchString, 'result:',sqlLikeMatch(value, matchString));\n  return sqlLikeMatch(value, matchString);\n}\n\nfunction sqlLikeMatch (value,matchString) {\n\n  if(_.isRegExp(matchString)) {\n    // awesome\n  } else if(_.isString(matchString)) {\n    // Handle escaped percent (%) signs\n    matchString = matchString.replace(/%%%/g, '%');\n\n    // Escape regex\n    matchString = escapeRegExp(matchString);\n\n    // Replace SQL % match notation with something the ECMA regex parser can handle\n    matchString = matchString.replace(/([^%]*)%([^%]*)/g, '$1.*$2');\n\n    // Case insensitive by default\n    // TODO: make this overridable\n    var modifiers = 'i';\n\n    matchString = new RegExp('^' + matchString + '$', modifiers);\n  }\n  // Unexpected match string!\n  else {\n    console.error('matchString:');\n    console.error(matchString);\n    throw new Error('Unexpected match string: ' + matchString + ' Please use a regexp or string.');\n  }\n\n  // Deal with non-strings\n  if(_.isNumber(value)) value = '' + value;\n  else if(_.isBoolean(value)) value = value ? 'true' : 'false';\n  else if(!_.isString(value)) {\n    // Ignore objects, arrays, null, and undefined data for now\n    // (and maybe forever)\n    return false;\n  }\n\n  // Check that criterion attribute and is at least similar to the model's value for that attr\n  if(!value.match(matchString)) {\n    return false;\n  }\n  return true;\n}\n\nfunction escapeRegExp(str) {\n  return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&');\n}\n\n\n\n/**\n * Safer helper for hasOwnProperty checks\n *\n * @param {Object} obj\n * @param {String} prop\n * @return {Boolean}\n * @api public\n */\n\nvar hop = Object.prototype.hasOwnProperty;\nfunction hasOwnProperty(obj, prop) {\n  return hop.call(obj, prop);\n}\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash')\n  , util = require('util');\n\n\n/**\n * Apply a `limit` modifier to `data` using `limit`.\n *\n * @param  { Object[] }  data\n * @param  { Integer }    limit\n * @return { Object[] }\n */\nmodule.exports = function (data, limit) {\n  if( limit === undefined || !data ) return data;\n  if( limit === 0 ) return null;\n  return _.first(data, limit);\n};\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash')\n  , util = require('util');\n\n\n/**\n * Apply a `skip` modifier to `data` using `numToSkip`.\n * \n * @param  { Object[] }  data\n * @param  { Integer }   numToSkip\n * @return { Object[] }\n */\nmodule.exports = function (data, numToSkip) {\n\n  if(!numToSkip || !data) return data;\n  \n  // Ignore the first `numToSkip` tuples\n  return _.rest(data, numToSkip);\n};\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\nvar util = require('util');\nvar X_ISO_DATE = require('./X_ISO_DATE.constant');\n\n\n\n/**\n * Sort the tuples in `data` using `comparator`.\n *\n * @param  { Object[] }  data\n * @param  { Object }    comparator\n * @param  { Function }    when\n * @return { Object[] }\n */\nmodule.exports = function(data, comparator, when) {\n  if (!comparator || !data) return data;\n\n  // Equivalent to a SQL \"WHEN\"\n  when = when||function rankSpecialCase (record, attrName) {\n\n    // null ranks lower than anything else\n    if ( typeof record[attrName]==='undefined' || record[attrName] === null ) {\n      return false;\n    }\n    else return true;\n  };\n\n  return sortData(_.cloneDeep(data), comparator, when);\n};\n\n\n\n//////////////////////////\n///\n/// private methods   ||\n///                   \\/\n///                   \n//////////////////////////\n\n\n\n\n\n\n/**\n * Sort `data` (tuples) using `sortVector` (comparator obj)\n *\n * Based on method described here:\n * http://stackoverflow.com/a/4760279/909625\n *\n * @param  { Object[] } data         [tuples]\n * @param  { Object }   sortVector [mongo-style comparator object]\n * @return { Object[] }\n */\n\nfunction sortData(data, sortVector, when) {\n\n  // Constants\n  var GREATER_THAN = 1;\n  var LESS_THAN = -1;\n  var EQUAL = 0;\n  \n  return data.sort(function comparator(a, b) {\n    return _(sortVector).reduce(function (flagSoFar, sortDirection, attrName){\n\n\n      var outcome;\n\n      // Handle special cases (defined by WHEN):\n      var $a = when(a, attrName);\n      var $b = when(b, attrName);\n      if (!$a && !$b) outcome = EQUAL;\n      else if (!$a && $b) outcome = LESS_THAN;\n      else if ($a && !$b) outcome = GREATER_THAN;\n\n      // General case:\n      else {\n        // Coerce types\n        $a = a[attrName];\n        $b = b[attrName];\n        if ( $a < $b ) outcome = LESS_THAN;\n        else if ( $a > $b ) outcome = GREATER_THAN;\n        else outcome = EQUAL;\n      }\n\n      // Less-Than case (-1)\n      // (leaves flagSoFar untouched if it has been set, otherwise sets it)\n      if ( outcome === LESS_THAN ) {\n        return flagSoFar || -sortDirection;\n      }\n      // Greater-Than case (1)\n      // (leaves flagSoFar untouched if it has been set, otherwise sets it)\n      else if ( outcome === GREATER_THAN ) {\n        return flagSoFar || sortDirection;\n      }\n      // Equals case (0)\n      // (always leaves flagSoFar untouched)\n      else return flagSoFar;\n\n    }, 0);\n  });\n}\n\n\n\n\n\n\n/**\n * Coerce a value to its probable intended type for sorting.\n * \n * @param  {???} x\n * @return {???}\n */\nfunction coerceIntoBestGuessType (x) {\n  switch ( guessType(x) ) {\n    case 'booleanish': return (x==='true')?true:false;\n    case 'numberish': return +x;\n    case 'dateish': return new Date(x);\n    default: return x;\n  }\n}\n\n\nfunction guessType (x) {\n\n  if (!_.isString(x)) {\n    return typeof x;\n  }\n\n  // Probably meant to be a boolean\n  else if (x === 'true' || x === 'false') {\n    return 'booleanish';\n  }\n\n  // Probably meant to be a number\n  else if (+x === x) {\n    return 'numberish';\n  }\n\n  // Probably meant to be a date\n  else if (x.match(X_ISO_DATE)) {\n    return 'dateish';\n  }\n\n  // Just another string\n  else return typeof x;\n}\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash')\n  , util = require('util');\n\n\n/**\n * Partition the tuples in `filteredData` into buckets via `groupByAttribute`.\n * Works with aggregations to allow for powerful reporting queries.\n * \n * @param  { Object[] }  filteredData\n * @param  { String }    groupByAttribute\n * @return { Object[] }\n */\nmodule.exports = function (filteredData, groupByAttribute) {\n  return filteredData;\n};\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash')\n  , util = require('util');\n\n\n/**\n * Project `tuples` on `fields`.\n * \n * @param  { Object[] }  tuples    [i.e. filteredData]\n * @param  { String[]/Object{} }  fields    [i.e. schema]\n * @return { Object[] }\n */\nfunction select (tuples, fields) {\n\n  // If `fields` are not an Object or Array, don't modify the output.\n  if (typeof fields !== 'object') return tuples;\n\n  // If `fields` are specified as an Array, convert them to an Object.\n  if (_.isArray(fields)) {\n    fields = _.reduce(fields, function arrayToObj(memo, attrName) {\n      memo[attrName] = true;\n      return memo;\n    }, {});\n  }\n\n\n  // Finally, select fields from tuples.\n  return _.map(tuples, function (tuple) {\n\n    // Select the requested attributes of the tuple\n    tuple = _.pick(tuple, Object.keys(fields));\n\n    // Take recursive step if necessary to support nested\n    // SELECT clauses (NOT nested modifiers- more like nested\n    // WHEREs)\n    // \n    // e.g.:\n    // like this:\n    //   -> { select: { pet: { collarSize: true } } }\n    //   \n    // not this:\n    //   -> { select: { pet: { select: { collarSize: true } } } }\n    //   \n    _.each(fields, function (subselect, attrName) {\n\n      if (typeof subselect === 'object') {\n        if (_.isArray(tuple[attrName])) {\n          tuple[attrName] = select(tuple[attrName], subselect);\n        }\n        else if (_.isObject(tuple[attrName])) {\n          tuple[attrName] = select([tuple[attrName]], subselect)[0];\n        }\n      }\n    });\n\n    return tuple;\n  });\n}\n\nmodule.exports = select;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// Split a filename into [root, dir, basename, ext], unix version\n// 'root' is just a slash, or nothing.\nvar splitPathRe =\n    /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;\nvar splitPath = function(filename) {\n  return splitPathRe.exec(filename).slice(1);\n};\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function(path) {\n  var result = splitPath(path),\n      root = result[0],\n      dir = result[1];\n\n  if (!root && !dir) {\n    // No dirname whatsoever\n    return '.';\n  }\n\n  if (dir) {\n    // It has a dirname, strip trailing slash\n    dir = dir.substr(0, dir.length - 1);\n  }\n\n  return root + dir;\n};\n\n\nexports.basename = function(path, ext) {\n  var f = splitPath(path)[2];\n  // TODO: make this comparison case-insensitive on windows?\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\n\nexports.extname = function(path) {\n  return splitPath(path)[3];\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  // Allow for deprecating things in the process of starting up.\n  if (isUndefined(global.process)) {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  if (process.noDeprecation === true) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n","/**\n * Module dependencies\n */\n\nvar _ = require('lodash');\nvar util = require('util');\n\n\n/**\n * `errorFactory()`\n * \n * @param  {?} value\n * @param  {String} ruleName\n * @param  {String} keyName\n * @param  {String|Function} customMessage    (optional)\n * \n * @return {Object}\n * \n * @api private\n */\n\nmodule.exports = function errorFactory(value, ruleName, keyName, customMessage) {\n\n  // Construct error message\n  var errMsg;\n  if (_.isString(customMessage)) {\n    errMsg = customMessage;\n  }\n  else if (_.isFunction(customMessage)) {\n    errMsg = customMessage(value, ruleName, keyName);\n  }\n  else {\n    // errMsg = 'Validation error: \"' + value + '\" ';\n    // errMsg += keyName ? '(' + keyName + ') ' : '';\n    // errMsg += 'is not of type \"' + ruleName + '\"';\n\n    errMsg = util.format(\n      '`%s` should be a %s (instead of \"%s\", which is a %s)',\n      keyName, ruleName, value, typeof value\n    );\n  }\n\n\n  // Construct error object\n  return [{\n    property: keyName,\n    data: value,\n    message: errMsg,\n    rule: ruleName,\n    actualType: typeof value,\n    expectedType: ruleName\n  }];\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar Buffer = require('buffer').Buffer;\n\nvar isBufferEncoding = Buffer.isEncoding\n  || function(encoding) {\n       switch (encoding && encoding.toLowerCase()) {\n         case 'hex': case 'utf8': case 'utf-8': case 'ascii': case 'binary': case 'base64': case 'ucs2': case 'ucs-2': case 'utf16le': case 'utf-16le': case 'raw': return true;\n         default: return false;\n       }\n     }\n\n\nfunction assertEncoding(encoding) {\n  if (encoding && !isBufferEncoding(encoding)) {\n    throw new Error('Unknown encoding: ' + encoding);\n  }\n}\n\nvar StringDecoder = exports.StringDecoder = function(encoding) {\n  this.encoding = (encoding || 'utf8').toLowerCase().replace(/[-_]/, '');\n  assertEncoding(encoding);\n  switch (this.encoding) {\n    case 'utf8':\n      // CESU-8 represents each of Surrogate Pair by 3-bytes\n      this.surrogateSize = 3;\n      break;\n    case 'ucs2':\n    case 'utf16le':\n      // UTF-16 represents each of Surrogate Pair by 2-bytes\n      this.surrogateSize = 2;\n      this.detectIncompleteChar = utf16DetectIncompleteChar;\n      break;\n    case 'base64':\n      // Base-64 stores 3 bytes in 4 chars, and pads the remainder.\n      this.surrogateSize = 3;\n      this.detectIncompleteChar = base64DetectIncompleteChar;\n      break;\n    default:\n      this.write = passThroughWrite;\n      return;\n  }\n\n  this.charBuffer = new Buffer(6);\n  this.charReceived = 0;\n  this.charLength = 0;\n};\n\n\nStringDecoder.prototype.write = function(buffer) {\n  var charStr = '';\n  var offset = 0;\n\n  // if our last write ended with an incomplete multibyte character\n  while (this.charLength) {\n    // determine how many remaining bytes this buffer has to offer for this char\n    var i = (buffer.length >= this.charLength - this.charReceived) ?\n                this.charLength - this.charReceived :\n                buffer.length;\n\n    // add the new bytes to the char buffer\n    buffer.copy(this.charBuffer, this.charReceived, offset, i);\n    this.charReceived += (i - offset);\n    offset = i;\n\n    if (this.charReceived < this.charLength) {\n      // still not enough chars in this buffer? wait for more ...\n      return '';\n    }\n\n    // get the character that was split\n    charStr = this.charBuffer.slice(0, this.charLength).toString(this.encoding);\n\n    // lead surrogate (D800-DBFF) is also the incomplete character\n    var charCode = charStr.charCodeAt(charStr.length - 1);\n    if (charCode >= 0xD800 && charCode <= 0xDBFF) {\n      this.charLength += this.surrogateSize;\n      charStr = '';\n      continue;\n    }\n    this.charReceived = this.charLength = 0;\n\n    // if there are no more bytes in this buffer, just emit our char\n    if (i == buffer.length) return charStr;\n\n    // otherwise cut off the characters end from the beginning of this buffer\n    buffer = buffer.slice(i, buffer.length);\n    break;\n  }\n\n  var lenIncomplete = this.detectIncompleteChar(buffer);\n\n  var end = buffer.length;\n  if (this.charLength) {\n    // buffer the incomplete character bytes we got\n    buffer.copy(this.charBuffer, 0, buffer.length - lenIncomplete, end);\n    this.charReceived = lenIncomplete;\n    end -= lenIncomplete;\n  }\n\n  charStr += buffer.toString(this.encoding, 0, end);\n\n  var end = charStr.length - 1;\n  var charCode = charStr.charCodeAt(end);\n  // lead surrogate (D800-DBFF) is also the incomplete character\n  if (charCode >= 0xD800 && charCode <= 0xDBFF) {\n    var size = this.surrogateSize;\n    this.charLength += size;\n    this.charReceived += size;\n    this.charBuffer.copy(this.charBuffer, size, 0, size);\n    this.charBuffer.write(charStr.charAt(charStr.length - 1), this.encoding);\n    return charStr.substring(0, end);\n  }\n\n  // or just emit the charStr\n  return charStr;\n};\n\nStringDecoder.prototype.detectIncompleteChar = function(buffer) {\n  // determine how many bytes we have to check at the end of this buffer\n  var i = (buffer.length >= 3) ? 3 : buffer.length;\n\n  // Figure out if one of the last i bytes of our buffer announces an\n  // incomplete char.\n  for (; i > 0; i--) {\n    var c = buffer[buffer.length - i];\n\n    // See http://en.wikipedia.org/wiki/UTF-8#Description\n\n    // 110XXXXX\n    if (i == 1 && c >> 5 == 0x06) {\n      this.charLength = 2;\n      break;\n    }\n\n    // 1110XXXX\n    if (i <= 2 && c >> 4 == 0x0E) {\n      this.charLength = 3;\n      break;\n    }\n\n    // 11110XXX\n    if (i <= 3 && c >> 3 == 0x1E) {\n      this.charLength = 4;\n      break;\n    }\n  }\n\n  return i;\n};\n\nStringDecoder.prototype.end = function(buffer) {\n  var res = '';\n  if (buffer && buffer.length)\n    res = this.write(buffer);\n\n  if (this.charReceived) {\n    var cr = this.charReceived;\n    var buf = this.charBuffer;\n    var enc = this.encoding;\n    res += buf.slice(0, cr).toString(enc);\n  }\n\n  return res;\n};\n\nfunction passThroughWrite(buffer) {\n  return buffer.toString(this.encoding);\n}\n\nfunction utf16DetectIncompleteChar(buffer) {\n  var incomplete = this.charReceived = buffer.length % 2;\n  this.charLength = incomplete ? 2 : 0;\n  return incomplete;\n}\n\nfunction base64DetectIncompleteChar(buffer) {\n  var incomplete = this.charReceived = buffer.length % 3;\n  this.charLength = incomplete ? 3 : 0;\n  return incomplete;\n}\n","module.exports = Array.isArray || function (arr) {\n  return Object.prototype.toString.call(arr) == '[object Array]';\n};\n","exports.read = function(buffer, offset, isLE, mLen, nBytes) {\n  var e, m,\n      eLen = nBytes * 8 - mLen - 1,\n      eMax = (1 << eLen) - 1,\n      eBias = eMax >> 1,\n      nBits = -7,\n      i = isLE ? (nBytes - 1) : 0,\n      d = isLE ? -1 : 1,\n      s = buffer[offset + i];\n\n  i += d;\n\n  e = s & ((1 << (-nBits)) - 1);\n  s >>= (-nBits);\n  nBits += eLen;\n  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8);\n\n  m = e & ((1 << (-nBits)) - 1);\n  e >>= (-nBits);\n  nBits += mLen;\n  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8);\n\n  if (e === 0) {\n    e = 1 - eBias;\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity);\n  } else {\n    m = m + Math.pow(2, mLen);\n    e = e - eBias;\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen);\n};\n\nexports.write = function(buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c,\n      eLen = nBytes * 8 - mLen - 1,\n      eMax = (1 << eLen) - 1,\n      eBias = eMax >> 1,\n      rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0),\n      i = isLE ? 0 : (nBytes - 1),\n      d = isLE ? 1 : -1,\n      s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0;\n\n  value = Math.abs(value);\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0;\n    e = eMax;\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2);\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--;\n      c *= 2;\n    }\n    if (e + eBias >= 1) {\n      value += rt / c;\n    } else {\n      value += rt * Math.pow(2, 1 - eBias);\n    }\n    if (value * c >= 2) {\n      e++;\n      c /= 2;\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0;\n      e = eMax;\n    } else if (e + eBias >= 1) {\n      m = (value * c - 1) * Math.pow(2, mLen);\n      e = e + eBias;\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen);\n      e = 0;\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8);\n\n  e = (e << mLen) | m;\n  eLen += mLen;\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8);\n\n  buffer[offset + i - d] |= s * 128;\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nfunction isBuffer(arg) {\n  return Buffer.isBuffer(arg);\n}\nexports.isBuffer = isBuffer;\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}","// See http://stackoverflow.com/a/3143231/486547\nmodule.exports = /(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d:[0-5]\\d\\.\\d+([+-][0-2]\\d:[0-5]\\d|Z))|(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d:[0-5]\\d([+-][0-2]\\d:[0-5]\\d|Z))|(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d([+-][0-2]\\d:[0-5]\\d|Z))/;\n","var lookup = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n;(function (exports) {\n\t'use strict';\n\n  var Arr = (typeof Uint8Array !== 'undefined')\n    ? Uint8Array\n    : Array\n\n\tvar ZERO   = '0'.charCodeAt(0)\n\tvar PLUS   = '+'.charCodeAt(0)\n\tvar SLASH  = '/'.charCodeAt(0)\n\tvar NUMBER = '0'.charCodeAt(0)\n\tvar LOWER  = 'a'.charCodeAt(0)\n\tvar UPPER  = 'A'.charCodeAt(0)\n\n\tfunction decode (elt) {\n\t\tvar code = elt.charCodeAt(0)\n\t\tif (code === PLUS)\n\t\t\treturn 62 // '+'\n\t\tif (code === SLASH)\n\t\t\treturn 63 // '/'\n\t\tif (code < NUMBER)\n\t\t\treturn -1 //no match\n\t\tif (code < NUMBER + 10)\n\t\t\treturn code - NUMBER + 26 + 26\n\t\tif (code < UPPER + 26)\n\t\t\treturn code - UPPER\n\t\tif (code < LOWER + 26)\n\t\t\treturn code - LOWER + 26\n\t}\n\n\tfunction b64ToByteArray (b64) {\n\t\tvar i, j, l, tmp, placeHolders, arr\n\n\t\tif (b64.length % 4 > 0) {\n\t\t\tthrow new Error('Invalid string. Length must be a multiple of 4')\n\t\t}\n\n\t\t// the number of equal signs (place holders)\n\t\t// if there are two placeholders, than the two characters before it\n\t\t// represent one byte\n\t\t// if there is only one, then the three characters before it represent 2 bytes\n\t\t// this is just a cheap hack to not do indexOf twice\n\t\tvar len = b64.length\n\t\tplaceHolders = '=' === b64.charAt(len - 2) ? 2 : '=' === b64.charAt(len - 1) ? 1 : 0\n\n\t\t// base64 is 4/3 + up to two characters of the original data\n\t\tarr = new Arr(b64.length * 3 / 4 - placeHolders)\n\n\t\t// if there are placeholders, only get up to the last complete 4 chars\n\t\tl = placeHolders > 0 ? b64.length - 4 : b64.length\n\n\t\tvar L = 0\n\n\t\tfunction push (v) {\n\t\t\tarr[L++] = v\n\t\t}\n\n\t\tfor (i = 0, j = 0; i < l; i += 4, j += 3) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 18) | (decode(b64.charAt(i + 1)) << 12) | (decode(b64.charAt(i + 2)) << 6) | decode(b64.charAt(i + 3))\n\t\t\tpush((tmp & 0xFF0000) >> 16)\n\t\t\tpush((tmp & 0xFF00) >> 8)\n\t\t\tpush(tmp & 0xFF)\n\t\t}\n\n\t\tif (placeHolders === 2) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 2) | (decode(b64.charAt(i + 1)) >> 4)\n\t\t\tpush(tmp & 0xFF)\n\t\t} else if (placeHolders === 1) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 10) | (decode(b64.charAt(i + 1)) << 4) | (decode(b64.charAt(i + 2)) >> 2)\n\t\t\tpush((tmp >> 8) & 0xFF)\n\t\t\tpush(tmp & 0xFF)\n\t\t}\n\n\t\treturn arr\n\t}\n\n\tfunction uint8ToBase64 (uint8) {\n\t\tvar i,\n\t\t\textraBytes = uint8.length % 3, // if we have 1 byte left, pad 2 bytes\n\t\t\toutput = \"\",\n\t\t\ttemp, length\n\n\t\tfunction encode (num) {\n\t\t\treturn lookup.charAt(num)\n\t\t}\n\n\t\tfunction tripletToBase64 (num) {\n\t\t\treturn encode(num >> 18 & 0x3F) + encode(num >> 12 & 0x3F) + encode(num >> 6 & 0x3F) + encode(num & 0x3F)\n\t\t}\n\n\t\t// go through the array every three bytes, we'll deal with trailing stuff later\n\t\tfor (i = 0, length = uint8.length - extraBytes; i < length; i += 3) {\n\t\t\ttemp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])\n\t\t\toutput += tripletToBase64(temp)\n\t\t}\n\n\t\t// pad the end with zeros, but make sure to not forget the extra bytes\n\t\tswitch (extraBytes) {\n\t\t\tcase 1:\n\t\t\t\ttemp = uint8[uint8.length - 1]\n\t\t\t\toutput += encode(temp >> 2)\n\t\t\t\toutput += encode((temp << 4) & 0x3F)\n\t\t\t\toutput += '=='\n\t\t\t\tbreak\n\t\t\tcase 2:\n\t\t\t\ttemp = (uint8[uint8.length - 2] << 8) + (uint8[uint8.length - 1])\n\t\t\t\toutput += encode(temp >> 10)\n\t\t\t\toutput += encode((temp >> 4) & 0x3F)\n\t\t\t\toutput += encode((temp << 2) & 0x3F)\n\t\t\t\toutput += '='\n\t\t\t\tbreak\n\t\t}\n\n\t\treturn output\n\t}\n\n\tmodule.exports.toByteArray = b64ToByteArray\n\tmodule.exports.fromByteArray = uint8ToBase64\n}())\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","/*\n * prompt.js: Simple prompt for prompting information from the command line\n *\n * (C) 2010, Nodejitsu Inc.\n *\n */\n\nvar events = require('events'),\n    readline = require('readline'),\n    utile = require('utile'),\n    async = utile.async,\n    read = require('read'),\n    validate = require('revalidator').validate,\n    winston = require('winston');\n\n//\n// Monkey-punch readline.Interface to work-around\n// https://github.com/joyent/node/issues/3860\n//\nreadline.Interface.prototype.setPrompt = function(prompt, length) {\n  this._prompt = prompt;\n  if (length) {\n    this._promptLength = length;\n  } else {\n    var lines = prompt.split(/[\\r\\n]/);\n    var lastLine = lines[lines.length - 1];\n    this._promptLength = lastLine.replace(/\\u001b\\[(\\d+(;\\d+)*)?m/g, '').length;\n  }\n};\n\n//\n// Expose version using `pkginfo`\n//\nrequire('pkginfo')(module, 'version');\n\nvar stdin, stdout, history = [];\nvar prompt = module.exports = Object.create(events.EventEmitter.prototype);\nvar logger = prompt.logger = new winston.Logger({\n  transports: [new (winston.transports.Console)()]\n});\n\nprompt.started    = false;\nprompt.paused     = false;\nprompt.allowEmpty = false;\nprompt.message    = 'prompt';\nprompt.delimiter  = ': ';\nprompt.colors     = true;\n\n//\n// Create an empty object for the properties\n// known to `prompt`\n//\nprompt.properties = {};\n\n//\n// Setup the default winston logger to use\n// the `cli` levels and colors.\n//\nlogger.cli();\n\n//\n// ### function start (options)\n// #### @options {Object} **Optional** Options to consume by prompt\n// Starts the prompt by listening to the appropriate events on `options.stdin`\n// and `options.stdout`. If no streams are supplied, then `process.stdin`\n// and `process.stdout` are used, respectively.\n//\nprompt.start = function (options) {\n  if (prompt.started) {\n    return;\n  }\n\n  options = options        || {};\n  stdin   = options.stdin  || process.stdin;\n  stdout  = options.stdout || process.stdout;\n\n  //\n  // By default: Remember the last `10` prompt property /\n  // answer pairs and don't allow empty responses globally.\n  //\n  prompt.memory     = options.memory     || 10;\n  prompt.allowEmpty = options.allowEmpty || false;\n  prompt.message    = options.message    || prompt.message;\n  prompt.delimiter  = options.delimiter  || prompt.delimiter;\n  prompt.colors     = options.colors     || prompt.colors;\n\n  if (process.platform !== 'win32') {\n    // windows falls apart trying to deal with SIGINT\n    process.on('SIGINT', function () {\n      stdout.write('\\n');\n      process.exit(1);\n    });\n  }\n\n  prompt.emit('start');\n  prompt.started = true;\n  return prompt;\n};\n\n//\n// ### function pause ()\n// Pauses input coming in from stdin\n//\nprompt.pause = function () {\n  if (!prompt.started || prompt.paused) {\n    return;\n  }\n\n  stdin.pause();\n  prompt.emit('pause');\n  prompt.paused = true;\n  return prompt;\n};\n\n//\n// ### function resume ()\n// Resumes input coming in from stdin\n//\nprompt.resume = function () {\n  if (!prompt.started || !prompt.paused) {\n    return;\n  }\n\n  stdin.resume();\n  prompt.emit('resume');\n  prompt.paused = false;\n  return prompt;\n};\n\n//\n// ### function history (search)\n// #### @search {Number|string} Index or property name to find.\n// Returns the `property:value` pair from within the prompts\n// `history` array.\n//\nprompt.history = function (search) {\n  if (typeof search === 'number') {\n    return history[search] || {};\n  }\n\n  var names = history.map(function (pair) {\n    return typeof pair.property === 'string'\n      ? pair.property\n      : pair.property.name;\n  });\n\n  if (!~names.indexOf(search)) {\n    return null;\n  }\n\n  return history.filter(function (pair) {\n    return typeof pair.property === 'string'\n      ? pair.property === search\n      : pair.property.name === search;\n  })[0];\n};\n\n//\n// ### function get (schema, callback)\n// #### @schema {Array|Object|string} Set of variables to get input for.\n// #### @callback {function} Continuation to pass control to when complete.\n// Gets input from the user via stdin for the specified message(s) `msg`.\n//\nprompt.get = function (schema, callback) {\n  //\n  // Transforms a full JSON-schema into an array describing path and sub-schemas.\n  // Used for iteration purposes.\n  //\n  function untangle(schema, path) {\n    var results = [];\n    path = path || [];\n\n    if (schema.properties) {\n      //\n      // Iterate over the properties in the schema and use recursion\n      // to process sub-properties.\n      //\n      Object.keys(schema.properties).forEach(function (key) {\n        var obj = {};\n        obj[key] = schema.properties[key];\n\n        //\n        // Concat a sub-untangling to the results.\n        //\n        results = results.concat(untangle(obj[key], path.concat(key)));\n      });\n\n      // Return the results.\n      return results;\n    }\n\n    //\n    // This is a schema \"leaf\".\n    //\n    return {\n      path: path,\n      schema: schema\n    };\n  }\n\n  //\n  // Iterate over the values in the schema, represented as\n  // a legit single-property object subschemas. Accepts `schema`\n  // of the forms:\n  //\n  //    'prop-name'\n  //\n  //    ['string-name', { path: ['or-well-formed-subschema'], properties: ... }]\n  //\n  //    { path: ['or-well-formed-subschema'], properties: ... ] }\n  //\n  //    { properties: { 'schema-with-no-path' } }\n  //\n  // And transforms them all into\n  //\n  //    { path: ['path', 'to', 'property'], properties: { path: { to: ...} } }\n  //\n  function iterate(schema, get, done) {\n    var iterator = [],\n        result = {};\n\n    if (typeof schema === 'string') {\n      //\n      // We can iterate over a single string.\n      //\n      iterator.push({\n        path: [schema],\n        schema: prompt.properties[schema.toLowerCase()] || {}\n      });\n    }\n    else if (Array.isArray(schema)) {\n      //\n      // An array of strings and/or single-prop schema and/or no-prop schema.\n      //\n      iterator = schema.map(function (element) {\n        if (typeof element === 'string') {\n          return {\n            path: [element],\n            schema: prompt.properties[element.toLowerCase()] || {}\n          };\n        }\n        else if (element.properties) {\n          return {\n            path: [Object.keys(element.properties)[0]],\n            schema: element.properties[Object.keys(element.properties)[0]]\n          };\n        }\n        else if (element.path && element.schema) {\n          return element;\n        }\n        else {\n          return {\n            path: [element.name || 'question'],\n            schema: element\n          };\n        }\n      });\n    }\n    else if (schema.properties) {\n      //\n      // Or a complete schema `untangle` it for use.\n      //\n      iterator = untangle(schema);\n    }\n    else {\n      //\n      // Or a partial schema and path.\n      // TODO: Evaluate need for this option.\n      //\n      iterator = [{\n        schema: schema.schema ? schema.schema : schema,\n        path: schema.path || [schema.name || 'question']\n      }];\n    }\n\n    //\n    // Now, iterate and assemble the result.\n    //\n    async.forEachSeries(iterator, function (branch, next) {\n      get(branch, function assembler(err, line) {\n        if (err) {\n          return next(err);\n        }\n\n        function build(path, line) {\n          var obj = {};\n          if (path.length) {\n            obj[path[0]] = build(path.slice(1), line);\n            return obj;\n          }\n\n          return line;\n        }\n\n        function attach(obj, attr) {\n          var keys;\n          if (typeof attr !== 'object' || attr instanceof Array) {\n            return attr;\n          }\n\n          keys = Object.keys(attr);\n          if (keys.length) {\n            if (!obj[keys[0]]) {\n              obj[keys[0]] = {};\n            }\n            obj[keys[0]] = attach(obj[keys[0]], attr[keys[0]]);\n          }\n\n          return obj;\n        }\n\n        result = attach(result, build(branch.path, line));\n        next();\n      });\n    }, function (err) {\n      return err ? done(err) : done(null, result);\n    });\n  }\n\n  iterate(schema, function get(target, next) {\n    prompt.getInput(target, function (err, line) {\n      return err ? next(err) : next(null, line);\n    });\n  }, callback);\n\n  return prompt;\n};\n\n//\n// ### function confirm (msg, callback)\n// #### @msg {Array|Object|string} set of message to confirm\n// #### @callback {function} Continuation to pass control to when complete.\n// Confirms a single or series of messages by prompting the user for a Y/N response.\n// Returns `true` if ALL messages are answered in the affirmative, otherwise `false`\n//\n// `msg` can be a string, or object (or array of strings/objects).\n// An object may have the following properties:\n//\n//    {\n//      description: 'yes/no' // message to prompt user\n//      pattern: /^[yntf]{1}/i // optional - regex defining acceptable responses\n//      yes: /^[yt]{1}/i // optional - regex defining `affirmative` responses\n//      message: 'yes/no' // optional - message to display for invalid responses\n//    }\n//\nprompt.confirm = function (/* msg, options, callback */) {\n  var args     = Array.prototype.slice.call(arguments),\n      msg      = args.shift(),\n      callback = args.pop(),\n      opts     = args.shift(),\n      vars     = !Array.isArray(msg) ? [msg] : msg,\n      RX_Y     = /^[yt]{1}/i,\n      RX_YN    = /^[yntf]{1}/i;\n\n  function confirm(target, next) {\n    var yes = target.yes || RX_Y,\n      options = utile.mixin({\n        description: typeof target === 'string' ? target : target.description||'yes/no',\n        pattern: target.pattern || RX_YN,\n        name: 'confirm',\n        message: target.message || 'yes/no'\n      }, opts || {});\n\n\n    prompt.get([options], function (err, result) {\n      next(err ? false : yes.test(result[options.name]));\n    });\n  }\n\n  async.rejectSeries(vars, confirm, function(result) {\n    callback(null, result.length===0);\n  });\n};\n\n\n// Variables needed outside of getInput for multiline arrays.\nvar tmp = [];\n\n\n// ### function getInput (prop, callback)\n// #### @prop {Object|string} Variable to get input for.\n// #### @callback {function} Continuation to pass control to when complete.\n// Gets input from the user via stdin for the specified message `msg`.\n//\nprompt.getInput = function (prop, callback) {\n  var schema = prop.schema || prop,\n      propName = prop.path && prop.path.join(':') || prop,\n      storedSchema = prompt.properties[propName.toLowerCase()],\n      delim = prompt.delimiter,\n      defaultLine,\n      against,\n      hidden,\n      length,\n      valid,\n      name,\n      raw,\n      msg;\n\n  //\n  // If there is a stored schema for `propName` in `propmpt.properties`\n  // then use it.\n  //\n  if (schema instanceof Object && !Object.keys(schema).length &&\n    typeof storedSchema !== 'undefined') {\n    schema = storedSchema;\n  }\n\n  //\n  // Build a proper validation schema if we just have a string\n  // and no `storedSchema`.\n  //\n  if (typeof prop === 'string' && !storedSchema) {\n    schema = {};\n  }\n\n  schema = convert(schema);\n  defaultLine = schema.default;\n  name = prop.description || schema.description || propName;\n  raw = prompt.colors\n    ? [prompt.message, delim + name.grey, delim.grey]\n    : [prompt.message, delim + name, delim];\n\n  prop = {\n    schema: schema,\n    path: propName.split(':')\n  };\n\n  //\n  // If the schema has no `properties` value then set\n  // it to an object containing the current schema\n  // for `propName`.\n  //\n  if (!schema.properties) {\n    schema = (function () {\n      var obj = { properties: {} };\n      obj.properties[propName] = schema;\n      return obj;\n    })();\n  }\n\n  //\n  // Handle overrides here.\n  // TODO: Make overrides nestable\n  //\n  if (prompt.override && prompt.override[propName]) {\n    if (prompt._performValidation(name, prop, prompt.override, schema, -1, callback)) {\n      return callback(null, prompt.override[propName]);\n    }\n\n    delete prompt.override[propName];\n  }\n\n  var type = (schema.properties && schema.properties[name] &&\n              schema.properties[name].type || '').toLowerCase().trim(),\n      wait = type === 'array';\n\n  if (type === 'array') {\n    length = prop.schema.maxItems;\n    if (length) {\n      msg = (tmp.length + 1).toString() + '/' + length.toString();\n    }\n    else {\n      msg = (tmp.length + 1).toString();\n    }\n    msg += delim;\n    raw.push(prompt.colors ? msg.grey : msg);\n  }\n\n  //\n  // Calculate the raw length and colorize the prompt\n  //\n  length = raw.join('').length;\n  raw[0] = raw[0];\n  msg = raw.join('');\n\n  if (schema.help) {\n    schema.help.forEach(function (line) {\n      logger.help(line);\n    });\n  }\n\n  //\n  // Emit a \"prompting\" event\n  //\n  prompt.emit('prompt', prop);\n\n  //\n  // If there is no default line, set it to an empty string\n  //\n  if(typeof defaultLine === 'undefined') {\n    defaultLine = '';\n  }\n\n  //\n  // set to string for readline ( will not accept Numbers )\n  //\n  defaultLine = defaultLine.toString();\n\n  //\n  // Make the actual read\n  //\n  read({\n    prompt: msg,\n    silent: prop.schema && prop.schema.hidden,\n    default: defaultLine,\n    input: stdin,\n    output: stdout\n  }, function (err, line) {\n    if (err && wait === false) {\n      return callback(err);\n    }\n\n    var against = {},\n        numericInput,\n        isValid;\n\n    if (line !== '') {\n\n      if (schema.properties[name]) {\n        var type = (schema.properties[name].type || '').toLowerCase().trim() || undefined;\n\n        //\n        // Attempt to parse input as a float if the schema expects a number.\n        //\n        if (type == 'number') {\n          numericInput = parseFloat(line, 10);\n          if (!isNaN(numericInput)) {\n            line = numericInput;\n          }\n        }\n\n        //\n        // Attempt to parse input as a boolean if the schema expects a boolean\n        //\n        if (type == 'boolean') {\n          if(line === \"true\") {\n            line = true;\n          }\n          if(line === \"false\") {\n            line = false;\n          }\n        }\n\n        //\n        // If the type is an array, wait for the end. Fixes #54\n        //\n        if (type == 'array') {\n          var length = prop.schema.maxItems;\n          if (err) {\n            if (err.message == 'canceled') {\n              wait = false;\n              stdout.write('\\n');\n            }\n          }\n          else {\n            if (length) {\n              if (tmp.length + 1 < length) {\n                isValid = false;\n                wait = true;\n              }\n              else {\n                isValid = true;\n                wait = false;\n              }\n            }\n            else {\n              isValid = false;\n              wait = true;\n            }\n            tmp.push(line);\n          }\n          line = tmp;\n        }\n      }\n\n      against[propName] = line;\n    }\n\n    if (prop && prop.schema.before) {\n      line = prop.schema.before(line);\n    }\n\n    // Validate\n    if (isValid === undefined) isValid = prompt._performValidation(name, prop, against, schema, line, callback);\n\n    if (!isValid) {\n      return prompt.getInput(prop, callback);\n    }\n\n    //\n    // Log the resulting line, append this `property:value`\n    // pair to the history for `prompt` and respond to\n    // the callback.\n    //\n    logger.input(line.yellow);\n    prompt._remember(propName, line);\n    callback(null, line);\n\n    // Make sure `tmp` is emptied\n    tmp = [];\n  });\n};\n\n//\n// ### function performValidation (name, prop, against, schema, line, callback)\n// #### @name {Object} Variable name\n// #### @prop {Object|string} Variable to get input for.\n// #### @against {Object} Input\n// #### @schema {Object} Validation schema\n// #### @line {String|Boolean} Input line\n// #### @callback {function} Continuation to pass control to when complete.\n// Perfoms user input validation, print errors if needed and returns value according to validation\n//\nprompt._performValidation = function (name, prop, against, schema, line, callback) {\n  var numericInput, valid, msg;\n\n  try {\n    valid = validate(against, schema);\n  }\n  catch (err) {\n    return (line !== -1) ? callback(err) : false;\n  }\n\n  if (!valid.valid) {\n    msg = line !== -1 ? 'Invalid input for ' : 'Invalid command-line input for ';\n\n    if (prompt.colors) {\n      logger.error(msg + name.grey);\n    }\n    else {\n      logger.error(msg + name);\n    }\n\n    if (prop.schema.message) {\n      logger.error(prop.schema.message);\n    }\n\n    prompt.emit('invalid', prop, line);\n  }\n\n  return valid.valid;\n};\n\n//\n// ### function addProperties (obj, properties, callback)\n// #### @obj {Object} Object to add properties to\n// #### @properties {Array} List of properties to get values for\n// #### @callback {function} Continuation to pass control to when complete.\n// Prompts the user for values each of the `properties` if `obj` does not already\n// have a value for the property. Responds with the modified object.\n//\nprompt.addProperties = function (obj, properties, callback) {\n  properties = properties.filter(function (prop) {\n    return typeof obj[prop] === 'undefined';\n  });\n\n  if (properties.length === 0) {\n    return callback(obj);\n  }\n\n  prompt.get(properties, function (err, results) {\n    if (err) {\n      return callback(err);\n    }\n    else if (!results) {\n      return callback(null, obj);\n    }\n\n    function putNested (obj, path, value) {\n      var last = obj, key;\n\n      while (path.length > 1) {\n        key = path.shift();\n        if (!last[key]) {\n          last[key] = {};\n        }\n\n        last = last[key];\n      }\n\n      last[path.shift()] = value;\n    }\n\n    Object.keys(results).forEach(function (key) {\n      putNested(obj, key.split('.'), results[key]);\n    });\n\n    callback(null, obj);\n  });\n\n  return prompt;\n};\n\n//\n// ### @private function _remember (property, value)\n// #### @property {Object|string} Property that the value is in response to.\n// #### @value {string} User input captured by `prompt`.\n// Prepends the `property:value` pair into the private `history` Array\n// for `prompt` so that it can be accessed later.\n//\nprompt._remember = function (property, value) {\n  history.unshift({\n    property: property,\n    value: value\n  });\n\n  //\n  // If the length of the `history` Array\n  // has exceeded the specified length to remember,\n  // `prompt.memory`, truncate it.\n  //\n  if (history.length > prompt.memory) {\n    history.splice(prompt.memory, history.length - prompt.memory);\n  }\n};\n\n//\n// ### @private function convert (schema)\n// #### @schema {Object} Schema for a property\n// Converts the schema into new format if it is in old format\n//\nfunction convert(schema) {\n  var newProps = Object.keys(validate.messages),\n      newSchema = false,\n      key;\n\n  newProps = newProps.concat(['description', 'dependencies']);\n\n  for (key in schema) {\n    if (newProps.indexOf(key) > 0) {\n      newSchema = true;\n      break;\n    }\n  }\n\n  if (!newSchema || schema.validator || schema.warning || typeof schema.empty !== 'undefined') {\n    schema.description = schema.message;\n    schema.message = schema.warning;\n\n    if (typeof schema.validator === 'function') {\n      schema.conform = schema.validator;\n    } else {\n      schema.pattern = schema.validator;\n    }\n\n    if (typeof schema.empty !== 'undefined') {\n      schema.required = !(schema.empty);\n    }\n\n    delete schema.warning;\n    delete schema.validator;\n    delete schema.empty;\n  }\n\n  return schema;\n}\n","var fs = require('fs');\nvar ltrim = require('underscore.string').ltrim;\n\n\n// Returns false if the directory doesn't exist\nmodule.exports = function requireAll(options) {\n  var files;\n  var modules = {};\n\n  if (typeof(options.force) == 'undefined') {\n    options.force = true;\n  }\n\n  // Sane default for `filter` option\n  if (!options.filter) {\n    options.filter = /(.*)/;\n  }\n\n  // Reset our depth counter the first time\n  if (typeof options._depth === 'undefined') {\n    options._depth = 0;\n  }\n\n  // Bail out if our counter has reached the desired depth\n  // indicated by the user in options.depth\n  if (typeof options.depth !== 'undefined' &&\n    options._depth >= options.depth) {\n    return;\n  }\n\n  // Remember the starting directory\n  if (!options.startDirname) {\n    options.startDirname = options.dirname;\n  }\n\n  try {\n    files = fs.readdirSync(options.dirname);\n  } catch (e) {\n    if (options.optional) return {};\n    else throw new Error('Directory not found: ' + options.dirname);\n  }\n\n  // Iterate through files in the current directory\n  files.forEach(function(file) {\n    var filepath = options.dirname + '/' + file;\n\n    // For directories, continue to recursively include modules\n    if (fs.statSync(filepath).isDirectory()) {\n\n      // Ignore explicitly excluded directories\n      if (excludeDirectory(file)) return;\n\n      // Recursively call requireAll on each child directory\n      modules[file] = requireAll({\n        dirname: filepath,\n        filter: options.filter,\n        pathFilter: options.pathFilter,\n        excludeDirs: options.excludeDirs,\n        startDirname: options.startDirname,\n        dontLoad: options.dontLoad,\n        markDirectories: options.markDirectories,\n        flattenDirectories: options.flattenDirectories,\n        keepDirectoryPath: options.keepDirectoryPath,\n        force: options.force,\n\n        // Keep track of depth\n        _depth: options._depth+1,\n        depth: options.depth\n      });\n\n      if (options.markDirectories || options.flattenDirectories) {\n        modules[file].isDirectory = true;\n      }\n\n      if (options.flattenDirectories) {\n\n        modules = (function flattenDirectories(modules, accum, path) {\n          accum = accum || {};\n          Object.keys(modules).forEach(function(identity) {\n            if (typeof(modules[identity]) !== 'object' && typeof(modules[identity]) !== 'function') {\n              return;\n            }\n            if (modules[identity].isDirectory) {\n              flattenDirectories(modules[identity], accum, path ? path + '/' + identity : identity );\n            } else {\n              accum[options.keepDirectoryPath ? (path ? path + '/' + identity : identity) : identity] = modules[identity];\n            }\n          });\n          return accum;\n        })(modules);\n\n      }\n\n    }\n    // For files, go ahead and add the code to the module map\n    else {\n\n      // Key name for module\n      var identity;\n\n      // Filename filter\n      if (options.filter) {\n        var match = file.match(options.filter);\n        if (!match) return;\n        identity = match[1];\n      }\n\n      // Full relative path filter\n      if (options.pathFilter) {\n        // Peel off relative path\n        var path = filepath.replace(options.startDirname, '');\n\n        // make sure a slash exists on the left side of path\n        path = '/' + ltrim(path, '/');\n\n        var pathMatch = path.match(options.pathFilter);\n        if (!pathMatch) return;\n        identity = pathMatch[2];\n      }\n\n      // Load module into memory (unless `dontLoad` is true)\n      if (options.dontLoad) {\n        modules[identity] = true;\n      } else {\n        if (options.force) {\n          var resolved = require.resolve(filepath);\n          if (require.cache[resolved]) delete require.cache[resolved];\n        }\n        modules[identity] = require(filepath);\n      }\n    }\n  });\n\n  // Pass map of modules back to app code\n  return modules;\n\n  function excludeDirectory(dirname) {\n    return options.excludeDirs && dirname.match(options.excludeDirs);\n  }\n};","//  Underscore.string\n//  (c) 2010 Esa-Matti Suuronen <esa-matti aet suuronen dot org>\n//  Underscore.string is freely distributable under the terms of the MIT license.\n//  Documentation: https://github.com/epeli/underscore.string\n//  Some code is borrowed from MooTools and Alexandru Marasteanu.\n//  Version '2.3.1'\n\n!function(root, String){\n  'use strict';\n\n  // Defining helper functions.\n\n  var nativeTrim = String.prototype.trim;\n  var nativeTrimRight = String.prototype.trimRight;\n  var nativeTrimLeft = String.prototype.trimLeft;\n\n  var parseNumber = function(source) { return source * 1 || 0; };\n\n  var strRepeat = function(str, qty){\n    if (qty < 1) return '';\n    var result = '';\n    while (qty > 0) {\n      if (qty & 1) result += str;\n      qty >>= 1, str += str;\n    }\n    return result;\n  };\n\n  var slice = [].slice;\n\n  var defaultToWhiteSpace = function(characters) {\n    if (characters == null)\n      return '\\\\s';\n    else if (characters.source)\n      return characters.source;\n    else\n      return '[' + _s.escapeRegExp(characters) + ']';\n  };\n\n  var escapeChars = {\n    lt: '<',\n    gt: '>',\n    quot: '\"',\n    amp: '&',\n    apos: \"'\"\n  };\n\n  var reversedEscapeChars = {};\n  for(var key in escapeChars) reversedEscapeChars[escapeChars[key]] = key;\n  reversedEscapeChars[\"'\"] = '#39';\n\n  // sprintf() for JavaScript 0.7-beta1\n  // http://www.diveintojavascript.com/projects/javascript-sprintf\n  //\n  // Copyright (c) Alexandru Marasteanu <alexaholic [at) gmail (dot] com>\n  // All rights reserved.\n\n  var sprintf = (function() {\n    function get_type(variable) {\n      return Object.prototype.toString.call(variable).slice(8, -1).toLowerCase();\n    }\n\n    var str_repeat = strRepeat;\n\n    var str_format = function() {\n      if (!str_format.cache.hasOwnProperty(arguments[0])) {\n        str_format.cache[arguments[0]] = str_format.parse(arguments[0]);\n      }\n      return str_format.format.call(null, str_format.cache[arguments[0]], arguments);\n    };\n\n    str_format.format = function(parse_tree, argv) {\n      var cursor = 1, tree_length = parse_tree.length, node_type = '', arg, output = [], i, k, match, pad, pad_character, pad_length;\n      for (i = 0; i < tree_length; i++) {\n        node_type = get_type(parse_tree[i]);\n        if (node_type === 'string') {\n          output.push(parse_tree[i]);\n        }\n        else if (node_type === 'array') {\n          match = parse_tree[i]; // convenience purposes only\n          if (match[2]) { // keyword argument\n            arg = argv[cursor];\n            for (k = 0; k < match[2].length; k++) {\n              if (!arg.hasOwnProperty(match[2][k])) {\n                throw new Error(sprintf('[_.sprintf] property \"%s\" does not exist', match[2][k]));\n              }\n              arg = arg[match[2][k]];\n            }\n          } else if (match[1]) { // positional argument (explicit)\n            arg = argv[match[1]];\n          }\n          else { // positional argument (implicit)\n            arg = argv[cursor++];\n          }\n\n          if (/[^s]/.test(match[8]) && (get_type(arg) != 'number')) {\n            throw new Error(sprintf('[_.sprintf] expecting number but found %s', get_type(arg)));\n          }\n          switch (match[8]) {\n            case 'b': arg = arg.toString(2); break;\n            case 'c': arg = String.fromCharCode(arg); break;\n            case 'd': arg = parseInt(arg, 10); break;\n            case 'e': arg = match[7] ? arg.toExponential(match[7]) : arg.toExponential(); break;\n            case 'f': arg = match[7] ? parseFloat(arg).toFixed(match[7]) : parseFloat(arg); break;\n            case 'o': arg = arg.toString(8); break;\n            case 's': arg = ((arg = String(arg)) && match[7] ? arg.substring(0, match[7]) : arg); break;\n            case 'u': arg = Math.abs(arg); break;\n            case 'x': arg = arg.toString(16); break;\n            case 'X': arg = arg.toString(16).toUpperCase(); break;\n          }\n          arg = (/[def]/.test(match[8]) && match[3] && arg >= 0 ? '+'+ arg : arg);\n          pad_character = match[4] ? match[4] == '0' ? '0' : match[4].charAt(1) : ' ';\n          pad_length = match[6] - String(arg).length;\n          pad = match[6] ? str_repeat(pad_character, pad_length) : '';\n          output.push(match[5] ? arg + pad : pad + arg);\n        }\n      }\n      return output.join('');\n    };\n\n    str_format.cache = {};\n\n    str_format.parse = function(fmt) {\n      var _fmt = fmt, match = [], parse_tree = [], arg_names = 0;\n      while (_fmt) {\n        if ((match = /^[^\\x25]+/.exec(_fmt)) !== null) {\n          parse_tree.push(match[0]);\n        }\n        else if ((match = /^\\x25{2}/.exec(_fmt)) !== null) {\n          parse_tree.push('%');\n        }\n        else if ((match = /^\\x25(?:([1-9]\\d*)\\$|\\(([^\\)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-fosuxX])/.exec(_fmt)) !== null) {\n          if (match[2]) {\n            arg_names |= 1;\n            var field_list = [], replacement_field = match[2], field_match = [];\n            if ((field_match = /^([a-z_][a-z_\\d]*)/i.exec(replacement_field)) !== null) {\n              field_list.push(field_match[1]);\n              while ((replacement_field = replacement_field.substring(field_match[0].length)) !== '') {\n                if ((field_match = /^\\.([a-z_][a-z_\\d]*)/i.exec(replacement_field)) !== null) {\n                  field_list.push(field_match[1]);\n                }\n                else if ((field_match = /^\\[(\\d+)\\]/.exec(replacement_field)) !== null) {\n                  field_list.push(field_match[1]);\n                }\n                else {\n                  throw new Error('[_.sprintf] huh?');\n                }\n              }\n            }\n            else {\n              throw new Error('[_.sprintf] huh?');\n            }\n            match[2] = field_list;\n          }\n          else {\n            arg_names |= 2;\n          }\n          if (arg_names === 3) {\n            throw new Error('[_.sprintf] mixing positional and named placeholders is not (yet) supported');\n          }\n          parse_tree.push(match);\n        }\n        else {\n          throw new Error('[_.sprintf] huh?');\n        }\n        _fmt = _fmt.substring(match[0].length);\n      }\n      return parse_tree;\n    };\n\n    return str_format;\n  })();\n\n\n\n  // Defining underscore.string\n\n  var _s = {\n\n    VERSION: '2.3.1',\n\n    isBlank: function(str){\n      if (str == null) str = '';\n      return (/^\\s*$/).test(str);\n    },\n\n    stripTags: function(str){\n      if (str == null) return '';\n      return String(str).replace(/<\\/?[^>]+>/g, '');\n    },\n\n    capitalize : function(str){\n      str = str == null ? '' : String(str);\n      return str.charAt(0).toUpperCase() + str.slice(1);\n    },\n\n    chop: function(str, step){\n      if (str == null) return [];\n      str = String(str);\n      step = ~~step;\n      return step > 0 ? str.match(new RegExp('.{1,' + step + '}', 'g')) : [str];\n    },\n\n    clean: function(str){\n      return _s.strip(str).replace(/\\s+/g, ' ');\n    },\n\n    count: function(str, substr){\n      if (str == null || substr == null) return 0;\n\n      str = String(str);\n      substr = String(substr);\n\n      var count = 0,\n        pos = 0,\n        length = substr.length;\n\n      while (true) {\n        pos = str.indexOf(substr, pos);\n        if (pos === -1) break;\n        count++;\n        pos += length;\n      }\n\n      return count;\n    },\n\n    chars: function(str) {\n      if (str == null) return [];\n      return String(str).split('');\n    },\n\n    swapCase: function(str) {\n      if (str == null) return '';\n      return String(str).replace(/\\S/g, function(c){\n        return c === c.toUpperCase() ? c.toLowerCase() : c.toUpperCase();\n      });\n    },\n\n    escapeHTML: function(str) {\n      if (str == null) return '';\n      return String(str).replace(/[&<>\"']/g, function(m){ return '&' + reversedEscapeChars[m] + ';'; });\n    },\n\n    unescapeHTML: function(str) {\n      if (str == null) return '';\n      return String(str).replace(/\\&([^;]+);/g, function(entity, entityCode){\n        var match;\n\n        if (entityCode in escapeChars) {\n          return escapeChars[entityCode];\n        } else if (match = entityCode.match(/^#x([\\da-fA-F]+)$/)) {\n          return String.fromCharCode(parseInt(match[1], 16));\n        } else if (match = entityCode.match(/^#(\\d+)$/)) {\n          return String.fromCharCode(~~match[1]);\n        } else {\n          return entity;\n        }\n      });\n    },\n\n    escapeRegExp: function(str){\n      if (str == null) return '';\n      return String(str).replace(/([.*+?^=!:${}()|[\\]\\/\\\\])/g, '\\\\$1');\n    },\n\n    splice: function(str, i, howmany, substr){\n      var arr = _s.chars(str);\n      arr.splice(~~i, ~~howmany, substr);\n      return arr.join('');\n    },\n\n    insert: function(str, i, substr){\n      return _s.splice(str, i, 0, substr);\n    },\n\n    include: function(str, needle){\n      if (needle === '') return true;\n      if (str == null) return false;\n      return String(str).indexOf(needle) !== -1;\n    },\n\n    join: function() {\n      var args = slice.call(arguments),\n        separator = args.shift();\n\n      if (separator == null) separator = '';\n\n      return args.join(separator);\n    },\n\n    lines: function(str) {\n      if (str == null) return [];\n      return String(str).split(\"\\n\");\n    },\n\n    reverse: function(str){\n      return _s.chars(str).reverse().join('');\n    },\n\n    startsWith: function(str, starts){\n      if (starts === '') return true;\n      if (str == null || starts == null) return false;\n      str = String(str); starts = String(starts);\n      return str.length >= starts.length && str.slice(0, starts.length) === starts;\n    },\n\n    endsWith: function(str, ends){\n      if (ends === '') return true;\n      if (str == null || ends == null) return false;\n      str = String(str); ends = String(ends);\n      return str.length >= ends.length && str.slice(str.length - ends.length) === ends;\n    },\n\n    succ: function(str){\n      if (str == null) return '';\n      str = String(str);\n      return str.slice(0, -1) + String.fromCharCode(str.charCodeAt(str.length-1) + 1);\n    },\n\n    titleize: function(str){\n      if (str == null) return '';\n      return String(str).replace(/(?:^|\\s)\\S/g, function(c){ return c.toUpperCase(); });\n    },\n\n    camelize: function(str){\n      return _s.trim(str).replace(/[-_\\s]+(.)?/g, function(match, c){ return c.toUpperCase(); });\n    },\n\n    underscored: function(str){\n      return _s.trim(str).replace(/([a-z\\d])([A-Z]+)/g, '$1_$2').replace(/[-\\s]+/g, '_').toLowerCase();\n    },\n\n    dasherize: function(str){\n      return _s.trim(str).replace(/([A-Z])/g, '-$1').replace(/[-_\\s]+/g, '-').toLowerCase();\n    },\n\n    classify: function(str){\n      return _s.titleize(String(str).replace(/[\\W_]/g, ' ')).replace(/\\s/g, '');\n    },\n\n    humanize: function(str){\n      return _s.capitalize(_s.underscored(str).replace(/_id$/,'').replace(/_/g, ' '));\n    },\n\n    trim: function(str, characters){\n      if (str == null) return '';\n      if (!characters && nativeTrim) return nativeTrim.call(str);\n      characters = defaultToWhiteSpace(characters);\n      return String(str).replace(new RegExp('\\^' + characters + '+|' + characters + '+$', 'g'), '');\n    },\n\n    ltrim: function(str, characters){\n      if (str == null) return '';\n      if (!characters && nativeTrimLeft) return nativeTrimLeft.call(str);\n      characters = defaultToWhiteSpace(characters);\n      return String(str).replace(new RegExp('^' + characters + '+'), '');\n    },\n\n    rtrim: function(str, characters){\n      if (str == null) return '';\n      if (!characters && nativeTrimRight) return nativeTrimRight.call(str);\n      characters = defaultToWhiteSpace(characters);\n      return String(str).replace(new RegExp(characters + '+$'), '');\n    },\n\n    truncate: function(str, length, truncateStr){\n      if (str == null) return '';\n      str = String(str); truncateStr = truncateStr || '...';\n      length = ~~length;\n      return str.length > length ? str.slice(0, length) + truncateStr : str;\n    },\n\n    /**\n     * _s.prune: a more elegant version of truncate\n     * prune extra chars, never leaving a half-chopped word.\n     * @author github.com/rwz\n     */\n    prune: function(str, length, pruneStr){\n      if (str == null) return '';\n\n      str = String(str); length = ~~length;\n      pruneStr = pruneStr != null ? String(pruneStr) : '...';\n\n      if (str.length <= length) return str;\n\n      var tmpl = function(c){ return c.toUpperCase() !== c.toLowerCase() ? 'A' : ' '; },\n        template = str.slice(0, length+1).replace(/.(?=\\W*\\w*$)/g, tmpl); // 'Hello, world' -> 'HellAA AAAAA'\n\n      if (template.slice(template.length-2).match(/\\w\\w/))\n        template = template.replace(/\\s*\\S+$/, '');\n      else\n        template = _s.rtrim(template.slice(0, template.length-1));\n\n      return (template+pruneStr).length > str.length ? str : str.slice(0, template.length)+pruneStr;\n    },\n\n    words: function(str, delimiter) {\n      if (_s.isBlank(str)) return [];\n      return _s.trim(str, delimiter).split(delimiter || /\\s+/);\n    },\n\n    pad: function(str, length, padStr, type) {\n      str = str == null ? '' : String(str);\n      length = ~~length;\n\n      var padlen  = 0;\n\n      if (!padStr)\n        padStr = ' ';\n      else if (padStr.length > 1)\n        padStr = padStr.charAt(0);\n\n      switch(type) {\n        case 'right':\n          padlen = length - str.length;\n          return str + strRepeat(padStr, padlen);\n        case 'both':\n          padlen = length - str.length;\n          return strRepeat(padStr, Math.ceil(padlen/2)) + str\n                  + strRepeat(padStr, Math.floor(padlen/2));\n        default: // 'left'\n          padlen = length - str.length;\n          return strRepeat(padStr, padlen) + str;\n        }\n    },\n\n    lpad: function(str, length, padStr) {\n      return _s.pad(str, length, padStr);\n    },\n\n    rpad: function(str, length, padStr) {\n      return _s.pad(str, length, padStr, 'right');\n    },\n\n    lrpad: function(str, length, padStr) {\n      return _s.pad(str, length, padStr, 'both');\n    },\n\n    sprintf: sprintf,\n\n    vsprintf: function(fmt, argv){\n      argv.unshift(fmt);\n      return sprintf.apply(null, argv);\n    },\n\n    toNumber: function(str, decimals) {\n      if (!str) return 0;\n      str = _s.trim(str);\n      if (!str.match(/^-?\\d+(?:\\.\\d+)?$/)) return NaN;\n      return parseNumber(parseNumber(str).toFixed(~~decimals));\n    },\n\n    numberFormat : function(number, dec, dsep, tsep) {\n      if (isNaN(number) || number == null) return '';\n\n      number = number.toFixed(~~dec);\n      tsep = typeof tsep == 'string' ? tsep : ',';\n\n      var parts = number.split('.'), fnums = parts[0],\n        decimals = parts[1] ? (dsep || '.') + parts[1] : '';\n\n      return fnums.replace(/(\\d)(?=(?:\\d{3})+$)/g, '$1' + tsep) + decimals;\n    },\n\n    strRight: function(str, sep){\n      if (str == null) return '';\n      str = String(str); sep = sep != null ? String(sep) : sep;\n      var pos = !sep ? -1 : str.indexOf(sep);\n      return ~pos ? str.slice(pos+sep.length, str.length) : str;\n    },\n\n    strRightBack: function(str, sep){\n      if (str == null) return '';\n      str = String(str); sep = sep != null ? String(sep) : sep;\n      var pos = !sep ? -1 : str.lastIndexOf(sep);\n      return ~pos ? str.slice(pos+sep.length, str.length) : str;\n    },\n\n    strLeft: function(str, sep){\n      if (str == null) return '';\n      str = String(str); sep = sep != null ? String(sep) : sep;\n      var pos = !sep ? -1 : str.indexOf(sep);\n      return ~pos ? str.slice(0, pos) : str;\n    },\n\n    strLeftBack: function(str, sep){\n      if (str == null) return '';\n      str += ''; sep = sep != null ? ''+sep : sep;\n      var pos = str.lastIndexOf(sep);\n      return ~pos ? str.slice(0, pos) : str;\n    },\n\n    toSentence: function(array, separator, lastSeparator, serial) {\n      separator = separator || ', '\n      lastSeparator = lastSeparator || ' and '\n      var a = array.slice(), lastMember = a.pop();\n\n      if (array.length > 2 && serial) lastSeparator = _s.rtrim(separator) + lastSeparator;\n\n      return a.length ? a.join(separator) + lastSeparator + lastMember : lastMember;\n    },\n\n    toSentenceSerial: function() {\n      var args = slice.call(arguments);\n      args[3] = true;\n      return _s.toSentence.apply(_s, args);\n    },\n\n    slugify: function(str) {\n      if (str == null) return '';\n\n      var from  = \"ąàáäâãåæćęèéëêìíïîłńòóöôõøùúüûñçżź\",\n          to    = \"aaaaaaaaceeeeeiiiilnoooooouuuunczz\",\n          regex = new RegExp(defaultToWhiteSpace(from), 'g');\n\n      str = String(str).toLowerCase().replace(regex, function(c){\n        var index = from.indexOf(c);\n        return to.charAt(index) || '-';\n      });\n\n      return _s.dasherize(str.replace(/[^\\w\\s-]/g, ''));\n    },\n\n    surround: function(str, wrapper) {\n      return [wrapper, str, wrapper].join('');\n    },\n\n    quote: function(str) {\n      return _s.surround(str, '\"');\n    },\n\n    exports: function() {\n      var result = {};\n\n      for (var prop in this) {\n        if (!this.hasOwnProperty(prop) || prop.match(/^(?:include|contains|reverse)$/)) continue;\n        result[prop] = this[prop];\n      }\n\n      return result;\n    },\n\n    repeat: function(str, qty, separator){\n      if (str == null) return '';\n\n      qty = ~~qty;\n\n      // using faster implementation if separator is not needed;\n      if (separator == null) return strRepeat(String(str), qty);\n\n      // this one is about 300x slower in Google Chrome\n      for (var repeat = []; qty > 0; repeat[--qty] = str) {}\n      return repeat.join(separator);\n    },\n\n    levenshtein: function(str1, str2) {\n      if (str1 == null && str2 == null) return 0;\n      if (str1 == null) return String(str2).length;\n      if (str2 == null) return String(str1).length;\n\n      str1 = String(str1); str2 = String(str2);\n\n      var current = [], prev, value;\n\n      for (var i = 0; i <= str2.length; i++)\n        for (var j = 0; j <= str1.length; j++) {\n          if (i && j)\n            if (str1.charAt(j - 1) === str2.charAt(i - 1))\n              value = prev;\n            else\n              value = Math.min(current[j], current[j - 1], prev) + 1;\n          else\n            value = i + j;\n\n          prev = current[j];\n          current[j] = value;\n        }\n\n      return current.pop();\n    }\n  };\n\n  // Aliases\n\n  _s.strip    = _s.trim;\n  _s.lstrip   = _s.ltrim;\n  _s.rstrip   = _s.rtrim;\n  _s.center   = _s.lrpad;\n  _s.rjust    = _s.lpad;\n  _s.ljust    = _s.rpad;\n  _s.contains = _s.include;\n  _s.q        = _s.quote;\n\n  // Exporting\n\n  // CommonJS module is defined\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports)\n      module.exports = _s;\n\n    exports._s = _s;\n  }\n\n  // Register as a named module with AMD.\n  if (typeof define === 'function' && define.amd)\n    define('underscore.string', [], function(){ return _s; });\n\n\n  // Integrate with Underscore.js if defined\n  // or create our own underscore object.\n  root._ = root._ || {};\n  root._.string = root._.str = _s;\n}(this, String);\n","\nmodule.exports = read\n\nvar readline = require('readline')\nvar Mute = require('mute-stream')\n\nfunction read (opts, cb) {\n  if (opts.num) {\n    throw new Error('read() no longer accepts a char number limit')\n  }\n\n  if (typeof opts.default !== 'undefined' &&\n      typeof opts.default !== 'string' &&\n      typeof opts.default !== 'number') {\n    throw new Error('default value must be string or number')\n  }\n\n  var input = opts.input || process.stdin\n  var output = opts.output || process.stdout\n  var prompt = (opts.prompt || '').trim() + ' '\n  var silent = opts.silent\n  var editDef = false\n  var timeout = opts.timeout\n\n  var def = opts.default || ''\n  if (def) {\n    if (silent) {\n      prompt += '(<default hidden>) '\n    } else if (opts.edit) {\n      editDef = true\n    } else {\n      prompt += '(' + def + ') '\n    }\n  }\n  var terminal = !!(opts.terminal || output.isTTY)\n\n  var m = new Mute({ replace: opts.replace, prompt: prompt })\n  m.pipe(output, {end: false})\n  output = m\n  var rlOpts = { input: input, output: output, terminal: terminal }\n\n  if (process.version.match(/^v0\\.6/)) {\n    var rl = readline.createInterface(rlOpts.input, rlOpts.output)\n  } else {\n    var rl = readline.createInterface(rlOpts)\n  }\n\n\n  output.unmute()\n  rl.setPrompt(prompt)\n  rl.prompt()\n  if (silent) {\n    output.mute()\n  } else if (editDef) {\n    rl.line = def\n    rl.cursor = def.length\n    rl._refreshLine()\n  }\n\n  var called = false\n  rl.on('line', onLine)\n  rl.on('error', onError)\n\n  rl.on('SIGINT', function () {\n    rl.close()\n    onError(new Error('canceled'))\n  })\n\n  var timer\n  if (timeout) {\n    timer = setTimeout(function () {\n      onError(new Error('timed out'))\n    }, timeout)\n  }\n\n  function done () {\n    called = true\n    rl.close()\n\n    if (process.version.match(/^v0\\.6/)) {\n      rl.input.removeAllListeners('data')\n      rl.input.removeAllListeners('keypress')\n      rl.input.pause()\n    }\n\n    clearTimeout(timer)\n    output.mute()\n    output.end()\n  }\n\n  function onError (er) {\n    if (called) return\n    done()\n    return cb(er)\n  }\n\n  function onLine (line) {\n    if (called) return\n    if (silent && terminal) {\n      output.unmute()\n      output.write('\\r\\n')\n    }\n    done()\n    // truncate the \\n at the end.\n    line = line.replace(/\\r?\\n$/, '')\n    var isDefault = !!(editDef && line === def)\n    if (def && !line) {\n      isDefault = true\n      line = def\n    }\n    cb(null, line, isDefault)\n  }\n}\n","/*\n * pkginfo.js: Top-level include for the pkginfo module\n *\n * (C) 2011, Charlie Robbins\n *\n */\n \nvar fs = require('fs'),\n    path = require('path');\n\n//\n// ### function pkginfo ([options, 'property', 'property' ..])\n// #### @pmodule {Module} Parent module to read from.\n// #### @options {Object|Array|string} **Optional** Options used when exposing properties.\n// #### @arguments {string...} **Optional** Specified properties to expose.\n// Exposes properties from the package.json file for the parent module on \n// it's exports. Valid usage:\n//\n// `require('pkginfo')()`\n//\n// `require('pkginfo')('version', 'author');`\n//\n// `require('pkginfo')(['version', 'author']);`\n//\n// `require('pkginfo')({ include: ['version', 'author'] });`\n//\nvar pkginfo = module.exports = function (pmodule, options) {\n  var args = [].slice.call(arguments, 2).filter(function (arg) {\n    return typeof arg === 'string';\n  });\n  \n  //\n  // **Parse variable arguments**\n  //\n  if (Array.isArray(options)) {\n    //\n    // If the options passed in is an Array assume that\n    // it is the Array of properties to expose from the\n    // on the package.json file on the parent module.\n    //\n    options = { include: options };\n  }\n  else if (typeof options === 'string') {\n    //\n    // Otherwise if the first argument is a string, then\n    // assume that it is the first property to expose from\n    // the package.json file on the parent module.\n    //\n    options = { include: [options] };\n  }\n  \n  //\n  // **Setup default options**\n  //\n  options = options || {};\n  \n  // ensure that includes have been defined\n  options.include = options.include || [];\n  \n  if (args.length > 0) {\n    //\n    // If additional string arguments have been passed in\n    // then add them to the properties to expose on the \n    // parent module. \n    //\n    options.include = options.include.concat(args);\n  }\n  \n  var pkg = pkginfo.read(pmodule, options.dir).package;\n  Object.keys(pkg).forEach(function (key) {\n    if (options.include.length > 0 && !~options.include.indexOf(key)) {\n      return;\n    }\n    \n    if (!pmodule.exports[key]) {\n      pmodule.exports[key] = pkg[key];\n    }\n  });\n  \n  return pkginfo;\n};\n\n//\n// ### function find (dir)\n// #### @pmodule {Module} Parent module to read from.\n// #### @dir {string} **Optional** Directory to start search from.\n// Searches up the directory tree from `dir` until it finds a directory\n// which contains a `package.json` file. \n//\npkginfo.find = function (pmodule, dir) {\n  if (! dir) {\n    dir = path.dirname(pmodule.filename);\n  }\n  \n  var files = fs.readdirSync(dir);\n  \n  if (~files.indexOf('package.json')) {\n    return path.join(dir, 'package.json');\n  }\n  \n  if (dir === '/') {\n    throw new Error('Could not find package.json up from: ' + dir);\n  }\n  else if (!dir || dir === '.') {\n    throw new Error('Cannot find package.json from unspecified directory');\n  }\n  \n  return pkginfo.find(pmodule, path.dirname(dir));\n};\n\n//\n// ### function read (pmodule, dir)\n// #### @pmodule {Module} Parent module to read from.\n// #### @dir {string} **Optional** Directory to start search from.\n// Searches up the directory tree from `dir` until it finds a directory\n// which contains a `package.json` file and returns the package information.\n//\npkginfo.read = function (pmodule, dir) { \n  dir = pkginfo.find(pmodule, dir);\n  \n  var data = fs.readFileSync(dir).toString();\n      \n  return {\n    dir: dir, \n    package: JSON.parse(data)\n  };\n};\n\n//\n// Call `pkginfo` on this module and expose version.\n//\npkginfo(module, {\n  dir: __dirname,\n  include: ['version'],\n  target: pkginfo\n});","(function (exports) {\n  exports.validate = validate;\n  exports.mixin = mixin;\n\n  //\n  // ### function validate (object, schema, options)\n  // #### {Object} object the object to validate.\n  // #### {Object} schema (optional) the JSON Schema to validate against.\n  // #### {Object} options (optional) options controlling the validation\n  //      process. See {@link #validate.defaults) for details.\n  // Validate <code>object</code> against a JSON Schema.\n  // If <code>object</code> is self-describing (i.e. has a\n  // <code>$schema</code> property), it will also be validated\n  // against the referenced schema. [TODO]: This behaviour bay be\n  // suppressed by setting the {@link #validate.options.???}\n  // option to <code>???</code>.[/TODO]\n  //\n  // If <code>schema</code> is not specified, and <code>object</code>\n  // is not self-describing, validation always passes.\n  //\n  // <strong>Note:</strong> in order to pass options but no schema,\n  // <code>schema</code> <em>must</em> be specified in the call to\n  // <code>validate()</code>; otherwise, <code>options</code> will\n  // be interpreted as the schema. <code>schema</code> may be passed\n  // as <code>null</code>, <code>undefinded</code>, or the empty object\n  // (<code>{}</code>) in this case.\n  //\n  function validate(object, schema, options) {\n    options = mixin({}, options, validate.defaults);\n    var errors = [];\n\n    validateObject(object, schema, options, errors);\n\n    //\n    // TODO: self-described validation\n    // if (! options.selfDescribing) { ... }\n    //\n\n    return {\n      valid: !(errors.length),\n      errors: errors\n    };\n  };\n\n  /**\n   * Default validation options. Defaults can be overridden by\n   * passing an 'options' hash to {@link #validate}. They can\n   * also be set globally be changing the values in\n   * <code>validate.defaults</code> directly.\n   */\n  validate.defaults = {\n      /**\n       * <p>\n       * Enforce 'format' constraints.\n       * </p><p>\n       * <em>Default: <code>true</code></em>\n       * </p>\n       */\n      validateFormats: true,\n      /**\n       * <p>\n       * When {@link #validateFormats} is <code>true</code>,\n       * treat unrecognized formats as validation errors.\n       * </p><p>\n       * <em>Default: <code>false</code></em>\n       * </p>\n       *\n       * @see validation.formats for default supported formats.\n       */\n      validateFormatsStrict: false,\n      /**\n       * <p>\n       * When {@link #validateFormats} is <code>true</code>,\n       * also validate formats defined in {@link #validate.formatExtensions}.\n       * </p><p>\n       * <em>Default: <code>true</code></em>\n       * </p>\n       */\n      validateFormatExtensions: true\n  };\n\n  /**\n   * Default messages to include with validation errors.\n   */\n  validate.messages = {\n      required:         \"is required\",\n      allowEmpty:       \"must not be empty\",\n      minLength:        \"is too short (minimum is %{expected} characters)\",\n      maxLength:        \"is too long (maximum is %{expected} characters)\",\n      pattern:          \"invalid input\",\n      minimum:          \"must be greater than or equal to %{expected}\",\n      maximum:          \"must be less than or equal to %{expected}\",\n      exclusiveMinimum: \"must be greater than %{expected}\",\n      exclusiveMaximum: \"must be less than %{expected}\",\n      divisibleBy:      \"must be divisible by %{expected}\",\n      minItems:         \"must contain more than %{expected} items\",\n      maxItems:         \"must contain less than %{expected} items\",\n      uniqueItems:      \"must hold a unique set of values\",\n      format:           \"is not a valid %{expected}\",\n      conform:          \"must conform to given constraint\",\n      type:             \"must be of %{expected} type\"\n  };\n  validate.messages['enum'] = \"must be present in given enumerator\";\n\n  /**\n   *\n   */\n  validate.formats = {\n    'email':          /^((([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.?$/i,\n    'ip-address':     /^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/i,\n    'ipv6':           /^([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}$/,\n    'date-time':      /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(?:.\\d{1,3})?Z$/,\n    'date':           /^\\d{4}-\\d{2}-\\d{2}$/,\n    'time':           /^\\d{2}:\\d{2}:\\d{2}$/,\n    'color':          /^#[a-z0-9]{6}|#[a-z0-9]{3}|(?:rgb\\(\\s*(?:[+-]?\\d+%?)\\s*,\\s*(?:[+-]?\\d+%?)\\s*,\\s*(?:[+-]?\\d+%?)\\s*\\))aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow$/i,\n    //'style':        (not supported)\n    //'phone':        (not supported)\n    //'uri':          (not supported)\n    'host-name':      /^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\\-]*[A-Za-z0-9])/,\n    'utc-millisec':   {\n      test: function (value) {\n        return typeof(value) === 'number' && value >= 0;\n      }\n    },\n    'regex':          {\n      test: function (value) {\n        try { new RegExp(value) }\n        catch (e) { return false }\n\n        return true;\n      }\n    }\n  };\n\n  /**\n   *\n   */\n  validate.formatExtensions = {\n    'url': /^(https?|ftp|git):\\/\\/(((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:)*@)?(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5]))|((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.?)(:\\d*)?)(\\/((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)+(\\/(([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)*)*)?)?(\\?((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|[\\uE000-\\uF8FF]|\\/|\\?)*)?(\\#((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|\\/|\\?)*)?$/i\n  };\n\n  function mixin(obj) {\n    var sources = Array.prototype.slice.call(arguments, 1);\n    while (sources.length) {\n      var source = sources.shift();\n      if (!source) { continue }\n\n      if (typeof(source) !== 'object') {\n        throw new TypeError('mixin non-object');\n      }\n\n      for (var p in source) {\n        if (source.hasOwnProperty(p)) {\n          obj[p] = source[p];\n        }\n      }\n    }\n\n    return obj;\n  };\n\n  function validateObject(object, schema, options, errors) {\n    var props, allProps = Object.keys(object),\n        visitedProps = [];\n\n    // see 5.2\n    if (schema.properties) {\n      props = schema.properties;\n      for (var p in props) {\n        if (props.hasOwnProperty(p)) {\n          visitedProps.push(p);\n          validateProperty(object, object[p], p, props[p], options, errors);\n        }\n      }\n    }\n\n    // see 5.3\n    if (schema.patternProperties) {\n      props = schema.patternProperties;\n      for (var p in props) {\n        if (props.hasOwnProperty(p)) {\n          var re = new RegExp(p);\n\n          // Find all object properties that are matching `re`\n          for (var k in object) {\n            if (object.hasOwnProperty(k)) {\n              visitedProps.push(k);\n              if (re.exec(k) !== null) {\n                validateProperty(object, object[k], p, props[p], options, errors);\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // see 5.4\n    if (undefined !== schema.additionalProperties) {\n      var i, l;\n\n      var unvisitedProps = allProps.filter(function(k){\n        return -1 === visitedProps.indexOf(k);\n      });\n\n      // Prevent additional properties; each unvisited property is therefore an error\n      if (schema.additionalProperties === false && unvisitedProps.length > 0) {\n        for (i = 0, l = unvisitedProps.length; i < l; i++) {\n          error(\"additionalProperties\", unvisitedProps[i], object[unvisitedProps[i]], false, errors);\n        }\n      }\n      // additionalProperties is a schema and validate unvisited properties against that schema\n      else if (typeof schema.additionalProperties == \"object\" && unvisitedProps.length > 0) {\n        for (i = 0, l = unvisitedProps.length; i < l; i++) {\n          validateProperty(object, object[unvisitedProps[i]], unvisitedProps[i], schema.unvisitedProperties, options, errors);\n        }\n      }\n    }\n\n  };\n\n  function validateProperty(object, value, property, schema, options, errors) {\n    var format,\n        valid,\n        spec,\n        type;\n\n    function constrain(name, value, assert) {\n      if (schema[name] !== undefined && !assert(value, schema[name])) {\n        error(name, property, value, schema, errors);\n      }\n    }\n\n    if (value === undefined) {\n      if (schema.required && schema.type !== 'any') {\n        return error('required', property, undefined, schema, errors);\n      } else {\n        return;\n      }\n    }\n\n    if (options.cast) {\n      if (('integer' === schema.type || 'number' === schema.type) && value == +value) {\n        value = +value;\n        object[property] = value;\n      }\n\n      if ('boolean' === schema.type) {\n        if ('true' === value || '1' === value || 1 === value) {\n          value = true;\n          object[property] = value;\n        }\n\n        if ('false' === value || '0' === value || 0 === value) {\n          value = false;\n          object[property] = value;\n        }\n      }\n    }\n\n    if (schema.format && options.validateFormats) {\n      format = schema.format;\n\n      if (options.validateFormatExtensions) { spec = validate.formatExtensions[format] }\n      if (!spec) { spec = validate.formats[format] }\n      if (!spec) {\n        if (options.validateFormatsStrict) {\n          return error('format', property, value, schema, errors);\n        }\n      }\n      else {\n        if (!spec.test(value)) {\n          return error('format', property, value, schema, errors);\n        }\n      }\n    }\n\n    if (schema['enum'] && schema['enum'].indexOf(value) === -1) {\n      error('enum', property, value, schema, errors);\n    }\n\n    // Dependencies (see 5.8)\n    if (typeof schema.dependencies === 'string' &&\n        object[schema.dependencies] === undefined) {\n      error('dependencies', property, null, schema, errors);\n    }\n\n    if (isArray(schema.dependencies)) {\n      for (var i = 0, l = schema.dependencies.length; i < l; i++) {\n        if (object[schema.dependencies[i]] === undefined) {\n          error('dependencies', property, null, schema, errors);\n        }\n      }\n    }\n\n    if (typeof schema.dependencies === 'object') {\n      validateObject(object, schema.dependencies, options, errors);\n    }\n\n    checkType(value, schema.type, function(err, type) {\n      if (err) return error('type', property, typeof value, schema, errors);\n\n      constrain('conform', value, function (a, e) { return e(a, object) });\n\n      switch (type || (isArray(value) ? 'array' : typeof value)) {\n        case 'string':\n          constrain('allowEmpty', value,        function (a, e) { return e ? e : a !== '' });\n          constrain('minLength',  value.length, function (a, e) { return a >= e });\n          constrain('maxLength',  value.length, function (a, e) { return a <= e });\n          constrain('pattern',    value,        function (a, e) {\n            e = typeof e === 'string'\n              ? e = new RegExp(e)\n              : e;\n            return e.test(a)\n          });\n          break;\n        case 'integer':\n        case 'number':\n          constrain('minimum',     value, function (a, e) { return a >= e });\n          constrain('maximum',     value, function (a, e) { return a <= e });\n          constrain('exclusiveMinimum', value, function (a, e) { return a > e });\n          constrain('exclusiveMaximum', value, function (a, e) { return a < e });\n          constrain('divisibleBy', value, function (a, e) {\n            var multiplier = Math.max((a - Math.floor(a)).toString().length - 2, (e - Math.floor(e)).toString().length - 2);\n            multiplier = multiplier > 0 ? Math.pow(10, multiplier) : 1;\n            return (a * multiplier) % (e * multiplier) === 0\n          });\n          break;\n        case 'array':\n          constrain('items', value, function (a, e) {\n            for (var i = 0, l = a.length; i < l; i++) {\n              validateProperty(object, a[i], property, e, options, errors);\n            }\n            return true;\n          });\n          constrain('minItems', value, function (a, e) { return a.length >= e });\n          constrain('maxItems', value, function (a, e) { return a.length <= e });\n          constrain('uniqueItems', value, function (a) {\n            var h = {};\n\n            for (var i = 0, l = a.length; i < l; i++) {\n              var key = JSON.stringify(a[i]);\n              if (h[key]) return false;\n              h[key] = true;\n            }\n\n            return true;\n          });\n          break;\n        case 'object':\n          // Recursive validation\n          if (schema.properties || schema.patternProperties || schema.additionalProperties) {\n            validateObject(value, schema, options, errors);\n          }\n          break;\n      }\n    });\n  };\n\n  function checkType(val, type, callback) {\n    var result = false,\n        types = isArray(type) ? type : [type];\n\n    // No type - no check\n    if (type === undefined) return callback(null, type);\n\n    // Go through available types\n    // And fine first matching\n    for (var i = 0, l = types.length; i < l; i++) {\n      type = types[i].toLowerCase().trim();\n      if (type === 'string' ? typeof val === 'string' :\n          type === 'array' ? isArray(val) :\n          type === 'object' ? val && typeof val === 'object' &&\n                             !isArray(val) :\n          type === 'number' ? typeof val === 'number' :\n          type === 'integer' ? typeof val === 'number' && ~~val === val :\n          type === 'null' ? val === null :\n          type === 'boolean'? typeof val === 'boolean' :\n          type === 'date' ? isDate(val) :\n          type === 'any' ? typeof val !== 'undefined' : false) {\n        return callback(null, type);\n      }\n    };\n\n    callback(true);\n  };\n\n  function error(attribute, property, actual, schema, errors) {\n    var lookup = { expected: schema[attribute], actual: actual, attribute: attribute, property: property };\n    var message = schema.messages && schema.messages[attribute] || schema.message || validate.messages[attribute] || \"no default message\";\n    message = message.replace(/%\\{([a-z]+)\\}/ig, function (_, match) { return lookup[match.toLowerCase()] || ''; });\n    errors.push({\n      attribute: attribute,\n      property:  property,\n      expected:  schema[attribute],\n      actual:    actual,\n      message:   message\n    });\n  };\n\n  function isArray(value) {\n    var s = typeof value;\n    if (s === 'object') {\n      if (value) {\n        if (typeof value.length === 'number' &&\n           !(value.propertyIsEnumerable('length')) &&\n           typeof value.splice === 'function') {\n           return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  function isDate(value) {\n    var s = typeof value;\n    if (s === 'object') {\n      if (value) {\n        if (typeof value.getTime === 'function') {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n})(typeof module === 'object' && module && module.exports ? module.exports : window);\n","/*\n * index.js: Top-level include for the `utile` module.\n *\n * (C) 2011, Nodejitsu Inc.\n * MIT LICENSE\n *\n */\n\nvar fs = require('fs'),\n    path = require('path'),\n    util = require('util');\n\nvar utile = module.exports;\n\n//\n// Extend the `utile` object with all methods from the\n// core node `util` methods.\n//\nObject.keys(util).forEach(function (key) {\n  utile[key] = util[key];\n});\n\nObject.defineProperties(utile, {\n\n  //\n  // ### function async\n  // Simple wrapper to `require('async')`.\n  //\n  'async': {\n    get: function() {\n      return utile.async = require('async');\n    }\n  },\n\n  //\n  // ### function inflect\n  // Simple wrapper to `require('i')`.\n  //\n  'inflect': {\n    get: function() {\n      return utile.inflect = require('i')();\n    }\n  },\n\n  //\n  // ### function mkdirp\n  // Simple wrapper to `require('mkdirp')`\n  //\n  'mkdirp': {\n    get: function() {\n      return utile.mkdirp = require('mkdirp');\n    }\n  },\n\n  //\n  // ### function deepEqual\n  // Simple wrapper to `require('deep-equal')`\n  // Remark: deepEqual is 4x faster then using assert.deepEqual\n  //         see: https://gist.github.com/2790507\n  //\n  'deepEqual': {\n    get: function() {\n      return utile.deepEqual = require('deep-equal');\n    }\n  },\n\n  //\n  // ### function rimraf\n  // Simple wrapper to `require('rimraf')`\n  //\n  'rimraf': {\n    get: function() {\n      return utile.rimraf = require('rimraf');\n    }\n  },\n\n  //\n  // ### function cpr\n  // Simple wrapper to `require('ncp').ncp`\n  //\n  'cpr': {\n    get: function() {\n      return utile.cpr = require('ncp').ncp;\n    }\n  },\n\n  //\n  // ### @file {Object}\n  // Lazy-loaded `file` module\n  //\n  'file': {\n    get: function() {\n      return utile.file = require('./file');\n    }\n  },\n\n  //\n  // ### @args {Object}\n  // Lazy-loaded `args` module\n  //\n  'args': {\n    get: function() {\n      return utile.args = require('./args');\n    }\n  },\n\n  //\n  // ### @base64 {Object}\n  // Lazy-loaded `base64` object\n  //\n  'base64': {\n    get: function() {\n      return utile.base64 = require('./base64');\n    }\n  },\n\n  //\n  // ### @format {Object}\n  // Lazy-loaded `format` object\n  //\n  'format': {\n    get: function() {\n      return utile.format = require('./format');\n    }\n  }\n\n});\n\n\n//\n// ### function rargs(_args)\n// #### _args {Arguments} Original function arguments\n//\n// Top-level method will accept a javascript \"arguments\" object\n// (the actual keyword \"arguments\" inside any scope) and return\n// back an Array.\n//\nutile.rargs = function (_args, slice) {\n  if (!slice) {\n    slice = 0;\n  }\n\n  var len = (_args || []).length,\n      args = new Array(len - slice),\n      i;\n\n  //\n  // Convert the raw `_args` to a proper Array.\n  //\n  for (i = slice; i < len; i++) {\n    args[i - slice] = _args[i];\n  }\n\n  return args;\n};\n\n//\n// ### function each (obj, iterator)\n// #### @obj {Object} Object to iterate over\n// #### @iterator {function} Continuation to use on each key. `function (value, key, object)`\n// Iterate over the keys of an object.\n//\nutile.each = function (obj, iterator) {\n  Object.keys(obj).forEach(function (key) {\n    iterator(obj[key], key, obj);\n  });\n};\n\n//\n// ### function find (o)\n//\n//\nutile.find = function (obj, pred) {\n  var value, key;\n\n  for (key in obj) {\n    value = obj[key];\n    if (pred(value, key)) {\n      return value;\n    }\n  }\n};\n\n//\n// ### function pad (str, len, chr)\n// ### @str {String} String to pad\n// ### @len {Number} Number of chars to pad str with\n// ### @chr {String} Optional replacement character, defaults to empty space\n// Appends chr to str until it reaches a length of len\n//\nutile.pad = function pad(str, len, chr) {\n  var s;\n  if (!chr) {\n    chr = ' ';\n  }\n  str = str || '';\n  s = str;\n  if (str.length < len) {\n    for (var i = 0; i < (len - str.length); i++) {\n      s += chr;\n    }\n  }\n  return s;\n}\n\n//\n// ### function path (obj, path, value)\n// ### @obj {Object} Object to insert value into\n// ### @path {Array} List of nested keys to insert value at\n// Retreives a value from given Object, `obj`, located at the\n// nested keys, `path`.\n//\nutile.path = function (obj, path) {\n  var key, i;\n\n  for (i in path) {\n    if (typeof obj === 'undefined') {\n      return undefined;\n    }\n\n    key = path[i];\n    obj = obj[key];\n  }\n\n  return obj;\n};\n\n//\n// ### function createPath (obj, path, value)\n// ### @obj {Object} Object to insert value into\n// ### @path {Array} List of nested keys to insert value at\n// ### @value {*} Value to insert into the object.\n// Inserts the `value` into the given Object, `obj`, creating\n// any keys in `path` along the way if necessary.\n//\nutile.createPath = function (obj, path, value) {\n  var key, i;\n\n  for (i in path) {\n    key = path[i];\n    if (!obj[key]) {\n      obj[key] = ((+i + 1 === path.length) ? value : {});\n    }\n\n    obj = obj[key];\n  }\n};\n\n//\n// ### function mixin (target [source0, source1, ...])\n// Copies enumerable properties from `source0 ... sourceN`\n// onto `target` and returns the resulting object.\n//\nutile.mixin = function (target) {\n  utile.rargs(arguments, 1).forEach(function (o) {\n    Object.getOwnPropertyNames(o).forEach(function(attr) {\n      var getter = Object.getOwnPropertyDescriptor(o, attr).get,\n          setter = Object.getOwnPropertyDescriptor(o, attr).set;\n\n      if (!getter && !setter) {\n        target[attr] = o[attr];\n      }\n      else {\n        Object.defineProperty(target, attr, {\n          get: getter,\n          set: setter\n        });\n      }\n    });\n  });\n\n  return target;\n};\n\n\n//\n// ### function capitalize (str)\n// #### @str {string} String to capitalize\n// Capitalizes the specified `str`.\n//\nutile.capitalize = utile.inflect.camelize;\n\n//\n// ### function escapeRegExp (str)\n// #### @str {string} String to be escaped\n// Escape string for use in Javascript regex\n//\nutile.escapeRegExp = function (str) {\n  return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n};\n\n//\n// ### function randomString (length)\n// #### @length {integer} The number of bits for the random base64 string returned to contain\n// randomString returns a pseude-random ASCII string (subset)\n// the return value is a string of length ⌈bits/6⌉ of characters\n// from the base64 alphabet.\n//\nutile.randomString = function (length) {\n  var chars, rand, i, ret, mod, bits;\n\n  chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-';\n  ret = '';\n  // standard 4\n  mod = 4;\n  // default is 16\n  bits = length * mod || 64;\n\n  // in v8, Math.random() yields 32 pseudo-random bits (in spidermonkey it gives 53)\n  while (bits > 0) {\n    // 32-bit integer\n    rand = Math.floor(Math.random() * 0x100000000);\n    //we use the top bits\n    for (i = 26; i > 0 && bits > 0; i -= mod, bits -= mod) {\n      ret += chars[0x3F & rand >>> i];\n    }\n  }\n\n  return ret;\n};\n\n//\n// ### function filter (object, test)\n// #### @obj {Object} Object to iterate over\n// #### @pred {function} Predicate applied to each property. `function (value, key, object)`\n// Returns an object with properties from `obj` which satisfy\n// the predicate `pred`\n//\nutile.filter = function (obj, pred) {\n  var copy;\n  if (Array.isArray(obj)) {\n    copy = [];\n    utile.each(obj, function (val, key) {\n      if (pred(val, key, obj)) {\n        copy.push(val);\n      }\n    });\n  }\n  else {\n    copy = {};\n    utile.each(obj, function (val, key) {\n      if (pred(val, key, obj)) {\n        copy[key] = val;\n      }\n    });\n  }\n  return copy;\n};\n\n//\n// ### function requireDir (directory)\n// #### @directory {string} Directory to require\n// Requires all files and directories from `directory`, returning an object\n// with keys being filenames (without trailing `.js`) and respective values\n// being return values of `require(filename)`.\n//\nutile.requireDir = function (directory) {\n  var result = {},\n      files = fs.readdirSync(directory);\n\n  files.forEach(function (file) {\n    if (file.substr(-3) === '.js') {\n      file = file.substr(0, file.length - 3);\n    }\n    result[file] = require(path.resolve(directory, file));\n  });\n  return result;\n};\n\n//\n// ### function requireDirLazy (directory)\n// #### @directory {string} Directory to require\n// Lazily requires all files and directories from `directory`, returning an\n// object with keys being filenames (without trailing `.js`) and respective\n// values (getters) being return values of `require(filename)`.\n//\nutile.requireDirLazy = function (directory) {\n  var result = {},\n      files = fs.readdirSync(directory);\n\n  files.forEach(function (file) {\n    if (file.substr(-3) === '.js') {\n      file = file.substr(0, file.length - 3);\n    }\n    Object.defineProperty(result, file, {\n      get: function() {\n        return result[file] = require(path.resolve(directory, file));\n      }\n    });\n  });\n  \n  return result;\n};\n\n//\n// ### function clone (object, filter)\n// #### @object {Object} Object to clone\n// #### @filter {Function} Filter to be used\n// Shallow clones the specified object.\n//\nutile.clone = function (object, filter) {\n  return Object.keys(object).reduce(filter ? function (obj, k) {\n    if (filter(k)) obj[k] = object[k];\n    return obj;\n  } : function (obj, k) {\n    obj[k] = object[k];\n    return obj;\n  }, {});\n};\n\n//\n// ### function camelToUnderscore (obj)\n// #### @obj {Object} Object to convert keys on.\n// Converts all keys of the type `keyName` to `key_name` on the\n// specified `obj`.\n//\nutile.camelToUnderscore = function (obj) {\n  if (typeof obj !== 'object' || obj === null) {\n    return obj;\n  }\n\n  if (Array.isArray(obj)) {\n    obj.forEach(utile.camelToUnderscore);\n    return obj;\n  }\n\n  Object.keys(obj).forEach(function (key) {\n    var k = utile.inflect.underscore(key);\n    if (k !== key) {\n      obj[k] = obj[key];\n      delete obj[key];\n      key = k;\n    }\n    utile.camelToUnderscore(obj[key]);\n  });\n\n  return obj;\n};\n\n//\n// ### function underscoreToCamel (obj)\n// #### @obj {Object} Object to convert keys on.\n// Converts all keys of the type `key_name` to `keyName` on the\n// specified `obj`.\n//\nutile.underscoreToCamel = function (obj) {\n  if (typeof obj !== 'object' || obj === null) {\n    return obj;\n  }\n\n  if (Array.isArray(obj)) {\n    obj.forEach(utile.underscoreToCamel);\n    return obj;\n  }\n\n  Object.keys(obj).forEach(function (key) {\n    var k = utile.inflect.camelize(key, false);\n    if (k !== key) {\n      obj[k] = obj[key];\n      delete obj[key];\n      key = k;\n    }\n    utile.underscoreToCamel(obj[key]);\n  });\n\n  return obj;\n};\n","/*\n * winston.js: Top-level include defining Winston.\n *\n * (C) 2010 Charlie Robbins\n * MIT LICENCE\n *\n */\n\nvar winston = exports;\n\n//\n// Expose version using `pkginfo`\n//\nrequire('pkginfo')(module, 'version');\n\n//\n// Include transports defined by default by winston\n//\nwinston.transports = require('./winston/transports');\n\n//\n// Expose utility methods\n//\nvar common             = require('./winston/common');\nwinston.hash           = common.hash;\nwinston.clone          = common.clone;\nwinston.longestElement = common.longestElement;\nwinston.exception      = require('./winston/exception');\nwinston.config         = require('./winston/config');\nwinston.addColors      = winston.config.addColors;\n\n//\n// Expose core Logging-related prototypes.\n//\nwinston.Container      = require('./winston/container').Container;\nwinston.Logger         = require('./winston/logger').Logger;\nwinston.Transport      = require('./winston/transports/transport').Transport;\n\n//\n// We create and expose a default `Container` to `winston.loggers` so that the\n// programmer may manage multiple `winston.Logger` instances without any additional overhead.\n//\n// ### some-file1.js\n//\n//     var logger = require('winston').loggers.get('something');\n//\n// ### some-file2.js\n//\n//     var logger = require('winston').loggers.get('something');\n//\nwinston.loggers = new winston.Container();\n\n//\n// We create and expose a 'defaultLogger' so that the programmer may do the\n// following without the need to create an instance of winston.Logger directly:\n//\n//     var winston = require('winston');\n//     winston.log('info', 'some message');\n//     winston.error('some error');\n//\nvar defaultLogger = new winston.Logger({\n  transports: [new winston.transports.Console()]\n});\n\n//\n// Pass through the target methods onto `winston.\n//\nvar methods = [\n  'log',\n  'query',\n  'stream',\n  'add',\n  'remove',\n  'profile',\n  'startTimer',\n  'extend',\n  'cli',\n  'handleExceptions',\n  'unhandleExceptions'\n];\ncommon.setLevels(winston, null, defaultLogger.levels);\nmethods.forEach(function (method) {\n  winston[method] = function () {\n    return defaultLogger[method].apply(defaultLogger, arguments);\n  };\n});\n\n//\n// ### function cli ()\n// Configures the default winston logger to have the\n// settings for command-line interfaces: no timestamp,\n// colors enabled, padded output, and additional levels.\n//\nwinston.cli = function () {\n  winston.padLevels = true;\n  common.setLevels(winston, defaultLogger.levels, winston.config.cli.levels);\n  defaultLogger.setLevels(winston.config.cli.levels);\n  winston.config.addColors(winston.config.cli.colors);\n\n  if (defaultLogger.transports.console) {\n    defaultLogger.transports.console.colorize = true;\n    defaultLogger.transports.console.timestamp = false;\n  }\n\n  return winston;\n};\n\n//\n// ### function setLevels (target)\n// #### @target {Object} Target levels to use\n// Sets the `target` levels specified on the default winston logger.\n//\nwinston.setLevels = function (target) {\n  common.setLevels(winston, defaultLogger.levels, target);\n  defaultLogger.setLevels(target);\n};\n\n//\n// Define getters / setters for appropriate properties of the\n// default logger which need to be exposed by winston.\n//\n['emitErrs', 'exitOnError', 'padLevels', 'level', 'levelLength', 'stripColors'].forEach(function (prop) {\n  Object.defineProperty(winston, prop, {\n    get: function () {\n      return defaultLogger[prop];\n    },\n    set: function (val) {\n      defaultLogger[prop] = val;\n    }\n  });\n});\n\n//\n// @default {Object}\n// The default transports and exceptionHandlers for\n// the default winston logger.\n//\nObject.defineProperty(winston, 'default', {\n  get: function () {\n    return {\n      transports: defaultLogger.transports,\n      exceptionHandlers: defaultLogger.exceptionHandlers\n    };\n  }\n});\n","/*\n * file.js: Simple utilities for working with the file system.\n *\n * (C) 2011, Nodejitsu Inc.\n * MIT LICENSE\n *\n */\n\nvar fs = require('fs');\n\nexports.readJson = exports.readJSON = function (file, callback) {\n  if (typeof callback !== 'function') {\n    throw new Error('utile.file.readJson needs a callback');\n  }\n\n  fs.readFile(file, 'utf-8', function (err, data) {\n    if (err) {\n      return callback(err);\n    }\n\n    try {\n      var json = JSON.parse(data);\n      callback(null, json);\n    }\n    catch (err) {\n      return callback(err);\n    }\n  });\n};\n\nexports.readJsonSync = exports.readJSONSync = function (file) {\n  return JSON.parse(fs.readFileSync(file, 'utf-8'));\n};\n","/*\n * args.js: function argument parsing helper utility\n *\n * (C) 2012, Nodejitsu Inc.\n * MIT LICENSE\n *\n */\n\nvar utile = require('./index');\n\n//\n// ### function args(_args)\n// #### _args {Arguments} Original function arguments\n//\n// Top-level method will accept a javascript \"arguments\" object (the actual keyword\n// \"arguments\" inside any scope), and attempt to return back an intelligent object\n// representing the functions arguments\n//\nmodule.exports = function (_args) {\n  var args = utile.rargs(_args),\n      _cb;\n\n  //\n  // Find and define the first argument\n  //\n  Object.defineProperty(args, 'first', { value: args[0] });\n\n  //\n  // Find and define any callback\n  //\n  _cb = args[args.length - 1] || args[args.length];\n  if (typeof _cb === \"function\") {\n    Object.defineProperty(args, 'callback', { value: _cb });\n    Object.defineProperty(args, 'cb', { value: _cb });\n    args.pop();\n  }\n\n  //\n  // Find and define the last argument\n  //\n  if (args.length) {\n    Object.defineProperty(args, 'last', { value: args[args.length - 1] });\n  }\n\n  return args;\n};\n","/*\n * base64.js: An extremely simple implementation of base64 encoding / decoding using node.js Buffers\n *\n * (C) 2010, Nodejitsu Inc.\n *\n */\n\nvar base64 = exports;\n\n//\n// ### function encode (unencoded)\n// #### @unencoded {string} The string to base64 encode\n// Encodes the specified string to base64 using node.js Buffers.\n//\nbase64.encode = function (unencoded) {\n  var encoded;\n\n  try {\n    encoded = new Buffer(unencoded || '').toString('base64');\n  }\n  catch (ex) {\n    return null;\n  }\n\n  return encoded;\n};\n\n//\n// ### function decode (encoded)\n// #### @encoded {string} The string to base64 decode\n// Decodes the specified string from base64 using node.js Buffers.\n//\nbase64.decode = function (encoded) {\n  var decoded;\n\n  try {\n    decoded = new Buffer(encoded || '', 'base64').toString('utf8');\n  }\n  catch (ex) {\n    return null;\n  }\n\n  return decoded;\n};","/*\n * format.js: `util.format` enhancement to allow custom formatting parameters.\n *\n * (C) 2012, Nodejitsu Inc.\n * MIT LICENSE\n *\n */\n\nvar util = require('util');\n\nexports = module.exports = function(str) {\n  var formats = [].slice.call(arguments, 1, 3);\n\n  if (!(formats[0] instanceof Array && formats[1] instanceof Array) || arguments.length > 3)\n    return util.format.apply(null, arguments);\n\n  var replacements = formats.pop(),\n      formats = formats.shift();\n\n  formats.forEach(function(format, id) {\n    str = str.replace(new RegExp(format), replacements[id]);\n  });\n\n  return str;\n};\n","/*\n * transports.js: Set of all transports Winston knows about\n *\n * (C) 2010 Charlie Robbins\n * MIT LICENCE\n *\n */\n\nvar fs = require('fs'),\n    path = require('path'),\n    common = require('./common');\n\nvar transports = exports;\n\n//\n// Setup all transports as lazy-loaded getters.\n//\nfs.readdirSync(path.join(__dirname, 'transports')).forEach(function (file) {\n  var transport = file.replace('.js', ''),\n      name  = common.capitalize(transport);\n\n  if (transport === 'transport') {\n    return;\n  }\n\n  transports.__defineGetter__(name, function () {\n    return require('./transports/' + transport)[name];\n  });\n});","/*\n * common.js: Internal helper and utility functions for winston\n *\n * (C) 2010 Charlie Robbins\n * MIT LICENCE\n *\n */\n\nvar util = require('util'),\n    crypto = require('crypto'),\n    cycle = require('cycle'),\n    config = require('./config');\n\n//\n// ### function setLevels (target, past, current)\n// #### @target {Object} Object on which to set levels.\n// #### @past {Object} Previous levels set on target.\n// #### @current {Object} Current levels to set on target.\n// Create functions on the target objects for each level\n// in current.levels. If past is defined, remove functions\n// for each of those levels.\n//\nexports.setLevels = function (target, past, current, isDefault) {\n  if (past) {\n    Object.keys(past).forEach(function (level) {\n      delete target[level];\n    });\n  }\n\n  target.levels = current || config.npm.levels;\n  if (target.padLevels) {\n    target.levelLength = exports.longestElement(Object.keys(target.levels));\n  }\n\n  //\n  //  Define prototype methods for each log level\n  //  e.g. target.log('info', msg) <=> target.info(msg)\n  //\n  Object.keys(target.levels).forEach(function (level) {\n    target[level] = function (msg) {\n      var args     = Array.prototype.slice.call(arguments),\n          callback = typeof args[args.length - 1] === 'function' || !args[args.length - 1] ? args.pop() : null,\n          meta     = args.length === 2 ? args.pop() : null;\n\n      return target.log(level, msg, meta, callback);\n    };\n  });\n\n  return target;\n};\n\n//\n// ### function longestElement\n// #### @xs {Array} Array to calculate against\n// Returns the longest element in the `xs` array.\n//\nexports.longestElement = function (xs) {\n  return Math.max.apply(\n    null,\n    xs.map(function (x) { return x.length; })\n  );\n};\n\n//\n// ### function clone (obj)\n// #### @obj {Object} Object to clone.\n// Helper method for deep cloning pure JSON objects\n// i.e. JSON objects that are either literals or objects (no Arrays, etc)\n//\nexports.clone = function (obj) {\n  // we only need to clone refrence types (Object)\n  if (!(obj instanceof Object)) {\n    return obj;\n  }\n  else if (obj instanceof Date) {\n    return obj;\n  }\n\n  var copy = {};\n  for (var i in obj) {\n    if (Array.isArray(obj[i])) {\n      copy[i] = obj[i].slice(0);\n    }\n    else if (obj[i] instanceof Buffer) {\n        copy[i] = obj[i].slice(0);\n    }\n    else if (typeof obj[i] != 'function') {\n      copy[i] = obj[i] instanceof Object ? exports.clone(obj[i]) : obj[i];\n    }\n  }\n\n  return copy;\n};\n\n//\n// ### function log (options)\n// #### @options {Object} All information about the log serialization.\n// Generic logging function for returning timestamped strings\n// with the following options:\n//\n//    {\n//      level:     'level to add to serialized message',\n//      message:   'message to serialize',\n//      meta:      'additional logging metadata to serialize',\n//      colorize:  false, // Colorizes output (only if `.json` is false)\n//      timestamp: true   // Adds a timestamp to the serialized message\n//    }\n//\nexports.log = function (options) {\n  var timestampFn = typeof options.timestamp === 'function'\n                  ? options.timestamp\n                  : exports.timestamp,\n      timestamp   = options.timestamp ? timestampFn() : null,\n      meta        = options.meta ? exports.clone(cycle.decycle(options.meta)) : null,\n      output;\n\n  //\n  // raw mode is intended for outputing winston as streaming JSON to STDOUT\n  //\n  if (options.raw) {\n    if (typeof meta !== 'object' && meta != null) {\n      meta = { meta: meta };\n    }\n    output         = exports.clone(meta) || {};\n    output.level   = options.level;\n    output.message = options.message.stripColors;\n    return JSON.stringify(output);\n  }\n\n  //\n  // json mode is intended for pretty printing multi-line json to the terminal\n  //\n  if (options.json) {\n    if (typeof meta !== 'object' && meta != null) {\n      meta = { meta: meta };\n    }\n\n    output         = exports.clone(meta) || {};\n    output.level   = options.level;\n    output.message = options.message;\n\n    if (timestamp) {\n      output.timestamp = timestamp;\n    }\n\n    if (typeof options.stringify === 'function') {\n      return options.stringify(output);\n    }\n\n    return JSON.stringify(output, function (key, value) {\n      return value instanceof Buffer\n        ? value.toString('base64')\n        : value;\n    });\n  }\n\n  output = timestamp ? timestamp + ' - ' : '';\n  output += options.colorize ? config.colorize(options.level) : options.level;\n  output += (': ' + options.message);\n\n  if (meta) {\n    if (typeof meta !== 'object') {\n      output += ' ' + meta;\n    }\n    else if (Object.keys(meta).length > 0) {\n      output += ' ' + (options.prettyPrint ? ('\\n' + util.inspect(meta, false, null, options.colorize)) : exports.serialize(meta));\n    }\n  }\n\n  return output;\n};\n\nexports.capitalize = function (str) {\n  return str && str[0].toUpperCase() + str.slice(1);\n};\n\n//\n// ### function hash (str)\n// #### @str {string} String to hash.\n// Utility function for creating unique ids\n// e.g. Profiling incoming HTTP requests on the same tick\n//\nexports.hash = function (str) {\n  return crypto.createHash('sha1').update(str).digest('hex');\n};\n\n//\n// ### function pad (n)\n// Returns a padded string if `n < 10`.\n//\nexports.pad = function (n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n};\n\n//\n// ### function timestamp ()\n// Returns a timestamp string for the current time.\n//\nexports.timestamp = function () {\n  return new Date().toISOString();\n};\n\n//\n// ### function serialize (obj, key)\n// #### @obj {Object|literal} Object to serialize\n// #### @key {string} **Optional** Optional key represented by obj in a larger object\n// Performs simple comma-separated, `key=value` serialization for Loggly when\n// logging to non-JSON inputs.\n//\nexports.serialize = function (obj, key) {\n  if (obj === null) {\n    obj = 'null';\n  }\n  else if (obj === undefined) {\n    obj = 'undefined';\n  }\n  else if (obj === false) {\n    obj = 'false';\n  }\n\n  if (typeof obj !== 'object') {\n    return key ? key + '=' + obj : obj;\n  }\n\n  if (obj instanceof Buffer) {\n    return key ? key + '=' + obj.toString('base64') : obj.toString('base64');\n  }\n\n  var msg = '',\n      keys = Object.keys(obj),\n      length = keys.length;\n\n  for (var i = 0; i < length; i++) {\n    if (Array.isArray(obj[keys[i]])) {\n      msg += keys[i] + '=[';\n\n      for (var j = 0, l = obj[keys[i]].length; j < l; j++) {\n        msg += exports.serialize(obj[keys[i]][j]);\n        if (j < l - 1) {\n          msg += ', ';\n        }\n      }\n\n      msg += ']';\n    }\n    else if (obj[keys[i]] instanceof Date) {\n      msg += keys[i] + '=' + obj[keys[i]];\n    }\n    else {\n      msg += exports.serialize(obj[keys[i]], keys[i]);\n    }\n\n    if (i < length - 1) {\n      msg += ', ';\n    }\n  }\n\n  return msg;\n};\n","/*\n * exception.js: Utility methods for gathing information about uncaughtExceptions.\n *\n * (C) 2010 Charlie Robbins\n * MIT LICENCE\n *\n */\n\nvar os = require('os'),\n    stackTrace = require('stack-trace');\n\nvar exception = exports;\n\nexception.getAllInfo = function (err) {\n  return {\n    date:    new Date().toString(),\n    process: exception.getProcessInfo(),\n    os:      exception.getOsInfo(),\n    trace:   exception.getTrace(err),\n    stack:   err.stack && err.stack.split('\\n')\n  };\n};\n\nexception.getProcessInfo = function () {\n  return {\n    pid:         process.pid,\n    uid:         process.getuid ? process.getuid() : null,\n    gid:         process.getgid ? process.getgid() : null,\n    cwd:         process.cwd(),\n    execPath:    process.execPath,\n    version:     process.version,\n    argv:        process.argv,\n    memoryUsage: process.memoryUsage()\n  };\n};\n\nexception.getOsInfo = function () {\n  return {\n    loadavg: os.loadavg(),\n    uptime:  os.uptime()\n  };\n};\n\nexception.getTrace = function (err) {\n  var trace = err ? stackTrace.parse(err) : stackTrace.get();\n  return trace.map(function (site) {\n    return {\n      column:   site.getColumnNumber(),\n      file:     site.getFileName(),\n      function: site.getFunctionName(),\n      line:     site.getLineNumber(),\n      method:   site.getMethodName(),\n      native:   site.isNative(),\n    }\n  });\n};\n","/*\n * config.js: Default settings for all levels that winston knows about\n *\n * (C) 2010 Charlie Robbins\n * MIT LICENCE\n *\n */\n\nvar colors = require('colors');\n\nvar config = exports,\n    allColors = exports.allColors = {};\n\nconfig.addColors = function (colors) {\n  mixin(allColors, colors);\n};\n\nconfig.colorize = function (level) {\n  return level[allColors[level]];\n};\n\n//\n// Export config sets\n//\nconfig.cli    = require('./config/cli-config');\nconfig.npm    = require('./config/npm-config');\nconfig.syslog = require('./config/syslog-config');\n\n//\n// Add colors for pre-defined config sets\n//\nconfig.addColors(config.npm.colors);\nconfig.addColors(config.syslog.colors);\n\nfunction mixin (target) {\n  var args = Array.prototype.slice.call(arguments, 1);\n\n  args.forEach(function (a) {\n    var keys = Object.keys(a);\n    for (var i = 0; i < keys.length; i++) {\n      target[keys[i]] = a[keys[i]];\n    }\n  });\n  return target;\n};","/*\n * container.js: Inversion of control container for winston logger instances\n *\n * (C) 2010 Charlie Robbins\n * MIT LICENCE\n *\n */\n\nvar common = require('./common'),\n    winston = require('../winston');\n\n//\n// ### function Container (options)\n// #### @options {Object} Default pass-thru options for Loggers\n// Constructor function for the Container object responsible for managing\n// a set of `winston.Logger` instances based on string ids.\n//\nvar Container = exports.Container = function (options) {\n  this.loggers = {};\n  this.options = options || {};\n  this.default = {\n    transports: [\n      new winston.transports.Console({\n        level: 'silly',\n        colorize: false\n      })\n    ]\n  }\n};\n\n//\n// ### function get / add (id, options)\n// #### @id {string} Id of the Logger to get\n// #### @options {Object} **Optional** Options for the Logger instance\n// Retreives a `winston.Logger` instance for the specified `id`. If\n// an instance does not exist, one is created.\n//\nContainer.prototype.get = Container.prototype.add = function (id, options) {\n  if (!this.loggers[id]) {\n    options = common.clone(options || this.options || this.default);\n    options.transports = options.transports || [];\n\n    if (options.transports.length === 0 && (!options || !options['console'])) {\n      options.transports.push(this.default.transports[0]);\n    }\n\n    Object.keys(options).forEach(function (key) {\n      if (key === 'transports') {\n        return;\n      }\n\n      var name = common.capitalize(key);\n\n      if (!winston.transports[name]) {\n        throw new Error('Cannot add unknown transport: ' + name);\n      }\n\n      var namedOptions = options[key];\n      namedOptions.id = id;\n      options.transports.push(new (winston.transports[name])(namedOptions));\n    });\n\n    this.loggers[id] = new winston.Logger(options);\n  }\n\n  return this.loggers[id];\n};\n\n//\n// ### function close (id)\n// #### @id {string} **Optional** Id of the Logger instance to find\n// Returns a boolean value indicating if this instance\n// has a logger with the specified `id`.\n//\nContainer.prototype.has = function (id) {\n  return !!this.loggers[id];\n};\n\n//\n// ### function close (id)\n// #### @id {string} **Optional** Id of the Logger instance to close\n// Closes a `Logger` instance with the specified `id` if it exists.\n// If no `id` is supplied then all Loggers are closed.\n//\nContainer.prototype.close = function (id) {\n  var self = this;\n\n  function _close (id) {\n    if (!self.loggers[id]) {\n      return;\n    }\n\n    self.loggers[id].close();\n    delete self.loggers[id];\n  }\n\n  return id ? _close(id) : Object.keys(this.loggers).forEach(function (id) {\n    _close(id);\n  });\n};\n\n","/*\n * logger.js: Core logger object used by winston.\n *\n * (C) 2010 Charlie Robbins\n * MIT LICENCE\n *\n */\n\nvar events = require('events'),\n    util = require('util'),\n    async = require('async'),\n    config = require('./config'),\n    common = require('./common'),\n    exception = require('./exception'),\n    Stream = require('stream').Stream;\n\n//\n// Time constants\n//\nvar ticksPerMillisecond = 10000;\n\n//\n// ### function Logger (options)\n// #### @options {Object} Options for this instance.\n// Constructor function for the Logger object responsible\n// for persisting log messages and metadata to one or more transports.\n//\nvar Logger = exports.Logger = function (options) {\n  events.EventEmitter.call(this);\n  options = options || {};\n\n  var self = this,\n      handleExceptions = false;\n\n  //\n  // Set Levels and default logging level\n  //\n  this.padLevels = options.padLevels || false;\n  this.setLevels(options.levels);\n  if (options.colors) {\n    config.addColors(options.colors);\n  }\n\n  //\n  // Hoist other options onto this instance.\n  //\n  this.level       = options.level || 'info';\n  this.emitErrs    = options.emitErrs || false;\n  this.stripColors = options.stripColors || false;\n  this.exitOnError = typeof options.exitOnError !== 'undefined'\n    ? options.exitOnError\n    : true;\n\n  //\n  // Setup other intelligent default settings.\n  //\n  this.transports        = {};\n  this.rewriters         = [];\n  this.exceptionHandlers = {};\n  this.profilers         = {};\n  this._names            = [];\n  this._hnames           = [];\n\n  if (options.transports) {\n    options.transports.forEach(function (transport) {\n      self.add(transport, null, true);\n\n      if (transport.handleExceptions) {\n        handleExceptions = true;\n      }\n    });\n  }\n\n  if (options.rewriters) {\n    options.rewriters.forEach(function (rewriter) {\n      self.addRewriter(rewriter);\n    });\n  }\n\n  if (options.exceptionHandlers) {\n    handleExceptions = true;\n    options.exceptionHandlers.forEach(function (handler) {\n      self._hnames.push(handler.name);\n      self.exceptionHandlers[handler.name] = handler;\n    });\n  }\n\n  if (options.handleExceptions || handleExceptions) {\n    this.handleExceptions();\n  }\n};\n\n//\n// Inherit from `events.EventEmitter`.\n//\nutil.inherits(Logger, events.EventEmitter);\n\n//\n// ### function extend (target)\n// #### @target {Object} Target to extend.\n// Extends the target object with a 'log' method\n// along with a method for each level in this instance.\n//\nLogger.prototype.extend = function (target) {\n  var self = this;\n  ['log', 'profile', 'startTimer'].concat(Object.keys(this.levels)).forEach(function (method) {\n    target[method] = function () {\n      return self[method].apply(self, arguments);\n    };\n  });\n\n  return this;\n};\n\n//\n// ### function log (level, msg, [meta], callback)\n// #### @level {string} Level at which to log the message.\n// #### @msg {string} Message to log\n// #### @meta {Object} **Optional** Additional metadata to attach\n// #### @callback {function} Continuation to respond to when complete.\n// Core logging method exposed to Winston. Metadata is optional.\n//\nLogger.prototype.log = function (level, msg) {\n  var self = this,\n      callback,\n      meta;\n\n  if (arguments.length === 3) {\n    if (typeof arguments[2] === 'function') {\n      meta = {};\n      callback = arguments[2];\n    }\n    else if (typeof arguments[2] === 'object') {\n      meta = arguments[2];\n    }\n  }\n  else if (arguments.length === 4) {\n    meta = arguments[2];\n    callback = arguments[3];\n  }\n\n  // If we should pad for levels, do so\n  if (this.padLevels) {\n    msg = new Array(this.levelLength - level.length + 1).join(' ') + msg;\n  }\n\n  function onError (err) {\n    if (callback) {\n      callback(err);\n    }\n    else if (self.emitErrs) {\n      self.emit('error', err);\n    };\n  }\n\n  if (this.transports.length === 0) {\n    return onError(new Error('Cannot log with no transports.'));\n  }\n  else if (typeof self.levels[level] === 'undefined') {\n    return onError(new Error('Unknown log level: ' + level));\n  }\n\n  this.rewriters.forEach(function (rewriter) {\n    meta = rewriter(level, msg, meta);\n  });\n\n  //\n  // For consideration of terminal 'color\" programs like colors.js,\n  // which can add ANSI escape color codes to strings, we destyle the\n  // ANSI color escape codes when `this.stripColors` is set.\n  //\n  // see: http://en.wikipedia.org/wiki/ANSI_escape_code\n  //\n  if (this.stripColors) {\n    var code = /\\u001b\\[(\\d+(;\\d+)*)?m/g;\n    msg = ('' + msg).replace(code, '');\n  }\n\n  //\n  // Log for each transport and emit 'logging' event\n  //\n  function emit(name, next) {\n    var transport = self.transports[name];\n    if ((transport.level && self.levels[transport.level] <= self.levels[level])\n      || (!transport.level && self.levels[self.level] <= self.levels[level])) {\n      transport.log(level, msg, meta, function (err) {\n        if (err) {\n          err.transport = transport;\n          cb(err);\n          return next();\n        }\n        self.emit('logging', transport, level, msg, meta);\n        next();\n      });\n    } else {\n      next();\n    }\n  }\n\n  //\n  // Respond to the callback\n  //\n  function cb(err) {\n    if (callback) {\n      if (err) return callback(err);\n      callback(null, level, msg, meta);\n    }\n    callback = null;\n  }\n\n  async.forEach(this._names, emit, cb);\n\n  return this;\n};\n\n//\n// ### function query (options, callback)\n// #### @options {Object} Query options for this instance.\n// #### @callback {function} Continuation to respond to when complete.\n// Queries the all transports for this instance with the specified `options`.\n// This will aggregate each transport's results into one object containing\n// a property per transport.\n//\nLogger.prototype.query = function (options, callback) {\n  if (typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  var self = this,\n      options = options || {},\n      results = {},\n      query = common.clone(options.query) || {},\n      transports;\n\n  //\n  // Helper function to query a single transport\n  //\n  function queryTransport(transport, next) {\n    if (options.query) {\n      options.query = transport.formatQuery(query);\n    }\n\n    transport.query(options, function (err, results) {\n      if (err) {\n        return next(err);\n      }\n\n      next(null, transport.formatResults(results, options.format));\n    });\n  }\n\n  //\n  // Helper function to accumulate the results from\n  // `queryTransport` into the `results`.\n  //\n  function addResults (transport, next) {\n    queryTransport(transport, function (err, result) {\n      result = err || result;\n      if (result) {\n        results[transport.name] = result;\n      }\n      next();\n    });\n  }\n\n  //\n  // If an explicit transport is being queried then\n  // respond with the results from only that transport\n  //\n  if (options.transport) {\n    options.transport = options.transport.toLowerCase();\n    return queryTransport(this.transports[options.transport], callback);\n  }\n\n  //\n  // Create a list of all transports for this instance.\n  //\n  transports = this._names.map(function (name) {\n    return self.transports[name];\n  }).filter(function (transport) {\n    return !!transport.query;\n  });\n\n  //\n  // Iterate over the transports in parallel setting the\n  // appropriate key in the `results`\n  //\n  async.forEach(transports, addResults, function () {\n    callback(null, results);\n  });\n};\n\n//\n// ### function stream (options)\n// #### @options {Object} Stream options for this instance.\n// Returns a log stream for all transports. Options object is optional.\n//\nLogger.prototype.stream = function (options) {\n  var self = this,\n      options = options || {},\n      out = new Stream,\n      streams = [],\n      transports;\n\n  if (options.transport) {\n    var transport = this.transports[options.transport];\n    delete options.transport;\n    if (transport && transport.stream) {\n      return transport.stream(options);\n    }\n  }\n\n  out._streams = streams;\n  out.destroy = function () {\n    var i = streams.length;\n    while (i--) streams[i].destroy();\n  };\n\n  //\n  // Create a list of all transports for this instance.\n  //\n  transports = this._names.map(function (name) {\n    return self.transports[name];\n  }).filter(function (transport) {\n    return !!transport.stream;\n  });\n\n  transports.forEach(function (transport) {\n    var stream = transport.stream(options);\n    if (!stream) return;\n\n    streams.push(stream);\n\n    stream.on('log', function (log) {\n      log.transport = log.transport || [];\n      log.transport.push(transport.name);\n      out.emit('log', log);\n    });\n\n    stream.on('error', function (err) {\n      err.transport = err.transport || [];\n      err.transport.push(transport.name);\n      out.emit('error', err);\n    });\n  });\n\n  return out;\n};\n\n//\n// ### function close ()\n// Cleans up resources (streams, event listeners) for all\n// transports associated with this instance (if necessary).\n//\nLogger.prototype.close = function () {\n  var self = this;\n\n  this._names.forEach(function (name) {\n    var transport = self.transports[name];\n    if (transport && transport.close) {\n      transport.close();\n    }\n  });\n};\n\n//\n// ### function handleExceptions ()\n// Handles `uncaughtException` events for the current process\n//\nLogger.prototype.handleExceptions = function () {\n  var args = Array.prototype.slice.call(arguments),\n      handlers = [],\n      self = this;\n\n  args.forEach(function (a) {\n    if (Array.isArray(a)) {\n      handlers = handlers.concat(a);\n    }\n    else {\n      handlers.push(a);\n    }\n  });\n\n  handlers.forEach(function (handler) {\n    self.exceptionHandlers[handler.name] = handler;\n  });\n\n  this._hnames = Object.keys(self.exceptionHandlers);\n\n  if (!this.catchExceptions) {\n    this.catchExceptions = this._uncaughtException.bind(this);\n    process.on('uncaughtException', this.catchExceptions);\n  }\n};\n\n//\n// ### function unhandleExceptions ()\n// Removes any handlers to `uncaughtException` events\n// for the current process\n//\nLogger.prototype.unhandleExceptions = function () {\n  var self = this;\n\n  if (this.catchExceptions) {\n    Object.keys(this.exceptionHandlers).forEach(function (name) {\n      if (handler.close) {\n        handler.close();\n      }\n    });\n\n    this.exceptionHandlers = {};\n    Object.keys(this.transports).forEach(function (name) {\n      var transport = self.transports[name];\n      if (transport.handleExceptions) {\n        transport.handleExceptions = false;\n      }\n    })\n\n    process.removeListener('uncaughtException', this.catchExceptions);\n    this.catchExceptions = false;\n  }\n};\n\n//\n// ### function add (transport, [options])\n// #### @transport {Transport} Prototype of the Transport object to add.\n// #### @options {Object} **Optional** Options for the Transport to add.\n// #### @instance {Boolean} **Optional** Value indicating if `transport` is already instantiated.\n// Adds a transport of the specified type to this instance.\n//\nLogger.prototype.add = function (transport, options, created) {\n  var instance = created ? transport : (new (transport)(options));\n\n  if (!instance.name && !instance.log) {\n    throw new Error('Unknown transport with no log() method');\n  }\n  else if (this.transports[instance.name]) {\n    throw new Error('Transport already attached: ' + instance.name);\n  }\n\n  this.transports[instance.name] = instance;\n  this._names = Object.keys(this.transports);\n\n  //\n  // Listen for the `error` event on the new Transport\n  //\n  instance._onError = this._onError.bind(this, instance)\n  instance.on('error', instance._onError);\n\n  //\n  // If this transport has `handleExceptions` set to `true`\n  // and we are not already handling exceptions, do so.\n  //\n  if (instance.handleExceptions && !this.catchExceptions) {\n    this.handleExceptions();\n  }\n\n  return this;\n};\n\n//\n// ### function addRewriter (transport, [options])\n// #### @transport {Transport} Prototype of the Transport object to add.\n// #### @options {Object} **Optional** Options for the Transport to add.\n// #### @instance {Boolean} **Optional** Value indicating if `transport` is already instantiated.\n// Adds a transport of the specified type to this instance.\n//\nLogger.prototype.addRewriter = function (rewriter) {\n  this.rewriters.push(rewriter);\n}\n\n//\n// ### function clear ()\n// Remove all transports from this instance\n//\nLogger.prototype.clear = function () {\n  for (var name in this.transports) {\n    this.remove({ name: name });\n  }\n};\n\n//\n// ### function remove (transport)\n// #### @transport {Transport} Transport to remove.\n// Removes a transport of the specified type from this instance.\n//\nLogger.prototype.remove = function (transport) {\n  var name = transport.name || transport.prototype.name;\n\n  if (!this.transports[name]) {\n    throw new Error('Transport ' + name + ' not attached to this instance');\n  }\n\n  var instance = this.transports[name];\n  delete this.transports[name];\n  this._names = Object.keys(this.transports);\n\n  if (instance.close) {\n    instance.close();\n  }\n\n  instance.removeListener('error', instance._onError);\n  return this;\n};\n\nvar ProfileHandler = function (logger) {\n  this.logger = logger;\n\n  this.start = Date.now();\n\n  this.done = function (msg) {\n    var args, callback, meta;\n    args     = Array.prototype.slice.call(arguments);\n    callback = typeof args[args.length - 1] === 'function' ? args.pop() : null;\n    meta     = typeof args[args.length - 1] === 'object' ? args.pop() : {};\n\n    meta.duration = (Date.now()) - this.start + 'ms';\n\n    return this.logger.info(msg, meta, callback);\n  }\n}\n\nLogger.prototype.startTimer = function () {\n  return new ProfileHandler(this);\n}\n\n//\n// ### function profile (id, [msg, meta, callback])\n// #### @id {string} Unique id of the profiler\n// #### @msg {string} **Optional** Message to log\n// #### @meta {Object} **Optional** Additional metadata to attach\n// #### @callback {function} **Optional** Continuation to respond to when complete.\n// Tracks the time inbetween subsequent calls to this method\n// with the same `id` parameter. The second call to this method\n// will log the difference in milliseconds along with the message.\n//\nLogger.prototype.profile = function (id) {\n  var now = Date.now(), then, args,\n      msg, meta, callback;\n\n  if (this.profilers[id]) {\n    then = this.profilers[id];\n    delete this.profilers[id];\n\n    // Support variable arguments: msg, meta, callback\n    args     = Array.prototype.slice.call(arguments);\n    callback = typeof args[args.length - 1] === 'function' ? args.pop() : null;\n    meta     = typeof args[args.length - 1] === 'object' ? args.pop() : {};\n    msg      = args.length === 2 ? args[1] : id;\n\n    // Set the duration property of the metadata\n    meta.duration = now - then + 'ms';\n    return this.info(msg, meta, callback);\n  }\n  else {\n    this.profilers[id] = now;\n  }\n\n  return this;\n};\n\n//\n// ### function setLevels (target)\n// #### @target {Object} Target levels to use on this instance\n// Sets the `target` levels specified on this instance.\n//\nLogger.prototype.setLevels = function (target) {\n  return common.setLevels(this, this.levels, target);\n};\n\n//\n// ### function cli ()\n// Configures this instance to have the default\n// settings for command-line interfaces: no timestamp,\n// colors enabled, padded output, and additional levels.\n//\nLogger.prototype.cli = function () {\n  this.padLevels = true;\n  this.setLevels(config.cli.levels);\n  config.addColors(config.cli.colors);\n\n  if (this.transports.console) {\n    this.transports.console.colorize = true;\n    this.transports.console.timestamp = false;\n  }\n\n  return this;\n};\n\n//\n// ### @private function _uncaughtException (err)\n// #### @err {Error} Error to handle\n// Logs all relevant information around the `err` and\n// exits the current process.\n//\nLogger.prototype._uncaughtException = function (err) {\n  var self = this,\n      responded = false,\n      info = exception.getAllInfo(err),\n      handlers = this._getExceptionHandlers(),\n      timeout,\n      doExit;\n\n  //\n  // Calculate if we should exit on this error\n  //\n  doExit = typeof this.exitOnError === 'function'\n    ? this.exitOnError(err)\n    : this.exitOnError;\n\n  function logAndWait(transport, next) {\n    transport.logException('uncaughtException', info, next, err);\n  }\n\n  function gracefulExit() {\n    if (doExit && !responded) {\n      //\n      // Remark: Currently ignoring any exceptions from transports\n      //         when catching uncaught exceptions.\n      //\n      clearTimeout(timeout);\n      responded = true;\n      process.exit(1);\n    }\n  }\n\n  if (!handlers || handlers.length === 0) {\n    return gracefulExit();\n  }\n\n  //\n  // Log to all transports and allow the operation to take\n  // only up to `3000ms`.\n  //\n  async.forEach(handlers, logAndWait, gracefulExit);\n  if (doExit) {\n    timeout = setTimeout(gracefulExit, 3000);\n  }\n};\n\n//\n// ### @private function _getExceptionHandlers ()\n// Returns the list of transports and exceptionHandlers\n// for this instance.\n//\nLogger.prototype._getExceptionHandlers = function () {\n  var self = this;\n\n  return this._hnames.map(function (name) {\n    return self.exceptionHandlers[name];\n  }).concat(this._names.map(function (name) {\n    return self.transports[name].handleExceptions && self.transports[name];\n  })).filter(Boolean);\n};\n\n//\n// ### @private function _onError (transport, err)\n// #### @transport {Object} Transport on which the error occured\n// #### @err {Error} Error that occurred on the transport\n// Bubbles the error, `err`, that occured on the specified `transport`\n// up from this instance if `emitErrs` has been set.\n//\nLogger.prototype._onError = function (transport, err) {\n  if (this.emitErrs) {\n    this.emit('error', err, transport);\n  }\n};\n","/*\n * transport.js: Base Transport object for all Winston transports.\n *\n * (C) 2010 Charlie Robbins\n * MIT LICENCE\n *\n */\n\nvar events = require('events'),\n    util = require('util');\n\n//\n// ### function Transport (options)\n// #### @options {Object} Options for this instance.\n// Constructor function for the Tranport object responsible\n// base functionality for all winston transports.\n//\nvar Transport = exports.Transport = function (options) {\n  events.EventEmitter.call(this);\n\n  options               = options        || {};\n  this.level            = options.level  || 'info';\n  this.silent           = options.silent || false;\n  this.raw              = options.raw    || false;\n\n  this.handleExceptions = options.handleExceptions || false;\n};\n\n//\n// Inherit from `events.EventEmitter`.\n//\nutil.inherits(Transport, events.EventEmitter);\n\n//\n// ### function formatQuery (query)\n// #### @query {string|Object} Query to format\n// Formats the specified `query` Object (or string) to conform\n// with the underlying implementation of this transport.\n//\nTransport.prototype.formatQuery = function (query) {\n  return query;\n};\n\n//\n// ### function normalizeQuery (query)\n// #### @options {string|Object} Query to normalize\n// Normalize options for query\n//\nTransport.prototype.normalizeQuery = function (options) {\n  //\n  // Use options similar to loggly.\n  // [See Loggly Search API](http://wiki.loggly.com/retrieve_events#optional)\n  //\n\n  options = options || {};\n\n  // limit\n  options.rows = options.rows || options.limit || 10;\n\n  // starting row offset\n  options.start = options.start || 0;\n\n  // now - 24\n  options.from = options.from || new Date - (24 * 60 * 60 * 1000);\n  if (typeof options.from !== 'object') {\n    options.from = new Date(options.from);\n  }\n\n  // now\n  options.until = options.until || new Date;\n  if (typeof options.until !== 'object') {\n    options.until = new Date(options.until);\n  }\n\n  // 'asc' or 'desc'\n  options.order = options.order || 'desc';\n\n  // which fields to select\n  options.fields = options.fields;\n\n  return options;\n};\n\n//\n// ### function formatResults (results, options)\n// #### @results {Object|Array} Results returned from `.query`.\n// #### @options {Object} **Optional** Formatting options\n// Formats the specified `results` with the given `options` accordinging\n// to the implementation of this transport.\n//\nTransport.prototype.formatResults = function (results, options) {\n  return results;\n};\n\n//\n// ### function logException (msg, meta, callback)\n// #### @msg {string} Message to log\n// #### @meta {Object} **Optional** Additional metadata to attach\n// #### @callback {function} Continuation to respond to when complete.\n// Logs the specified `msg`, `meta` and responds to the callback once the log\n// operation is complete to ensure that the event loop will not exit before\n// all logging has completed.\n//\nTransport.prototype.logException = function (msg, meta, callback) {\n  var self = this;\n\n  function onLogged () {\n    self.removeListener('error', onError);\n    callback();\n  }\n\n  function onError () {\n    self.removeListener('logged', onLogged);\n    callback();\n  }\n\n  this.once('logged', onLogged);\n  this.once('error', onError);\n  this.log('error', msg, meta, function () { });\n};\n","/*\n * cli-config.js: Config that conform to commonly used CLI logging levels.\n *\n * (C) 2010 Charlie Robbins\n * MIT LICENCE\n *\n */\n\nvar cliConfig = exports;\n\ncliConfig.levels = {\n  silly: 0,\n  input: 1,\n  verbose: 2,\n  prompt: 3,\n  info: 4,\n  data: 5,\n  help: 6,\n  warn: 7,\n  debug: 8,\n  error: 9\n};\n\ncliConfig.colors = {\n  silly: 'magenta',\n  input: 'grey',\n  verbose: 'cyan',\n  prompt: 'grey',\n  info: 'green',\n  data: 'grey',\n  help: 'cyan',\n  warn: 'yellow',\n  debug: 'blue',\n  error: 'red'\n};","/*\n * npm-config.js: Config that conform to npm logging levels.\n *\n * (C) 2010 Charlie Robbins\n * MIT LICENCE\n *\n */\n\nvar npmConfig = exports;\n\nnpmConfig.levels = {\n  silly: 0,\n  verbose: 1,\n  info: 2,\n  warn: 3,\n  debug: 4,\n  error: 5\n};\n\nnpmConfig.colors = {\n  silly: 'magenta',\n  verbose: 'cyan',\n  info: 'green',\n  warn: 'yellow',\n  debug: 'blue',\n  error: 'red'\n};","/*\n * syslog-config.js: Config that conform to syslog logging levels.\n *\n * (C) 2010 Charlie Robbins\n * MIT LICENCE\n *\n */\n\nvar syslogConfig = exports;\n\nsyslogConfig.levels = {\n  debug: 0,\n  info: 1,\n  notice: 2,\n  warning: 3,\n  error: 4,\n  crit: 5,\n  alert: 6,\n  emerg: 7\n};\n\nsyslogConfig.colors = {\n  debug: 'blue',\n  info: 'green',\n  notice: 'yellow',\n  warning: 'red',\n  error: 'red',\n  crit: 'red',\n  alert: 'yellow',\n  emerg: 'red'\n};","var Buffer = require('buffer').Buffer\nvar sha = require('./sha')\nvar sha256 = require('./sha256')\nvar rng = require('./rng')\nvar md5 = require('./md5')\n\nvar algorithms = {\n  sha1: sha,\n  sha256: sha256,\n  md5: md5\n}\n\nvar blocksize = 64\nvar zeroBuffer = new Buffer(blocksize); zeroBuffer.fill(0)\nfunction hmac(fn, key, data) {\n  if(!Buffer.isBuffer(key)) key = new Buffer(key)\n  if(!Buffer.isBuffer(data)) data = new Buffer(data)\n\n  if(key.length > blocksize) {\n    key = fn(key)\n  } else if(key.length < blocksize) {\n    key = Buffer.concat([key, zeroBuffer], blocksize)\n  }\n\n  var ipad = new Buffer(blocksize), opad = new Buffer(blocksize)\n  for(var i = 0; i < blocksize; i++) {\n    ipad[i] = key[i] ^ 0x36\n    opad[i] = key[i] ^ 0x5C\n  }\n\n  var hash = fn(Buffer.concat([ipad, data]))\n  return fn(Buffer.concat([opad, hash]))\n}\n\nfunction hash(alg, key) {\n  alg = alg || 'sha1'\n  var fn = algorithms[alg]\n  var bufs = []\n  var length = 0\n  if(!fn) error('algorithm:', alg, 'is not yet supported')\n  return {\n    update: function (data) {\n      if(!Buffer.isBuffer(data)) data = new Buffer(data)\n        \n      bufs.push(data)\n      length += data.length\n      return this\n    },\n    digest: function (enc) {\n      var buf = Buffer.concat(bufs)\n      var r = key ? hmac(fn, key, buf) : fn(buf)\n      bufs = null\n      return enc ? r.toString(enc) : r\n    }\n  }\n}\n\nfunction error () {\n  var m = [].slice.call(arguments).join(' ')\n  throw new Error([\n    m,\n    'we accept pull requests',\n    'http://github.com/dominictarr/crypto-browserify'\n    ].join('\\n'))\n}\n\nexports.createHash = function (alg) { return hash(alg) }\nexports.createHmac = function (alg, key) { return hash(alg, key) }\nexports.randomBytes = function(size, callback) {\n  if (callback && callback.call) {\n    try {\n      callback.call(this, undefined, new Buffer(rng(size)))\n    } catch (err) { callback(err) }\n  } else {\n    return new Buffer(rng(size))\n  }\n}\n\nfunction each(a, f) {\n  for(var i in a)\n    f(a[i], i)\n}\n\n// the least I can do is make error messages for the rest of the node.js/crypto api.\neach(['createCredentials'\n, 'createCipher'\n, 'createCipheriv'\n, 'createDecipher'\n, 'createDecipheriv'\n, 'createSign'\n, 'createVerify'\n, 'createDiffieHellman'\n, 'pbkdf2'], function (name) {\n  exports[name] = function () {\n    error('sorry,', name, 'is not implemented yet')\n  }\n})\n","exports.endianness = function () { return 'LE' };\n\nexports.hostname = function () {\n    if (typeof location !== 'undefined') {\n        return location.hostname\n    }\n    else return '';\n};\n\nexports.loadavg = function () { return [] };\n\nexports.uptime = function () { return 0 };\n\nexports.freemem = function () {\n    return Number.MAX_VALUE;\n};\n\nexports.totalmem = function () {\n    return Number.MAX_VALUE;\n};\n\nexports.cpus = function () { return [] };\n\nexports.type = function () { return 'Browser' };\n\nexports.release = function () {\n    if (typeof navigator !== 'undefined') {\n        return navigator.appVersion;\n    }\n    return '';\n};\n\nexports.networkInterfaces\n= exports.getNetworkInterfaces\n= function () { return {} };\n\nexports.arch = function () { return 'javascript' };\n\nexports.platform = function () { return 'browser' };\n\nexports.tmpdir = exports.tmpDir = function () {\n    return '/tmp';\n};\n\nexports.EOL = '\\n';\n","var Stream = require('stream')\n\nmodule.exports = MuteStream\n\n// var out = new MuteStream(process.stdout)\n// argument auto-pipes\nfunction MuteStream (opts) {\n  Stream.apply(this)\n  opts = opts || {}\n  this.writable = this.readable = true\n  this.muted = false\n  this.on('pipe', this._onpipe)\n  this.replace = opts.replace\n\n  // For readline-type situations\n  // This much at the start of a line being redrawn after a ctrl char\n  // is seen (such as backspace) won't be redrawn as the replacement\n  this._prompt = opts.prompt || null\n  this._hadControl = false\n}\n\nMuteStream.prototype = Object.create(Stream.prototype)\n\nObject.defineProperty(MuteStream.prototype, 'constructor', {\n  value: MuteStream,\n  enumerable: false\n})\n\nMuteStream.prototype.mute = function () {\n  this.muted = true\n}\n\nMuteStream.prototype.unmute = function () {\n  this.muted = false\n}\n\nObject.defineProperty(MuteStream.prototype, '_onpipe', {\n  value: onPipe,\n  enumerable: false,\n  writable: true,\n  configurable: true\n})\n\nfunction onPipe (src) {\n  this._src = src\n}\n\nObject.defineProperty(MuteStream.prototype, 'isTTY', {\n  get: getIsTTY,\n  set: setIsTTY,\n  enumerable: true,\n  configurable: true\n})\n\nfunction getIsTTY () {\n  return( (this._dest) ? this._dest.isTTY\n        : (this._src) ? this._src.isTTY\n        : false\n        )\n}\n\n// basically just get replace the getter/setter with a regular value\nfunction setIsTTY (isTTY) {\n  Object.defineProperty(this, 'isTTY', {\n    value: isTTY,\n    enumerable: true,\n    writable: true,\n    configurable: true\n  })\n}\n\nObject.defineProperty(MuteStream.prototype, 'rows', {\n  get: function () {\n    return( this._dest ? this._dest.rows\n          : this._src ? this._src.rows\n          : undefined )\n  }, enumerable: true, configurable: true })\n\nObject.defineProperty(MuteStream.prototype, 'columns', {\n  get: function () {\n    return( this._dest ? this._dest.columns\n          : this._src ? this._src.columns\n          : undefined )\n  }, enumerable: true, configurable: true })\n\n\nMuteStream.prototype.pipe = function (dest) {\n  this._dest = dest\n  return Stream.prototype.pipe.call(this, dest)\n}\n\nMuteStream.prototype.pause = function () {\n  if (this._src) return this._src.pause()\n}\n\nMuteStream.prototype.resume = function () {\n  if (this._src) return this._src.resume()\n}\n\nMuteStream.prototype.write = function (c) {\n  if (this.muted) {\n    if (!this.replace) return true\n    if (c.match(/^\\u001b/)) {\n      this._hadControl = true\n      return this.emit('data', c)\n    } else {\n      if (this._prompt && this._hadControl &&\n          c.indexOf(this._prompt) === 0) {\n        this._hadControl = false\n        this.emit('data', this._prompt)\n        c = c.substr(this._prompt.length)\n      }\n      c = c.toString().replace(/./g, this.replace)\n    }\n  }\n  this.emit('data', c)\n}\n\nMuteStream.prototype.end = function (c) {\n  if (this.muted) {\n    if (c && this.replace) {\n      c = c.toString().replace(/./g, this.replace)\n    } else {\n      c = null\n    }\n  }\n  if (c) this.emit('data', c)\n  this.emit('end')\n}\n\nfunction proxy (fn) { return function () {\n  var d = this._dest\n  var s = this._src\n  if (d && d[fn]) d[fn].apply(d, arguments)\n  if (s && s[fn]) s[fn].apply(s, arguments)\n}}\n\nMuteStream.prototype.destroy = proxy('destroy')\nMuteStream.prototype.destroySoon = proxy('destroySoon')\nMuteStream.prototype.close = proxy('close')\n","var pSlice = Array.prototype.slice;\nvar objectKeys = require('./lib/keys.js');\nvar isArguments = require('./lib/is_arguments.js');\n\nvar deepEqual = module.exports = function (actual, expected, opts) {\n  if (!opts) opts = {};\n  // 7.1. All identical values are equivalent, as determined by ===.\n  if (actual === expected) {\n    return true;\n\n  } else if (actual instanceof Date && expected instanceof Date) {\n    return actual.getTime() === expected.getTime();\n\n  // 7.3. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if (typeof actual != 'object' && typeof expected != 'object') {\n    return opts.strict ? actual === expected : actual == expected;\n\n  // 7.4. For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else {\n    return objEquiv(actual, expected, opts);\n  }\n}\n\nfunction isUndefinedOrNull(value) {\n  return value === null || value === undefined;\n}\n\nfunction isBuffer (x) {\n  if (!x || typeof x !== 'object' || typeof x.length !== 'number') return false;\n  if (typeof x.copy !== 'function' || typeof x.slice !== 'function') {\n    return false;\n  }\n  if (x.length > 0 && typeof x[0] !== 'number') return false;\n  return true;\n}\n\nfunction objEquiv(a, b, opts) {\n  var i, key;\n  if (isUndefinedOrNull(a) || isUndefinedOrNull(b))\n    return false;\n  // an identical 'prototype' property.\n  if (a.prototype !== b.prototype) return false;\n  //~~~I've managed to break Object.keys through screwy arguments passing.\n  //   Converting to array solves the problem.\n  if (isArguments(a)) {\n    if (!isArguments(b)) {\n      return false;\n    }\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return deepEqual(a, b, opts);\n  }\n  if (isBuffer(a)) {\n    if (!isBuffer(b)) {\n      return false;\n    }\n    if (a.length !== b.length) return false;\n    for (i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) return false;\n    }\n    return true;\n  }\n  try {\n    var ka = objectKeys(a),\n        kb = objectKeys(b);\n  } catch (e) {//happens when one is a string literal and the other isn't\n    return false;\n  }\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length != kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!deepEqual(a[key], b[key], opts)) return false;\n  }\n  return true;\n}\n","module.exports = rimraf\nrimraf.sync = rimrafSync\n\nvar assert = require(\"assert\")\nvar path = require(\"path\")\nvar fs = require(\"fs\")\n\n// for EMFILE handling\nvar timeout = 0\nexports.EMFILE_MAX = 1000\nexports.BUSYTRIES_MAX = 3\n\nvar isWindows = (process.platform === \"win32\")\n\nfunction defaults (options) {\n  var methods = [\n    'unlink',\n    'chmod',\n    'stat',\n    'rmdir',\n    'readdir'\n  ]\n  methods.forEach(function(m) {\n    options[m] = options[m] || fs[m]\n    m = m + 'Sync'\n    options[m] = options[m] || fs[m]\n  })\n}\n\nfunction rimraf (p, options, cb) {\n  if (typeof options === 'function') {\n    cb = options\n    options = {}\n  }\n  assert(p)\n  assert(options)\n  assert(typeof cb === 'function')\n\n  defaults(options)\n\n  if (!cb) throw new Error(\"No callback passed to rimraf()\")\n\n  var busyTries = 0\n  rimraf_(p, options, function CB (er) {\n    if (er) {\n      if (isWindows && (er.code === \"EBUSY\" || er.code === \"ENOTEMPTY\") &&\n          busyTries < exports.BUSYTRIES_MAX) {\n        busyTries ++\n        var time = busyTries * 100\n        // try again, with the same exact callback as this one.\n        return setTimeout(function () {\n          rimraf_(p, options, CB)\n        }, time)\n      }\n\n      // this one won't happen if graceful-fs is used.\n      if (er.code === \"EMFILE\" && timeout < exports.EMFILE_MAX) {\n        return setTimeout(function () {\n          rimraf_(p, options, CB)\n        }, timeout ++)\n      }\n\n      // already gone\n      if (er.code === \"ENOENT\") er = null\n    }\n\n    timeout = 0\n    cb(er)\n  })\n}\n\n// Two possible strategies.\n// 1. Assume it's a file.  unlink it, then do the dir stuff on EPERM or EISDIR\n// 2. Assume it's a directory.  readdir, then do the file stuff on ENOTDIR\n//\n// Both result in an extra syscall when you guess wrong.  However, there\n// are likely far more normal files in the world than directories.  This\n// is based on the assumption that a the average number of files per\n// directory is >= 1.\n//\n// If anyone ever complains about this, then I guess the strategy could\n// be made configurable somehow.  But until then, YAGNI.\nfunction rimraf_ (p, options, cb) {\n  assert(p)\n  assert(options)\n  assert(typeof cb === 'function')\n\n  options.unlink(p, function (er) {\n    if (er) {\n      if (er.code === \"ENOENT\")\n        return cb(null)\n      if (er.code === \"EPERM\")\n        return (isWindows)\n          ? fixWinEPERM(p, options, er, cb)\n          : rmdir(p, options, er, cb)\n      if (er.code === \"EISDIR\")\n        return rmdir(p, options, er, cb)\n    }\n    return cb(er)\n  })\n}\n\nfunction fixWinEPERM (p, options, er, cb) {\n  assert(p)\n  assert(options)\n  assert(typeof cb === 'function')\n  if (er)\n    assert(er instanceof Error)\n\n  options.chmod(p, 666, function (er2) {\n    if (er2)\n      cb(er2.code === \"ENOENT\" ? null : er)\n    else\n      options.stat(p, function(er3, stats) {\n        if (er3)\n          cb(er3.code === \"ENOENT\" ? null : er)\n        else if (stats.isDirectory())\n          rmdir(p, options, er, cb)\n        else\n          options.unlink(p, cb)\n      })\n  })\n}\n\nfunction fixWinEPERMSync (p, options, er) {\n  assert(p)\n  assert(options)\n  if (er)\n    assert(er instanceof Error)\n\n  try {\n    options.chmodSync(p, 666)\n  } catch (er2) {\n    if (er2.code === \"ENOENT\")\n      return\n    else\n      throw er\n  }\n\n  try {\n    var stats = options.statSync(p)\n  } catch (er3) {\n    if (er3.code === \"ENOENT\")\n      return\n    else\n      throw er\n  }\n\n  if (stats.isDirectory())\n    rmdirSync(p, options, er)\n  else\n    options.unlinkSync(p)\n}\n\nfunction rmdir (p, options, originalEr, cb) {\n  assert(p)\n  assert(options)\n  if (originalEr)\n    assert(originalEr instanceof Error)\n  assert(typeof cb === 'function')\n\n  // try to rmdir first, and only readdir on ENOTEMPTY or EEXIST (SunOS)\n  // if we guessed wrong, and it's not a directory, then\n  // raise the original error.\n  options.rmdir(p, function (er) {\n    if (er && (er.code === \"ENOTEMPTY\" || er.code === \"EEXIST\" || er.code === \"EPERM\"))\n      rmkids(p, options, cb)\n    else if (er && er.code === \"ENOTDIR\")\n      cb(originalEr)\n    else\n      cb(er)\n  })\n}\n\nfunction rmkids(p, options, cb) {\n  assert(p)\n  assert(options)\n  assert(typeof cb === 'function')\n\n  options.readdir(p, function (er, files) {\n    if (er)\n      return cb(er)\n    var n = files.length\n    if (n === 0)\n      return options.rmdir(p, cb)\n    var errState\n    files.forEach(function (f) {\n      rimraf(path.join(p, f), options, function (er) {\n        if (errState)\n          return\n        if (er)\n          return cb(errState = er)\n        if (--n === 0)\n          options.rmdir(p, cb)\n      })\n    })\n  })\n}\n\n// this looks simpler, and is strictly *faster*, but will\n// tie up the JavaScript thread and fail on excessively\n// deep directory trees.\nfunction rimrafSync (p, options) {\n  options = options || {}\n  defaults(options)\n\n  assert(p)\n  assert(options)\n\n  try {\n    options.unlinkSync(p)\n  } catch (er) {\n    if (er.code === \"ENOENT\")\n      return\n    if (er.code === \"EPERM\")\n      return isWindows ? fixWinEPERMSync(p, options, er) : rmdirSync(p, options, er)\n    if (er.code !== \"EISDIR\")\n      throw er\n    rmdirSync(p, options, er)\n  }\n}\n\nfunction rmdirSync (p, options, originalEr) {\n  assert(p)\n  assert(options)\n  if (originalEr)\n    assert(originalEr instanceof Error)\n\n  try {\n    options.rmdirSync(p)\n  } catch (er) {\n    if (er.code === \"ENOENT\")\n      return\n    if (er.code === \"ENOTDIR\")\n      throw originalEr\n    if (er.code === \"ENOTEMPTY\" || er.code === \"EEXIST\" || er.code === \"EPERM\")\n      rmkidsSync(p, options)\n  }\n}\n\nfunction rmkidsSync (p, options) {\n  assert(p)\n  assert(options)\n  options.readdirSync(p).forEach(function (f) {\n    rimrafSync(path.join(p, f), options)\n  })\n  options.rmdirSync(p, options)\n}\n","var path = require('path');\nvar fs = require('fs');\n\nmodule.exports = mkdirP.mkdirp = mkdirP.mkdirP = mkdirP;\n\nfunction mkdirP (p, opts, f, made) {\n    if (typeof opts === 'function') {\n        f = opts;\n        opts = {};\n    }\n    else if (!opts || typeof opts !== 'object') {\n        opts = { mode: opts };\n    }\n    \n    var mode = opts.mode;\n    var xfs = opts.fs || fs;\n    \n    if (mode === undefined) {\n        mode = 0777 & (~process.umask());\n    }\n    if (!made) made = null;\n    \n    var cb = f || function () {};\n    p = path.resolve(p);\n    \n    xfs.mkdir(p, mode, function (er) {\n        if (!er) {\n            made = made || p;\n            return cb(null, made);\n        }\n        switch (er.code) {\n            case 'ENOENT':\n                mkdirP(path.dirname(p), opts, function (er, made) {\n                    if (er) cb(er, made);\n                    else mkdirP(p, opts, cb, made);\n                });\n                break;\n\n            // In the case of any other error, just see if there's a dir\n            // there already.  If so, then hooray!  If not, then something\n            // is borked.\n            default:\n                xfs.stat(p, function (er2, stat) {\n                    // if the stat fails, then that's super weird.\n                    // let the original error be the failure reason.\n                    if (er2 || !stat.isDirectory()) cb(er, made)\n                    else cb(null, made);\n                });\n                break;\n        }\n    });\n}\n\nmkdirP.sync = function sync (p, opts, made) {\n    if (!opts || typeof opts !== 'object') {\n        opts = { mode: opts };\n    }\n    \n    var mode = opts.mode;\n    var xfs = opts.fs || fs;\n    \n    if (mode === undefined) {\n        mode = 0777 & (~process.umask());\n    }\n    if (!made) made = null;\n\n    p = path.resolve(p);\n\n    try {\n        xfs.mkdirSync(p, mode);\n        made = made || p;\n    }\n    catch (err0) {\n        switch (err0.code) {\n            case 'ENOENT' :\n                made = sync(path.dirname(p), opts, made);\n                sync(p, opts, made);\n                break;\n\n            // In the case of any other error, just see if there's a dir\n            // there already.  If so, then hooray!  If not, then something\n            // is borked.\n            default:\n                var stat;\n                try {\n                    stat = xfs.statSync(p);\n                }\n                catch (err1) {\n                    throw err0;\n                }\n                if (!stat.isDirectory()) throw err0;\n                break;\n        }\n    }\n\n    return made;\n};\n","var fs = require('fs'),\n    path = require('path');\n\nmodule.exports = ncp\nncp.ncp = ncp\n\nfunction ncp (source, dest, options, callback) {\n  if (!callback) {\n    callback = options;\n    options = {};\n  }\n\n  var basePath = process.cwd(),\n      currentPath = path.resolve(basePath, source),\n      targetPath = path.resolve(basePath, dest),\n      filter = options.filter,\n      transform = options.transform,\n      clobber = options.clobber !== false,\n      errs = null,\n      started = 0,\n      finished = 0,\n      running = 0,\n      limit = options.limit || ncp.limit || 16;\n\n  limit = (limit < 1) ? 1 : (limit > 512) ? 512 : limit;\n\n  startCopy(currentPath);\n  \n  function startCopy(source) {\n    started++;\n    if (filter) {\n      if (filter instanceof RegExp) {\n        if (!filter.test(source)) {\n          return cb(true);\n        }\n      }\n      else if (typeof filter === 'function') {\n        if (!filter(source)) {\n          return cb(true);\n        }\n      }\n    }\n    return getStats(source);\n  }\n\n  function defer(fn) {\n    if (typeof(setImmediate) === 'function')\n      return setImmediate(fn);\n    return process.nextTick(fn);\n  }\n\n  function getStats(source) {\n    if (running >= limit) {\n      return defer(function () {\n        getStats(source);\n      });\n    }\n    running++;\n    fs.lstat(source, function (err, stats) {\n      var item = {};\n      if (err) {\n        return onError(err);\n      }\n\n      // We need to get the mode from the stats object and preserve it.\n      item.name = source;\n      item.mode = stats.mode;\n\n      if (stats.isDirectory()) {\n        return onDir(item);\n      }\n      else if (stats.isFile()) {\n        return onFile(item);\n      }\n      else if (stats.isSymbolicLink()) {\n        // Symlinks don't really need to know about the mode.\n        return onLink(source);\n      }\n    });\n  }\n\n  function onFile(file) {\n    var target = file.name.replace(currentPath, targetPath);\n    isWritable(target, function (writable) {\n      if (writable) {\n        return copyFile(file, target);\n      }\n      if(clobber)\n        rmFile(target, function () {\n          copyFile(file, target);\n        });\n    });\n  }\n\n  function copyFile(file, target) {\n    var readStream = fs.createReadStream(file.name),\n        writeStream = fs.createWriteStream(target, { mode: file.mode });\n    if(transform) {\n      transform(readStream, writeStream,file);\n    } else {\n      readStream.pipe(writeStream);\n    }\n    readStream.once('end', cb);\n  }\n\n  function rmFile(file, done) {\n    fs.unlink(file, function (err) {\n      if (err) {\n        return onError(err);\n      }\n      return done();\n    });\n  }\n\n  function onDir(dir) {\n    var target = dir.name.replace(currentPath, targetPath);\n    isWritable(target, function (writable) {\n      if (writable) {\n        return mkDir(dir, target);\n      }\n      copyDir(dir.name);\n    });\n  }\n\n  function mkDir(dir, target) {\n    fs.mkdir(target, dir.mode, function (err) {\n      if (err) {\n        return onError(err);\n      }\n      copyDir(dir.name);\n    });\n  }\n\n  function copyDir(dir) {\n    fs.readdir(dir, function (err, items) {\n      if (err) {\n        return onError(err);\n      }\n      items.forEach(function (item) {\n        startCopy(dir + '/' + item);\n      });\n      return cb();\n    });\n  }\n\n  function onLink(link) {\n    var target = link.replace(currentPath, targetPath);\n    fs.readlink(link, function (err, resolvedPath) {\n      if (err) {\n        return onError(err);\n      }\n      checkLink(resolvedPath, target);\n    });\n  }\n\n  function checkLink(resolvedPath, target) {\n    isWritable(target, function (writable) {\n      if (writable) {\n        return makeLink(resolvedPath, target);\n      }\n      fs.readlink(target, function (err, targetDest) {\n        if (err) {\n          return onError(err);\n        }\n        if (targetDest === resolvedPath) {\n          return cb();\n        }\n        return rmFile(target, function () {\n          makeLink(resolvedPath, target);\n        });\n      });\n    });\n  }\n\n  function makeLink(linkPath, target) {\n    fs.symlink(linkPath, target, function (err) {\n      if (err) {\n        return onError(err);\n      }\n      return cb();\n    });\n  }\n\n  function isWritable(path, done) {\n    fs.lstat(path, function (err, stats) {\n      if (err) {\n        if (err.code === 'ENOENT') return done(true);\n        return done(false);\n      }\n      return done(false);\n    });\n  }\n\n  function onError(err) {\n    if (options.stopOnError) {\n      return callback(err);\n    }\n    else if (!errs && options.errs) {\n      errs = fs.createWriteStream(options.errs);\n    }\n    else if (!errs) {\n      errs = [];\n    }\n    if (typeof errs.write === 'undefined') {\n        errs.push(err);\n    }\n    else { \n        errs.write(err.stack + '\\n\\n');\n    }\n    return cb();\n  }\n\n  function cb(skipped) {\n    if (!skipped) running--;\n    finished++;\n    if ((started === finished) && (running === 0)) {\n      return errs ? callback(errs) : callback(null);\n    }\n  }\n};\n\n\n","// Requiring modules\n\nmodule.exports = function (attach) {\n  var methods = require('./methods');\n\n  if (attach) {\n    require('./native')(methods);\n  }\n\n  return methods\n};\n","/*\n * pkginfo.js: Top-level include for the pkginfo module\n *\n * (C) 2011, Charlie Robbins\n *\n */\n \nvar fs = require('fs'),\n    path = require('path');\n\n//\n// ### function pkginfo ([options, 'property', 'property' ..])\n// #### @pmodule {Module} Parent module to read from.\n// #### @options {Object|Array|string} **Optional** Options used when exposing properties.\n// #### @arguments {string...} **Optional** Specified properties to expose.\n// Exposes properties from the package.json file for the parent module on \n// it's exports. Valid usage:\n//\n// `require('pkginfo')()`\n//\n// `require('pkginfo')('version', 'author');`\n//\n// `require('pkginfo')(['version', 'author']);`\n//\n// `require('pkginfo')({ include: ['version', 'author'] });`\n//\nvar pkginfo = module.exports = function (pmodule, options) {\n  var args = [].slice.call(arguments, 2).filter(function (arg) {\n    return typeof arg === 'string';\n  });\n  \n  //\n  // **Parse variable arguments**\n  //\n  if (Array.isArray(options)) {\n    //\n    // If the options passed in is an Array assume that\n    // it is the Array of properties to expose from the\n    // on the package.json file on the parent module.\n    //\n    options = { include: options };\n  }\n  else if (typeof options === 'string') {\n    //\n    // Otherwise if the first argument is a string, then\n    // assume that it is the first property to expose from\n    // the package.json file on the parent module.\n    //\n    options = { include: [options] };\n  }\n  \n  //\n  // **Setup default options**\n  //\n  options = options || { include: [] };\n  \n  if (args.length > 0) {\n    //\n    // If additional string arguments have been passed in\n    // then add them to the properties to expose on the \n    // parent module. \n    //\n    options.include = options.include.concat(args);\n  }\n  \n  var pkg = pkginfo.read(pmodule, options.dir).package;\n  Object.keys(pkg).forEach(function (key) {\n    if (options.include.length > 0 && !~options.include.indexOf(key)) {\n      return;\n    }\n    \n    if (!pmodule.exports[key]) {\n      pmodule.exports[key] = pkg[key];\n    }\n  });\n  \n  return pkginfo;\n};\n\n//\n// ### function find (dir)\n// #### @pmodule {Module} Parent module to read from.\n// #### @dir {string} **Optional** Directory to start search from.\n// Searches up the directory tree from `dir` until it finds a directory\n// which contains a `package.json` file. \n//\npkginfo.find = function (pmodule, dir) {\n  dir = dir || pmodule.filename;\n  dir = path.dirname(dir); \n  \n  var files = fs.readdirSync(dir);\n  \n  if (~files.indexOf('package.json')) {\n    return path.join(dir, 'package.json');\n  }\n  \n  if (dir === '/') {\n    throw new Error('Could not find package.json up from: ' + dir);\n  }\n  else if (!dir || dir === '.') {\n    throw new Error('Cannot find package.json from unspecified directory');\n  }\n  \n  return pkginfo.find(pmodule, dir);\n};\n\n//\n// ### function read (pmodule, dir)\n// #### @pmodule {Module} Parent module to read from.\n// #### @dir {string} **Optional** Directory to start search from.\n// Searches up the directory tree from `dir` until it finds a directory\n// which contains a `package.json` file and returns the package information.\n//\npkginfo.read = function (pmodule, dir) { \n  dir = pkginfo.find(pmodule, dir);\n  \n  var data = fs.readFileSync(dir).toString();\n      \n  return {\n    dir: dir, \n    package: JSON.parse(data)\n  };\n};\n\n//\n// Call `pkginfo` on this module and expose version.\n//\npkginfo(module, {\n  dir: __dirname,\n  include: ['version'],\n  target: pkginfo\n});","/*\n * A JavaScript implementation of the Secure Hash Algorithm, SHA-1, as defined\n * in FIPS PUB 180-1\n * Version 2.1a Copyright Paul Johnston 2000 - 2002.\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for details.\n */\n\nvar helpers = require('./helpers');\n\n/*\n * Calculate the SHA-1 of an array of big-endian words, and a bit length\n */\nfunction core_sha1(x, len)\n{\n  /* append padding */\n  x[len >> 5] |= 0x80 << (24 - len % 32);\n  x[((len + 64 >> 9) << 4) + 15] = len;\n\n  var w = Array(80);\n  var a =  1732584193;\n  var b = -271733879;\n  var c = -1732584194;\n  var d =  271733878;\n  var e = -1009589776;\n\n  for(var i = 0; i < x.length; i += 16)\n  {\n    var olda = a;\n    var oldb = b;\n    var oldc = c;\n    var oldd = d;\n    var olde = e;\n\n    for(var j = 0; j < 80; j++)\n    {\n      if(j < 16) w[j] = x[i + j];\n      else w[j] = rol(w[j-3] ^ w[j-8] ^ w[j-14] ^ w[j-16], 1);\n      var t = safe_add(safe_add(rol(a, 5), sha1_ft(j, b, c, d)),\n                       safe_add(safe_add(e, w[j]), sha1_kt(j)));\n      e = d;\n      d = c;\n      c = rol(b, 30);\n      b = a;\n      a = t;\n    }\n\n    a = safe_add(a, olda);\n    b = safe_add(b, oldb);\n    c = safe_add(c, oldc);\n    d = safe_add(d, oldd);\n    e = safe_add(e, olde);\n  }\n  return Array(a, b, c, d, e);\n\n}\n\n/*\n * Perform the appropriate triplet combination function for the current\n * iteration\n */\nfunction sha1_ft(t, b, c, d)\n{\n  if(t < 20) return (b & c) | ((~b) & d);\n  if(t < 40) return b ^ c ^ d;\n  if(t < 60) return (b & c) | (b & d) | (c & d);\n  return b ^ c ^ d;\n}\n\n/*\n * Determine the appropriate additive constant for the current iteration\n */\nfunction sha1_kt(t)\n{\n  return (t < 20) ?  1518500249 : (t < 40) ?  1859775393 :\n         (t < 60) ? -1894007588 : -899497514;\n}\n\n/*\n * Add integers, wrapping at 2^32. This uses 16-bit operations internally\n * to work around bugs in some JS interpreters.\n */\nfunction safe_add(x, y)\n{\n  var lsw = (x & 0xFFFF) + (y & 0xFFFF);\n  var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n  return (msw << 16) | (lsw & 0xFFFF);\n}\n\n/*\n * Bitwise rotate a 32-bit number to the left.\n */\nfunction rol(num, cnt)\n{\n  return (num << cnt) | (num >>> (32 - cnt));\n}\n\nmodule.exports = function sha1(buf) {\n  return helpers.hash(buf, core_sha1, 20, true);\n};\n","\n/**\n * A JavaScript implementation of the Secure Hash Algorithm, SHA-256, as defined\n * in FIPS 180-2\n * Version 2.2-beta Copyright Angel Marin, Paul Johnston 2000 - 2009.\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n *\n */\n\nvar helpers = require('./helpers');\n\nvar safe_add = function(x, y) {\n  var lsw = (x & 0xFFFF) + (y & 0xFFFF);\n  var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n  return (msw << 16) | (lsw & 0xFFFF);\n};\n\nvar S = function(X, n) {\n  return (X >>> n) | (X << (32 - n));\n};\n\nvar R = function(X, n) {\n  return (X >>> n);\n};\n\nvar Ch = function(x, y, z) {\n  return ((x & y) ^ ((~x) & z));\n};\n\nvar Maj = function(x, y, z) {\n  return ((x & y) ^ (x & z) ^ (y & z));\n};\n\nvar Sigma0256 = function(x) {\n  return (S(x, 2) ^ S(x, 13) ^ S(x, 22));\n};\n\nvar Sigma1256 = function(x) {\n  return (S(x, 6) ^ S(x, 11) ^ S(x, 25));\n};\n\nvar Gamma0256 = function(x) {\n  return (S(x, 7) ^ S(x, 18) ^ R(x, 3));\n};\n\nvar Gamma1256 = function(x) {\n  return (S(x, 17) ^ S(x, 19) ^ R(x, 10));\n};\n\nvar core_sha256 = function(m, l) {\n  var K = new Array(0x428A2F98,0x71374491,0xB5C0FBCF,0xE9B5DBA5,0x3956C25B,0x59F111F1,0x923F82A4,0xAB1C5ED5,0xD807AA98,0x12835B01,0x243185BE,0x550C7DC3,0x72BE5D74,0x80DEB1FE,0x9BDC06A7,0xC19BF174,0xE49B69C1,0xEFBE4786,0xFC19DC6,0x240CA1CC,0x2DE92C6F,0x4A7484AA,0x5CB0A9DC,0x76F988DA,0x983E5152,0xA831C66D,0xB00327C8,0xBF597FC7,0xC6E00BF3,0xD5A79147,0x6CA6351,0x14292967,0x27B70A85,0x2E1B2138,0x4D2C6DFC,0x53380D13,0x650A7354,0x766A0ABB,0x81C2C92E,0x92722C85,0xA2BFE8A1,0xA81A664B,0xC24B8B70,0xC76C51A3,0xD192E819,0xD6990624,0xF40E3585,0x106AA070,0x19A4C116,0x1E376C08,0x2748774C,0x34B0BCB5,0x391C0CB3,0x4ED8AA4A,0x5B9CCA4F,0x682E6FF3,0x748F82EE,0x78A5636F,0x84C87814,0x8CC70208,0x90BEFFFA,0xA4506CEB,0xBEF9A3F7,0xC67178F2);\n  var HASH = new Array(0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19);\n    var W = new Array(64);\n    var a, b, c, d, e, f, g, h, i, j;\n    var T1, T2;\n  /* append padding */\n  m[l >> 5] |= 0x80 << (24 - l % 32);\n  m[((l + 64 >> 9) << 4) + 15] = l;\n  for (var i = 0; i < m.length; i += 16) {\n    a = HASH[0]; b = HASH[1]; c = HASH[2]; d = HASH[3]; e = HASH[4]; f = HASH[5]; g = HASH[6]; h = HASH[7];\n    for (var j = 0; j < 64; j++) {\n      if (j < 16) {\n        W[j] = m[j + i];\n      } else {\n        W[j] = safe_add(safe_add(safe_add(Gamma1256(W[j - 2]), W[j - 7]), Gamma0256(W[j - 15])), W[j - 16]);\n      }\n      T1 = safe_add(safe_add(safe_add(safe_add(h, Sigma1256(e)), Ch(e, f, g)), K[j]), W[j]);\n      T2 = safe_add(Sigma0256(a), Maj(a, b, c));\n      h = g; g = f; f = e; e = safe_add(d, T1); d = c; c = b; b = a; a = safe_add(T1, T2);\n    }\n    HASH[0] = safe_add(a, HASH[0]); HASH[1] = safe_add(b, HASH[1]); HASH[2] = safe_add(c, HASH[2]); HASH[3] = safe_add(d, HASH[3]);\n    HASH[4] = safe_add(e, HASH[4]); HASH[5] = safe_add(f, HASH[5]); HASH[6] = safe_add(g, HASH[6]); HASH[7] = safe_add(h, HASH[7]);\n  }\n  return HASH;\n};\n\nmodule.exports = function sha256(buf) {\n  return helpers.hash(buf, core_sha256, 32, true);\n};\n","// Original code adapted from Robert Kieffer.\n// details at https://github.com/broofa/node-uuid\n(function() {\n  var _global = this;\n\n  var mathRNG, whatwgRNG;\n\n  // NOTE: Math.random() does not guarantee \"cryptographic quality\"\n  mathRNG = function(size) {\n    var bytes = new Array(size);\n    var r;\n\n    for (var i = 0, r; i < size; i++) {\n      if ((i & 0x03) == 0) r = Math.random() * 0x100000000;\n      bytes[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return bytes;\n  }\n\n  if (_global.crypto && crypto.getRandomValues) {\n    whatwgRNG = function(size) {\n      var bytes = new Uint8Array(size);\n      crypto.getRandomValues(bytes);\n      return bytes;\n    }\n  }\n\n  module.exports = whatwgRNG || mathRNG;\n\n}())\n","/*\r\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\r\n * Digest Algorithm, as defined in RFC 1321.\r\n * Version 2.1 Copyright (C) Paul Johnston 1999 - 2002.\r\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\r\n * Distributed under the BSD License\r\n * See http://pajhome.org.uk/crypt/md5 for more info.\r\n */\r\n\r\nvar helpers = require('./helpers');\r\n\r\n/*\r\n * Perform a simple self-test to see if the VM is working\r\n */\r\nfunction md5_vm_test()\r\n{\r\n  return hex_md5(\"abc\") == \"900150983cd24fb0d6963f7d28e17f72\";\r\n}\r\n\r\n/*\r\n * Calculate the MD5 of an array of little-endian words, and a bit length\r\n */\r\nfunction core_md5(x, len)\r\n{\r\n  /* append padding */\r\n  x[len >> 5] |= 0x80 << ((len) % 32);\r\n  x[(((len + 64) >>> 9) << 4) + 14] = len;\r\n\r\n  var a =  1732584193;\r\n  var b = -271733879;\r\n  var c = -1732584194;\r\n  var d =  271733878;\r\n\r\n  for(var i = 0; i < x.length; i += 16)\r\n  {\r\n    var olda = a;\r\n    var oldb = b;\r\n    var oldc = c;\r\n    var oldd = d;\r\n\r\n    a = md5_ff(a, b, c, d, x[i+ 0], 7 , -680876936);\r\n    d = md5_ff(d, a, b, c, x[i+ 1], 12, -389564586);\r\n    c = md5_ff(c, d, a, b, x[i+ 2], 17,  606105819);\r\n    b = md5_ff(b, c, d, a, x[i+ 3], 22, -1044525330);\r\n    a = md5_ff(a, b, c, d, x[i+ 4], 7 , -176418897);\r\n    d = md5_ff(d, a, b, c, x[i+ 5], 12,  1200080426);\r\n    c = md5_ff(c, d, a, b, x[i+ 6], 17, -1473231341);\r\n    b = md5_ff(b, c, d, a, x[i+ 7], 22, -45705983);\r\n    a = md5_ff(a, b, c, d, x[i+ 8], 7 ,  1770035416);\r\n    d = md5_ff(d, a, b, c, x[i+ 9], 12, -1958414417);\r\n    c = md5_ff(c, d, a, b, x[i+10], 17, -42063);\r\n    b = md5_ff(b, c, d, a, x[i+11], 22, -1990404162);\r\n    a = md5_ff(a, b, c, d, x[i+12], 7 ,  1804603682);\r\n    d = md5_ff(d, a, b, c, x[i+13], 12, -40341101);\r\n    c = md5_ff(c, d, a, b, x[i+14], 17, -1502002290);\r\n    b = md5_ff(b, c, d, a, x[i+15], 22,  1236535329);\r\n\r\n    a = md5_gg(a, b, c, d, x[i+ 1], 5 , -165796510);\r\n    d = md5_gg(d, a, b, c, x[i+ 6], 9 , -1069501632);\r\n    c = md5_gg(c, d, a, b, x[i+11], 14,  643717713);\r\n    b = md5_gg(b, c, d, a, x[i+ 0], 20, -373897302);\r\n    a = md5_gg(a, b, c, d, x[i+ 5], 5 , -701558691);\r\n    d = md5_gg(d, a, b, c, x[i+10], 9 ,  38016083);\r\n    c = md5_gg(c, d, a, b, x[i+15], 14, -660478335);\r\n    b = md5_gg(b, c, d, a, x[i+ 4], 20, -405537848);\r\n    a = md5_gg(a, b, c, d, x[i+ 9], 5 ,  568446438);\r\n    d = md5_gg(d, a, b, c, x[i+14], 9 , -1019803690);\r\n    c = md5_gg(c, d, a, b, x[i+ 3], 14, -187363961);\r\n    b = md5_gg(b, c, d, a, x[i+ 8], 20,  1163531501);\r\n    a = md5_gg(a, b, c, d, x[i+13], 5 , -1444681467);\r\n    d = md5_gg(d, a, b, c, x[i+ 2], 9 , -51403784);\r\n    c = md5_gg(c, d, a, b, x[i+ 7], 14,  1735328473);\r\n    b = md5_gg(b, c, d, a, x[i+12], 20, -1926607734);\r\n\r\n    a = md5_hh(a, b, c, d, x[i+ 5], 4 , -378558);\r\n    d = md5_hh(d, a, b, c, x[i+ 8], 11, -2022574463);\r\n    c = md5_hh(c, d, a, b, x[i+11], 16,  1839030562);\r\n    b = md5_hh(b, c, d, a, x[i+14], 23, -35309556);\r\n    a = md5_hh(a, b, c, d, x[i+ 1], 4 , -1530992060);\r\n    d = md5_hh(d, a, b, c, x[i+ 4], 11,  1272893353);\r\n    c = md5_hh(c, d, a, b, x[i+ 7], 16, -155497632);\r\n    b = md5_hh(b, c, d, a, x[i+10], 23, -1094730640);\r\n    a = md5_hh(a, b, c, d, x[i+13], 4 ,  681279174);\r\n    d = md5_hh(d, a, b, c, x[i+ 0], 11, -358537222);\r\n    c = md5_hh(c, d, a, b, x[i+ 3], 16, -722521979);\r\n    b = md5_hh(b, c, d, a, x[i+ 6], 23,  76029189);\r\n    a = md5_hh(a, b, c, d, x[i+ 9], 4 , -640364487);\r\n    d = md5_hh(d, a, b, c, x[i+12], 11, -421815835);\r\n    c = md5_hh(c, d, a, b, x[i+15], 16,  530742520);\r\n    b = md5_hh(b, c, d, a, x[i+ 2], 23, -995338651);\r\n\r\n    a = md5_ii(a, b, c, d, x[i+ 0], 6 , -198630844);\r\n    d = md5_ii(d, a, b, c, x[i+ 7], 10,  1126891415);\r\n    c = md5_ii(c, d, a, b, x[i+14], 15, -1416354905);\r\n    b = md5_ii(b, c, d, a, x[i+ 5], 21, -57434055);\r\n    a = md5_ii(a, b, c, d, x[i+12], 6 ,  1700485571);\r\n    d = md5_ii(d, a, b, c, x[i+ 3], 10, -1894986606);\r\n    c = md5_ii(c, d, a, b, x[i+10], 15, -1051523);\r\n    b = md5_ii(b, c, d, a, x[i+ 1], 21, -2054922799);\r\n    a = md5_ii(a, b, c, d, x[i+ 8], 6 ,  1873313359);\r\n    d = md5_ii(d, a, b, c, x[i+15], 10, -30611744);\r\n    c = md5_ii(c, d, a, b, x[i+ 6], 15, -1560198380);\r\n    b = md5_ii(b, c, d, a, x[i+13], 21,  1309151649);\r\n    a = md5_ii(a, b, c, d, x[i+ 4], 6 , -145523070);\r\n    d = md5_ii(d, a, b, c, x[i+11], 10, -1120210379);\r\n    c = md5_ii(c, d, a, b, x[i+ 2], 15,  718787259);\r\n    b = md5_ii(b, c, d, a, x[i+ 9], 21, -343485551);\r\n\r\n    a = safe_add(a, olda);\r\n    b = safe_add(b, oldb);\r\n    c = safe_add(c, oldc);\r\n    d = safe_add(d, oldd);\r\n  }\r\n  return Array(a, b, c, d);\r\n\r\n}\r\n\r\n/*\r\n * These functions implement the four basic operations the algorithm uses.\r\n */\r\nfunction md5_cmn(q, a, b, x, s, t)\r\n{\r\n  return safe_add(bit_rol(safe_add(safe_add(a, q), safe_add(x, t)), s),b);\r\n}\r\nfunction md5_ff(a, b, c, d, x, s, t)\r\n{\r\n  return md5_cmn((b & c) | ((~b) & d), a, b, x, s, t);\r\n}\r\nfunction md5_gg(a, b, c, d, x, s, t)\r\n{\r\n  return md5_cmn((b & d) | (c & (~d)), a, b, x, s, t);\r\n}\r\nfunction md5_hh(a, b, c, d, x, s, t)\r\n{\r\n  return md5_cmn(b ^ c ^ d, a, b, x, s, t);\r\n}\r\nfunction md5_ii(a, b, c, d, x, s, t)\r\n{\r\n  return md5_cmn(c ^ (b | (~d)), a, b, x, s, t);\r\n}\r\n\r\n/*\r\n * Add integers, wrapping at 2^32. This uses 16-bit operations internally\r\n * to work around bugs in some JS interpreters.\r\n */\r\nfunction safe_add(x, y)\r\n{\r\n  var lsw = (x & 0xFFFF) + (y & 0xFFFF);\r\n  var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\r\n  return (msw << 16) | (lsw & 0xFFFF);\r\n}\r\n\r\n/*\r\n * Bitwise rotate a 32-bit number to the left.\r\n */\r\nfunction bit_rol(num, cnt)\r\n{\r\n  return (num << cnt) | (num >>> (32 - cnt));\r\n}\r\n\r\nmodule.exports = function md5(buf) {\r\n  return helpers.hash(buf, core_md5, 16);\r\n};\r\n","exports = module.exports = typeof Object.keys === 'function'\n  ? Object.keys : shim;\n\nexports.shim = shim;\nfunction shim (obj) {\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  return keys;\n}\n","var supportsArgumentsClass = (function(){\n  return Object.prototype.toString.call(arguments)\n})() == '[object Arguments]';\n\nexports = module.exports = supportsArgumentsClass ? supported : unsupported;\n\nexports.supported = supported;\nfunction supported(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n};\n\nexports.unsupported = unsupported;\nfunction unsupported(object){\n  return object &&\n    typeof object == 'object' &&\n    typeof object.length == 'number' &&\n    Object.prototype.hasOwnProperty.call(object, 'callee') &&\n    !Object.prototype.propertyIsEnumerable.call(object, 'callee') ||\n    false;\n};\n","// The Inflector transforms words from singular to plural, class names to table names, modularized class names to ones without,\n// and class names to foreign keys. The default inflections for pluralization, singularization, and uncountable words are kept\n// in inflections.coffee\n//\n// If you discover an incorrect inflection and require it for your application, you'll need\n// to correct it yourself (explained below).\n\nvar util = require('./util');\n\nvar inflect = module.exports;\n\n// Import [inflections](inflections.html) instance\ninflect.inflections = require('./inflections')\n\n// Gives easy access to add inflections to this class\ninflect.inflect = function (inflections_function) {\n  inflections_function(inflect.inflections);\n};\n\n// By default, _camelize_ converts strings to UpperCamelCase. If the argument to _camelize_\n// is set to _false_ then _camelize_ produces lowerCamelCase.\n//\n// _camelize_ will also convert '/' to '.' which is useful for converting paths to namespaces.\n//\n//     \"bullet_record\".camelize()             // => \"BulletRecord\"\n//     \"bullet_record\".camelize(false)        // => \"bulletRecord\"\n//     \"bullet_record/errors\".camelize()      // => \"BulletRecord.Errors\"\n//     \"bullet_record/errors\".camelize(false) // => \"bulletRecord.Errors\"\n//\n// As a rule of thumb you can think of _camelize_ as the inverse of _underscore_,\n// though there are cases where that does not hold:\n//\n//     \"SSLError\".underscore.camelize // => \"SslError\"\ninflect.camelize = function(lower_case_and_underscored_word, first_letter_in_uppercase) {\n  var result;\n  if (first_letter_in_uppercase == null) first_letter_in_uppercase = true;\n  result = util.string.gsub(lower_case_and_underscored_word, /\\/(.?)/, function($) {\n    return \".\" + (util.string.upcase($[1]));\n  });\n  result = util.string.gsub(result, /(?:_)(.)/, function($) {\n    return util.string.upcase($[1]);\n  });\n  if (first_letter_in_uppercase) {\n    return util.string.upcase(result);\n  } else {\n    return util.string.downcase(result);\n  }\n};\n\n// Makes an underscored, lowercase form from the expression in the string.\n//\n// Changes '.' to '/' to convert namespaces to paths.\n//\n//     \"BulletRecord\".underscore()         // => \"bullet_record\"\n//     \"BulletRecord.Errors\".underscore()  // => \"bullet_record/errors\"\n//\n// As a rule of thumb you can think of +underscore+ as the inverse of +camelize+,\n// though there are cases where that does not hold:\n//\n//     \"SSLError\".underscore().camelize() // => \"SslError\"\ninflect.underscore = function (camel_cased_word) {\n  var self;\n  self = util.string.gsub(camel_cased_word, /\\./, '/');\n  self = util.string.gsub(self, /([A-Z]+)([A-Z][a-z])/, \"$1_$2\");\n  self = util.string.gsub(self, /([a-z\\d])([A-Z])/, \"$1_$2\");\n  self = util.string.gsub(self, /-/, '_');\n  return self.toLowerCase();\n};\n\n// Replaces underscores with dashes in the string.\n//\n//     \"puni_puni\".dasherize()   // => \"puni-puni\"\ninflect.dasherize = function (underscored_word) {\n  return util.string.gsub(underscored_word, /_/, '-');\n};\n\n// Removes the module part from the expression in the string.\n//\n//     \"BulletRecord.String.Inflections\".demodulize() // => \"Inflections\"\n//     \"Inflections\".demodulize()                     // => \"Inflections\"\ninflect.demodulize = function (class_name_in_module) {\n  return util.string.gsub(class_name_in_module, /^.*\\./, '');\n};\n\n// Creates a foreign key name from a class name.\n// _separate_class_name_and_id_with_underscore_ sets whether\n// the method should put '_' between the name and 'id'.\n//\n//     \"Message\".foreign_key()      // => \"message_id\"\n//     \"Message\".foreign_key(false) // => \"messageid\"\n//     \"Admin::Post\".foreign_key()  // => \"post_id\"\ninflect.foreign_key = function (class_name, separate_class_name_and_id_with_underscore) {\n  if (separate_class_name_and_id_with_underscore == null) {\n    separate_class_name_and_id_with_underscore = true;\n  }\n  return inflect.underscore(inflect.demodulize(class_name)) + (separate_class_name_and_id_with_underscore ? \"_id\" : \"id\");\n};\n\n// Turns a number into an ordinal string used to denote the position in an\n// ordered sequence such as 1st, 2nd, 3rd, 4th.\n//\n//     ordinalize(1)     // => \"1st\"\n//     ordinalize(2)     // => \"2nd\"\n//     ordinalize(1002)  // => \"1002nd\"\n//     ordinalize(1003)  // => \"1003rd\"\n//     ordinalize(-11)   // => \"-11th\"\n//     ordinalize(-1021) // => \"-1021st\"\ninflect.ordinalize = function (number) {\n  var _ref;\n  number = parseInt(number);\n  if ((_ref = Math.abs(number) % 100) === 11 || _ref === 12 || _ref === 13) {\n    return \"\" + number + \"th\";\n  } else {\n    switch (Math.abs(number) % 10) {\n      case 1:\n        return \"\" + number + \"st\";\n      case 2:\n        return \"\" + number + \"nd\";\n      case 3:\n        return \"\" + number + \"rd\";\n      default:\n        return \"\" + number + \"th\";\n    }\n  }\n};\n\n// Checks a given word for uncountability\n//\n//     \"money\".uncountability()     // => true\n//     \"my money\".uncountability()  // => true\ninflect.uncountability = function (word) {\n  return inflect.inflections.uncountables.some(function(ele, ind, arr) {\n    return word.match(new RegExp(\"(\\\\b|_)\" + ele + \"$\", 'i')) != null;\n  });\n};\n\n// Returns the plural form of the word in the string.\n//\n//     \"post\".pluralize()             // => \"posts\"\n//     \"octopus\".pluralize()          // => \"octopi\"\n//     \"sheep\".pluralize()            // => \"sheep\"\n//     \"words\".pluralize()            // => \"words\"\n//     \"CamelOctopus\".pluralize()     // => \"CamelOctopi\"\ninflect.pluralize = function (word) {\n  var plural, result;\n  result = word;\n  if (word === '' || inflect.uncountability(word)) {\n    return result;\n  } else {\n    for (var i = 0; i < inflect.inflections.plurals.length; i++) {\n      plural = inflect.inflections.plurals[i];\n      result = util.string.gsub(result, plural[0], plural[1]);\n      if (word.match(plural[0]) != null) break;\n    }\n    return result;\n  }\n};\n\n// The reverse of _pluralize_, returns the singular form of a word in a string.\n//\n//     \"posts\".singularize()            // => \"post\"\n//     \"octopi\".singularize()           // => \"octopus\"\n//     \"sheep\".singularize()            // => \"sheep\"\n//     \"word\".singularize()             // => \"word\"\n//     \"CamelOctopi\".singularize()      // => \"CamelOctopus\"\ninflect.singularize = function (word) {\n  var result, singular;\n  result = word;\n  if (word === '' || inflect.uncountability(word)) {\n    return result;\n  } else {\n    for (var i = 0; i < inflect.inflections.singulars.length; i++) {\n      singular = inflect.inflections.singulars[i];\n      result = util.string.gsub(result, singular[0], singular[1]);\n      if (word.match(singular[0])) break;\n    }\n    return result;\n  }\n};\n\n// Capitalizes the first word and turns underscores into spaces and strips a\n// trailing \"_id\", if any. Like _titleize_, this is meant for creating pretty output.\n//\n//     \"employee_salary\".humanize()   // => \"Employee salary\"\n//     \"author_id\".humanize()         // => \"Author\"\ninflect.humanize = function (lower_case_and_underscored_word) {\n  var human, result;\n  result = lower_case_and_underscored_word;\n  for (var i = 0; i < inflect.inflections.humans.length; i++) {\n    human = inflect.inflections.humans[i];\n    result = util.string.gsub(result, human[0], human[1]);\n  }\n  result = util.string.gsub(result, /_id$/, \"\");\n  result = util.string.gsub(result, /_/, \" \");\n  return util.string.capitalize(result, true);\n};\n\n// Capitalizes all the words and replaces some characters in the string to create\n// a nicer looking title. _titleize_ is meant for creating pretty output. It is not\n// used in the Bullet internals.\n//\n//\n//     \"man from the boondocks\".titleize()   // => \"Man From The Boondocks\"\n//     \"x-men: the last stand\".titleize()    // => \"X Men: The Last Stand\"\ninflect.titleize = function (word) {\n  var self;\n  self = inflect.humanize(inflect.underscore(word));\n  self = util.string.gsub(self, /[^a-zA-Z:']/, ' ');\n  return util.string.capitalize(self);\n};\n\n// Create the name of a table like Bullet does for models to table names. This method\n// uses the _pluralize_ method on the last word in the string.\n//\n//     \"RawScaledScorer\".tableize()   // => \"raw_scaled_scorers\"\n//     \"egg_and_ham\".tableize()       // => \"egg_and_hams\"\n//     \"fancyCategory\".tableize()     // => \"fancy_categories\"\ninflect.tableize = function (class_name) {\n  return inflect.pluralize(inflect.underscore(class_name));\n};\n\n// Create a class name from a plural table name like Bullet does for table names to models.\n// Note that this returns a string and not a Class.\n//\n//     \"egg_and_hams\".classify()   // => \"EggAndHam\"\n//     \"posts\".classify()          // => \"Post\"\n//\n// Singular names are not handled correctly:\n//\n//     \"business\".classify()       // => \"Busines\"\ninflect.classify = function (table_name) {\n  return inflect.camelize(inflect.singularize(util.string.gsub(table_name, /.*\\./, '')));\n}\n","module.exports = function (obj) {\n\n  var addProperty = function (method, func) {\n    String.prototype.__defineGetter__(method, func);\n  }\n\n  var stringPrototypeBlacklist = [\n    '__defineGetter__', '__defineSetter__', '__lookupGetter__', '__lookupSetter__', 'charAt', 'constructor',\n    'hasOwnProperty', 'isPrototypeOf', 'propertyIsEnumerable', 'toLocaleString', 'toString', 'valueOf', 'charCodeAt',\n    'indexOf', 'lastIndexof', 'length', 'localeCompare', 'match', 'replace', 'search', 'slice', 'split', 'substring',\n    'toLocaleLowerCase', 'toLocaleUpperCase', 'toLowerCase', 'toUpperCase', 'trim', 'trimLeft', 'trimRight', 'gsub'\n  ];\n\n  Object.keys(obj).forEach(function (key) {\n    if (key != 'inflect' && key != 'inflections') {\n      if (stringPrototypeBlacklist.indexOf(key) !== -1) {\n        console.log('warn: You should not override String.prototype.' + key);\n      } else {\n        addProperty(key, function () {\n          return obj[key](this);\n        });\n      }\n    }\n  });\n\n}\n","var Buffer = require('buffer').Buffer;\nvar intSize = 4;\nvar zeroBuffer = new Buffer(intSize); zeroBuffer.fill(0);\nvar chrsz = 8;\n\nfunction toArray(buf, bigEndian) {\n  if ((buf.length % intSize) !== 0) {\n    var len = buf.length + (intSize - (buf.length % intSize));\n    buf = Buffer.concat([buf, zeroBuffer], len);\n  }\n\n  var arr = [];\n  var fn = bigEndian ? buf.readInt32BE : buf.readInt32LE;\n  for (var i = 0; i < buf.length; i += intSize) {\n    arr.push(fn.call(buf, i));\n  }\n  return arr;\n}\n\nfunction toBuffer(arr, size, bigEndian) {\n  var buf = new Buffer(size);\n  var fn = bigEndian ? buf.writeInt32BE : buf.writeInt32LE;\n  for (var i = 0; i < arr.length; i++) {\n    fn.call(buf, arr[i], i * 4, true);\n  }\n  return buf;\n}\n\nfunction hash(buf, fn, hashSize, bigEndian) {\n  if (!Buffer.isBuffer(buf)) buf = new Buffer(buf);\n  var arr = fn(toArray(buf, bigEndian), buf.length * chrsz);\n  return toBuffer(arr, hashSize, bigEndian);\n}\n\nmodule.exports = { hash: hash };\n","/*\n    cycle.js\n    2013-02-19\n\n    Public Domain.\n\n    NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.\n\n    This code should be minified before deployment.\n    See http://javascript.crockford.com/jsmin.html\n\n    USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO\n    NOT CONTROL.\n*/\n\n/*jslint evil: true, regexp: true */\n\n/*members $ref, apply, call, decycle, hasOwnProperty, length, prototype, push,\n    retrocycle, stringify, test, toString\n*/\n\nvar cycle = exports;\n\ncycle.decycle = function decycle(object) {\n    'use strict';\n\n// Make a deep copy of an object or array, assuring that there is at most\n// one instance of each object or array in the resulting structure. The\n// duplicate references (which might be forming cycles) are replaced with\n// an object of the form\n//      {$ref: PATH}\n// where the PATH is a JSONPath string that locates the first occurance.\n// So,\n//      var a = [];\n//      a[0] = a;\n//      return JSON.stringify(JSON.decycle(a));\n// produces the string '[{\"$ref\":\"$\"}]'.\n\n// JSONPath is used to locate the unique object. $ indicates the top level of\n// the object or array. [NUMBER] or [STRING] indicates a child member or\n// property.\n\n    var objects = [],   // Keep a reference to each unique object or array\n        paths = [];     // Keep the path to each unique object or array\n\n    return (function derez(value, path) {\n\n// The derez recurses through the object, producing the deep copy.\n\n        var i,          // The loop counter\n            name,       // Property name\n            nu;         // The new object or array\n\n// typeof null === 'object', so go on if this value is really an object but not\n// one of the weird builtin objects.\n\n        if (typeof value === 'object' && value !== null &&\n                !(value instanceof Boolean) &&\n                !(value instanceof Date)    &&\n                !(value instanceof Number)  &&\n                !(value instanceof RegExp)  &&\n                !(value instanceof String)) {\n\n// If the value is an object or array, look to see if we have already\n// encountered it. If so, return a $ref/path object. This is a hard way,\n// linear search that will get slower as the number of unique objects grows.\n\n            for (i = 0; i < objects.length; i += 1) {\n                if (objects[i] === value) {\n                    return {$ref: paths[i]};\n                }\n            }\n\n// Otherwise, accumulate the unique value and its path.\n\n            objects.push(value);\n            paths.push(path);\n\n// If it is an array, replicate the array.\n\n            if (Object.prototype.toString.apply(value) === '[object Array]') {\n                nu = [];\n                for (i = 0; i < value.length; i += 1) {\n                    nu[i] = derez(value[i], path + '[' + i + ']');\n                }\n            } else {\n\n// If it is an object, replicate the object.\n\n                nu = {};\n                for (name in value) {\n                    if (Object.prototype.hasOwnProperty.call(value, name)) {\n                        nu[name] = derez(value[name],\n                            path + '[' + JSON.stringify(name) + ']');\n                    }\n                }\n            }\n            return nu;\n        }\n        return value;\n    }(object, '$'));\n};\n\n\ncycle.retrocycle = function retrocycle($) {\n    'use strict';\n\n// Restore an object that was reduced by decycle. Members whose values are\n// objects of the form\n//      {$ref: PATH}\n// are replaced with references to the value found by the PATH. This will\n// restore cycles. The object will be mutated.\n\n// The eval function is used to locate the values described by a PATH. The\n// root object is kept in a $ variable. A regular expression is used to\n// assure that the PATH is extremely well formed. The regexp contains nested\n// * quantifiers. That has been known to have extremely bad performance\n// problems on some browsers for very long strings. A PATH is expected to be\n// reasonably short. A PATH is allowed to belong to a very restricted subset of\n// Goessner's JSONPath.\n\n// So,\n//      var s = '[{\"$ref\":\"$\"}]';\n//      return JSON.retrocycle(JSON.parse(s));\n// produces an array containing a single element which is the array itself.\n\n    var px =\n        /^\\$(?:\\[(?:\\d+|\\\"(?:[^\\\\\\\"\\u0000-\\u001f]|\\\\([\\\\\\\"\\/bfnrt]|u[0-9a-zA-Z]{4}))*\\\")\\])*$/;\n\n    (function rez(value) {\n\n// The rez function walks recursively through the object looking for $ref\n// properties. When it finds one that has a value that is a path, then it\n// replaces the $ref object with a reference to the value that is found by\n// the path.\n\n        var i, item, name, path;\n\n        if (value && typeof value === 'object') {\n            if (Object.prototype.toString.apply(value) === '[object Array]') {\n                for (i = 0; i < value.length; i += 1) {\n                    item = value[i];\n                    if (item && typeof item === 'object') {\n                        path = item.$ref;\n                        if (typeof path === 'string' && px.test(path)) {\n                            value[i] = eval(path);\n                        } else {\n                            rez(item);\n                        }\n                    }\n                }\n            } else {\n                for (name in value) {\n                    if (typeof value[name] === 'object') {\n                        item = value[name];\n                        if (item) {\n                            path = item.$ref;\n                            if (typeof path === 'string' && px.test(path)) {\n                                value[name] = eval(path);\n                            } else {\n                                rez(item);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }($));\n    return $;\n};\n","/*\ncolors.js\n\nCopyright (c) 2010\n\nMarak Squires\nAlexis Sellier (cloudhead)\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n\n*/\n\nvar isHeadless = false;\n\nif (typeof module !== 'undefined') {\n  isHeadless = true;\n}\n\nif (!isHeadless) {\n  var exports = {};\n  var module = {};\n  var colors = exports;\n  exports.mode = \"browser\";\n} else {\n  exports.mode = \"console\";\n}\n\n//\n// Prototypes the string object to have additional method calls that add terminal colors\n//\nvar addProperty = function (color, func) {\n  exports[color] = function (str) {\n    return func.apply(str);\n  };\n  String.prototype.__defineGetter__(color, func);\n};\n\nfunction stylize(str, style) {\n\n  var styles;\n\n  if (exports.mode === 'console') {\n    styles = {\n      //styles\n      'bold'      : ['\\x1B[1m',  '\\x1B[22m'],\n      'italic'    : ['\\x1B[3m',  '\\x1B[23m'],\n      'underline' : ['\\x1B[4m',  '\\x1B[24m'],\n      'inverse'   : ['\\x1B[7m',  '\\x1B[27m'],\n      'strikethrough' : ['\\x1B[9m',  '\\x1B[29m'],\n      //text colors\n      //grayscale\n      'white'     : ['\\x1B[37m', '\\x1B[39m'],\n      'grey'      : ['\\x1B[90m', '\\x1B[39m'],\n      'black'     : ['\\x1B[30m', '\\x1B[39m'],\n      //colors\n      'blue'      : ['\\x1B[34m', '\\x1B[39m'],\n      'cyan'      : ['\\x1B[36m', '\\x1B[39m'],\n      'green'     : ['\\x1B[32m', '\\x1B[39m'],\n      'magenta'   : ['\\x1B[35m', '\\x1B[39m'],\n      'red'       : ['\\x1B[31m', '\\x1B[39m'],\n      'yellow'    : ['\\x1B[33m', '\\x1B[39m'],\n      //background colors\n      //grayscale\n      'whiteBG'     : ['\\x1B[47m', '\\x1B[49m'],\n      'greyBG'      : ['\\x1B[49;5;8m', '\\x1B[49m'],\n      'blackBG'     : ['\\x1B[40m', '\\x1B[49m'],\n      //colors\n      'blueBG'      : ['\\x1B[44m', '\\x1B[49m'],\n      'cyanBG'      : ['\\x1B[46m', '\\x1B[49m'],\n      'greenBG'     : ['\\x1B[42m', '\\x1B[49m'],\n      'magentaBG'   : ['\\x1B[45m', '\\x1B[49m'],\n      'redBG'       : ['\\x1B[41m', '\\x1B[49m'],\n      'yellowBG'    : ['\\x1B[43m', '\\x1B[49m']\n    };\n  } else if (exports.mode === 'browser') {\n    styles = {\n      //styles\n      'bold'      : ['<b>',  '</b>'],\n      'italic'    : ['<i>',  '</i>'],\n      'underline' : ['<u>',  '</u>'],\n      'inverse'   : ['<span style=\"background-color:black;color:white;\">',  '</span>'],\n      'strikethrough' : ['<del>',  '</del>'],\n      //text colors\n      //grayscale\n      'white'     : ['<span style=\"color:white;\">',   '</span>'],\n      'grey'      : ['<span style=\"color:gray;\">',    '</span>'],\n      'black'     : ['<span style=\"color:black;\">',   '</span>'],\n      //colors\n      'blue'      : ['<span style=\"color:blue;\">',    '</span>'],\n      'cyan'      : ['<span style=\"color:cyan;\">',    '</span>'],\n      'green'     : ['<span style=\"color:green;\">',   '</span>'],\n      'magenta'   : ['<span style=\"color:magenta;\">', '</span>'],\n      'red'       : ['<span style=\"color:red;\">',     '</span>'],\n      'yellow'    : ['<span style=\"color:yellow;\">',  '</span>'],\n      //background colors\n      //grayscale\n      'whiteBG'     : ['<span style=\"background-color:white;\">',   '</span>'],\n      'greyBG'      : ['<span style=\"background-color:gray;\">',    '</span>'],\n      'blackBG'     : ['<span style=\"background-color:black;\">',   '</span>'],\n      //colors\n      'blueBG'      : ['<span style=\"background-color:blue;\">',    '</span>'],\n      'cyanBG'      : ['<span style=\"background-color:cyan;\">',    '</span>'],\n      'greenBG'     : ['<span style=\"background-color:green;\">',   '</span>'],\n      'magentaBG'   : ['<span style=\"background-color:magenta;\">', '</span>'],\n      'redBG'       : ['<span style=\"background-color:red;\">',     '</span>'],\n      'yellowBG'    : ['<span style=\"background-color:yellow;\">',  '</span>']\n    };\n  } else if (exports.mode === 'none') {\n    return str + '';\n  } else {\n    console.log('unsupported mode, try \"browser\", \"console\" or \"none\"');\n  }\n  return styles[style][0] + str + styles[style][1];\n}\n\nfunction applyTheme(theme) {\n\n  //\n  // Remark: This is a list of methods that exist\n  // on String that you should not overwrite.\n  //\n  var stringPrototypeBlacklist = [\n    '__defineGetter__', '__defineSetter__', '__lookupGetter__', '__lookupSetter__', 'charAt', 'constructor',\n    'hasOwnProperty', 'isPrototypeOf', 'propertyIsEnumerable', 'toLocaleString', 'toString', 'valueOf', 'charCodeAt',\n    'indexOf', 'lastIndexof', 'length', 'localeCompare', 'match', 'replace', 'search', 'slice', 'split', 'substring',\n    'toLocaleLowerCase', 'toLocaleUpperCase', 'toLowerCase', 'toUpperCase', 'trim', 'trimLeft', 'trimRight'\n  ];\n\n  Object.keys(theme).forEach(function (prop) {\n    if (stringPrototypeBlacklist.indexOf(prop) !== -1) {\n      console.log('warn: '.red + ('String.prototype' + prop).magenta + ' is probably something you don\\'t want to override. Ignoring style name');\n    }\n    else {\n      if (typeof(theme[prop]) === 'string') {\n        addProperty(prop, function () {\n          return exports[theme[prop]](this);\n        });\n      }\n      else {\n        addProperty(prop, function () {\n          var ret = this;\n          for (var t = 0; t < theme[prop].length; t++) {\n            ret = exports[theme[prop][t]](ret);\n          }\n          return ret;\n        });\n      }\n    }\n  });\n}\n\n\n//\n// Iterate through all default styles and colors\n//\nvar x = ['bold', 'underline', 'strikethrough', 'italic', 'inverse', 'grey', 'black', 'yellow', 'red', 'green', 'blue', 'white', 'cyan', 'magenta', 'greyBG', 'blackBG', 'yellowBG', 'redBG', 'greenBG', 'blueBG', 'whiteBG', 'cyanBG', 'magentaBG'];\nx.forEach(function (style) {\n\n  // __defineGetter__ at the least works in more browsers\n  // http://robertnyman.com/javascript/javascript-getters-setters.html\n  // Object.defineProperty only works in Chrome\n  addProperty(style, function () {\n    return stylize(this, style);\n  });\n});\n\nfunction sequencer(map) {\n  return function () {\n    if (!isHeadless) {\n      return this.replace(/( )/, '$1');\n    }\n    var exploded = this.split(\"\"), i = 0;\n    exploded = exploded.map(map);\n    return exploded.join(\"\");\n  };\n}\n\nvar rainbowMap = (function () {\n  var rainbowColors = ['red', 'yellow', 'green', 'blue', 'magenta']; //RoY G BiV\n  return function (letter, i, exploded) {\n    if (letter === \" \") {\n      return letter;\n    } else {\n      return stylize(letter, rainbowColors[i++ % rainbowColors.length]);\n    }\n  };\n})();\n\nexports.themes = {};\n\nexports.addSequencer = function (name, map) {\n  addProperty(name, sequencer(map));\n};\n\nexports.addSequencer('rainbow', rainbowMap);\nexports.addSequencer('zebra', function (letter, i, exploded) {\n  return i % 2 === 0 ? letter : letter.inverse;\n});\n\nexports.setTheme = function (theme) {\n  if (typeof theme === 'string') {\n    try {\n      exports.themes[theme] = require(theme);\n      applyTheme(exports.themes[theme]);\n      return exports.themes[theme];\n    } catch (err) {\n      console.log(err);\n      return err;\n    }\n  } else {\n    applyTheme(theme);\n  }\n};\n\n\naddProperty('stripColors', function () {\n  return (\"\" + this).replace(/\\x1B\\[\\d+m/g, '');\n});\n\n// please no\nfunction zalgo(text, options) {\n  var soul = {\n    \"up\" : [\n      '̍', '̎', '̄', '̅',\n      '̿', '̑', '̆', '̐',\n      '͒', '͗', '͑', '̇',\n      '̈', '̊', '͂', '̓',\n      '̈', '͊', '͋', '͌',\n      '̃', '̂', '̌', '͐',\n      '̀', '́', '̋', '̏',\n      '̒', '̓', '̔', '̽',\n      '̉', 'ͣ', 'ͤ', 'ͥ',\n      'ͦ', 'ͧ', 'ͨ', 'ͩ',\n      'ͪ', 'ͫ', 'ͬ', 'ͭ',\n      'ͮ', 'ͯ', '̾', '͛',\n      '͆', '̚'\n    ],\n    \"down\" : [\n      '̖', '̗', '̘', '̙',\n      '̜', '̝', '̞', '̟',\n      '̠', '̤', '̥', '̦',\n      '̩', '̪', '̫', '̬',\n      '̭', '̮', '̯', '̰',\n      '̱', '̲', '̳', '̹',\n      '̺', '̻', '̼', 'ͅ',\n      '͇', '͈', '͉', '͍',\n      '͎', '͓', '͔', '͕',\n      '͖', '͙', '͚', '̣'\n    ],\n    \"mid\" : [\n      '̕', '̛', '̀', '́',\n      '͘', '̡', '̢', '̧',\n      '̨', '̴', '̵', '̶',\n      '͜', '͝', '͞',\n      '͟', '͠', '͢', '̸',\n      '̷', '͡', ' ҉'\n    ]\n  },\n  all = [].concat(soul.up, soul.down, soul.mid),\n  zalgo = {};\n\n  function randomNumber(range) {\n    var r = Math.floor(Math.random() * range);\n    return r;\n  }\n\n  function is_char(character) {\n    var bool = false;\n    all.filter(function (i) {\n      bool = (i === character);\n    });\n    return bool;\n  }\n\n  function heComes(text, options) {\n    var result = '', counts, l;\n    options = options || {};\n    options[\"up\"] = options[\"up\"] || true;\n    options[\"mid\"] = options[\"mid\"] || true;\n    options[\"down\"] = options[\"down\"] || true;\n    options[\"size\"] = options[\"size\"] || \"maxi\";\n    text = text.split('');\n    for (l in text) {\n      if (is_char(l)) {\n        continue;\n      }\n      result = result + text[l];\n      counts = {\"up\" : 0, \"down\" : 0, \"mid\" : 0};\n      switch (options.size) {\n      case 'mini':\n        counts.up = randomNumber(8);\n        counts.min = randomNumber(2);\n        counts.down = randomNumber(8);\n        break;\n      case 'maxi':\n        counts.up = randomNumber(16) + 3;\n        counts.min = randomNumber(4) + 1;\n        counts.down = randomNumber(64) + 3;\n        break;\n      default:\n        counts.up = randomNumber(8) + 1;\n        counts.mid = randomNumber(6) / 2;\n        counts.down = randomNumber(8) + 1;\n        break;\n      }\n\n      var arr = [\"up\", \"mid\", \"down\"];\n      for (var d in arr) {\n        var index = arr[d];\n        for (var i = 0 ; i <= counts[index]; i++) {\n          if (options[index]) {\n            result = result + soul[index][randomNumber(soul[index].length)];\n          }\n        }\n      }\n    }\n    return result;\n  }\n  return heComes(text);\n}\n\n\n// don't summon zalgo\naddProperty('zalgo', function () {\n  return zalgo(this);\n});\n","// This file is just added for convenience so this repository can be\n// directly checked out into a project's deps folder\nmodule.exports = require('./lib/async');\n","exports.get = function(belowFn) {\n  var oldLimit = Error.stackTraceLimit;\n  Error.stackTraceLimit = Infinity;\n\n  var dummyObject = {};\n\n  var v8Handler = Error.prepareStackTrace;\n  Error.prepareStackTrace = function(dummyObject, v8StackTrace) {\n    return v8StackTrace;\n  };\n  Error.captureStackTrace(dummyObject, belowFn || exports.get);\n\n  var v8StackTrace = dummyObject.stack;\n  Error.prepareStackTrace = v8Handler;\n  Error.stackTraceLimit = oldLimit;\n\n  return v8StackTrace;\n};\n\nexports.parse = function(err) {\n  if (!err.stack) {\n    return [];\n  }\n\n  var self = this;\n  var lines = err.stack.split('\\n').slice(1);\n\n  return lines\n    .map(function(line) {\n      if (line.match(/^\\s*[-]{4,}$/)) {\n        return self._createParsedCallSite({\n          fileName: line,\n          lineNumber: null,\n          functionName: null,\n          typeName: null,\n          methodName: null,\n          columnNumber: null,\n          'native': null,\n        });\n      }\n\n      var lineMatch = line.match(/at (?:(.+)\\s+)?\\(?(?:(.+?):(\\d+):(\\d+)|([^)]+))\\)?/);\n      if (!lineMatch) {\n        return;\n      }\n\n      var object = null;\n      var method = null;\n      var functionName = null;\n      var typeName = null;\n      var methodName = null;\n      var isNative = (lineMatch[5] === 'native');\n\n      if (lineMatch[1]) {\n        var methodMatch = lineMatch[1].match(/([^\\.]+)(?:\\.(.+))?/);\n        object = methodMatch[1];\n        method = methodMatch[2];\n        functionName = lineMatch[1];\n        typeName = 'Object';\n      }\n\n      if (method) {\n        typeName = object;\n        methodName = method;\n      }\n\n      if (method === '<anonymous>') {\n        methodName = null;\n        functionName = '';\n      }\n\n      var properties = {\n        fileName: lineMatch[2] || null,\n        lineNumber: parseInt(lineMatch[3], 10) || null,\n        functionName: functionName,\n        typeName: typeName,\n        methodName: methodName,\n        columnNumber: parseInt(lineMatch[4], 10) || null,\n        'native': isNative,\n      };\n\n      return self._createParsedCallSite(properties);\n    })\n    .filter(function(callSite) {\n      return !!callSite;\n    });\n};\n\nexports._createParsedCallSite = function(properties) {\n  var methods = {};\n  for (var property in properties) {\n    var prefix = 'get';\n    if (property === 'native') {\n      prefix = 'is';\n    }\n    var method = prefix + property.substr(0, 1).toUpperCase() + property.substr(1);\n\n    (function(property) {\n      methods[method] = function() {\n        return properties[property];\n      }\n    })(property);\n  }\n\n  var callSite = Object.create(methods);\n  for (var property in properties) {\n    callSite[property] = properties[property];\n  }\n\n  return callSite;\n};\n","// Some utility functions in js\n\nvar u = module.exports = {\n  array: {\n    // Returns a copy of the array with the value removed once\n    //\n    //     [1, 2, 3, 1].del 1 #=> [2, 3, 1]\n    //     [1, 2, 3].del 4    #=> [1, 2, 3]\n    del: function (arr, val) {\n      var index = arr.indexOf(val);\n      if (index != -1) {\n        if (index == 0) {\n         return arr.slice(1)\n        } else {\n          return arr.slice(0, index).concat(arr.slice(index+1));\n        }\n      } else {\n        return arr;\n      }\n    },\n\n    // Returns the first element of the array\n    //\n    //     [1, 2, 3].first() #=> 1\n    first: function(arr) {\n      return arr[0];\n    },\n\n    // Returns the last element of the array\n    //\n    //     [1, 2, 3].last()  #=> 3\n    last: function(arr) {\n      return arr[arr.length-1];\n    }\n  },\n  string: {\n    // Returns a copy of str with all occurrences of pattern replaced with either replacement or the return value of a function.\n    // The pattern will typically be a Regexp; if it is a String then no regular expression metacharacters will be interpreted\n    // (that is /\\d/ will match a digit, but ‘\\d’ will match a backslash followed by a ‘d’).\n    //\n    // In the function form, the current match object is passed in as a parameter to the function, and variables such as\n    // $[1], $[2], $[3] (where $ is the match object) will be set appropriately. The value returned by the function will be\n    // substituted for the match on each call.\n    //\n    // The result inherits any tainting in the original string or any supplied replacement string.\n    //\n    //     \"hello\".gsub /[aeiou]/, '*'      #=> \"h*ll*\"\n    //     \"hello\".gsub /[aeiou]/, '<$1>'   #=> \"h<e>ll<o>\"\n    //     \"hello\".gsub /[aeiou]/, ($) {\n    //       \"<#{$[1]}>\"                    #=> \"h<e>ll<o>\"\n    //\n    gsub: function (str, pattern, replacement) {\n      var i, match, matchCmpr, matchCmprPrev, replacementStr, result, self;\n      if (!((pattern != null) && (replacement != null))) return u.string.value(str);\n      result = '';\n      self = str;\n      while (self.length > 0) {\n        if ((match = self.match(pattern))) {\n          result += self.slice(0, match.index);\n          if (typeof replacement === 'function') {\n            match[1] = match[1] || match[0];\n            result += replacement(match);\n          } else if (replacement.match(/\\$[1-9]/)) {\n            matchCmprPrev = match;\n            matchCmpr = u.array.del(match, void 0);\n            while (matchCmpr !== matchCmprPrev) {\n              matchCmprPrev = matchCmpr;\n              matchCmpr = u.array.del(matchCmpr, void 0);\n            }\n            match[1] = match[1] || match[0];\n            replacementStr = replacement;\n            for (i = 1; i <= 9; i++) {\n              if (matchCmpr[i]) {\n                replacementStr = u.string.gsub(replacementStr, new RegExp(\"\\\\\\$\" + i), matchCmpr[i]);\n              }\n            }\n            result += replacementStr;\n          } else {\n            result += replacement;\n          }\n          self = self.slice(match.index + match[0].length);\n        } else {\n          result += self;\n          self = '';\n        }\n      }\n      return result;\n    },\n\n    // Returns a copy of the String with the first letter being upper case\n    //\n    //     \"hello\".upcase #=> \"Hello\"\n    upcase: function(str) {\n      var self = u.string.gsub(str, /_([a-z])/, function ($) {\n        return \"_\" + $[1].toUpperCase();\n      });\n      self = u.string.gsub(self, /\\/([a-z])/, function ($) {\n        return \"/\" + $[1].toUpperCase();\n      });\n      return self[0].toUpperCase() + self.substr(1);\n    },\n\n    // Returns a copy of capitalized string\n    //\n    //     \"employee salary\" #=> \"Employee Salary\"\n    capitalize: function (str, spaces) {\n      var self = str.toLowerCase();\n      if(!spaces) {\n        self = u.string.gsub(self, /\\s([a-z])/, function ($) {\n          return \" \" + $[1].toUpperCase();\n        });\n      }\n      return self[0].toUpperCase() + self.substr(1);\n    },\n\n    // Returns a copy of the String with the first letter being lower case\n    //\n    //     \"HELLO\".downcase #=> \"hELLO\"\n    downcase: function(str) {\n      var self = u.string.gsub(str, /_([A-Z])/, function ($) {\n        return \"_\" + $[1].toLowerCase();\n      });\n      self = u.string.gsub(self, /\\/([A-Z])/, function ($) {\n        return \"/\" + $[1].toLowerCase();\n      });\n      return self[0].toLowerCase() + self.substr(1);\n    },\n\n    // Returns a string value for the String object\n    //\n    //     \"hello\".value() #=> \"hello\"\n    value: function (str) {\n      return str.substr(0);\n    }\n  }\n}\n","// A singleton instance of this class is yielded by Inflector.inflections, which can then be used to specify additional\n// inflection rules. Examples:\n//\n//     BulletSupport.Inflector.inflect ($) ->\n//       $.plural /^(ox)$/i, '$1en'\n//       $.singular /^(ox)en/i, '$1'\n//\n//       $.irregular 'octopus', 'octopi'\n//\n//       $.uncountable \"equipment\"\n//\n// New rules are added at the top. So in the example above, the irregular rule for octopus will now be the first of the\n// pluralization and singularization rules that is runs. This guarantees that your rules run before any of the rules that may\n// already have been loaded.\n\nvar util = require('./util');\n\nvar Inflections = function () {\n  this.plurals = [];\n  this.singulars = [];\n  this.uncountables = [];\n  this.humans = [];\n  require('./defaults')(this);\n  return this;\n};\n\n// Specifies a new pluralization rule and its replacement. The rule can either be a string or a regular expression.\n// The replacement should always be a string that may include references to the matched data from the rule.\nInflections.prototype.plural = function (rule, replacement) {\n  if (typeof rule == 'string') {\n    this.uncountables = util.array.del(this.uncountables, rule);\n  }\n  this.uncountables = util.array.del(this.uncountables, replacement);\n  this.plurals.unshift([rule, replacement]);\n};\n\n// Specifies a new singularization rule and its replacement. The rule can either be a string or a regular expression.\n// The replacement should always be a string that may include references to the matched data from the rule.\nInflections.prototype.singular = function (rule, replacement) {\n  if (typeof rule == 'string') {\n    this.uncountables = util.array.del(this.uncountables, rule);\n  }\n  this.uncountables = util.array.del(this.uncountables, replacement);\n  this.singulars.unshift([rule, replacement]);\n};\n\n// Specifies a new irregular that applies to both pluralization and singularization at the same time. This can only be used\n// for strings, not regular expressions. You simply pass the irregular in singular and plural form.\n//\n//     irregular 'octopus', 'octopi'\n//     irregular 'person', 'people'\nInflections.prototype.irregular =  function (singular, plural) {\n  this.uncountables = util.array.del(this.uncountables, singular);\n  this.uncountables = util.array.del(this.uncountables, plural);\n  if (singular[0].toUpperCase() == plural[0].toUpperCase()) {\n    this.plural(new RegExp(\"(\" + singular[0] + \")\" + singular.slice(1) + \"$\", \"i\"), '$1' + plural.slice(1));\n    this.plural(new RegExp(\"(\" + plural[0] + \")\" + plural.slice(1) + \"$\", \"i\"), '$1' + plural.slice(1));\n    this.singular(new RegExp(\"(\" + plural[0] + \")\" + plural.slice(1) + \"$\", \"i\"), '$1' + singular.slice(1));\n  } else {\n    this.plural(new RegExp(\"\" + (singular[0].toUpperCase()) + singular.slice(1) + \"$\"), plural[0].toUpperCase() + plural.slice(1));\n    this.plural(new RegExp(\"\" + (singular[0].toLowerCase()) + singular.slice(1) + \"$\"), plural[0].toLowerCase() + plural.slice(1));\n    this.plural(new RegExp(\"\" + (plural[0].toUpperCase()) + plural.slice(1) + \"$\"), plural[0].toUpperCase() + plural.slice(1));\n    this.plural(new RegExp(\"\" + (plural[0].toLowerCase()) + plural.slice(1) + \"$\"), plural[0].toLowerCase() + plural.slice(1));\n    this.singular(new RegExp(\"\" + (plural[0].toUpperCase()) + plural.slice(1) + \"$\"), singular[0].toUpperCase() + singular.slice(1));\n    this.singular(new RegExp(\"\" + (plural[0].toLowerCase()) + plural.slice(1) + \"$\"), singular[0].toLowerCase() + singular.slice(1));\n  }\n};\n\n// Specifies a humanized form of a string by a regular expression rule or by a string mapping.\n// When using a regular expression based replacement, the normal humanize formatting is called after the replacement.\n// When a string is used, the human form should be specified as desired (example: 'The name', not 'the_name')\n//\n//     human /(.*)_cnt$/i, '$1_count'\n//     human \"legacy_col_person_name\", \"Name\"\nInflections.prototype.human = function (rule, replacement) {\n  this.humans.unshift([rule, replacement]);\n}\n\n// Add uncountable words that shouldn't be attempted inflected.\n//\n//     uncountable \"money\"\n//     uncountable [\"money\", \"information\"]\nInflections.prototype.uncountable = function (words) {\n  this.uncountables = this.uncountables.concat(words);\n}\n\n// Clears the loaded inflections within a given scope (default is _'all'_).\n// Give the scope as a symbol of the inflection type, the options are: _'plurals'_,\n// _'singulars'_, _'uncountables'_, _'humans'_.\n//\n//     clear 'all'\n//     clear 'plurals'\nInflections.prototype.clear = function (scope) {\n  if (scope == null) scope = 'all';\n  switch (scope) {\n    case 'all':\n      this.plurals = [];\n      this.singulars = [];\n      this.uncountables = [];\n      this.humans = [];\n    default:\n      this[scope] = [];\n  }\n}\n\n// Clears the loaded inflections and initializes them to [default](../inflections.html)\nInflections.prototype.default = function () {\n  this.plurals = [];\n  this.singulars = [];\n  this.uncountables = [];\n  this.humans = [];\n  require('./defaults')(this);\n  return this;\n};\n\nmodule.exports = new Inflections();\n","/*global setTimeout: false, console: false */\n(function () {\n\n    var async = {};\n\n    // global on the server, window in the browser\n    var root = this,\n        previous_async = root.async;\n\n    if (typeof module !== 'undefined' && module.exports) {\n        module.exports = async;\n    }\n    else {\n        root.async = async;\n    }\n\n    async.noConflict = function () {\n        root.async = previous_async;\n        return async;\n    };\n\n    //// cross-browser compatiblity functions ////\n\n    var _forEach = function (arr, iterator) {\n        if (arr.forEach) {\n            return arr.forEach(iterator);\n        }\n        for (var i = 0; i < arr.length; i += 1) {\n            iterator(arr[i], i, arr);\n        }\n    };\n\n    var _map = function (arr, iterator) {\n        if (arr.map) {\n            return arr.map(iterator);\n        }\n        var results = [];\n        _forEach(arr, function (x, i, a) {\n            results.push(iterator(x, i, a));\n        });\n        return results;\n    };\n\n    var _reduce = function (arr, iterator, memo) {\n        if (arr.reduce) {\n            return arr.reduce(iterator, memo);\n        }\n        _forEach(arr, function (x, i, a) {\n            memo = iterator(memo, x, i, a);\n        });\n        return memo;\n    };\n\n    var _keys = function (obj) {\n        if (Object.keys) {\n            return Object.keys(obj);\n        }\n        var keys = [];\n        for (var k in obj) {\n            if (obj.hasOwnProperty(k)) {\n                keys.push(k);\n            }\n        }\n        return keys;\n    };\n\n    //// exported async module functions ////\n\n    //// nextTick implementation with browser-compatible fallback ////\n    if (typeof process === 'undefined' || !(process.nextTick)) {\n        async.nextTick = function (fn) {\n            setTimeout(fn, 0);\n        };\n    }\n    else {\n        async.nextTick = process.nextTick;\n    }\n\n    async.forEach = function (arr, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length) {\n            return callback();\n        }\n        var completed = 0;\n        _forEach(arr, function (x) {\n            iterator(x, function (err) {\n                if (err) {\n                    callback(err);\n                    callback = function () {};\n                }\n                else {\n                    completed += 1;\n                    if (completed === arr.length) {\n                        callback(null);\n                    }\n                }\n            });\n        });\n    };\n\n    async.forEachSeries = function (arr, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length) {\n            return callback();\n        }\n        var completed = 0;\n        var iterate = function () {\n            iterator(arr[completed], function (err) {\n                if (err) {\n                    callback(err);\n                    callback = function () {};\n                }\n                else {\n                    completed += 1;\n                    if (completed === arr.length) {\n                        callback(null);\n                    }\n                    else {\n                        iterate();\n                    }\n                }\n            });\n        };\n        iterate();\n    };\n\n    async.forEachLimit = function (arr, limit, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length || limit <= 0) {\n            return callback();\n        }\n        var completed = 0;\n        var started = 0;\n        var running = 0;\n\n        (function replenish () {\n            if (completed === arr.length) {\n                return callback();\n            }\n\n            while (running < limit && started < arr.length) {\n                started += 1;\n                running += 1;\n                iterator(arr[started - 1], function (err) {\n                    if (err) {\n                        callback(err);\n                        callback = function () {};\n                    }\n                    else {\n                        completed += 1;\n                        running -= 1;\n                        if (completed === arr.length) {\n                            callback();\n                        }\n                        else {\n                            replenish();\n                        }\n                    }\n                });\n            }\n        })();\n    };\n\n\n    var doParallel = function (fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [async.forEach].concat(args));\n        };\n    };\n    var doSeries = function (fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [async.forEachSeries].concat(args));\n        };\n    };\n\n\n    var _asyncMap = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (err, v) {\n                results[x.index] = v;\n                callback(err);\n            });\n        }, function (err) {\n            callback(err, results);\n        });\n    };\n    async.map = doParallel(_asyncMap);\n    async.mapSeries = doSeries(_asyncMap);\n\n\n    // reduce only has a series version, as doing reduce in parallel won't\n    // work in many situations.\n    async.reduce = function (arr, memo, iterator, callback) {\n        async.forEachSeries(arr, function (x, callback) {\n            iterator(memo, x, function (err, v) {\n                memo = v;\n                callback(err);\n            });\n        }, function (err) {\n            callback(err, memo);\n        });\n    };\n    // inject alias\n    async.inject = async.reduce;\n    // foldl alias\n    async.foldl = async.reduce;\n\n    async.reduceRight = function (arr, memo, iterator, callback) {\n        var reversed = _map(arr, function (x) {\n            return x;\n        }).reverse();\n        async.reduce(reversed, memo, iterator, callback);\n    };\n    // foldr alias\n    async.foldr = async.reduceRight;\n\n    var _filter = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (v) {\n                if (v) {\n                    results.push(x);\n                }\n                callback();\n            });\n        }, function (err) {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    };\n    async.filter = doParallel(_filter);\n    async.filterSeries = doSeries(_filter);\n    // select alias\n    async.select = async.filter;\n    async.selectSeries = async.filterSeries;\n\n    var _reject = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (v) {\n                if (!v) {\n                    results.push(x);\n                }\n                callback();\n            });\n        }, function (err) {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    };\n    async.reject = doParallel(_reject);\n    async.rejectSeries = doSeries(_reject);\n\n    var _detect = function (eachfn, arr, iterator, main_callback) {\n        eachfn(arr, function (x, callback) {\n            iterator(x, function (result) {\n                if (result) {\n                    main_callback(x);\n                    main_callback = function () {};\n                }\n                else {\n                    callback();\n                }\n            });\n        }, function (err) {\n            main_callback();\n        });\n    };\n    async.detect = doParallel(_detect);\n    async.detectSeries = doSeries(_detect);\n\n    async.some = function (arr, iterator, main_callback) {\n        async.forEach(arr, function (x, callback) {\n            iterator(x, function (v) {\n                if (v) {\n                    main_callback(true);\n                    main_callback = function () {};\n                }\n                callback();\n            });\n        }, function (err) {\n            main_callback(false);\n        });\n    };\n    // any alias\n    async.any = async.some;\n\n    async.every = function (arr, iterator, main_callback) {\n        async.forEach(arr, function (x, callback) {\n            iterator(x, function (v) {\n                if (!v) {\n                    main_callback(false);\n                    main_callback = function () {};\n                }\n                callback();\n            });\n        }, function (err) {\n            main_callback(true);\n        });\n    };\n    // all alias\n    async.all = async.every;\n\n    async.sortBy = function (arr, iterator, callback) {\n        async.map(arr, function (x, callback) {\n            iterator(x, function (err, criteria) {\n                if (err) {\n                    callback(err);\n                }\n                else {\n                    callback(null, {value: x, criteria: criteria});\n                }\n            });\n        }, function (err, results) {\n            if (err) {\n                return callback(err);\n            }\n            else {\n                var fn = function (left, right) {\n                    var a = left.criteria, b = right.criteria;\n                    return a < b ? -1 : a > b ? 1 : 0;\n                };\n                callback(null, _map(results.sort(fn), function (x) {\n                    return x.value;\n                }));\n            }\n        });\n    };\n\n    async.auto = function (tasks, callback) {\n        callback = callback || function () {};\n        var keys = _keys(tasks);\n        if (!keys.length) {\n            return callback(null);\n        }\n\n        var results = {};\n\n        var listeners = [];\n        var addListener = function (fn) {\n            listeners.unshift(fn);\n        };\n        var removeListener = function (fn) {\n            for (var i = 0; i < listeners.length; i += 1) {\n                if (listeners[i] === fn) {\n                    listeners.splice(i, 1);\n                    return;\n                }\n            }\n        };\n        var taskComplete = function () {\n            _forEach(listeners.slice(0), function (fn) {\n                fn();\n            });\n        };\n\n        addListener(function () {\n            if (_keys(results).length === keys.length) {\n                callback(null, results);\n                callback = function () {};\n            }\n        });\n\n        _forEach(keys, function (k) {\n            var task = (tasks[k] instanceof Function) ? [tasks[k]]: tasks[k];\n            var taskCallback = function (err) {\n                if (err) {\n                    callback(err);\n                    // stop subsequent errors hitting callback multiple times\n                    callback = function () {};\n                }\n                else {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    taskComplete();\n                }\n            };\n            var requires = task.slice(0, Math.abs(task.length - 1)) || [];\n            var ready = function () {\n                return _reduce(requires, function (a, x) {\n                    return (a && results.hasOwnProperty(x));\n                }, true) && !results.hasOwnProperty(k);\n            };\n            if (ready()) {\n                task[task.length - 1](taskCallback, results);\n            }\n            else {\n                var listener = function () {\n                    if (ready()) {\n                        removeListener(listener);\n                        task[task.length - 1](taskCallback, results);\n                    }\n                };\n                addListener(listener);\n            }\n        });\n    };\n\n    async.waterfall = function (tasks, callback) {\n        callback = callback || function () {};\n        if (!tasks.length) {\n            return callback();\n        }\n        var wrapIterator = function (iterator) {\n            return function (err) {\n                if (err) {\n                    callback(err);\n                    callback = function () {};\n                }\n                else {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    var next = iterator.next();\n                    if (next) {\n                        args.push(wrapIterator(next));\n                    }\n                    else {\n                        args.push(callback);\n                    }\n                    async.nextTick(function () {\n                        iterator.apply(null, args);\n                    });\n                }\n            };\n        };\n        wrapIterator(async.iterator(tasks))();\n    };\n\n    async.parallel = function (tasks, callback) {\n        callback = callback || function () {};\n        if (tasks.constructor === Array) {\n            async.map(tasks, function (fn, callback) {\n                if (fn) {\n                    fn(function (err) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        if (args.length <= 1) {\n                            args = args[0];\n                        }\n                        callback.call(null, err, args);\n                    });\n                }\n            }, callback);\n        }\n        else {\n            var results = {};\n            async.forEach(_keys(tasks), function (k, callback) {\n                tasks[k](function (err) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n\n    async.series = function (tasks, callback) {\n        callback = callback || function () {};\n        if (tasks.constructor === Array) {\n            async.mapSeries(tasks, function (fn, callback) {\n                if (fn) {\n                    fn(function (err) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        if (args.length <= 1) {\n                            args = args[0];\n                        }\n                        callback.call(null, err, args);\n                    });\n                }\n            }, callback);\n        }\n        else {\n            var results = {};\n            async.forEachSeries(_keys(tasks), function (k, callback) {\n                tasks[k](function (err) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n\n    async.iterator = function (tasks) {\n        var makeCallback = function (index) {\n            var fn = function () {\n                if (tasks.length) {\n                    tasks[index].apply(null, arguments);\n                }\n                return fn.next();\n            };\n            fn.next = function () {\n                return (index < tasks.length - 1) ? makeCallback(index + 1): null;\n            };\n            return fn;\n        };\n        return makeCallback(0);\n    };\n\n    async.apply = function (fn) {\n        var args = Array.prototype.slice.call(arguments, 1);\n        return function () {\n            return fn.apply(\n                null, args.concat(Array.prototype.slice.call(arguments))\n            );\n        };\n    };\n\n    var _concat = function (eachfn, arr, fn, callback) {\n        var r = [];\n        eachfn(arr, function (x, cb) {\n            fn(x, function (err, y) {\n                r = r.concat(y || []);\n                cb(err);\n            });\n        }, function (err) {\n            callback(err, r);\n        });\n    };\n    async.concat = doParallel(_concat);\n    async.concatSeries = doSeries(_concat);\n\n    async.whilst = function (test, iterator, callback) {\n        if (test()) {\n            iterator(function (err) {\n                if (err) {\n                    return callback(err);\n                }\n                async.whilst(test, iterator, callback);\n            });\n        }\n        else {\n            callback();\n        }\n    };\n\n    async.until = function (test, iterator, callback) {\n        if (!test()) {\n            iterator(function (err) {\n                if (err) {\n                    return callback(err);\n                }\n                async.until(test, iterator, callback);\n            });\n        }\n        else {\n            callback();\n        }\n    };\n\n    async.queue = function (worker, concurrency) {\n        var workers = 0;\n        var q = {\n            tasks: [],\n            concurrency: concurrency,\n            saturated: null,\n            empty: null,\n            drain: null,\n            push: function (data, callback) {\n                if(data.constructor !== Array) {\n                    data = [data];\n                }\n                _forEach(data, function(task) {\n                    q.tasks.push({\n                        data: task,\n                        callback: typeof callback === 'function' ? callback : null\n                    });\n                    if (q.saturated && q.tasks.length == concurrency) {\n                        q.saturated();\n                    }\n                    async.nextTick(q.process);\n                });\n            },\n            process: function () {\n                if (workers < q.concurrency && q.tasks.length) {\n                    var task = q.tasks.shift();\n                    if(q.empty && q.tasks.length == 0) q.empty();\n                    workers += 1;\n                    worker(task.data, function () {\n                        workers -= 1;\n                        if (task.callback) {\n                            task.callback.apply(task, arguments);\n                        }\n                        if(q.drain && q.tasks.length + workers == 0) q.drain();\n                        q.process();\n                    });\n                }\n            },\n            length: function () {\n                return q.tasks.length;\n            },\n            running: function () {\n                return workers;\n            }\n        };\n        return q;\n    };\n\n    var _console_fn = function (name) {\n        return function (fn) {\n            var args = Array.prototype.slice.call(arguments, 1);\n            fn.apply(null, args.concat([function (err) {\n                var args = Array.prototype.slice.call(arguments, 1);\n                if (typeof console !== 'undefined') {\n                    if (err) {\n                        if (console.error) {\n                            console.error(err);\n                        }\n                    }\n                    else if (console[name]) {\n                        _forEach(args, function (x) {\n                            console[name](x);\n                        });\n                    }\n                }\n            }]));\n        };\n    };\n    async.log = _console_fn('log');\n    async.dir = _console_fn('dir');\n    /*async.info = _console_fn('info');\n    async.warn = _console_fn('warn');\n    async.error = _console_fn('error');*/\n\n    async.memoize = function (fn, hasher) {\n        var memo = {};\n        var queues = {};\n        hasher = hasher || function (x) {\n            return x;\n        };\n        var memoized = function () {\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            var key = hasher.apply(null, args);\n            if (key in memo) {\n                callback.apply(null, memo[key]);\n            }\n            else if (key in queues) {\n                queues[key].push(callback);\n            }\n            else {\n                queues[key] = [callback];\n                fn.apply(null, args.concat([function () {\n                    memo[key] = arguments;\n                    var q = queues[key];\n                    delete queues[key];\n                    for (var i = 0, l = q.length; i < l; i++) {\n                      q[i].apply(null, arguments);\n                    }\n                }]));\n            }\n        };\n        memoized.unmemoized = fn;\n        return memoized;\n    };\n\n    async.unmemoize = function (fn) {\n      return function () {\n        return (fn.unmemoized || fn).apply(null, arguments);\n      };\n    };\n\n}());\n","// Default inflections\nmodule.exports = function (inflect) {\n\n  inflect.plural(/$/, 's');\n  inflect.plural(/s$/i, 's');\n  inflect.plural(/(ax|test)is$/i, '$1es');\n  inflect.plural(/(octop|vir)us$/i, '$1i');\n  inflect.plural(/(octop|vir)i$/i, '$1i');\n  inflect.plural(/(alias|status)$/i, '$1es');\n  inflect.plural(/(bu)s$/i, '$1ses');\n  inflect.plural(/(buffal|tomat)o$/i, '$1oes');\n  inflect.plural(/([ti])um$/i, '$1a');\n  inflect.plural(/([ti])a$/i, '$1a');\n  inflect.plural(/sis$/i, 'ses');\n  inflect.plural(/(?:([^f])fe|([lr])f)$/i, '$1ves');\n  inflect.plural(/(hive)$/i, '$1s');\n  inflect.plural(/([^aeiouy]|qu)y$/i, '$1ies');\n  inflect.plural(/(x|ch|ss|sh)$/i, '$1es');\n  inflect.plural(/(matr|vert|ind)(?:ix|ex)$/i, '$1ices');\n  inflect.plural(/([m|l])ouse$/i, '$1ice');\n  inflect.plural(/([m|l])ice$/i, '$1ice');\n  inflect.plural(/^(ox)$/i, '$1en');\n  inflect.plural(/^(oxen)$/i, '$1');\n  inflect.plural(/(quiz)$/i, '$1zes');\n\n\n  inflect.singular(/s$/i, '');\n  inflect.singular(/(n)ews$/i, '$1ews');\n  inflect.singular(/([ti])a$/i, '$1um');\n  inflect.singular(/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i, '$1sis');\n  inflect.singular(/(^analy)ses$/i, '$1sis');\n  inflect.singular(/([^f])ves$/i, '$1fe');\n  inflect.singular(/(hive)s$/i, '$1');\n  inflect.singular(/(tive)s$/i, '$1');\n  inflect.singular(/([lr])ves$/i, '$1f');\n  inflect.singular(/([^aeiouy]|qu)ies$/i, '$1y');\n  inflect.singular(/(s)eries$/i, '$1eries');\n  inflect.singular(/(m)ovies$/i, '$1ovie');\n  inflect.singular(/(x|ch|ss|sh)es$/i, '$1');\n  inflect.singular(/([m|l])ice$/i, '$1ouse');\n  inflect.singular(/(bus)es$/i, '$1');\n  inflect.singular(/(o)es$/i, '$1');\n  inflect.singular(/(shoe)s$/i, '$1');\n  inflect.singular(/(cris|ax|test)es$/i, '$1is');\n  inflect.singular(/(octop|vir)i$/i, '$1us');\n  inflect.singular(/(alias|status)es$/i, '$1');\n  inflect.singular(/^(ox)en/i, '$1');\n  inflect.singular(/(vert|ind)ices$/i, '$1ex');\n  inflect.singular(/(matr)ices$/i, '$1ix');\n  inflect.singular(/(quiz)zes$/i, '$1');\n  inflect.singular(/(database)s$/i, '$1');\n\n  inflect.irregular('child', 'children');\n  inflect.irregular('person', 'people');\n  inflect.irregular('man', 'men');\n  inflect.irregular('child', 'children');\n  inflect.irregular('sex', 'sexes');\n  inflect.irregular('move', 'moves');\n  inflect.irregular('cow', 'kine');\n  inflect.irregular('zombie', 'zombies');\n\n  inflect.uncountable(['equipment', 'information', 'rice', 'money', 'species', 'series', 'fish', 'sheep', 'jeans']);\n}\n"]}